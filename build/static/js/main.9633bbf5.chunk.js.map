{"version":3,"sources":["colors.js","HelperFunctions.js","Timechart.js","Regionchart.js","Layout.js","Bubblechart.js","Options.js","ParseData.js","Map.js","App.js","reportWebVitals.js","index.js"],"names":["colors","hdi_category","inform_severity","blue","lightblue","lightnavy","red","green","ifrcgreen","black","lightgrey","darkgrey","white","olive","purple","orange","pink","c","regions","addCommas","nStr","x","split","x1","x2","length","rgx","test","replace","nFormatter","num","digits","lookup","value","symbol","rx","item","slice","reverse","find","toFixed","yScaleCases","yScaleDeaths","yScaleVaccines","yAxisCases","yAxisDeaths","yAxisVaccines","yScaleCasesAxis","yScaleDeathsAxis","yScaleVaccinesAxis","xScale","xAxis","xScaleAxis","xScaleEvents","maxDate","minDate","md","vgroupedData","drawTimechart","data","options","Date","min_date","max_date","groupedData","who_data","forEach","d","i","timeline_frequency","date","week_start","month_start","ifrc_region","new_cases","new_deaths","cumulative_cases","cumulative_deaths","dd","ii","hasOwnProperty","total_new_cases","AF","AP","AM","EU","ME","OTH","total_cumulative_cases","total_new_deaths","total_cumulative_deaths","region","push","timeline_type","vaccines_data","new_vaccines","daily_vaccinations","cumulative_vaccines","total_new_vaccines","newVaccines","vData","clone","endOfWeekDate","moment","endOf","startOf","unix","maxDateUnix","endOfMonthDate","total_vaccinations","total_cumulative_vaccines","filter","el","numIntervals","d3","maxCases","maxDeaths","maxVaccines","toDate","add","svg","selectAll","remove","append","attr","barWidth","barSpacing","range","domain","scale","tickSize","tickPadding","ticks","tickFormat","yAxisGroup","xAxisCases","call","xAxisDeaths","xAxisVaccines","xAxisTimeline","barGroups","enter","totalNewCases","this","parentNode","datum","dp","y","totalNewDeaths","next","offset","vbarGroups","totalNewVaccines","tData","timeline_data","document","getElementById","appendChild","node","timelineTooltip","eventTooltip","hoverBar","on","event","coords","xDate","invert","getTime","style","tooltipStr","format","text","groupedDataFiltered","vgroupedDataFiltered","deaths","cases","vaccines","ratio","brushR","brushL","events","subtract","select","wrap","textwrap","bounds","height","width","method","description","bbox","getBBox","ys","parseInt","circles","brush","extent","parseFloat","viewBoxW","Math","round","brushScale","viewBoxX","gBrush","move","updateTimechart","transition","duration","maxVaccinations","xScaleCases","xScaleDeaths","xScaleVaccines","labelWidth","rcSize","margin","drawRegionchart","population","country","code","who_daily_latest","vaccine_daily_latest","cumulative_cases_per_100k","cumulative_deaths_per_100k","cumulative_vaccines_per_100k","isFinite","region_switch","regionChartContainer","rowHeight","rows","label","t","val","region_chart_toggle","isNaN","updateRegionchart","id","tween","floor","random","printing","selectedToggle","unselectedToggle","unselectedToggleText","selectedToggleText","Layout","updateTable","updateMap","bd","region_filter","map_toggle","tippy","content","placement","theme","arrow","delay","toggle","hdi_filter","inform_filter","tab_toggle","timechartContainer","tcSize","timechartSvg","layer1","tableRowHeight","tableBarYOffset","thisId","table_sort","table_sort_direction","page","setTimeout","html2canvas","querySelector","allowTaint","onclone","doc","useCORS","foreignObjectRendering","ignoreElements","element","scrollX","scrollY","logging","then","canvas","img","toDataURL","pdf","jsPDF","imgProps","getImageProperties","pdfWidth","internal","pageSize","getWidth","pdfHeight","addImage","save","link","createElement","download","href","click","collection","idx","indexOf","splice","yScale","zScale","maxX","maxY","maxZ","drawBubblechart","gni_2017","bubble_chart_y_axis","nice","join","people_vaccinated_per_hundred","people_fully_vaccinated_per_hundred","vaccine_acceptance_percent","bubble_chart_color_by","update","exit","country_name","toElement","updateBubblechart","country_filter","numPages","ParseData","sort","a","b","equity_data","pop","vaccines_used","avg_tests_per_1000","number_vaccine_types_used","vaccines_per_100","vaccines_who_data","country_iso3","ISO3","NUMBER_VACCINES_TYPES_USED","TOTAL_VACCINATIONS_PER100","VACCINES_USED","map","trim","ns_involvement","self_assessment","vaccine_acceptance","iso3","indicator_value","vaccine_acceptance_population","population_size","contract_tracing","toLowerCase","match","max","Date_reported","maxDateVaccines","min_vaccine_date","min","max_vaccine_date","country_code","Country_code","country_iso2","Cumulative_deaths","Cumulative_cases","New_cases","New_deaths","whoDataGrouped","flatGroup","datesToAdd","lastRecord","dayTotal","dayCheck","weekTotal","weekCheck","monthTotal","monthCheck","whoCountryCodes","dayOfYear","week","isoWeek","month","getMonth","year","getFullYear","undefined","includes","Country","WHO_region","iso_code","vaccineDataByCountry","newDays","hasDays","vDataFlat","lastDate","data_updated","day","setDate","getDate","newDay","totalVac","totalVac100","countryName","total_vaccinations_per_hundred","dailyVac","whoDataByCountry","countryCode","who_daily_7_days","who_daily_14_days","who_daily_21_days","who_daily_28_days","cumulative_deaths_7_days","cumulative_deaths_14_days","cumulative_deaths_21_days","cumulative_deaths_28_days","cumulative_cases_7_days","cumulative_cases_14_days","cumulative_cases_21_days","cumulative_cases_28_days","percentChange","percent_change","original","mapboxgl","accessToken","mapTooltip","createMap","setCenter","setZoom","Map","container","center","preserveDrawingBuffer","zoom","setRenderWorldCopies","addControl","NavigationControl","scrollZoom","disable","getCanvasContainer","e","setPaintProperty","setLayoutProperty","maxIncrease","maxDecrease","ceil","abs","colorScale","clamp","fillColorArray","maxValue","peoplevaccinated","features","queryRenderedFeatures","point","layer","properties","iso","countryfiltered","str","window","innerWidth","equityDataUrl","layoutUrl","whoDataUrl","vaccinesDataUrl","vaccinesWhoDataUrl","timelineDataUrl","selfAssessmentDataUrl","vaccineAcceptanceDataUrl","regionOptions","countryOptions","parse","p","App","useState","progress","setProgress","loaderText","setLoaderText","documentElement","createSelects","createCharts","updateTotals","hdi_countries","inform_countries","substring","countryIds","mergeFilter","concat","$","trigger","values","select2","hide","css","show","handleSelectLength","numCountriesFiltered","totalCases","textTween","totalDeaths","totalVaccinations","vaccinesPer100","vaccine_population","vaccineAcceptance","numNsInvolvedCountres","vaccine_types","ddd","vaccinePer100ByPopulation","vaccineAcceptancePercent","vtooltipbbox","hdiData","hdiDataPopulation","hdiDataVaccines","hdiContactTracing","hdiTotalCasesData","hdiTestingData","informData","informDataPopulation","informDataVaccines","informContactTracing","informTotalCasesData","informTestingData","totalHdiPop","totalInformPop","maxhdivac","maxinformvac","maxhditest","maxinformtest","sortKey","localeCompare","timer","ms","Promise","res","k","name","dayFormat","children","placeholder","scrollAfterSelect","renderTemplate","dropdownParent","shouldFocusInput","templateResult","removeData","preventDefault","params","minimumResultsForSearch","useEffect","init","className","multiple","defaultValue","target","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.9633bbf5.chunk.js","sourcesContent":["// default options\nconst colors = {\n    hdi_category: {\n        'very-high': '#D8EF8B', \n        'high': '#FDE08B', \n        'medium': '#FB8D59', \n        'low': '#D63127'\n    },\n    inform_severity: {\n        'very-high': '#D63127', \n        'high': '#FB8D59', \n        'medium': '#FDE08B', \n        'low': '#D8EF8B', \n        'no-score': '#DAE0EA', \n    },\n    blue: '#1F558C',\n    lightblue: '#62D7F7',\n    lightnavy: '#799EAD',\n    // red: '#E02225',\n    red: '#EE3224',\n    green: '#D8EF8B',\n    ifrcgreen: '#87C400',\n    black: '#595454',\n    lightgrey: '#e8e8e8',\n    darkgrey: '#c1c1c1',\n    white: '#fff',\n    olive: '#87C400',\n    purple: '#771966',\n    orange: '#FF3500',\n    pink: '#FB0080'\n}\n\n// option 1\nvar c = ['#00ADED','#003A5A','#62D7F7','#799EAD','#BCCED6']\n// option 2\nvar c = ['#00ADED','#62D7F7','#003A5A','#799EAD','#FFDD00'];\n// option 3\nvar reds = ['#771912','#be281d','#ee3224','#f79992','#fcd6d3'];\nvar blues = ['#09192a','#163b62','#1f558c','#7999ba','#d2dde8'];\n\n\ncolors.regions = {\n        'AP': colors.orange, \n        'AM': colors.lightblue, \n        'EU': colors.ifrcgreen, \n        'ME': '#0A3248', \n        'AF': '#FCD204', \n    }\n\n    colors.regions = {\n        'AP': c[1], \n        'AM': c[0], \n        'EU': c[2], \n        'ME': c[3], \n        'AF': c[4], \n    }\n\n    // colors.regions = {\n    //     'AP': reds[3], \n    //     'AM': reds[0], \n    //     'EU': reds[1], \n    //     'ME': reds[2], \n    //     'AF': reds[4], \n    // }\n\n    // colors.regions_blue = {\n    //     'AP': blues[3], \n    //     'AM': blues[0], \n    //     'EU': blues[1], \n    //     'ME': blues[2], \n    //     'AF': blues[4], \n    // }\n\n\n\nexport default colors;\n","export function addCommas(nStr){\n    nStr += '';\n    let x = nStr.split('.');\n    let x1 = x[0];\n    let x2 = x.length > 1 ? '.' + x[1] : '';\n    var rgx = /(\\d+)(\\d{3})/;\n    while (rgx.test(x1)) {\n        x1 = x1.replace(rgx, '$1' + ',' + '$2');\n    }\n    return x1 + x2;\n}\n\nexport function nFormatter(num, digits = 1) {\n    const lookup = [\n      { value: 1, symbol: \"\" },\n      { value: 1e3, symbol: \"k\" },\n      { value: 1e6, symbol: \"M\" },\n      { value: 1e9, symbol: \"B\" },\n      { value: 1e12, symbol: \"T\" },\n      { value: 1e15, symbol: \"P\" },\n      { value: 1e18, symbol: \"E\" }\n    ];\n    const rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/;\n    var item = lookup.slice().reverse().find(function(item) {\n      return num >= item.value;\n    });\n    return item ? (num / item.value).toFixed(digits).replace(rx, \"$1\") + item.symbol : \"0\";\n\n\n  }\n  \n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {nFormatter} from './HelperFunctions';\nimport { selection, textwrap } from 'd3-textwrap';\nimport clone from 'just-clone';\n\nlet yScaleCases;\nlet yScaleDeaths;\nlet yScaleVaccines;\nlet yAxisCases;\nlet yAxisDeaths;\nlet yAxisVaccines;\nlet yScaleCasesAxis;\nlet yScaleDeathsAxis;\nlet yScaleVaccinesAxis;\nlet xScale;\nlet xAxis; \nlet xScaleAxis;\nlet xScaleEvents;\nlet maxDate; \nlet minDate;\nlet md; \nlet vgroupedData;\n\nconst regions = ['AF', 'AP', 'ME', 'EU', 'AM', 'OTH'];\n\nexport function drawTimechart(data, options) {\n\n    minDate = new Date(data.min_date);\n    maxDate = new Date(data.max_date);\n\n    const groupedData = [];\n\n    data.who_data.forEach(function(d,i){\n        if(!groupedData[d[options.timeline_frequency+'Total']])groupedData[d[options.timeline_frequency+'Total']] = {};\n        if(options.timeline_frequency==='day') groupedData[d[options.timeline_frequency+'Total']].date = d.date;\n        if(options.timeline_frequency==='week') groupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n        if(options.timeline_frequency==='month') groupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n        if(!groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_cases += d.new_cases;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_deaths += d.new_deaths;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_cases = 0;\n    });\n\n    // totals by date\n    groupedData.forEach(function(d,i){\n        regions.forEach(function(dd,ii){\n            if(!d.hasOwnProperty(dd)){\n               d[dd] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n            }\n            // if(dd!=='OTH') d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n            if(i>0){\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases + groupedData[i-1][dd].cumulative_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths + groupedData[i-1][dd].cumulative_deaths;\n            } else {\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths;\n            }\n        })\n\n        d.total_new_cases = d.AF.new_cases + d.AP.new_cases + d.AM.new_cases + d.EU.new_cases + d.ME.new_cases + d.OTH.new_cases; \n        d.total_cumulative_cases = d.AF.cumulative_cases + d.AP.cumulative_cases + d.AM.cumulative_cases + d.EU.cumulative_cases + d.ME.cumulative_cases + d.OTH.cumulative_cases; \n        d.total_new_deaths = d.AF.new_deaths + d.AP.new_deaths + d.AM.new_deaths + d.EU.new_deaths + d.ME.new_deaths + d.OTH.new_deaths; \n        d.total_cumulative_deaths = d.AF.cumulative_deaths + d.AP.cumulative_deaths + d.AM.cumulative_deaths + d.EU.cumulative_deaths + d.ME.cumulative_deaths + d.OTH.cumulative_deaths; \n        d.region = [];\n\n        regions.forEach(function(dd,ii){\n            d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n        })\n\n    });\n\n    vgroupedData = [];\n\n    if(options.timeline_type!='cumulative'){ // cumulative and stacked\n        // data.vaccines_data = data.vaccines_data_daily;\n        // data.vaccines_data_daily = clone(data.vaccines_data);\n        data.vaccines_data.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_vaccines += d.daily_vaccinations;\n        });\n\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {new_vaccines: 0, cumulative_vaccines: 0}\n                }\n            });\n            d.total_new_vaccines = d.AF.new_vaccines + d.AP.new_vaccines + d.AM.new_vaccines + d.EU.new_vaccines + d.ME.new_vaccines + d.OTH.new_vaccines; \n            d.region = [];\n\n            regions.forEach(function(dd,ii){\n                var newVaccines = 0;\n                if(d[dd].new_vaccines>0){\n                    newVaccines += d[dd].new_vaccines\n                }\n                d.region.push({'region': dd, 'new_vaccines': newVaccines });\n            })\n        });\n\n    } else{ // cumulative only\n        var vData = [];\n        if(options.timeline_frequency==='day') {\n            vData = clone(data.vaccines_data);\n        }\n        if(options.timeline_frequency==='week') {\n            data.vaccines_data.forEach(function(d,i){\n                var endOfWeekDate = moment(d.date).endOf('isoWeek').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfWeekDate)||(date==moment(data.max_date).startOf('day').unix())){\n                    vData.push(d);\n                }\n            })\n        }\n        if(options.timeline_frequency==='month') {\n            var maxDateUnix = moment(data.max_date).startOf('day').unix();\n            data.vaccines_data.forEach(function(d,i){\n                var endOfMonthDate = moment(d.date).endOf('month').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfMonthDate)||((moment(data.max_date).startOf('day').unix()!=endOfMonthDate)&&(date==maxDateUnix))){\n                    vData.push(d);\n                }\n            })\n        }\n\n        vData.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {cumulative_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_vaccines += d.total_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {cumulative_vaccines: 0}\n                }\n            });\n            d.total_cumulative_vaccines = d.AF.cumulative_vaccines + d.AP.cumulative_vaccines + d.AM.cumulative_vaccines + d.EU.cumulative_vaccines + d.ME.cumulative_vaccines + d.OTH.cumulative_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'cumulative_vaccines': d[dd].cumulative_vaccines});\n            })\n        });\n    }\n\n    vgroupedData = vgroupedData.filter(function(el) { return el; });\n\n    const numIntervals = d3.max(data.who_data, function(d,i){\n        return d[options.timeline_frequency+'Total'];\n    });\n\n    const maxCases = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_cases;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_cases;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxDeaths = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_deaths;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_deaths;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxVaccines = d3.max(vgroupedData, function(d,i){\n        if(d){\n            if(options.timeline_type==='non-cumulative') return d.total_new_vaccines;\n            if(options.timeline_type==='cumulative') return d.total_cumulative_vaccines;\n            if(options.timeline_type==='stacked') return 100;\n        }\n    })\n\n    // define date range\n    // const minDate = groupedData[0].date;\n    // const maxDate = groupedData[numIntervals].date;\n    // const minDate = groupedData[0].date;\n\n    // if(options.timeline_frequency==='month') md = md.add(1, 'months');\n    // if(options.timeline_frequency==='week') md = md.add(1, 'weeks');\n    if(options.timeline_frequency==='month') minDate = moment(minDate).startOf('month').startOf('day').toDate();\n    if(options.timeline_frequency==='month') maxDate = moment(maxDate).endOf('month').startOf('day').toDate();\n    if(options.timeline_frequency==='week') maxDate = moment(maxDate).endOf('isoWeek').startOf('day').toDate();\n\n    md = moment(maxDate);\n    if(options.timeline_frequency==='day') md = new Date(moment(maxDate).add(1, 'days').toDate());\n\n    const svg = d3.select('#timechart_svg');\n    svg.selectAll('g').remove();\n    d3.selectAll('#layout .yAxis').remove();\n    d3.selectAll('#yAxis').remove();\n    d3.selectAll('#layout .xAxis').remove();\n\n    //bg\n    svg.append('g').append('rect')\n    .attr('width', 2000)\n    .attr('height', '100%')\n    .attr('x', 0)\n    .attr('y', 0)\n    .attr('fill', '#FFF')\n    .attr('opacity', 0);\n\n    const width = 2000;\n    const barWidth = width/numIntervals;\n\n    let barSpacing = 0.04; \n    if(options.timeline_frequency==='month') barSpacing = 0.03;\n    if(options.timeline_frequency==='day') barSpacing = 0.02;\n\n    // define scales\n\n    xScale = d3.scaleTime()\n    .range([0,width])\n    .domain([minDate,md]);\n\n    xScaleAxis = d3.scaleTime()\n    .range([0,596])\n    .domain([minDate,md]);\n\n    yScaleCases = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxCases]);\n\n    yScaleCasesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxCases]);\n\n    yScaleDeaths = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxDeaths]);\n\n    yScaleDeathsAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxDeaths]);\n\n    yScaleVaccines = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxVaccines]);\n\n    yScaleVaccinesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxVaccines]);\n\n    // define axi\n    \n    xAxis = d3.axisBottom()\n    .scale(xScaleAxis)\n    .tickSize(2)\n    .tickPadding(3);\n\n    // if(options.timeline_frequency=='month')\n    // xAxis.ticks(d3.timeMonth.every(3)).tickFormat(d3.timeFormat(\"%b %Y\"));\n\n    // if(options.timeline_frequency=='week')\n    // xAxis.ticks(d3.timeWeek.every(10)).tickFormat(d3.timeFormat(\"%d %b %Y\"));\n\n    yAxisCases = d3.axisRight()\n    .scale(yScaleCasesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisDeaths = d3.axisRight()\n    .scale(yScaleDeathsAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisVaccines = d3.axisRight()\n    .scale(yScaleVaccinesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    // y-axis cases\n    var yAxisGroup = d3.select('#layout').append(\"g\").attr('id', 'yAxis').attr('clip-path', 'url(#mask)');\n\n    var yAxisCasesText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"casesAxis\")\n    .attr('transform', 'translate(620,363)')\n    .call(yAxisCases);\n\n    // y-axis deaths\n    var yAxisDeathsText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"deathsAxis\")\n    .attr('transform', 'translate(620,534)')\n    .call(yAxisDeaths);\n\n    // y-axis vaccines\n    var yAxisVaccinesText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"VaccinesAxis\")\n    .attr('transform', 'translate(620,707.5)')\n    .call(yAxisVaccines);\n\n    // x-axis cases\n    var xAxisCases = yAxisGroup.append('g')\n    .attr(\"id\", \"casesXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,504)')\n    .call(xAxis);\n\n    var xAxisDeaths = yAxisGroup.append('g')\n    .attr(\"id\", \"deathsXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,674)')\n    .call(xAxis);\n\n    var xAxisVaccines = yAxisGroup.append('g')\n    .attr(\"id\", \"vaccinesXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,848)')\n    .call(xAxis);\n\n    var xAxisTimeline = yAxisGroup.append('g')\n    .attr(\"id\", \"timelineXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,908)')\n    .call(xAxis);\n\n    // CASES\n    // loop through groupedData and draw bars\n    const barGroups = svg.selectAll('.bar_group')\n    .data(groupedData)\n    .enter()\n    .append('g')\n    .attr('class', 'bar_group')\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+')'\n    })\n\n    // CASES\n    barGroups.selectAll('.cases_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', function(d,i) { return 'timeBar cases_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_cases;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleCases(d.cumulative_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleCases(d.new_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_cases/totalNewCases))-((140*(dp/totalNewCases))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleCases(d.cumulative_cases);\n        if(options.timeline_type==='non-cumulative') y = yScaleCases(d.new_cases);\n        if(options.timeline_type==='stacked') y = (140*(d.new_cases/totalNewCases));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n    })\n\n    // DEATHS\n    barGroups.selectAll('.deaths_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', function(d,i) { return 'timeBar deaths_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_deaths;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleDeaths(d.cumulative_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleDeaths(d.new_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_deaths/totalNewDeaths))-((140*(dp/totalNewDeaths)))+170)\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleDeaths(d.cumulative_deaths);\n        if(options.timeline_type==='non-cumulative') y = yScaleDeaths(d.new_deaths);\n        if(options.timeline_type==='stacked') y = (140*(d.new_deaths/totalNewDeaths));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n    });\n\n    // bar size tweak for spacing\n    if(options.timeline_frequency==='month'){\n        barGroups.selectAll(\".timeBar\")\n        .attr(\"width\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(1-barSpacing);\n            })\n        .attr(\"x\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(barSpacing/2);\n            })\n        }\n\n    // VACCINES\n\n    const vbarGroups = svg.selectAll('.vbar_group')\n    .data(vgroupedData)\n    .enter()\n    .append('g')\n    .attr('class', 'vbar_group')\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+', 344)'\n    })\n  \n    vbarGroups.selectAll('.vaccines_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', 'timeBar vaccines_bar')\n    .attr('class', function(d,i) { return 'timeBar vaccines_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_vaccines;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleVaccines(d.cumulative_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleVaccines(d.new_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_vaccines/totalNewVaccines))-((140*(dp/totalNewVaccines))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleVaccines(d.cumulative_vaccines);\n        if(options.timeline_type==='non-cumulative') y = yScaleVaccines(d.new_vaccines);\n        if(options.timeline_type==='stacked') y = (140*(d.new_vaccines/totalNewVaccines));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n        // return colors.regions_blue[d.region];\n    });\n\n    if(options.timeline_frequency==='month'){\n    vbarGroups.selectAll(\".timeBar\")\n    .attr(\"width\", function(d) {\n        var date = d3.select(this.parentNode).datum().date;\n        var next = d3.timeMonth.offset(date, 1);\n        return (xScale(next)- xScale(date))*(1-barSpacing);\n        })\n    .attr(\"x\", function(d) {\n        var date = d3.select(this.parentNode).datum().date;\n        var next = d3.timeMonth.offset(date, 1);\n        return (xScale(next)- xScale(date))*(barSpacing/2);\n        })\n    }\n\n    // bar size tweak for spacing\n    if(options.timeline_frequency==='month'){\n        barGroups.selectAll(\".timeBar\")\n        .attr(\"width\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(1-barSpacing);\n          })\n        .attr(\"x\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(barSpacing/2);\n          })\n        }\n\n        // tooltips\n\n        // events calendar timeline\n        var tData = data.timeline_data;\n\n        xScaleEvents = d3.scaleTime()\n        .range([25,619])\n        .domain([minDate,md]);\n        \n        // bring to front\n       document.getElementById(\"svg\").appendChild(d3.select('#timeline_tooltip').node());\n       document.getElementById(\"svg\").appendChild(d3.select('#event_tooltip').node());\n       var timelineTooltip = d3.select('#timeline_tooltip').attr('opacity', 0);\n       var eventTooltip = d3.select('#event_tooltip').attr('opacity', 0);\n\n        // hover bar\n        var hoverBar = svg.append('rect')\n        .attr('id','timechart_hover')\n        .attr('width', barWidth)\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('opacity', 0)\n        .attr('height', '100%')\n        .attr('fill', 'rgb(221 221 221 / 40%)')\n\n        d3.select('#timechart_svg').on('mouseover',  (event) => {\n\n            var coords = d3.pointer( event );\n            hoverBar.attr('opacity', 1)\n\n            var xDate = xScale.invert(coords[0]);\n\n            if(options.timeline_frequency=='week') {\n                xDate = moment(xDate).startOf('isoWeek');\n            }\n            if(options.timeline_frequency=='day') {\n                xDate = moment(xDate).startOf('day');\n            }\n            if(options.timeline_frequency=='month') {\n                xDate = moment(xDate).startOf('month');\n            }\n\n            if(coords[1]<470){\n                timelineTooltip.attr('opacity', 1).attr('display', 'inline');\n                hoverBar.attr('height', '100%');\n            } else if(coords[1]>510){\n                eventTooltip.attr('opacity', 1);\n                hoverBar.attr('height', '90%');\n            } else {\n                eventTooltip.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                hoverBar.attr('height', '100%');\n            }\n\n            if((xDate.toDate().getTime()<minDate.getTime())){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n            }\n\n            d3.select('#svg_container').style('z-index', 10);\n\n        }).on('mouseout',  (event) => {\n            hoverBar.attr('opacity', 0)\n            timelineTooltip.attr('opacity', 0).attr('display', 'none');\n            // timelineTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n            d3.select('#svg_container').style('z-index', 1);\n            eventTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n            d3.selectAll('.event_marker circle').style('stroke', colors.black);\n        })\n        .on('mousemove', (event) => {\n            var coords = d3.pointer( event );\n\n            var xDate = xScale.invert(coords[0]);\n\n            var tooltipStr = '';\n            if(options.timeline_frequency=='week') {\n                xDate = moment(xDate).startOf('isoWeek');\n                tooltipStr = xDate.format('ll');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            if(options.timeline_frequency=='day') {\n                xDate = moment(xDate).startOf('day');\n                tooltipStr = xDate.format('ll');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            if(options.timeline_frequency=='month') {\n                xDate = moment(xDate).startOf('month');\n                tooltipStr = xDate.format('MMMM YYYY');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            hoverBar.attr('x', xScale(xDate.toDate()));\n\n            var groupedDataFiltered = groupedData.filter(function(d,i){\n                return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n            });\n            var vgroupedDataFiltered = vgroupedData.filter(function(d,i){\n                return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n            });\n\n            var deaths = '-';\n            var cases = '-';\n            var vaccines = '-';\n            if(options.timeline_type=='cumulative'){ \n                // cumulative\n                if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_cumulative_cases, 2);\n                if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_cumulative_deaths, 2);\n                if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_cumulative_vaccines, 2);\n            } else {\n                // non-cumulative/stacked\n                if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_new_cases, 2);\n                if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_new_deaths, 2);\n                if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_new_vaccines, 2);\n            }\n\n            if(deaths==0) deaths = '-';\n            if(cases==0) cases = '-';\n            if(vaccines==0) vaccines = '-';\n\n            d3.select('#tooltip_cases tspan').text((cases)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n            d3.select('#tooltip_deaths tspan').text((deaths)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n            d3.select('#tooltip_vaccines tspan').text((vaccines)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n\n            // if((xDate.toDate().getTime()>options.maxDate.getTime())){\n            //     hoverBar.attr('opacity', 0);\n            // // } else \n            if(((xDate.toDate().getTime()<minDate.getTime()))&&(options.timeline_frequency=='day')){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n            }\n\n            if(options.timeline_frequency=='month'){\n                hoverBar.attr('width', function(){\n                   return xScale(moment(xDate).endOf('month')) - xScale(moment(xDate).startOf('month'));\n                })\n            }\n            timelineTooltip.attr('transform', function(){\n                var bw = barWidth;\n                var ratio = (options.brushR - options.brushL)/600;\n                var offset = 0;\n                if(ratio<0.5) offset = 3;\n                if(ratio<0.3) offset = 12;\n                if(ratio<0.2) offset = 20;\n                if(ratio<0.15) offset = 21;\n                if(options.timeline_frequency=='month') { \n                    if(ratio<0.6) offset = 20;\n                    if(ratio<0.5) offset = 30;\n                    if(ratio<0.3) offset = 50;\n                    if(ratio<0.2) offset = 60;\n                    if(ratio<0.1) offset = 70;\n                    return 'translate('+(((xScaleEvents(xDate.toDate()))+(barWidth/3))+offset)+','+(coords[1]+353)+')';\n                }\n                return 'translate('+((xScaleEvents(xDate.toDate())+(18))+offset)+','+(coords[1]+353)+')';\n            })\n\n            if(coords[1]<470){\n                timelineTooltip.attr('opacity', 1);\n                hoverBar.attr('opacity', 1);\n                hoverBar.attr('height', '100%');\n            } else if(coords[1]>510){\n                eventTooltip.attr('opacity', 1);\n                hoverBar.attr('height', '90%');\n                var x = moment(xScale.invert(coords[0])).startOf('day');\n                var xx = (xScale.invert(coords[0]))\n                eventTooltip.attr('transform', function(){\n                    return 'translate('+(xScaleEvents(x.toDate())+(-3))+','+(817)+')';\n                });\n\n                var events = tData.filter(function(d,i){\n                    return moment(d.date).startOf('day').unix() == x.unix()\n                });\n\n                // select nearest neighbor for ux purposes \n                if(events.length==0){\n                    events = tData.filter(function(d,i){\n                        return ((moment(d.date).startOf('day').unix() <= moment(x).add(1, 'days').unix())&&(moment(d.date).startOf('day').unix() >= moment(x).subtract(1, 'days').unix()))\n                    });\n                }\n                \n                if(events.length>0){\n\n                    d3.select('#event-'+moment(events[0].date).startOf('day').unix()).select('path').style('stroke', '#000').attr('opacity', 1);\n                    tooltipStr = moment(events[0].date).startOf('day').format('ll');\n                    d3.select('#event_tooltip_date tspan').text(tooltipStr);\n\n                    var wrap = textwrap().bounds({height: 200, width: 230}).method('tspans');\n                    var event = d3.select('#event_tooltip_text').text(events[0].description)\n                    .attr('y', 18)\n                    .attr('x', 6)\n                    d3.select('#event_tooltip_text').call(wrap);\n\n                    d3.selectAll('#event_tooltip_text tspan').attr('dy', '1.3em');\n                    var bbox = d3.select('#event_tooltip_text').node().getBBox();\n                    d3.select('#event_tooltip_rect').attr('width', bbox.width+17)\n                    .attr('height', bbox.height +26 );\n\n                    var h = d3.select('#event_tooltip_rect').attr('height');\n                    var ys = 0;\n\n                    if(bbox.height<20){\n                        ys = 19;\n                    } else if(bbox.height<30){\n                        ys = 9;\n                    } else if(bbox.height<40){\n                        ys = 0;\n                    } else if(bbox.height<50){\n                        ys = -20;\n                    } else if(bbox.height<60){\n                        ys = -20;\n                    }\n\n                    var y = d3.select('#event_tooltip_rect').attr('y');\n\n                    d3.select('#event_tooltip_rect').attr('y', ys);\n                    \n                    d3.selectAll('#event_tooltip_text').attr('y', function(d,i){\n                        return parseInt(d3.select(this).attr('y')) + ys;\n                    });\n\n                    d3.selectAll('#event_tooltip_date tspan').attr('dy', function(d,i){\n                        return ys;\n                    });\n\n                    eventTooltip.attr('opacity', 1);\n\n                } else {\n                    d3.selectAll('.event_marker circle').style('stroke', colors.black)\n                    eventTooltip.attr('opacity', 0);\n                }\n            } else {\n                eventTooltip.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                hoverBar.attr('opacity', 0);\n                hoverBar.attr('height', '100%');\n            }\n\n            if((options.timeline_frequency=='day')&&((xDate.toDate().getTime()<minDate.getTime()))){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                return false;\n            }\n        });\n\n        tData = tData.filter(d => d.date.length > 0);\n\n        // event lin\n\n        yAxisGroup.append('line')\n        .attr('id', 'event-line')\n        .attr('x1', 0)\n        .attr('x2', 620)\n        .attr('y1', 893)\n        .attr('y2', 893)\n        .attr('stroke-width', 2.5)\n        .attr('stroke', colors.black);\n\n        var circles = yAxisGroup.append('g').selectAll('.event_marker')\n        .data(tData)\n        .enter()\n        .append('g')\n        .attr('class', 'event_marker')\n        .attr('id', function(d,i){\n            return 'event-'+moment(d.date).startOf('day').unix();\n        })\n        .attr('transform', function(d){\n            var x = xScaleEvents(new Date(d.date));\n            return 'translate('+(x)+', 893)';\n        })\n        .style('cursor', 'pointer');\n        // .append('path')\n        // .attr('d', \"M0,-6L4,0 0,6 -4,0Z\")\n        \n        circles.append(\"circle\")\n        .style('stroke', colors.black)\n        .attr('opacity', 1)\n        .attr('r', 6.5)\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .style('stroke-width',2.2)\n        .style('fill', 'white');\n        circles\n        .append(\"circle\")\n        .attr('r', 2)\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .attr('fill', colors.black)\n        .style('stroke', colors.black);\n\n\n        // create brush zoom\n        // reset\n        // options.brushL = 0;\n        // options.brushR = 600;\n        const brush = d3.brushX()\n        .extent([[0,0],[600,20]])\n        .on(\"start brush end\", brushed);\n\n        d3.select('.brush').remove();\n;\n        var gBrush = d3.select('#zoombar').append(\"g\")\n        .attr(\"class\", \"brush\")\n        .attr('opacity', 0.1)\n        .call(brush);\n\n\t\td3.selectAll('.handle rect').attr('fill-opacity', '1').style('visibility', 'visible').attr('width', 2).attr('fill', '#000').style('stroke-opacity', 0);\n\n        var brushScale = d3.scaleLinear()\n        .domain([-3, 597])\n        .range([0,2000]);\n\n        gBrush.call(brush.move, [options.brushL,options.brushR]);\n\n        function brushed(){\n            var x = parseFloat(d3.select('.handle--w').attr('x'));\n            var x2 = parseFloat(d3.select('.handle--e').attr('x'));\n            if((x2-x)<40) return false;\n            var w = d3.select('.selection').attr('width');\n            d3.select('#zoomL').attr('transform', 'translate('+x+',0)');\n            d3.select('#zoomR').attr('transform', 'translate('+(x2)+',0)');\n            d3.select('#zoomOverlay').attr('width', (x2-x));\n            d3.select('#zoomOverlay').attr('x', (x));\n            d3.select('#zoomOverlay').attr('transform', 'translate(3,0)');\n            var viewBoxW = Math.round(brushScale(x2)-brushScale(x));\n            var viewBoxX = Math.round(brushScale(x));\n            options.brushL = x+3;\n            options.brushR = x2+3;\n\n            xScaleAxis = d3.scaleTime()\n            .range([0,596])\n            .domain([new Date(xScale.invert(brushScale(x))),new Date(xScale.invert(brushScale(x2)))]);\n\n            xScaleEvents = d3.scaleTime()\n            .range([25,619])\n            // .domain([minDate,md]);\n            .domain([new Date(xScale.invert(brushScale(x))),new Date(xScale.invert(brushScale(x2)))]);\n\n            d3.selectAll('.event_marker')\n            .attr('transform', function(d){\n                var x = xScaleEvents(new Date(d.date));\n                return 'translate('+(x)+', 893)';\n            });\n\n            xAxis = d3.axisBottom()\n            .ticks(5)\n            .scale(xScaleAxis);\n\n            xAxisCases.call(xAxis);\n            xAxisDeaths.call(xAxis);\n            xAxisVaccines.call(xAxis);\n            xAxisTimeline.call(xAxis);\n            \n            d3.select('#timechart_svg').attr('viewBox', viewBoxX + ' 0 '+ viewBoxW + ' 553')\n        }\n\n}\n\nexport function updateTimechart(data, options) {\n\n    const groupedData = [];\n\n    data.who_data.forEach(function(d,i){\n        if(!groupedData[d[options.timeline_frequency+'Total']])groupedData[d[options.timeline_frequency+'Total']] = {};\n        if(options.timeline_frequency==='day') groupedData[d[options.timeline_frequency+'Total']].date = d.date;\n        if(options.timeline_frequency==='week') groupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n        if(options.timeline_frequency==='month') groupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n        if(!groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_cases += d.new_cases;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_deaths += d.new_deaths;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_cases = 0;\n    });\n\n    // totals by date\n    groupedData.forEach(function(d,i){\n        regions.forEach(function(dd,ii){\n            if(!d.hasOwnProperty(dd)){\n               d[dd] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n            }\n            // if(dd!=='OTH') d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n            if(i>0){\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases + groupedData[i-1][dd].cumulative_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths + groupedData[i-1][dd].cumulative_deaths;\n            } else {\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths;\n            }\n        })\n\n        d.total_new_cases = d.AF.new_cases + d.AP.new_cases + d.AM.new_cases + d.EU.new_cases + d.ME.new_cases + d.OTH.new_cases; \n        d.total_cumulative_cases = d.AF.cumulative_cases + d.AP.cumulative_cases + d.AM.cumulative_cases + d.EU.cumulative_cases + d.ME.cumulative_cases + d.OTH.cumulative_cases; \n        d.total_new_deaths = d.AF.new_deaths + d.AP.new_deaths + d.AM.new_deaths + d.EU.new_deaths + d.ME.new_deaths + d.OTH.new_deaths; \n        d.total_cumulative_deaths = d.AF.cumulative_deaths + d.AP.cumulative_deaths + d.AM.cumulative_deaths + d.EU.cumulative_deaths + d.ME.cumulative_deaths + d.OTH.cumulative_deaths; \n        d.region = [];\n\n        regions.forEach(function(dd,ii){\n            d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n        })\n    });\n\n    vgroupedData = [];\n\n    if(options.timeline_type!='cumulative'){ // non-cumulative and stacked\n        // data.vaccines_data = data.vaccines_data_daily;\n        data.vaccines_data.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('isoWeek').toDate();\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('month').toDate();\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_vaccines += d.daily_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {new_vaccines: 0, cumulative_vaccines: 0}\n                }\n            });\n            d.total_new_vaccines = d.AF.new_vaccines + d.AP.new_vaccines + d.AM.new_vaccines + d.EU.new_vaccines + d.ME.new_vaccines + d.OTH.new_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'new_vaccines': d[dd].new_vaccines});\n            })\n        });\n\n    } else{ // cumulative only\n        var vData = [];\n        if(options.timeline_frequency==='day') {\n            vData = clone(data.vaccines_data);\n        }\n        if(options.timeline_frequency==='week') {\n            data.vaccines_data.forEach(function(d,i){\n                var endOfWeekDate = moment(d.date).endOf('isoWeek').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfWeekDate)||(date==moment(data.max_date).startOf('day').unix())){\n                    vData.push(d);\n                }\n            })\n        }\n        if(options.timeline_frequency==='month') {\n            var maxDateUnix = moment(data.max_date).startOf('day').unix();\n            data.vaccines_data.forEach(function(d,i){\n                var endOfMonthDate = moment(d.date).endOf('month').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfMonthDate)||((moment(data.max_date).startOf('day').unix()!=endOfMonthDate)&&(date==maxDateUnix))){\n                    vData.push(d);\n                }\n            })\n        }\n\n        vData.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('isoWeek').toDate();\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('month').toDate();\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {cumulative_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_vaccines += d.total_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {cumulative_vaccines: 0}\n                }\n            });\n            d.total_cumulative_vaccines = d.AF.cumulative_vaccines + d.AP.cumulative_vaccines + d.AM.cumulative_vaccines + d.EU.cumulative_vaccines + d.ME.cumulative_vaccines + d.OTH.cumulative_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'cumulative_vaccines': d[dd].cumulative_vaccines});\n            })\n        });\n    }\n\n    vgroupedData = vgroupedData.filter(function(el) { return el; });\n\n    const numIntervals = d3.max(data.who_data, function(d,i){\n        return d[options.timeline_frequency+'Total'];\n    });\n\n    const maxCases = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_cases;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_cases;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxDeaths = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_deaths;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_deaths;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxVaccines = d3.max(vgroupedData, function(d,i){\n        if(d){\n            if(options.timeline_type==='non-cumulative') return d.total_new_vaccines;\n            if(options.timeline_type==='cumulative') return d.total_cumulative_vaccines;\n            if(options.timeline_type==='stacked') return 100;\n        }\n    })\n\n    const svg = d3.select('#timechart_svg');\n\n    const width = 2000;\n    const barWidth = width/numIntervals;\n\n    let barSpacing = 0.04; \n    if(options.timeline_frequency==='month') barSpacing = 0.03;\n    if(options.timeline_frequency==='day') barSpacing = 0;\n\n    // define scales\n\n    // xScale = d3.scaleTime()\n    // .range([0,width])\n    // .domain([minDate,md]);\n\n    // xScaleAxis = d3.scaleTime()\n    // .range([23,596])\n    // .domain([minDate,md]);\n\n    yScaleCases = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxCases]);\n\n    yScaleCasesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxCases]);\n\n    yScaleDeaths = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxDeaths]);\n\n    yScaleDeathsAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxDeaths]);\n\n    yScaleVaccines = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxVaccines]);\n\n    yScaleVaccinesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxVaccines]);\n\n    // define axi\n    yAxisCases = d3.axisRight()\n    .scale(yScaleCasesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisDeaths = d3.axisRight()\n    .scale(yScaleDeathsAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisVaccines = d3.axisRight()\n    .scale(yScaleVaccinesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    // y-axis cases\n    var yAxisCasesText = d3.select('#casesAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisCases);\n\n    // y-axis deaths\n    var yAxisDeathsText = d3.select('#deathsAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisDeaths);\n\n    // y-axis vaccines\n    var yAxisVaccinesText = d3.select('#VaccinesAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisVaccines);\n\n    // CASES\n    // loop through groupedData and draw bars\n    const barGroups = svg.selectAll('.bar_group')\n    .data(groupedData)\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+')'\n    })\n\n    // CASES\n    barGroups.selectAll('.cases_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_cases;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleCases(d.cumulative_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleCases(d.new_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_cases/totalNewCases))-((140*(dp/totalNewCases))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleCases(d.cumulative_cases);\n        if(options.timeline_type==='non-cumulative') y = yScaleCases(d.new_cases);\n        if(options.timeline_type==='stacked') y = (140*(d.new_cases/totalNewCases));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n        return 'blue'\n    })\n\n    // // DEATHS\n    barGroups.selectAll('.deaths_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_deaths;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleDeaths(d.cumulative_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleDeaths(d.new_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_deaths/totalNewDeaths))-((140*(dp/totalNewDeaths)))+170)\n        // if(options.timeline_type==='non-cumulative') if(y>310) return 0;\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleDeaths(d.cumulative_deaths);\n        if(options.timeline_type==='non-cumulative') y = yScaleDeaths(d.new_deaths);\n        if(options.timeline_type==='stacked') y = (140*(d.new_deaths/totalNewDeaths));\n        if(options.timeline_type==='non-cumulative') if(y<0) return 0;\n\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n\n    if(groupedData.length==0){\n        d3.selectAll('.cases_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140)\n        .attr('height', 0)\n\n        d3.selectAll('.deaths_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140+170)\n        .attr('height', 0)\n        \n    }\n    // // VACCINES\n\n    const vbarGroups = svg.selectAll('.vbar_group')\n    .data(vgroupedData)\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+', 344)'\n    })\n\n    vbarGroups.selectAll('.vaccines_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_vaccines;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleVaccines(d.cumulative_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleVaccines(d.new_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_vaccines/totalNewVaccines))-((140*(dp/totalNewVaccines))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleVaccines(d.cumulative_vaccines);\n        if(options.timeline_type==='non-cumulative') y = yScaleVaccines(d.new_vaccines);\n        if(options.timeline_type==='stacked') y = (140*(d.new_vaccines/totalNewVaccines));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    });\n\n    if(vgroupedData.length==0){\n        d3.selectAll('.vaccines_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140)\n        .attr('height', 0)\n    }\n   \n    // // bar size tweak for spacing\n    // if(options.timeline_frequency==='month'){\n    //     barGroups.selectAll(\".timeBar\")\n    //     .attr(\"width\", function(d) {\n    //         var date = d3.select(this.parentNode).datum().date;\n    //         var next = d3.timeMonth.offset(date, 1);\n    //         return (xScale(next)- xScale(date))*(1-barSpacing);\n    //       })\n    //     .attr(\"x\", function(d) {\n    //         var date = d3.select(this.parentNode).datum().date;\n    //         var next = d3.timeMonth.offset(date, 1);\n    //         return (xScale(next)- xScale(date))*(barSpacing/2);\n    //       })\n    //     }\n\n}\n\nexport default drawTimechart;\n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxCases;\nlet maxDeaths;\nlet maxVaccinations;\nlet xScaleCases; \nlet xScaleDeaths;\nlet xScaleVaccines;\nlet labelWidth; \nconst margin = { left: 20, top: 0, right: 58 };\nlet rcSize; \nlet groupedData = [];\n\nexport function drawRegionchart(data, options, filter) {\n\n    const barSpacing = 0.1;\n\n    // reset region values to zero\n    data.regions.forEach(function(d,i){\n        d.population = 0;\n        d.cumulative_deaths = 0;\n        d.cumulative_cases = 0;\n        d.cumulative_vaccines = 0;\n    })\n\n    // loop through countries and calculate region totals\n    data.country.forEach(function(d,i){\n        data.regions.forEach(function(dd,ii){\n            if((dd.code==d.ifrc_region)){ \n                if((d.population>0)&&(d.who_daily_latest)){\n                    if(d.who_daily_latest.cumulative_cases>0)\n                    dd.cumulative_cases += d.who_daily_latest.cumulative_cases;\n                    if(d.who_daily_latest.cumulative_deaths>0)\n                    dd.cumulative_deaths += d.who_daily_latest.cumulative_deaths||0;\n                    dd.population += d.population;\n                }\n                if((d.population>0)&&(d.vaccine_daily_latest)){\n                    dd.cumulative_vaccines += (d.vaccine_daily_latest.total_vaccinations)||0;\n                }\n            }\n        });\n    });\n\n    // calculate regions per 100k values using total population for each region\n    data.regions.forEach(function(d,i){\n        d.cumulative_cases_per_100k = d.cumulative_cases/(d.population/100000)\n        d.cumulative_deaths_per_100k = d.cumulative_deaths/(d.population/100000);\n        d.cumulative_vaccines_per_100k = d.cumulative_vaccines/(d.population/100000);\n        if(!isFinite(d.cumulative_cases_per_100k)) d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k)) d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k)) d.cumulative_vaccines_per_100k = 0;\n    })\n\n    // get maximum values for each series\n    if(options.region_switch=='per100'){\n        // get maximum values for each series\n        maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines_per_100k;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases_per_100k;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        });\n    } else {\n         // get maximum values for each series\n         maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths;\n        });\n    }\n\n    // append region chart container\n    const regionChartContainer = d3.select('#layout #region_chart_container').attr('opacity', 0);\n\n    // get dimensions\n    rcSize = {\n        x: regionChartContainer.attr('x'), y: regionChartContainer.attr('y'), width: regionChartContainer.attr('width'), height: regionChartContainer.attr('height')\n    }\n\n    // create svg container\n    const svg = d3.select('#layout').append('g').attr('transform', 'translate('+rcSize.x+', '+rcSize.y+')')\n    .attr('id', 'region_chart');\n\n    // calculate chart row height\n\tvar rowHeight = rcSize.height/(data.regions.length-1); // remove OTH\n\n    // create rows\n    var rows = svg.selectAll('.bar-row')\n\t.data(data.regions.filter(d=>d.code!=='OTH'))\n\t.enter()\n\t.append('g')\n\t.attr('class', 'bar-row')\n\t.attr('transform', function(d,i){\n\t\treturn 'translate(0,' + ((i*rowHeight) + margin.top) + ')';\n\t});\n\n    // create region labels\n    var label = rows.append('text')\n\t.attr('y', rowHeight/2 )\n    .attr('x', margin.left-5)\n\t.attr('class', function(d,i){ return 'bar-labels bar-label-'+d.code })\n\t.style('alignment-baseline', 'middle')\n\t.style('font-size', '11px')\n    .attr('opacity', 1)\n\t.attr('fill', '#000')\n\t.text(function(d,i){\n\t\tif(d.code==='AM') return 'Americas';\n\t\tif(d.code==='EU') return 'Europe';\n\t\tif(d.code==='AF') return 'Africa';\n\t\tif(d.code==='ME') return 'Middle East and North Africa';\n\t\tif(d.code==='AP') return 'Asia-Pacific';\n\t}).style('text-anchor', 'end');\n\n    // get label node width for use in scale\n    labelWidth = rows.node().getBBox().width + margin.left;\n\tlabel.attr('x', labelWidth+89);\n\tlabelWidth = labelWidth + 94;\n    d3.selectAll('.timeBar').attr('opacity',1);\n    \n    // create fading background click area\n    var rowBg = rows.append('rect')\n\t.attr('y', 0)\n\t.attr('x', 0)\n\t.attr('width', labelWidth)\n\t.attr('height', rowHeight-2)\n\t.style('opacity', 0)\n    .attr('fill', 'grey')\n\t.style('cursor', 'pointer')\n\t.attr('class', function(d,i){ return 'bar-bg-'+d.code })\n\t.attr('data-id', function(d,i){ return d.code })\n\t.on('mouseover', function(d){\n\t\td3.select(this).style('opacity', 0.1);\n\t})\n\t.on('mouseout', function(){\n\t\td3.select(this).style('opacity', 0);\n\t})\n\t.on('click', function(d,i){\n        var t = d3.select(this).attr('data-id');\n        filter([t],'regionchart');\n    });\n\n    // define scales\n    xScaleCases = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxCases]);\n\n    xScaleDeaths = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxDeaths]);\n\n    xScaleVaccines = d3.scaleLinear()\n\t.range([labelWidth, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxVaccinations]);\n\n    var bars = rows.append('rect')\n    .attr('id', function(d,i){\n        return 'bar-'+d.code;\n    })\n\t.attr('data-id', function(d,i){ return d.code })\n    .attr('class', 'region-bar')\n    .attr('width', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k);\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k);\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k);\n        } else {\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases);\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths);\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines);                \n        }\n        if(!isNaN(val)) { return parseFloat(val) } else { return 0}\n    })\n    .attr('x', labelWidth)\n    .style('outline', 'none')\n    .style('cursor', 'pointer')\n    .attr('y', rowHeight*barSpacing - 1)\n    .attr('height', rowHeight-((rowHeight*barSpacing)*2))\n    .style('fill', function(d){\n        return colors.regions[d.code]\n    })\n    .attr('opacity',1)\n    .on('click', function(d,i){\n        var t = d3.select(this).attr('data-id');\n        filter([t],'regionchart');\n    })\n    .on('mouseover', function(d){\n        var dat = d3.select(this.parentNode).datum();\n        // d3.selectAll('.timeBar:not(.time_'+dat.region).transition().duration(500).attr('opacity', 0.3);\n        // d3.selectAll('.time_'+dat.region).attr('opacity', 1);\n\t})\n\t.on('mouseout', function(){\n        // d3.selectAll('.timeBar').transition().duration(500).attr('opacity', 1);\n\t})\n\n    // create data value labels\n    var dataLabel = rows.append('text')\n\t.text(function(d){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases_per_100k));\n            if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths_per_100k));\n            if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines_per_100k));\n        } else {\n            if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases));\n            if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths));\n            if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines));             \n        }\n        return addCommas(val);\n    })\n\t.attr('id', function(d,i){\n\t\treturn 'data-label'+d.code;\n\t})\n    .attr('data-id', function(d,i){ return d.code })\n\t.attr('class', 'data-label')\n\t.attr('y', rowHeight/2)\n\t.style('alignment-baseline', 'middle')\n\t.style('text-anchor', 'start')\n\t.attr('x', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k)+labelWidth+5;\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k)+labelWidth+5;\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k)+labelWidth+5;\n        } else {\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases)+labelWidth+5;\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths)+labelWidth+5;\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines)+labelWidth+5;               \n        }\n        return val;\n    })\n    .attr('opacity', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases_per_100k);\n            if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths_per_100k);\n            if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines_per_100k);\n        } else {\n            if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases);\n            if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths);\n            if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines);\n        }\n        if(val>0){ return 1 } else { return 0}\n    })\n\t.style('fill', '#696969')\n\t.style('font-weight', 'normal')\n\t.style('font-size', '10px');\n\n}\n\nexport function updateRegionchart(options,data) {\n    \n    // reset region values to zero\n    data.regions.forEach(function(d,i){\n        d.population = 0;\n        d.cumulative_deaths = 0;\n        d.cumulative_cases = 0;\n        d.cumulative_vaccines = 0;\n    })\n\n    // loop through countries and calculate region totals\n    data.country.forEach(function(d,i){\n        data.regions.forEach(function(dd,ii){\n            if((dd.code==d.ifrc_region)){ \n                if((d.population>0)&&(d.who_daily_latest)){\n                    if(d.who_daily_latest.cumulative_cases>0)\n                    dd.cumulative_cases += d.who_daily_latest.cumulative_cases;\n                    if(d.who_daily_latest.cumulative_deaths>0)\n                    dd.cumulative_deaths += d.who_daily_latest.cumulative_deaths||0;\n                    dd.population += d.population;\n                }\n                if((d.population>0)&&(d.vaccine_daily_latest)){\n                    dd.cumulative_vaccines += (d.vaccine_daily_latest.total_vaccinations)||0;\n                }\n            }\n        });\n    });\n\n    // calculate regions per 100k values using total population for each region\n    data.regions.forEach(function(d,i){\n        d.cumulative_cases_per_100k = d.cumulative_cases/(d.population/100000)\n        d.cumulative_deaths_per_100k = d.cumulative_deaths/(d.population/100000);\n        d.cumulative_vaccines_per_100k = d.cumulative_vaccines/(d.population/100000);\n        if(!isFinite(d.cumulative_cases_per_100k)) d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k)) d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k)) d.cumulative_vaccines_per_100k = 0;\n    })\n\n    if(options.region_switch=='per100'){\n        // get maximum values for each series\n        maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines_per_100k;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases_per_100k;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        });\n    } else {\n         // get maximum values for each series\n         maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths;\n        });\n    }\n\n    // redefine scales using new extent\n    xScaleCases = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxCases]);\n\n    xScaleDeaths = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxDeaths]);\n\n    xScaleVaccines = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxVaccinations]);\n\n    // update bars\n    if((maxVaccinations==0)&&(maxCases==0)&&(maxDeaths==0)){\n        d3.selectAll('.region-bar')\n        .transition().duration(500)\n        .attr('width', 0);\n\n        d3.selectAll('.data-label')\n        .transition()\n          .duration(500) \n          .attr('x', labelWidth)\n          .attr('opacity', 0);\n    } else {\n        d3.selectAll('.region-bar')\n        .transition().duration(500)\n        .style('fill', function(d){\n            return colors.regions[d.code];\n            if(options.region_chart_toggle=='vaccines'){\n                return colors.regions_blue[d.code]\n            } else {\n                return colors.regions[d.code]\n            }\n        })\n        .attr('width', function(d,i){\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k);\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k);\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k);\n            } else {\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases);\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths);\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines);                \n            }\n            if(!isNaN(val)) { return parseFloat(val) } else { return 0}\n        })   \n        d3.selectAll('.data-label')\n        .transition()\n          .duration(500)\n          .tween(\"text\", function(d,i) {\n            var val = 0;\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases_per_100k));\n                if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths_per_100k));\n                if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines_per_100k));\n            } else {\n                if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases));\n                if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths));\n                if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines));             \n            }\n            var i = d3.interpolate(Math.floor((Math.random() * 2346) + 9345), val);\n            return function(t) {\n              d3.select(this).text(addCommas(Math.round(i(t))));\n            };\n          })\n        .attr('x', function(d,i){\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k)+labelWidth+5;\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k)+labelWidth+5;\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k)+labelWidth+5;\n            } else {\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases)+labelWidth+5;\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths)+labelWidth+5;\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines)+labelWidth+5;               \n            }\n            return val;\n        })\n        .attr('opacity', function(d,i){\n            var d;\n            var id = d3.select(this).attr('data-id');\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases_per_100k);\n                if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths_per_100k);\n                if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines_per_100k);\n            } else {\n                if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases);\n                if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths);\n                if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines);\n            }\n            if(val>0){ return 1 } else { return 0}\n        })\n\n    }\n\n}\n\nexport default drawRegionchart;\n","import * as d3 from \"d3\";\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {updateRegionchart} from './Regionchart';\nimport colors from './colors';\nimport tippy from 'tippy.js';\nimport 'tippy.js/dist/svg-arrow.css';\nimport 'tippy.js/themes/light.css';\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from 'html2canvas';\n\nconst selectedToggle = '#595454';\nconst unselectedToggle = '#EAEAEA';\nconst unselectedToggleText = '#000';\nconst selectedToggleText = '#FFF';\n\nfunction Layout(svg, options, data, filter, updateTable, updateMap) {\n\n  // vaccine info\n  d3.select('#vaccine_tooltip').attr('opacity', 0).style('display', 'none');\n  d3.select('#vaccine_info path').attr('fill', colors.black);\n\n  svg.select('#vaccine_info').style('cursor', 'pointer')\n  .on('mouseover', function(event, bd){\n    d3.select('#svg_container').style('z-index', 10);\n    d3.select('#vaccine_tooltip').style('display', 'inline').transition().duration(500).attr('opacity', 1);\n    d3.select('#vaccine_info path').transition().duration(200).attr('fill', colors.blue);\n  }).on('mouseout', function(event, d){\n    d3.select('#svg_container').style('z-index', 1);\n    d3.select('#vaccine_tooltip').style('display', 'none').attr('opacity', 0);\n    d3.select('#vaccine_info path').transition().duration(500).attr('fill', colors.black);\n  })\n\n  // region chart toggle\n  svg.select('#region_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n    options.region_filter = []; \n    filter('clear-region');\n  });\n\n  svg.select('#region_switch').style('cursor', 'pointer').on('click', function(d,i){\n    if(options.region_switch=='total'){\n      options.region_switch = 'per100';\n      d3.select('#region_switch_toggle').transition().duration(200).attr('x', 15.1);\n    } else {\n      options.region_switch = 'total';\n      d3.select('#region_switch_toggle').transition().duration(200).attr('x', 3.1);\n    }\n    updateRegionchart(options,data);\n  })\n\n  svg.select('#region-chart-toggle #region-chart-toggle-cases').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'cases') return false;\n    options.region_chart_toggle = 'cases';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-cases rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-cases text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  svg.select('#region-chart-toggle #region-chart-toggle-deaths').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'deaths') return false;\n    options.region_chart_toggle = 'deaths';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-deaths rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-deaths text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  svg.select('#region-chart-toggle #region-chart-toggle-vaccines').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'vaccines') return false;\n    options.region_chart_toggle = 'vaccines';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-vaccines rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-vaccines text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  // map toggle\n  svg.select('#map-toggle #map-toggle-bi-weekly-change').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'bi-weekly-change') return false;\n    options.map_toggle = 'bi-weekly-change';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-bi-weekly-change rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-bi-weekly-change text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-cases').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'cases') return false;\n    options.map_toggle = 'cases';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-cases rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-cases text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-deaths').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'deaths') return false;\n    options.map_toggle = 'deaths';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-deaths rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-deaths text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-percent-fully-vaccinated').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'percent-fully-vaccinated') return false;\n    options.map_toggle = 'percent-fully-vaccinated';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-percent-fully-vaccinated rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-percent-fully-vaccinated text').attr('fill', selectedToggleText);\n    // update map legend\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-percent-vaccine-acceptance').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'percent-vaccine-acceptance') return false;\n    options.map_toggle = 'percent-vaccine-acceptance';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-percent-vaccine-acceptance rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-percent-vaccine-acceptance text').attr('fill', selectedToggleText);\n    // update map legend\n    updateMap(data, options, 700);\n  });\n\n    // time chart type \n    svg.select('#timechart-type-toggle #timechart-type-toggle-cumulative').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'cumulative') return false;\n      options.timeline_type = 'cumulative';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-cumulative rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-cumulative polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggle);\n      updateTimechart(data, options);\n    });\n  \n    tippy('#timechart-type-toggle-cumulative', {\n      content: 'Cumulative',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n    svg.select('#timechart-type-toggle #timechart-type-toggle-non-cumulative').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'non-cumulative') return false;\n      options.timeline_type = 'non-cumulative';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-non-cumulative rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-non-cumulative polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggle);\n      updateTimechart(data, options);\n    });\n\n    tippy('#timechart-type-toggle-non-cumulative', {\n      content: 'Non-cumulative',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n    svg.select('#timechart-type-toggle #timechart-type-toggle-stacked').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'stacked') return false;\n      options.timeline_type = 'stacked';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-stacked rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-stacked polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggleText);\n      updateTimechart(data, options);\n    });\n\n    tippy('#timechart-type-toggle-stacked', {\n      content: 'Stacked 100%',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n  // time chart frequency toggle\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-day').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'day') return false;\n    options.timeline_frequency = 'day';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-day rect').attr('fill', selectedToggle);\n    svg.select('#timechart-frequency-toggle-day text').attr('fill', selectedToggleText);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('DAY');\n    drawTimechart(data, options);\n  });\n\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-week').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'week') return false;\n    options.timeline_frequency = 'week';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-week rect').attr('fill', selectedToggle);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('WEEK');\n    svg.select('#timechart-frequency-toggle-week text').attr('fill', selectedToggleText);\n    drawTimechart(data, options);\n  });\n\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-month').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'month') return false;\n    options.timeline_frequency = 'month';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-month rect').attr('fill', selectedToggle);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('MONTH');\n    svg.select('#timechart-frequency-toggle-month text').attr('fill', selectedToggleText);\n    drawTimechart(data, options);\n  });\n\n    // HDI toggle\n\n    svg.select('#hdi_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n      d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);\n      filter('clear-hdi');\n    });\n\n    svg.select('#hdi-toggle #hdi-toggle-very-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'very-high');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n\n    svg.select('#hdi-toggle #hdi-toggle-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'high');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n    svg.select('#hdi-toggle #hdi-toggle-medium').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'medium');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n    svg.select('#hdi-toggle #hdi-toggle-low').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'low');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n\n    // inform severity toggle\n\n    svg.select('#inform_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n      d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);\n      filter('clear-inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-no-score').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'no-score');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-low').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'low');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-medium').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'medium');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'high');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-very-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'very-high');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n  \n  // tabs\n\n  d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n  d3.select('#vac-tab').attr('opacity', 1).select('#vac-tab-content').attr('display', 'inline');\n  d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n  d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  svg.select('#tabs #vaccination-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'vaccination-data') return false;\n    options.tab_toggle = 'vaccination-data';\n    d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n    d3.select('#vac-tab').attr('opacity', 1).select('#vac-tab-content').attr('display', 'inline');\n    d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#vaccination-tab rect').attr('fill', selectedToggle);\n    svg.select('#vaccination-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  });\n\n  svg.select('#tabs #indicators-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'indicators') return false;\n    options.tab_toggle = 'indicators';\n    d3.select('#additional-indicators-tab').attr('opacity', 1).select('#additional-indicators-tab-content').attr('display', 'inline');\n    d3.select('#vac-tab').attr('opacity', 0).select('#vac-tab-content').attr('display', 'none');\n    d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#indicators-tab rect').attr('fill', selectedToggle);\n    svg.select('#indicators-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  });\n\n  svg.select('#tabs #bubble-chart-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'bubble-chartt') return false;\n    options.tab_toggle = 'bubble-chart';\n    d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n    d3.select('#vac-tab').attr('opacity', 0).select('#vac-tab-content').attr('display', 'none');\n    d3.select('#bubblechart-tab').attr('opacity', 1).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'inline');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#bubble-chart-tab rect').attr('fill', selectedToggle);\n    svg.select('#bubble-chart-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'inline-block');\n\n  });\n\n  // time chart mask\n    d3.select('#svg defs').append('clipPath').attr('id', 'mask')\n    .append('rect')\n    .attr('y', 340)\n    .attr('height', 590)\n    .attr('width', 660)\n    .attr('x', 22);\n\n  \n  // append timechart svg\n  const timechartContainer = svg.select('#timechart_container').attr('opacity', 0);\n  const tcSize = {\n    x: timechartContainer.attr('x'), y: timechartContainer.attr('y'), width: timechartContainer.attr('width'), height: timechartContainer.attr('height')\n  }\n\n  const timechartSvg = svg.append('svg').attr('id', 'timechart_svg').attr('viewBox', '0 0 '+2000 +' '+ tcSize.height)\n  .attr('preserveAspectRatio', \"none\")\n  .attr('x', tcSize.x)\n  .attr('y', tcSize.y)\n  .attr('width', tcSize.width)\n  .attr('height', tcSize.height)\n\n  const layer1 = timechartSvg\n  .append('g')\n  .attr('id', 'layer1')\n\n  const timechartBg = timechartSvg.append('g').attr('id', 'layer0');\n\n  layer1.append('rect')\n  .attr('x', 0)\n  .attr('y', 0)\n  .attr('width', '100%')\n  .attr('height', '100%')\n  .attr('opacity', 0)\n  .style('fill', 'transparent');\n  \n  // table bars\n\n  var tableRowHeight = 18;\n  var tableBarYOffset = 68;\n\n  for(let i = 0; i < 10; i++){\n\n    // col 1 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col1bg colbg')\n    .attr('id','col1bg'+i)\n    .attr('x', 120)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 1 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col1bar')\n    .attr('id','col1bar'+i)\n    .attr('x', 120)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 2 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col2bg colbg')\n    .attr('id','col2bg'+i)\n    .attr('x', 230)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 2 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col2bar')\n    .attr('id','col2bar'+i)\n    .attr('x', 230)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 3 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col3bg colbg')\n    .attr('id','col3bg'+i)\n    .attr('x', 340)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 3 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col3bar')\n    .attr('id','col3bar'+i)\n    .attr('x', 340)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 4 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col4bg colbg')\n    .attr('id','col4bg'+i)\n    .attr('x', 454)\n    .attr('y', function(){\n      return 67+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 3 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col4bar')\n    .attr('id','col4bar'+i)\n    .attr('x', 454)\n    .attr('y', function(){\n      return 67+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    for(var x = 0; x<6; x++){\n      d3.select('#col'+x+'_sort_desc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort_asc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort').style('cursor', 'pointer')\n      .on('click', function(){\n        var thisId = d3.select(this).attr('id');\n        if(options.table_sort==thisId){\n          if(options.table_sort_direction=='desc'){\n            options.table_sort_direction = 'asc';\n          } else {\n            options.table_sort_direction = 'desc';\n          }\n        } else {\n          options.table_sort = thisId;\n          options.table_sort_direction = 'desc';\n        }\n        options.page = 1;\n        updateTable(data, options);\n    })\n    // d3.select('#col1_sort_desc').attr('opacity', 1);\n    }\n  }\n\n  d3.select('#reset_locations').attr('display', 'none');\n\n  printCopySave();\n\n}\n\n// print copy save\n\nvar printing;\n\nfunction printCopySave(){\n\n  tippy('#button-png', {\n    content: 'Save as PNG',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  tippy('#button-copy', {\n    content: 'Copy to clipboard',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  tippy('#button-print', {\n    content: 'Print to PDF',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  d3.select('#button-print').on('click', function(){\n\n    if(printing) return false;\n    printing = true;\n\n    setTimeout(function(){\n      html2canvas(document.querySelector(\"#root\"),{\n            allowTaint: true,\n            onclone: function(doc){\n\n            },\n            useCORS: false,\n            foreignObjectRendering: true,\n            ignoreElements: function(element){\n              // if(element.id=='adm-toggle') return true;\n              // if($(element).hasClass('select2')) return true;\n            return false;\n            },\n            scale: 2,\n            x: 0,\n            y: 0,\n            scrollX: 0,\n            scrollY: 0,\n            logging: false\n        }).then(canvas => {\n          var img = canvas.toDataURL(\"image/png\");\n          var pdf = new jsPDF(\"l\", \"mm\", \"a4\");\n          var imgProps= pdf.getImageProperties(img);\n          var pdfWidth = pdf.internal.pageSize.getWidth();\n          var pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;\n          pdf.addImage(img, 'JPEG', 10, 10, pdfWidth-20, pdfHeight-30);\n          pdf.save('deep-pdf-export.pdf');\n          printing = false;\n      },200);\n    });\n  });\n\n  d3.select('#button-png').on('click',function(){\n\n    if(printing) return false;\n    printing = true;\n\n    setTimeout(function(){\n      html2canvas(document.querySelector(\"#root\"),{\n            allowTaint: true,\n            onclone: function(doc){\n\n            },\n            useCORS: false,\n            foreignObjectRendering: true,\n            ignoreElements: function(element){\n              // if(element.id=='adm-toggle') return true;\n              // if($(element).hasClass('select2')) return true;\n            return false;\n            },\n            scale: 2,\n            x: 0,\n            y: 0,\n            scrollX: 0,\n            scrollY: 0,\n            logging: false\n        }).then(canvas => {\n\n      var img = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n      var link = document.createElement('a');\n      link.download = 'dashboard-export.png';\n      link.href = img;\n      link.click();\n      link.remove();\n\n      printing = false;\n      },200);\n    });\n  });\n\n  \n//   d3.select('#button-copy').on('click',function(){\n\n//     if(printing) return false;\n//     printing = true;\n\n//     setTimeout(function(){\n//       html2canvas(document.querySelector(\"#root\"),{\n//             allowTaint: true,\n//             onclone: function(doc){\n\n//             },\n//             useCORS: false,\n//             foreignObjectRendering: true,\n//             ignoreElements: function(element){\n//               // if(element.id=='adm-toggle') return true;\n//               // if($(element).hasClass('select2')) return true;\n//             return false;\n//             },\n//             scale: 1.8,\n//             windowWidth: 2800,\n//             windowHeight: 2000,\n//             logging: false\n//         }).then(canvas => {\n//           canvas.toBlob(blob, function(){\n//             navigator.clipboard.write([\n//               new ClipboardItem({\n//                 [blob.type]: blob\n//               })\n//             ]).then(() => {\n\n//             })\n//           })\n//         // copied to clipboard\n//         printing = false;\n//       });\n//       },200);\n//     });\n}\n\n\nexport default Layout;\n\nfunction toggle(collection, item) {\n  var idx = collection.indexOf(item);\n  if (idx !== -1) {\n    collection.splice(idx, 1);\n  } else {\n    collection.push(item);\n  }\n}\n\n/*\n\n#timechart-type-toggle #timechart-type-toggle-stacked\n#timechart-type-toggle #timechart-type-toggle-non-cumulative\n#timechart-type-toggle #timechart-type-toggle-cumulative\n\n#timechart-frequency-toggle #timechart-frequency-toggle-day\n#timechart-frequency-toggle #timechart-frequency-toggle-week\n#timechart-frequency-toggle #timechart-frequency-toggle-month\n\n#map-toggle #map-toggle-bi-weekly-change\n#map-toggle #map-toggle-deaths\n#map-toggle #map-toggle-percent-fully-vaccinated\n#map-toggle #map-toggle-percent-vaccine-acceptance\n#map-toggle #map-toggle-cases\n\n#tabs #bubble-chart-tab\n#tabs #indicators-tab\n#tabs #vaccination-tab\n\n#hdi-toggle #hdi-toggle-very-high\n#hdi-toggle #hdi-toggle-high\n#hdi-toggle #hdi-toggle-medium\n#hdi-toggle #hdi-toggle-low\n\n\n#inform-toggle #inform-toggle-no-score\n#inform-toggle #inform-toggle-low\n#inform-toggle #inform-toggle-medium\n#inform-toggle #inform-toggle-high\n#inform-toggle #inform-toggle-very-high\n\n*/","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxX =1000;\nlet maxY = 100;\nlet maxZ = 1000000;\nlet xScale; \nlet yScale; \nlet zScale; \nlet groupedData = [];\nlet width = 600;\nlet height = 233;\nlet x = 35;\nlet y = 58;\nlet bubbles;\n\nexport function drawBubblechart(data, options, filter) {\n\n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        // if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return 100;\n        // if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return 100;\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return 100;\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]).nice();\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart-tab').append('g').attr('transform', 'translate('+x+', '+y+')')\n    .attr('id', 'bubblechart');\n\n    // create y-axis\n    svg.append(\"g\")\n    .attr('id', 'bubbley')\n    .call(d3.axisLeft(yScale).ticks(3).tickSize(3));\n\n    // create x-axis\n    svg.append(\"g\")\n    .attr('id', 'bubblex')\n    .attr('class', 'xAxis')\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(xScale).ticks(4).tickSize(3));\n\n    // Add dots\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        }).attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    d3.select('#bubblechart_tooltip').attr('display', 'none');\n\n    d3.select('#bubble_y_axis_label').attr('text-anchor', 'middle').select('tspan').attr('dx', 50);\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n\n\n}\n\nexport function updateBubblechart(data,options,filter) {\n    \n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccine_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart');\n\n    // create y-axis\n    svg.select('#bubbley')\n    .transition().duration(800)\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.select('#bubblex')\n    .transition().duration(800)\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"cx\", function (d) { return xScale(maxX)})\n        .attr(\"cy\", function (d) { return yScale(maxY)})\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .transition().duration(800)\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            if(yScale.invert(val)==0) return 'none';\n            return 'inline';\n        }).attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        \n        \n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n    \n    \n\n\n}\n\nexport default drawBubblechart;\n","// default options\nconst options = {\n    region_chart_toggle: 'cases', // cases, deaths, vaccines\n    region_switch: 'total', // total, per100\n    region_filter: [],\n    country_filter: [],\n    hdi_filter: [], // very-high, high, medium, low\n    inform_filter: [], // no-score, low, medium, high, very-high\n    timeline_type: 'non-cumulative', // cumulative, non-cumulative, stacked \n    timeline_frequency: 'week', // day, week, month\n    map_toggle: 'cases', // bi-weekly-change, cases, deaths, percent-fully-vaccinated, percent-vaccine-acceptance\n    tab_toggle: 'vaccination-data', // vaccination-data, indicators, bubble-chart\n    table_sort: 'col1_sort',\n    table_sort_direction: 'desc',\n    bubble_chart_color_by: 'hdi', // hdi, inform-severity, region\n    bubble_chart_y_axis: 'percent-vaccinated-at-least-1-dose', // percent-vaccinated-at-least-1-dose, percent-fully-vaccinated, percent-vaccine-acceptance\n    brushL: 0,\n    brushR: 600,\n    page: 1,\n    numPages: 1\n}\n\nexport default options;\n","import {min,max,group,flatGroup} from \"d3\";\nimport moment from 'moment';\nimport clone from 'just-clone';\nimport { data } from \"jquery\";\n\nexport function ParseData(data, options) {\n\n    //*********************\n    // create regions\n    //*********************\n    data.regions = [\n        {sort: 5, 'code': 'AF', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 3, 'code': 'ME', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 4, 'code': 'AP', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 2, 'code': 'EU', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 1, 'code': 'AM', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 6, 'code': 'OTH', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0}\n    ]\n\n    data.regions.sort(function(a,b){\n        return (a.sort) - (b.sort);\n    });\n\n    //*********************\n    // clean up country data\n    //*********************\n    data.country = data.equity_data;\n    data.country.forEach(function(d,i){\n\n        // if not an IFRC region then set to OTH\n        if((d.ifrc_region!='AF')&&(d.ifrc_region!='ME')&&(d.ifrc_region!='AP')&&(d.ifrc_region!='EU')&&(d.ifrc_region!='AM')){\n            d.ifrc_region = 'OTH';\n        }\n        \n        // parse country population\n        d.population = parseInt(d.population)||0;\n        var pop = 0;\n        if(d.population>0) pop = d.population;\n\n        // sum up ifrc region population \n        data.regions.forEach(function(dd,ii){\n            if(dd.code==d.ifrc_region){\n                dd.population += pop\n            }\n        });\n\n        // get WHO vaccine data (vaccine types used, vaccines_per_100\n        d.vaccines_used = [];\n        d.avg_tests_per_1000 = parseFloat(d.avg_tests_per_1000)||0;\n        d.number_vaccine_types_used = 0;\n        d.vaccines_per_100 = 0;\n        d.number_vaccine_types_used = parseInt(d.avg_tests_per_1000);\n        data.vaccines_who_data.forEach(function(dd,ii){\n            if(d.country_iso3==dd.ISO3){\n                // d.data_updated = moment(dd.DATE_UPDATED).startOf('day').toDate();\n                d.number_vaccine_types_used = parseInt(dd.NUMBER_VACCINES_TYPES_USED);\n                d.vaccines_per_100 = parseFloat(dd.TOTAL_VACCINATIONS_PER100);\n                if(isNaN(d.vaccines_per_100))d.vaccines_per_100 = 0;\n                d.vaccines_used = dd.VACCINES_USED.split(',').map(function(item) {\n                    return item.trim();\n                  });\n            }\n        })\n\n        // get ns involvement in activities\n        d.ns_involvement = 0;\n        data.self_assessment.forEach(function(dd,ii){\n            if(d.country_iso3==dd.ISO3){\n                if(dd['Final involvement']=='Yes') d.ns_involvement = 1;\n            }\n        })\n\n        d.vaccine_acceptance_percent = 0;\n        // get vaccine acceptance\n        data.vaccine_acceptance.forEach(function(dd,ii){\n            if(d.country_iso3==dd.iso3){\n                // if(dd['Final involvement']=='Yes') d.ns_involvement = 1;\n                d.vaccine_acceptance_percent = parseFloat(dd.indicator_value)*100;\n                d.vaccine_acceptance_population = parseInt(dd.population_size);\n            }\n        })\n\n        // get contrat tracing\n        if((d.contract_tracing.toLowerCase()=='all')||(d.contract_tracing.toLowerCase()=='some')){\n            d.contract_tracing = 1;\n        } else {\n            d.contract_tracing = 0\n        }\n\n        // parse equity data inform/hdi indexes\n        if(d.hdi_category.match(/very high/i)){\n            d.hdi_category = 'very-high'\n        }\n        else if(d.hdi_category.match(/high/i)){\n            d.hdi_category = 'high'\n        }\n        else if(d.hdi_category.match(/medium/i)){\n            d.hdi_category = 'medium'\n        }\n        else if(d.hdi_category.match(/low/i)){\n            d.hdi_category = 'low'\n        }\n        if(d.inform_severity.match(/very high/i)){\n            d.inform_severity = 'very-high'\n        }\n        else if(d.inform_severity.match(/high/i)){\n            d.inform_severity = 'high'\n        }\n        else if(d.inform_severity.match(/medium/i)){\n            d.inform_severity = 'medium'\n        }\n        else if(d.inform_severity.match(/low/i)){\n            d.inform_severity = 'low'\n        }\n        else if(d.inform_severity.match(/no/i)){\n            d.inform_severity = 'no-score'\n        }\n\n    });\n\n    //*********************\n    // get min/max dates\n    //*********************\n\n    // get min and max dates from daily who data\n    let maxDate = moment(new Date(max(data.who_data, function(d){\n        return d.Date_reported;\n    }))).startOf('day');\n\n    // override min date to week start\n    data.min_date = moment('2019-12-31').startOf('day').toDate();\n\n    let maxDateVaccines = moment(new Date(max(data.vaccines_data, function(d){\n        return d.date;\n    }))).startOf('day');\n\n    data.min_vaccine_date = moment(new Date(min(data.vaccines_data, function(d){\n        return d.date;\n    }))).startOf('day').toDate();\n\n    data.max_vaccine_date = maxDateVaccines.toDate();\n\n    if(maxDateVaccines.unix()>maxDate.unix()) {\n        maxDate = maxDateVaccines;\n    }\n\n    data.max_date = maxDate.toDate();\n\n    //*********************\n    // parse who data\n    //*********************\n\n    data.who_data.forEach(function(d,i){\n        // parse dates\n        d.date = moment(d.Date_reported).startOf('day').toDate();\n        // override country name and code\n        d.country_code = d.Country_code;\n        d.country_name = null;\n        data.country.forEach(function(dd,ii){\n            if(dd.country_iso2===d.country_code){\n                d.ifrc_region = dd.ifrc_region;\n                d.country_name = dd.country_name;\n            }\n        })\n\n        // parse cases and deaths\n        d.cumulative_deaths = parseInt(d.Cumulative_deaths);\n        d.cumulative_cases = parseInt(d.Cumulative_cases);\n        d.new_cases = parseInt(d.New_cases);\n        d.new_deaths = parseInt(d.New_deaths);\n        \n    });\n\n    // sort by date\n    data.who_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.Date_reported);\n    });\n    \n    //*************************\n    // check for missing who dates and fill in the max date\n    //*************************\n\n    // group by country\n    var whoDataGrouped = flatGroup(data.who_data, d => d.country_code);\n\n    var datesToAdd = [];\n\n    whoDataGrouped.forEach(function(d,i){\n        \n        var maxDate = moment(max(d[1], d=>d.date)).startOf('day');\n        \n        var lastRecord = clone(d[1][d[1].length-1]);\n\n        if(maxDate.unix()!=data.max_date.getTime()){\n            lastRecord.date = new Date(data.max_date);\n            lastRecord.new_cases = 0;\n            lastRecord.new_deaths = 0;\n            datesToAdd.push(lastRecord);\n        }\n\n    })\n\n    data.who_data.push(...datesToAdd);\n\n    data.who_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // set count for incremental day/week/month numbers\n    let dayTotal = -1;\n    let dayCheck = 0;\n    let weekTotal = -1;\n    let weekCheck = -1;\n    let monthTotal = 0;\n    let monthCheck = 0;\n\n    // parse and clean up WHO data\n    let whoCountryCodes = [];\n    data.who_data.forEach(function(d,i){\n        // parse dates\n        // d.date = moment(d.Date_reported).startOf('day').toDate();\n        d.dayOfYear =  moment(d.date).dayOfYear();\n        if(d.dayOfYear!==dayCheck) dayTotal++;\n        d.dayTotal = dayTotal;\n        d.week = moment(d.date).isoWeek();\n        if(d.week!==weekCheck) weekTotal++;\n        d.weekTotal = weekTotal;\n        d.month = d.date.getMonth();\n        if(d.month!==monthCheck) monthTotal++;\n        d.monthTotal = monthTotal;\n        d.year = d.date.getFullYear();\n        d.week_start = new Date(moment(d.date).startOf('isoWeek').startOf('day').toDate());\n        d.month_start = new Date(moment(d.date).startOf('month').startOf('day').toDate());\n\n        // set negative values to zero for new cases/deaths\n        if(d.new_deaths<0)d.new_deaths = 0;\n        if(d.new_cases<0)d.new_cases = 0;\n\n        if(d.ifrc_region==undefined) d.ifrc_region = 'OTH';\n\n        // add country code to array so we know it is used\n        if((!whoCountryCodes.includes(d.country_code))&&(d.country_code.length>1)) {\n            whoCountryCodes.push(d.country_code);\n        }\n\n        // delete old unused keys\n        delete d.Date_reported;\n        delete d.Country;\n        delete d.New_cases;\n        delete d.New_deaths;\n        delete d.Country_code;\n        delete d.Cumulative_deaths;\n        delete d.Cumulative_cases;\n        delete d.Country_code;\n        delete d.WHO_region;\n        delete d.Country;\n        \n        // set incremental count\n        dayCheck = d.dayOfYear;\n        weekCheck = d.week;\n        monthCheck = d.month;\n    })\n   \n    //*********************\n    // parse vaccine cumulative data\n    //*********************\n\n    // clean up values\n    data.vaccines_data.forEach(function(d,i){\n        d.date = moment(d.date).startOf('day').toDate();\n    });\n    \n    data.vaccines_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // filter out vaccine data to only include records with ISO3 country codes\n    data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        return d.iso_code.length===3 && d.total_vaccinations > 0;\n    })\n\n    var vaccineDataByCountry = flatGroup(data.vaccines_data, d => d.iso_code);\n\n    // fill out missing vaccinations date records (extend cumulative from last data date)\n    var newDays = [];\n    var hasDays = [];\n    var lastRecord = {};\n    var vDataFlat = [];\n\n    vaccineDataByCountry.forEach(function(d,i){\n\n        var minDt = new Date(data.min_date);\n        var maxDt = new Date(data.max_date);\n\n        hasDays = [];\n        newDays = [];\n\n        // set the last recorded date fo this country\n        d.lastDate = moment(max(d[1], function(d,i){ return d.date })).startOf('day').toDate();\n        \n        // reset country name and code using country table\n        data.country.forEach(function(dd,ii){\n            if(dd.country_iso3===d[0]){\n                d.ifrc_region = dd.ifrc_region;\n                d.country_name = dd.country_name;\n                d.country_code = dd.country_iso2;\n                dd.data_updated = d.lastDate;\n\n            }\n        })\n\n        // loop through all date records for this country and add to hasDays array\n        d[1].forEach(function(dd,ii){\n            dd.total_vaccinations = parseInt(dd.total_vaccinations);\n            dd.daily_vaccinations = parseInt(dd.daily_vaccinations);\n            hasDays.push(new Date(dd.date).getTime());\n        })\n\n        // fill in missing dates\n        // d[1].forEach(function(dd,ii){\n            for (var day = new Date(data.min_vaccine_date);day <= data.max_date; day.setDate(day.getDate() + 1)) {\n                var newDay = new Date(day).getTime();\n                if(!hasDays.includes(newDay)){\n                    newDays.push({date: new Date(day), total_vaccinations: null, daily_vaccinations: 0})\n                }\n            }\n        // });\n\n        d[1].push(...newDays);\n        d[1].sort(function(a,b){\n            return new Date(a.date) - new Date(b.date);\n        });\n\n        // loop through dates and fill in missing cumulative values\n        var totalVac = 0;\n        var totalVac100 = 0;\n        var people_vaccinated_per_hundred = 0;\n        var people_fully_vaccinated_per_hundred = 0;\n        d[1].forEach(function(dd,ii){\n            if(dd.total_vaccinations){\n                totalVac = dd.total_vaccinations;\n            } else {\n                dd.total_vaccinations = totalVac;\n            }\n            if(dd.total_vaccinations_per_hundred){\n                totalVac100 = dd.total_vaccinations_per_hundred\n            } else {\n                dd.total_vaccinations_per_hundred = totalVac100;\n            }\n            if(dd.people_vaccinated_per_hundred){\n                people_vaccinated_per_hundred = dd.people_vaccinated_per_hundred;\n            } else {\n                dd.people_vaccinated_per_hundred = people_vaccinated_per_hundred;\n            }\n            if(dd.people_fully_vaccinated_per_hundred){\n                people_fully_vaccinated_per_hundred = dd.people_fully_vaccinated_per_hundred;\n            } else {\n                dd.people_fully_vaccinated_per_hundred = people_fully_vaccinated_per_hundred;\n            }\n\n            var countryName;\n            if(d.country_name==null) { countryName = d[0];\n            } else {\n                countryName = d.country_name\n            }\n            var dailyVac = 0;\n            if((dd.daily_vaccinations)&&(dd.daily_vaccinations>0)) dailyVac = dd.daily_vaccinations;\n\n            vDataFlat.push({\n                date: new Date(dd.date),\n                lastDate: d.lastDate,\n                total_vaccinations_per_hundred: parseFloat(totalVac100),\n                people_vaccinated_per_hundred: parseFloat(people_vaccinated_per_hundred),\n                people_fully_vaccinated_per_hundred: parseFloat(people_fully_vaccinated_per_hundred),\n                iso_code: d[0], \n                ifrc_region: d.ifrc_region,\n                country_name: countryName,\n                country_code: d.country_code, \n                total_vaccinations: totalVac,\n                daily_vaccinations: dailyVac\n            })\n        })\n    });\n\n    data.vaccines_data = vDataFlat;\n\n    data.vaccines_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // reset count for incremental day/week/month numbers\n    dayTotal = -1;\n    dayCheck = 0;\n    weekTotal = -1;\n    weekCheck = -1;\n    monthTotal = 0;\n    monthCheck = 0;\n    \n    data.vaccines_data.forEach(function(d,i){\n        if(d.ifrc_region==undefined) d.ifrc_region = 'OTH';\n        d.dayOfYear =  moment(d.date).dayOfYear();\n        if(d.dayOfYear!==dayCheck) dayTotal++;\n        d.dayTotal = dayTotal;\n        d.week = moment(d.date).isoWeek();\n        if(d.week!==weekCheck) weekTotal++;\n        d.weekTotal = weekTotal;\n        d.month = d.date.getMonth();\n        if(d.month!==monthCheck) monthTotal++;\n        d.monthTotal = monthTotal;\n        d.year = d.date.getFullYear();\n        dayCheck = d.dayOfYear;\n        weekCheck = d.week;\n        monthCheck = d.month;\n        d.week_start = new Date(moment(d.date).startOf('isoWeek').toDate());\n        d.month_start = new Date(moment(d.date).startOf('month').toDate());\n    })\n\n    //*********************\n    // add most recent owid vaccine data record to data.country\n    //*********************\n\n    // group who data by country\n    var vaccineDataByCountry = flatGroup(data.vaccines_data, d => d.country_code);\n\n    //*********************\n    // add most recent records from both datasets to data.country\n    //*********************\n\n    // first group who data by country\n    var whoDataByCountry = flatGroup(data.who_data, d => d.country_code);\n\n    data.country.forEach(function(d,i){\n        d.cumulative_cases_per_100k = 0;\n        d.cumulative_deaths_per_100k = 0;\n        d.cumulative_vaccines_per_100k = 0;\n        d.people_fully_vaccinated_per_hundred = 0;\n        d.people_vaccinated_per_hundred = 0;\n        d.total_vaccinations_per_hundred = 0;\n        var countryCode = d.country_iso2;\n\n        // calculate latest date and at weekly intervals (for bi-weekly percent change calculation)\n        whoDataByCountry.forEach(function(dd,ii){\n            if(dd[0]==countryCode){\n                d.who_daily_latest = dd[1][dd[1].length-1];\n                d.who_daily_7_days = dd[1][dd[1].length-8];\n                d.who_daily_14_days = dd[1][dd[1].length-15];\n                d.who_daily_21_days = dd[1][dd[1].length-22];\n                d.who_daily_28_days = dd[1][dd[1].length-29];\n                d.cumulative_cases_per_100k = (d.who_daily_latest.cumulative_cases/(d.population/100000));\n                d.cumulative_deaths_per_100k = (d.who_daily_latest.cumulative_deaths/(d.population/100000));\n                d.cumulative_cases = d.who_daily_latest.cumulative_cases;\n                d.cumulative_deaths = d.who_daily_latest.cumulative_deaths;\n                d.cumulative_deaths_7_days = d.who_daily_7_days.cumulative_deaths;\n                d.cumulative_deaths_14_days = d.who_daily_14_days.cumulative_deaths;\n                d.cumulative_deaths_21_days = d.who_daily_21_days.cumulative_deaths;\n                d.cumulative_deaths_28_days = d.who_daily_28_days.cumulative_deaths;\n                d.cumulative_cases_7_days = d.who_daily_7_days.cumulative_cases;\n                d.cumulative_cases_14_days = d.who_daily_14_days.cumulative_cases;\n                d.cumulative_cases_21_days = d.who_daily_21_days.cumulative_cases;\n                d.cumulative_cases_28_days = d.who_daily_28_days.cumulative_cases;\n                var percentChange = parseFloat(((d.cumulative_cases - d.cumulative_cases_14_days)-(d.cumulative_cases_14_days-d.cumulative_cases_28_days))/(d.cumulative_cases_14_days-d.cumulative_cases_28_days));\n                if(isFinite(percentChange)) { d.percent_change = percentChange; } else { d.percent_change = 0 }\n            }\n        })\n\n        vaccineDataByCountry.forEach(function(dd,ii){\n            if(dd[0]==countryCode){\n                if(typeof(dd[0]!='undefined')){\n                    d.vaccine_daily_latest = dd[1][dd[1].length-1];\n                    d.cumulative_vaccines_per_100k = (d.vaccine_daily_latest.total_vaccinations/(d.population/100000));\n                    d.people_fully_vaccinated_per_hundred = d.vaccine_daily_latest.people_fully_vaccinated_per_hundred;\n                    d.people_vaccinated_per_hundred = d.vaccine_daily_latest.people_vaccinated_per_hundred;\n                    d.total_vaccinations_per_hundred = d.vaccine_daily_latest.total_vaccinations_per_hundred;\n                    d.total_vaccinations = d.vaccine_daily_latest.total_vaccinations;\n                }\n            }\n        })\n\n        if(!isFinite(d.cumulative_cases_per_100k))d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k))d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k))d.cumulative_vaccines_per_100k = 0;\n        d.country_code = d.country_iso2;\n\n    })\n\n    data.original = clone(data);\n\n}\n\nexport default ParseData;\n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {filter} from './App';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport {addCommas} from './HelperFunctions';\n\nmapboxgl.accessToken = 'pk.eyJ1IjoiZ28taWZyYyIsImEiOiJjams3b2ZhZWswMGFvM3hxeHp2ZHFhOTRrIn0._pqO9OQ2iNeDGrpopJNjpg';\nvar mapboxStyle = 'mapbox://styles/go-ifrc/ckqrsg27f1cwu17pex8w2de2e';\n\nlet map;\nlet dots; \nlet maxSize = 15; \nlet mapTooltip;\n\nexport function createMap(data, options, filter) {\n\n    d3.select('#map-refresh').attr('display', 'none').style('cursor', 'pointer')\n    .on('click', function(d,i){\n        map.setCenter([8, 22]);\n        map.setZoom(0);\n        d3.select('#map-refresh').attr('display', 'none');\n    })\n    \n    map = new mapboxgl.Map({\n        container: 'map_div', // container ID\n        style: mapboxStyle, // style URL\n        center: [8, 22], // starting position [lng, lat]\n        preserveDrawingBuffer: true,\n        zoom: 0 // starting zoom\n    });\n\n    map.setRenderWorldCopies(false);\n    map.addControl(new mapboxgl.NavigationControl());\n    \n    // disable map zoom when using scroll\n    map.scrollZoom.disable();\n\n    map.on('zoom', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('touchmove', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('wheel', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('drag', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    var container = map.getCanvasContainer();\n\n    var svg = d3\n    .select(container)\n    .append(\"svg\")\n    .attr('id', 'mapoverlay')\n    .attr(\"width\", \"100%\")\n    .attr(\"height\", \"24vw\")\n    .style(\"position\", \"absolute\")\n    .style(\"z-index\", 2);\n\n    mapTooltip = d3.select('#map_tooltip').attr('opacity', 1).attr('transform', 'translate(0,0)').attr('display', 'inline');\n\n    // dots = svg\n    // .selectAll(\".country-map\")\n    // .data(data.world)\n    // .enter()\n    // .append(\"circle\")\n    // .attr('class', 'country-map')\n    // .attr('id', function(d,i){ return 'country-map-'+d.iso2 })\n    // .attr(\"r\", 0)\n    \n\n    // var maxValue = d3.max(data.country, function(d,i){\n    //     return d[1].cumulative_cases;\n    // })\n\n    // var rScale = d3.scalePow().exponent(0.5)\n    //   .domain([0, maxValue])\n    //   .range([0, 15]);\n\n    // data.country.forEach(function(d,i){\n    //     d3.select('#country-'+d[0]).attr('r', rScale(d[1].cumulative_cases))\n    //     .attr('data-name', d[1].country)\n    // })\n    \n    d3.select(\"#map_div\").append('svg')\n    .attr('width', '18vw')\n    .attr('height', '1.5vw')\n    .attr('id', 'maplegend')\n    .attr('viewBox', '-3 0 227 18')\n    .style('background-color', 'rgba(255,255,255,0.8)')\n\n    document.getElementById(\"maplegend\").appendChild(d3.select('#red_legend').node());\n    document.getElementById(\"maplegend\").appendChild(d3.select('#blue_legend').node());\n    document.getElementById(\"maplegend\").appendChild(d3.select('#bi_legend').node());\n\n    d3.select('#red_legend').attr('transform', 'translate(20,0)');\n    d3.select('#blue_legend').attr('transform', 'translate(20,0)');\n    d3.select('#bi_legend').attr('transform', 'translate(0,0)');\n\n    d3.select('#bi_legend').attr('display', 'none');\n    d3.select('#blue_legend').attr('display', 'none');\n\n    document.getElementById(\"mapoverlay\").appendChild(d3.select('#map_tooltip').node());\n    mapTooltip.attr('display', 'none')  \n\n    map.on('load', function (e) {\n\n        map.setPaintProperty('countries', 'fill-opacity-transition', {duration: 0, delay: 0});\n\n        updateMap(data, options) ;\n\n    });\n\n}\n\nexport function updateMap(data, options) {\n   \n    var duration = 800;\n    var delay = 10;\n\n    map.setLayoutProperty(\n        'countries',\n        'visibility',\n        'none'\n    );\n\n    if(options.map_toggle == 'bi-weekly-change'){\n        \n        var maxIncrease = d3.max(data.country, function(d,i){\n            return d.percent_change;\n        })\n\n        var maxDecrease = d3.min(data.country, function(d,i){\n            return d.percent_change;\n        })\n\n        d3.select('#bi_legend').attr('display', 'inline');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'none');\n\n        maxIncrease = (Math.ceil(maxIncrease/0.1))*0.1;\n        maxDecrease = (Math.floor(maxDecrease/0.1))*0.1;\n\n        if(maxIncrease>1) maxIncrease = 1;\n        if(maxDecrease<-1) maxDecrease = -1;\n\n        d3.select('#bi_legend_dec_val').attr('text-anchor', 'end');\n        if(maxIncrease<1){\n            d3.select('#bi_legend_inc_val tspan').text(Math.round(maxIncrease*100)+'%');\n        } else {\n            d3.select('#bi_legend_inc_val tspan').text(Math.round(maxIncrease*100)+'% +');\n        }\n        if(maxDecrease>-1){\n            d3.select('#bi_legend_dec_val tspan').text(Math.round(Math.abs(maxDecrease)*100)+'%').attr('dx', 14);\n        } else {\n            d3.select('#bi_legend_dec_val tspan').text(Math.round(Math.abs(maxDecrease)*100)+'% +').attr('dx', 14);\n        }\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([-1, 0, 1])\n        // .range([maxSize, 0, maxSize])\n        // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].percent_change))\n        //     .style('stroke', function(){\n        //         // if(d[1].percent_change>1){ return '#E02225'} else { return '#1F558C'}\n        //         return '#FFF'\n        //     }).style('fill', function(){\n        //         if(d[1].percent_change>0){ return colors.red } else { return colors.blue}\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([-1, 0, 1])\n        // .domain([maxDecrease, 0, maxIncrease])\n        .range([colors.blue, colors.lightgrey, colors.red])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            if(isFinite(d.percent_change)){\n                fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                fillColorArray.push(colorScale(d.percent_change));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n        \n    }\n\n    if(options.map_toggle == 'cases'){\n\n        var maxValue = d3.max(data.country, function(d,i){\n            return d.cumulative_cases_per_100k;\n        });\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'inline');\n\n        d3.select('#red_legend_title tspan').text('Cases per 100k');\n\n        if(maxValue>1000){\n            maxValue = (Math.ceil(maxValue/100))*100;\n        } else {\n            maxValue = (Math.ceil(maxValue/10))*10;\n        }\n\n        d3.select('#red_legend_val tspan').text(addCommas(maxValue));\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([0, maxValue])\n        // .range([0, maxSize]);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].cumulative_cases))\n        //     .style('fill', colors.red)\n        //     .style('stroke', '#FFF');\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, maxValue])\n        .range([colors.lightgrey, colors.red]);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n            fillColorArray.push(colorScale(d.cumulative_cases_per_100k));\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n\n    }\n    \n    if(options.map_toggle == 'deaths'){\n\n        var maxValue = d3.max(data.country, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        })\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'inline');\n\n        d3.select('#red_legend_title tspan').text('Deaths per 100k');\n\n        if(maxValue>1000){\n            maxValue = (Math.ceil(maxValue/100))*100;\n        } else {\n            maxValue = (Math.ceil(maxValue/10))*10;\n        }\n\n        d3.select('#red_legend_val tspan').text(addCommas(maxValue));\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([0, maxValue])\n        // .range([0, maxSize]);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].cumulative_deaths))\n        //     .style('fill', colors.red)\n        //     .style('stroke', '#FFF');\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, maxValue])\n        .range([colors.lightgrey, colors.red]);\n\n        var fillColorArray = ['case']\n\n        data.country.forEach(function(d,i){\n            fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n            fillColorArray.push(colorScale(d.cumulative_deaths_per_100k));\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n    }\n\n    if(options.map_toggle == 'percent-fully-vaccinated'){\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'inline');\n        d3.select('#red_legend').attr('display', 'none');\n        d3.select('#blue_legend_title tspan').text('Percent fully vaccinated');\n        d3.select('#blue_legend_val tspan').text('100%');\n\n        // var rScale = d3.scalePow().exponent(0.55)\n        // .domain([0, 1])\n        // .range([1, maxSize])\n        // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.vGroup.forEach(function(d,i){\n        //     var peoplevaccinated = parseFloat(d[1][0].people_fully_vaccinated_per_hundred)/100;\n        //     if(isNaN(peoplevaccinated)) peoplevaccinated = 0;\n        //     d3.select('#country-map-'+d[1][0].country_code)\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(peoplevaccinated))\n        //     .style('stroke', '#FFF')\n        //     .style('fill', function(){\n        //         return colors.blue;\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, 1])\n        .range([colors.lightgrey, colors.blue])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            var peoplevaccinated = parseFloat(d.people_fully_vaccinated_per_hundred)/100;\n            if(isNaN(peoplevaccinated)) peoplevaccinated = 0;\n            if(peoplevaccinated>0){\n                if(d.country_code) fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                if(d.country_code) fillColorArray.push(colorScale(peoplevaccinated));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        } else {\n            map.setPaintProperty(\n                'countries', \n                'fill-color',\n                colors.darkgrey\n            );\n        }\n        \n    }\n\n    if(options.map_toggle == 'percent-vaccine-acceptance'){\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'inline');\n        d3.select('#red_legend').attr('display', 'none');\n        d3.select('#blue_legend_title tspan').text('% vaccine acceptance');\n        d3.select('#blue_legend_val tspan').text('100%');\n        \n        // var rScale = d3.scalePow().exponent(1)\n        // .domain([0, 1])\n        // .range([1, maxSize*.7])\n        // // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.vGroup.forEach(function(d,i){\n        //     var vaccine_acceptance_percent = parseFloat(d[1][0].vaccine_acceptance_percent/100);\n            \n        //     if(isNaN(vaccine_acceptance_percent)) vaccine_acceptance_percent = 0;\n\n        //     d3.select('#country-map-'+d[1][0].country_code)\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(vaccine_acceptance_percent))\n        //     .style('stroke', '#FFF')\n        //     .style('fill', function(){\n        //         return colors.blue;\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, 1])\n        .range([colors.lightgrey, colors.blue])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            var vaccine_acceptance_percent = parseFloat(d.vaccine_acceptance_percent)/100;\n            if(isNaN(vaccine_acceptance_percent)) vaccine_acceptance_percent = 0;\n            if(vaccine_acceptance_percent>0){\n                if(d.country_code) fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                if(d.country_code) fillColorArray.push(colorScale(vaccine_acceptance_percent));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        } else {\n            map.setPaintProperty(\n                'countries', \n                'fill-color',\n                colors.darkgrey\n            );\n        }\n\n    }\n\n    mapTooltip.attr('display', 'none')  \n\n    map.on('mousemove', function (e) {\n        var features = map.queryRenderedFeatures(e.point);\n         \n        var displayProperties = [\n        'type',\n        'properties',\n        'id',\n        'layer',\n        'source',\n        'sourceLayer',\n        'state'\n        ];\n         \n        if((features.length==1)&&(features[0].layer.id=='countries')){\n\n            var id = features[0].properties.iso;\n            var countryfiltered = data.equity_data.filter(d=>d.country_iso2 == id);\n            var countryName;\n            if(countryfiltered[0]) countryName = countryfiltered[0].country_name;\n    \n            mapTooltip.select('#map_tooltip_name tspan').text(countryName);\n  \n            if(mapTooltip.select('#map_tooltip_name tspan').text().length==0){\n                mapTooltip\n                .attr('display', 'none');\n            };\n            \n            if(options.map_toggle=='cases'){\n                var country = data.country.filter(d=>d.country_code == id)[0];\n                if((!country)||(country.length==0)) return false;\n                mapTooltip.select('#map_tooltip_val tspan').text(addCommas(Math.round(country.cumulative_cases_per_100k))+' cases per 100k');\n            }\n    \n            if(options.map_toggle=='deaths'){\n                var country = data.country.filter(d=>d.country_code == id)[0];\n                if((!country)||(country.length==0)) return false;\n                mapTooltip.select('#map_tooltip_val tspan').text(addCommas(Math.round(country.cumulative_deaths_per_100k))+' deaths per 100k');\n            }\n    \n            if(options.map_toggle=='bi-weekly-change'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = ((country[0].percent_change)*100).toFixed(1);\n                var str = '';\n                if(val>=0){\n                    str = '% increase';\n                } else {\n                    str = '% decrease';\n                }\n                mapTooltip.select('#map_tooltip_val tspan').text(Math.abs(val)+str);\n            }\n    \n            if(options.map_toggle=='percent-fully-vaccinated'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = parseFloat(country[0].people_fully_vaccinated_per_hundred).toFixed(1)\n                if(isNaN(val)){ val = '-' } else { val = val + '% fully vaccinated'}\n                mapTooltip.select('#map_tooltip_val tspan').text(val);\n            }\n    \n            if(options.map_toggle=='percent-vaccine-acceptance'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = parseFloat(country[0].vaccine_acceptance_percent).toFixed(1)\n                if(isNaN(val)){ val = '-' } else { val = val + '% vaccine acceptance'}\n                mapTooltip.select('#map_tooltip_val tspan').text(val);\n            }\n    \n            var str = mapTooltip.select('#map_tooltip_val tspan').text();\n            if(str.includes('NaN')) mapTooltip.attr('display', 'none')\n\n            d3.select('#map_tooltip_bg').attr('width', 20)\n\n            var scale = window.innerWidth/1329;\n            mapTooltip\n            .attr('display', 'inline')\n            .attr('transform', 'translate('+(e.point.x+20)+','+e.point.y+')scale('+scale+')');\n            var heightOffset = mapTooltip.node().getBBox();\n\n            var bbox = d3.select('#map_tooltip').node().getBBox();\n            d3.select('#map_tooltip_bg').attr('width', (parseFloat(bbox.width)+2))\n\n            if(mapTooltip.select('#map_tooltip_name tspan').text().length==0){\n                mapTooltip\n                .attr('display', 'none');\n            };\n\n            // mapTooltip.attr('transform', 'translate('+(project(([d.lng, d.lat])).x+3)+','+(project(([d.lng, d.lat])).y+2-heightOffset.height/2)+')scale('+scale+')');\n        } else {\n            mapTooltip.attr('display', 'none')\n        }\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        mapTooltip.attr('display', 'none');\n    })\n\n\n    // function render() {\n    //     dots\n    //       .attr(\"cx\", function(d) {\n    //         return project(([d.lng, d.lat])).x;\n    //       })\n    //       .attr(\"cy\", function(d) {\n    //         return project(([d.lng, d.lat])).y;\n    //       });\n    //   }\n\n    // map.on(\"viewreset\", render);\n    // map.on(\"move\", render);\n    // map.on(\"moveend\", render);\n    // render(); // Call once to render\n\n    // tooltips\n\n    // var mapTooltip = d3.select('#map_tooltip').attr('opacity', 1).attr('transform', 'translate(0,0)').attr('display', 'none');\n\n    // d3.selectAll('.country-map').on('mousemove', function(event, d){\n\n    //     var id = d3.select(this).attr('id').substr(12,2);\n    //     var countryfiltered = data.equity_data.filter(d=>d.country_iso2 == id);\n    //     var countryName;\n    //     if(countryfiltered[0]) countryName = countryfiltered[0].country_name;\n\n    //     mapTooltip.select('#map_tooltip_name tspan').text(countryName);\n\n    //     if(options.map_toggle=='cases'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(addCommas(country[1].cumulative_cases)+' cases');\n    //     }\n\n    //     if(options.map_toggle=='deaths'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(addCommas(country[1].cumulative_deaths)+' deaths');\n    //     }\n\n    //     if(options.map_toggle=='bi-weekly-change'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         var val = ((country[1].percent_change)*100).toFixed(1);\n    //         var str = '';\n    //         if(val>=0){\n    //             str = '% increase';\n    //         } else {\n    //             str = '% decrease';\n    //         }\n    //         mapTooltip.select('#map_tooltip_val tspan').text(Math.abs(val)+str);\n    //     }\n\n    //     if(options.map_toggle=='percent-fully-vaccinated'){\n    //         var country = data.vGroup.filter(d=>d[1][0].country_code == id)[0][1];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(parseFloat(country[0].people_fully_vaccinated_per_hundred).toFixed(1)+'% fully vaccinated');\n    //     }\n\n    //     if(options.map_toggle=='percent-vaccine-acceptance'){\n    //         var country = data.vGroup.filter(d=>d[1][0].country_code == id)[0][1];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(parseFloat(country[0].vaccine_acceptance_percent).toFixed(1)+'% vaccine acceptance');\n    //     }\n\n\n    //     d3.select('#map_tooltip_bg').attr('width', 0)\n\n    //     var bbox = mapTooltip.node().getBBox();\n    //     d3.select('#map_tooltip_bg').attr('width', (parseFloat(bbox.width)+2))\n    //     var scale = window.innerWidth/1329;\n    //     mapTooltip\n    //     .attr('display', 'inline')\n    //     .attr('transform', 'translate('+project(([d.lng, d.lat])).x+','+project(([d.lng, d.lat])).y+')scale('+scale+')');\n\n    //     var heightOffset = mapTooltip.node().getBBox();\n    //     mapTooltip.attr('transform', 'translate('+(project(([d.lng, d.lat])).x+3)+','+(project(([d.lng, d.lat])).y+2-heightOffset.height/2)+')scale('+scale+')');\n\n   \n\n    map.setLayoutProperty(\n        'countries',\n        'visibility',\n        'visible'\n    );\n\n}\n\n// function project(d) {\n//     return map.project(new mapboxgl.LngLat(d[0], d[1]));\n// }\n\nexport default createMap;\n","import React, { useEffect, useState } from \"react\";\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {drawRegionchart, updateRegionchart} from './Regionchart';\nimport {drawBubblechart, updateBubblechart} from './Bubblechart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css'\nimport $ from \"jquery\";\nimport select2 from 'select2';\nimport 'select2/dist/css/select2.min.css'\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport { createMap, updateMap } from './Map';\nimport moment from 'moment';\n\n  /* \n  add this attribute to package.json when deploying to github pages.\n \"homepage\": \"https://ifrcgo.github.io/ifrc-covid-dataviz/build\", \n  */\n\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\n// const whoDataUrl = \"./data/who_global_cases.csv\";\nconst whoDataUrl = \"https://covid19.who.int/WHO-COVID-19-global-data.csv\";\n// const vaccinesDataUrl = \"./data/owid_vaccinations.csv\";\nconst vaccinesDataUrl = \"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations.csv\";\n// const vaccinesWhoDataUrl = \"./data/who_vaccination_data.csv\";\nconst vaccinesWhoDataUrl = \"https://covid19.who.int/who-data/vaccination-data.csv\";\nconst timelineDataUrl = \"./data/timeline.csv\";\nconst selfAssessmentDataUrl = \"./data/self_assessment.csv\";\nconst vaccineAcceptanceDataUrl = \"./data/vaccine_acceptance.csv\";\n\nconst data = {};\n\nconst regionOptions = [\n  { id: 'AM', text: 'Americas' },\n  { id: 'EU', text: 'Europe' },\n  { id: 'AP', text: 'Asia-Pacific' },\n  { id: 'ME', text: 'Middle East and North Africa'},\n  { id: 'AF', text: 'Africa' }\n]\n\nconst countryOptions = [];\n\nfunction App() {\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...');\n\n  async function init(){\n\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function(d){\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', '100%').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      svg.attr('id', 'svg');\n      Layout(svg, options, data, filter, updateTable, updateMap);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...');\n      // data source 2: equity_data.csv\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function(d){\n        data.equity_data = d;\n        d.forEach(function(d,i){\n          countryOptions.push({'text': d.country_name, 'id': 'Country-'+d.country_iso2 })\n        })\n        createSelects();\n        setProgress(0.1);\n        setLoaderText('Loading WHO data CSV...');\n        // data source 1: owid_vaccines.csv\n        const vaccinesData = d3.csv(vaccinesDataUrl);\n          vaccinesData.then(function(d){\n            data.vaccines_data = d;\n            setProgress(0.07);\n            setLoaderText('Loading OWID vaccines data...');\n             // data source 2: vaccinesWhoData.csv\n             const vaccinesWhoData = d3.csv(vaccinesWhoDataUrl);\n             vaccinesWhoData.then(function(d){\n               data.vaccines_who_data = d;\n               setProgress(0.15);\n               setLoaderText('Loading OWID vaccines data...');\n                // data source 3: self_assessment.csv\n                const selfAssessmentData = d3.csv(selfAssessmentDataUrl);\n                selfAssessmentData.then(function(d){\n                  data.self_assessment = d;\n                  setProgress(0.22);\n                  setLoaderText('Loading self assessment...');\n                  // data source 4: vaccine_acceptance.csv\n                  const vaccineAcceptanceData = d3.csv(vaccineAcceptanceDataUrl);\n                  vaccineAcceptanceData.then(function(d){\n                    data.vaccine_acceptance = d;\n                    setProgress(0.3);\n                      setLoaderText('Loading vaccine acceptance data...');\n                      // data source 3: timeline.csv\n                      const timelineData = d3.csv(timelineDataUrl);\n                      timelineData.then(function(d){\n                        data.timeline_data = d;\n                        setProgress(0.4);\n                        setLoaderText('Loading WHO daily data...');\n                          // data source 5: who_global_cases.csv\n                          const whoData = d3.csv(whoDataUrl);\n                          whoData.then(function(d){\n                            data.who_data = d;\n                            setProgress(0.8);\n                              setLoaderText('Loading complete.');\n                              setProgress(1);\n                              ParseData(data, options);\n                              createCharts();\n                              d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n                    });\n                  });\n                });\n              });\n            });\n          });\n      });\n    })\n  }\n  \n  function createCharts(){\n    d3.select('#who_data_date tspan').text(moment(data.max_date).format('ll'));\n    d3.select('#owid_data_date tspan').text(moment(data.max_vaccine_date).format('ll'));\n    drawTimechart(data, options);\n    drawRegionchart(data, options, filter);\n    updateTable(data, options);\n    updateTotals(data, options);\n    createMap(data, options, filter);\n    drawBubblechart(data, options, filter);\n  }\n\n  function filter(id,e){\n    options.page = 1;\n    if(id=='clear'){\n      options.region_filter = [];\n      options.country_filter = [];\n      d3.select('#reset_locations').attr('display', 'none');\n    } \n    if(id=='clear-region'){\n      options.region_filter = [];\n    } \n\n    if(id=='clear-hdi'){\n      options.hdi_filter = [];\n    } \n\n    if(id=='clear-inform'){\n      options.inform_filter = [];\n    } \n\n    if((id.length==1)&&(id[0].length==2)&&(id!='filter')){\n      if(options.region_filter.includes(id[0])){\n        options.region_filter = options.region_filter.filter(d=>d!==id[0])\n      } else {\n        options.region_filter.push(id[0]);\n      }\n    }\n\n    if(options.region_filter.length==5) options.region_filter = [];\n\n    if(options.region_filter.length>0){\n      d3.select('#region_remove_filter').attr('opacity', 1);\n\n      d3.selectAll('.bar-labels').attr('opacity', 0.5);\n      options.region_filter.forEach(function(d,i){\n        d3.select('.bar-label-'+d).attr('opacity', 1);\n      })\n    } else {\n        d3.select('#region_remove_filter').attr('opacity', 0);\n        d3.selectAll('.bar-labels').attr('opacity', 1);\n    }\n\n    data.country = data.original.country;\n\n    var hdi_countries = [];\n    if(options.hdi_filter.length>0){\n      d3.select('#hdi_remove_filter').attr('opacity', 1);\n      data.country.forEach(function(d,i){\n        if(options.hdi_filter.includes(d.hdi_category)){\n          hdi_countries.push(d.country_iso2);\n        }\n      })\n    } else {\n      d3.select('#hdi_remove_filter').attr('opacity', 0);\n    }\n\n    var inform_countries = [];\n    if(options.inform_filter.length>0){\n      d3.select('#inform_remove_filter').attr('opacity', 1);\n      data.country.forEach(function(d,i){\n        if(options.inform_filter.includes(d.inform_severity)){\n          inform_countries.push(d.country_iso2);\n        }\n      })\n    } else {\n      d3.select('#inform_remove_filter').attr('opacity', 0);\n    }\n\n    if((id.length==1)&&(id[0].length>2)){\n      var code = id[0].substring(8);\n      if(options.country_filter.includes(code)){\n        options.country_filter = options.country_filter.filter(d=>d!==code)\n      } else {\n        options.country_filter.push(code);\n      }\n    }\n\n    if((options.region_filter.length==0)&&(options.country_filter.length==0)){\n      d3.select('#reset_locations').attr('display', 'none');\n    }\n\n    var countryIds = [];\n    options.country_filter.forEach(function(d,i){\n      countryIds.push('Country-'+d);\n    })\n\n    if((options.region_filter.length>0)||(options.country_filter.length>0)) {\n        d3.select('#reset_locations').attr('display', 'inline')\n      } else {\n        d3.select('#reset_locations').attr('display', 'none')\n      }\n\n    var mergeFilter = options.region_filter.concat(countryIds);\n    $('#regionSelect').val(mergeFilter)\n    $('#regionSelect').trigger('change');\n\n    // update data\n    data.who_data = data.original.who_data;\n\n    if(inform_countries.length>0){\n      data.who_data = data.who_data.filter(function(d,i){\n        return inform_countries.includes(d.country_code)\n      })\n    }\n    \n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.who_data = data.who_data.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code)))&&(hdi_countries.includes(d.country_code))\n          } else {\n            return (hdi_countries.includes(d.country_code))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code))\n        }\n      })\n    }\n    data.vaccines_data = data.original.vaccines_data;\n\n    if(inform_countries.length>0){\n      data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        return inform_countries.includes(d.country_code)\n      })\n    }\n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code)))&&(hdi_countries.includes(d.country_code))\n          } else {\n            return (hdi_countries.includes(d.country_code))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code))\n        }\n      })\n    }\n\n    if(inform_countries.length>0){\n      data.country = data.country.filter(function(d,i){\n        return inform_countries.includes(d.country_iso2)\n      })\n    } \n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.country = data.country.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_iso2)))&&(hdi_countries.includes(d.country_iso2))\n          } else {\n            return (hdi_countries.includes(d.country_iso2))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_iso2))\n        }\n      })\n    }\n\n    handleSelectLength();\n    updateCharts();\n\n  }\n  function updateCharts(){\n    updateRegionchart(options,data);\n    updateTable(data, options);\n    updateTotals(data, options);\n    updateTimechart(data, options);\n    updateMap(data,options);\n    updateBubblechart(data, options, filter);\n  }\n\n  function updateTotals(data,options){\n\n    var numCountriesFiltered = data.country.length;\n\n    // total cases\n    var totalCases = d3.sum(data.country, d => d.cumulative_cases);\n    d3.select('#total_cases tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalCases)(t))\n      };\n    });\n\n    // hide bars when zero cases\n    if(totalCases==0){\n      d3.selectAll('.bar_group').attr('opacity',0);\n    } else {\n      d3.selectAll('.bar_group').attr('opacity',1);\n    }\n\n    // total new cases\n    var totalNewCases = totalCases - d3.sum(data.country, d => d.cumulative_cases_7_days);\n    d3.select('#total_new_cases tspan').text('-');\n    d3.select('#total_new_cases tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalNewCases)(t))\n      };\n    })\n\n    // total deaths\n    var totalDeaths = d3.sum(data.country, d => d.cumulative_deaths);\n    d3.select('#total_deaths tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalDeaths)(t))\n      };\n    })\n\n    var totalVaccinations = d3.sum(data.country, d => d.total_vaccinations);\n    d3.select('#total_vaccines tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalVaccinations)(t))\n      };\n    })\n\n    //***************************\n    // vaccies per 100 / acceptance / vaccine types / ns involvemnt\n    //***************************\n    var vaccinesPer100 = {population: 0, vaccine_population: 0};\n    var vaccineAcceptance = {population: 0, vaccine_acceptance_population: 0};\n    var numNsInvolvedCountres = 0;\n    data.vaccine_types = [];\n    data.country.forEach(function(dd,ii){\n      // vaccine per 100 including country population weight\n      if((dd.vaccines_per_100>0)&&(dd.population>0)) {\n        vaccinesPer100.population += dd.population;\n        vaccinesPer100.vaccine_population += dd.population*dd.vaccines_per_100;\n      }\n      // vaccine acceptance including country population weight\n      if(dd.vaccine_acceptance_population>0) {\n        vaccineAcceptance.population += dd.vaccine_acceptance_population;\n        vaccineAcceptance.vaccine_acceptance_population += dd.vaccine_acceptance_population*dd.vaccine_acceptance_percent;\n      }\n      // vacine types data\n      dd.vaccines_used.forEach(function(ddd){\n        if((!data.vaccine_types.includes(ddd))&&(ddd.length>1)&&(!ddd.includes('nactiv'))) data.vaccine_types.push(ddd);\n      })\n      // ns involved countries\n      numNsInvolvedCountres += dd.ns_involvement;\n    });\n\n    // update total doses per 100 total\n    d3.select('#total_vac_100 tspan').text('-');\n    var vaccinePer100ByPopulation = vaccinesPer100.vaccine_population / vaccinesPer100.population;\n    if(vaccinePer100ByPopulation){\n      d3.select('#total_vac_100 tspan').transition().duration(500)\n      .textTween(function() {\n        return function(t) {\n          return (d3.interpolate(0, vaccinePer100ByPopulation)(t).toFixed(1))\n        };\n      })\n    }\n\n    // update vaccine acceptance percent total\n    d3.select('#percent_acceptance tspan').text('-');\n    var vaccineAcceptancePercent = vaccineAcceptance.vaccine_acceptance_population / vaccineAcceptance.population;\n    if(vaccineAcceptancePercent){\n      d3.select('#percent_acceptance tspan').transition().duration(500)\n      .textTween(function() {\n        return function(t) {\n          return Math.round(d3.interpolate(0, Math.round(vaccineAcceptancePercent))(t))+'%';\n        };\n      })\n    }\n\n    // update ns involved total\n    d3.select('#total_ns_countries tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return Math.round(d3.interpolate(0, numNsInvolvedCountres)(t))\n      };\n    })\n\n    // update num types of vaccines total\n    d3.select('#num_vaccines tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return Math.round(d3.interpolate(0, data.vaccine_types.length)(t))\n      };\n    })\n\n    // vaccine type tooltip list\n    d3.selectAll('.vaccine_type').remove();\n    d3.select('#vaccine_tooltip_bg').attr('height', 1);\n    data.vaccine_types.forEach(function(d,i){\n      d3.select(\"#vaccine_tooltip\").append('text')\n      .attr('font-size', 9)\n      .attr('fill', '#000')\n      .attr('class', 'vaccine_type')\n      .append('tspan').text(d)\n      .attr('dx', 6)\n      .attr('dy',((i*1.3)+1.8)+'em')\n    });\n\n    var vtooltipbbox = d3.select('#vaccine_tooltip').node().getBBox();\n    d3.select('#vaccine_tooltip_bg').attr('height', vtooltipbbox.height+6);\n\n    //***************************\n    // update hdi / inform numbers\n    //***************************\n\n    // define empty objects\n    var hdiData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiDataPopulation = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiDataVaccines = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiContactTracing = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiTotalCasesData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiTestingData = {'very-high':[], 'high': [], 'medium': [], 'low': []};\n    var informData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informDataPopulation = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informDataVaccines = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informContactTracing = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informTotalCasesData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informTestingData = {'very-high':[], 'high': [], 'medium': [], 'low': [], 'no-score': []};\n    var totalRecordedPopulation = 0;\n\n    if(totalCases>0){\n      data.country.forEach(function(dd,ii){\n          \n          hdiData[dd.hdi_category] += 1;\n          hdiDataPopulation[dd.hdi_category] += parseInt(dd.population);\n          hdiDataVaccines[dd.hdi_category] += parseInt(dd.total_vaccinations)||0;\n\n          informData[dd.inform_severity] += 1;\n          \n          informContactTracing[dd.inform_severity] += dd.contract_tracing;\n          hdiContactTracing[dd.hdi_category] += dd.contract_tracing;\n\n          if((dd.hdi_category=='very-high')||(dd.hdi_category=='high')||(dd.hdi_category=='medium')||(dd.hdi_category=='low'))\n          hdiTestingData[dd.hdi_category].push(dd.avg_tests_per_1000);\n          if((dd.inform_severity=='very-high')||(dd.inform_severity=='high')||(dd.inform_severity=='medium')||(dd.inform_severity=='low')||(dd.inform_severity=='no-score'))\n          informTestingData[dd.inform_severity].push(dd.avg_tests_per_1000);\n\n          informDataPopulation[dd.inform_severity] += parseInt(dd.population);\n          informDataVaccines[dd.inform_severity] += parseInt(dd.total_vaccinations)||0;\n          // hdi index\n          hdiTotalCasesData[dd.hdi_category] += dd.cumulative_cases || 0;\n          informTotalCasesData[dd.inform_severity] += dd.cumulative_cases || 0;\n      })\n    }\n\n    var totalHdiPop = hdiDataPopulation['very-high']+hdiDataPopulation['high']+hdiDataPopulation['medium']+hdiDataPopulation['low'];\n    var totalInformPop = informDataPopulation['very-high']+informDataPopulation['high']+informDataPopulation['medium']+informDataPopulation['low']+informDataPopulation['no-score'];\n\n    // update additional indicators\n    // row 0 percent of vaccinations by hdi\n    d3.select('#hdi-percent-val-very-high tspan').text(parse((hdiTotalCasesData['very-high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-very-high').transition().duration(500).attr('width', (parse(hdiTotalCasesData['very-high']/totalCases)*70));\n    d3.select('#hdi-percent-val-high tspan').text(parse((hdiTotalCasesData['high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-high').transition().duration(500).attr('width', (parse(hdiTotalCasesData['high']/totalCases)*70));\n    d3.select('#hdi-percent-val-medium tspan').text(parse((hdiTotalCasesData['medium']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-medium').transition().duration(500).attr('width', (parse(hdiTotalCasesData['medium']/totalCases)*70));\n    d3.select('#hdi-percent-val-low tspan').text(parse((hdiTotalCasesData['low']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-low').transition().duration(500).attr('width', (parse(hdiTotalCasesData['low']/totalCases)*70));\n\n    d3.select('#inform-percent-val-very-high tspan').text(parse((informTotalCasesData['very-high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-very-high').transition().duration(500).attr('width', (parse(informTotalCasesData['very-high']/totalCases)*64));\n    d3.select('#inform-percent-val-high tspan').text(parse((informTotalCasesData['high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-high').transition().duration(500).attr('width', (parse(informTotalCasesData['high']/totalCases)*64));\n    d3.select('#inform-percent-val-medium tspan').text(parse((informTotalCasesData['medium']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-medium').transition().duration(500).attr('width', (parse(informTotalCasesData['medium']/totalCases)*64));\n    d3.select('#inform-percent-val-low tspan').text(parse((informTotalCasesData['low']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-low').transition().duration(500).attr('width', (parse(informTotalCasesData['low']/totalCases)*64));\n    d3.select('#inform-percent-val-no-score tspan').text(parse((informTotalCasesData['no-score']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-no-score').transition().duration(500).attr('width', (parse(informTotalCasesData['no-score']/totalCases)*64));\n\n    d3.select('#hdi-toggle-very-high-val tspan').text(hdiData['very-high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-high-val tspan').text(hdiData['high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-medium-val tspan').text(hdiData['medium']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-low-val tspan').text(hdiData['low']).style('text-anchor', 'end').attr('dx', '10');\n\n    d3.select('#inform-toggle-very-high-val tspan').text(informData['very-high']).style('text-anchor', 'end').attr('dx', '6');\n    d3.select('#inform-toggle-high-val tspan').text(informData['high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#inform-toggle-medium-val tspan').text(informData['medium']).style('text-anchor', 'end').attr('dx', '9');\n    d3.select('#inform-toggle-low-val tspan').text(informData['low']).style('text-anchor', 'end').attr('dx', '7');\n    d3.select('#inform-toggle-no-score-val tspan').text(informData['no-score']).style('text-anchor', 'end').attr('dx', '13');\n\n    // row 1 percnet of vaccinations by hdi\n    d3.select('#hdi1val-very-high tspan').text(parse((hdiDataPopulation['very-high']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-very-high').transition().duration(500).attr('width', (parse(hdiDataPopulation['very-high']/totalHdiPop)*70));\n    d3.select('#hdi1val-high tspan').text(parse((hdiDataPopulation['high']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-high').transition().duration(500).attr('width', (parse(hdiDataPopulation['high']/totalHdiPop)*70));\n    d3.select('#hdi1val-medium tspan').text(parse((hdiDataPopulation['medium']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-medium').transition().duration(500).attr('width', (parse(hdiDataPopulation['medium']/totalHdiPop)*70));\n    d3.select('#hdi1val-low tspan').text(parse((hdiDataPopulation['low']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-low').transition().duration(500).attr('width', (parse(hdiDataPopulation['low']/totalHdiPop)*70));\n\n    d3.select('#inform1val-very-high tspan').text(parse((informDataPopulation['very-high']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-very-high').transition().duration(500).attr('width', (parse(informDataPopulation['very-high']/totalInformPop)*64));\n    d3.select('#inform1val-high tspan').text(parse((informDataPopulation['high']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-high').transition().duration(500).attr('width', (parse(informDataPopulation['high']/totalInformPop)*64));\n    d3.select('#inform1val-medium tspan').text(parse((informDataPopulation['medium']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-medium').transition().duration(500).attr('width', (parse(informDataPopulation['medium']/totalInformPop)*64));\n    d3.select('#inform1val-low tspan').text(parse((informDataPopulation['low']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-low').transition().duration(500).attr('width', (parse(informDataPopulation['low']/totalInformPop)*64));\n    d3.select('#inform1val-no-score tspan').text(parse((informDataPopulation['no-score']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-no-score').transition().duration(500).attr('width', (parse(informDataPopulation['no-score']/totalInformPop)*64));\n\n    // row 2 percent of total vaccinations\n    d3.select('#hdi2val-very-high tspan').text(parse((hdiDataVaccines['very-high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-very-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['very-high']/totalVaccinations)*70));\n    d3.select('#hdi2val-high tspan').text(parse((hdiDataVaccines['high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['high']/totalVaccinations)*70));\n    d3.select('#hdi2val-medium tspan').text(parse((hdiDataVaccines['medium']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-medium').transition().duration(500).attr('width', (parse(hdiDataVaccines['medium']/totalVaccinations)*70));\n    d3.select('#hdi2val-low tspan').text(parse((hdiDataVaccines['low']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-low').transition().duration(500).attr('width', (parse(hdiDataVaccines['low']/totalVaccinations)*70));\n\n    d3.select('#inform2val-very-high tspan').text(parse((informDataVaccines['very-high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-very-high').transition().duration(500).attr('width', (parse(informDataVaccines['very-high']/totalVaccinations)*64));\n    d3.select('#inform2val-high tspan').text(parse((informDataVaccines['high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-high').transition().duration(500).attr('width', (parse(informDataVaccines['high']/totalVaccinations)*64));\n    d3.select('#inform2val-medium tspan').text(parse((informDataVaccines['medium']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-medium').transition().duration(500).attr('width', (parse(informDataVaccines['medium']/totalVaccinations)*64));\n    d3.select('#inform2val-low tspan').text(parse((informDataVaccines['low']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-low').transition().duration(500).attr('width', (parse(informDataVaccines['low']/totalVaccinations)*64));\n    d3.select('#inform2val-no-score tspan').text(parse((informDataVaccines['no-score']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-no-score').transition().duration(500).attr('width', (parse(informDataVaccines['no-score']/totalVaccinations)*64));\n\n    // row 3 total doses by hdi/inform\n    var maxhdivac = d3.max([ hdiDataVaccines['low'],hdiDataVaccines['medium'],hdiDataVaccines['high'],hdiDataVaccines['very-high'] ]);\n    var maxinformvac = d3.max([ informDataVaccines['low'],informDataVaccines['medium'],informDataVaccines['high'],informDataVaccines['very-high'],informDataVaccines['no-score'] ]);\n\n    d3.select('#hdi3val-very-high tspan').text(nFormatter(hdiDataVaccines['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-very-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['very-high']/maxhdivac)*70));\n    d3.select('#hdi3val-high tspan').text(nFormatter(hdiDataVaccines['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['high']/maxhdivac)*70));\n    d3.select('#hdi3val-medium tspan').text(nFormatter(hdiDataVaccines['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-medium').transition().duration(500).attr('width', (parse(hdiDataVaccines['medium']/maxhdivac)*70));\n    d3.select('#hdi3val-low tspan').text(nFormatter(hdiDataVaccines['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-low').transition().duration(500).attr('width', (parse(hdiDataVaccines['low']/maxhdivac)*70));\n\n    d3.select('#inform3val-very-high tspan').text(nFormatter(informDataVaccines['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-very-high').transition().duration(500).attr('width', (parse(informDataVaccines['very-high']/maxinformvac)*64));\n    d3.select('#inform3val-high tspan').text(nFormatter(informDataVaccines['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-high').transition().duration(500).attr('width', (parse(informDataVaccines['high']/maxinformvac)*64));\n    d3.select('#inform3val-medium tspan').text(nFormatter(informDataVaccines['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-medium').transition().duration(500).attr('width', (parse(informDataVaccines['medium']/maxinformvac)*64));\n    d3.select('#inform3val-low tspan').text(nFormatter(informDataVaccines['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-low').transition().duration(500).attr('width', (parse(informDataVaccines['low']/maxinformvac)*64));\n    d3.select('#inform3val-no-score tspan').text(nFormatter(informDataVaccines['no-score'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-no-score').transition().duration(500).attr('width', (parse(informDataVaccines['no-score']/maxinformvac)*64));\n\n    // row 4 total vaccinations\n    d3.select('#hdi4val-very-high tspan').text(parse((hdiContactTracing['very-high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-very-high').transition().duration(500).attr('width', (parse(hdiContactTracing['very-high']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-high tspan').text(parse((hdiContactTracing['high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-high').transition().duration(500).attr('width', (parse(hdiContactTracing['high']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-medium tspan').text(parse((hdiContactTracing['medium']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-medium').transition().duration(500).attr('width', (parse(hdiContactTracing['medium']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-low tspan').text(parse((hdiContactTracing['low']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-low').transition().duration(500).attr('width', (parse(hdiContactTracing['low']/numCountriesFiltered)*70));\n\n    d3.select('#inform4val-very-high tspan').text(parse((informContactTracing['very-high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-very-high').transition().duration(500).attr('width', (parse(informContactTracing['very-high']/numCountriesFiltered)*64));\n    d3.select('#inform4val-high tspan').text(parse((informContactTracing['high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-high').transition().duration(500).attr('width', (parse(informContactTracing['high']/numCountriesFiltered)*64));\n    d3.select('#inform4val-medium tspan').text(parse((informContactTracing['medium']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-medium').transition().duration(500).attr('width', (parse(informContactTracing['medium']/numCountriesFiltered)*64));\n    d3.select('#inform4val-low tspan').text(parse((informContactTracing['low']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-low').transition().duration(500).attr('width', (parse(informContactTracing['low']/numCountriesFiltered)*64));\n    d3.select('#inform4val-no-score tspan').text(parse((informContactTracing['no-score']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-no-score').transition().duration(500).attr('width', (parse(informContactTracing['no-score']/numCountriesFiltered)*64));\n\n    // row 5 average testing\n    hdiTestingData['low'] = Math.round(d3.mean(hdiTestingData['low']))||0;\n    hdiTestingData['medium'] = Math.round(d3.mean(hdiTestingData['medium']))||0;\n    hdiTestingData['high'] = Math.round(d3.mean(hdiTestingData['high']))||0;\n    hdiTestingData['very-high'] = Math.round(d3.mean(hdiTestingData['very-high']))||0;\n    informTestingData['no-score'] = Math.round(d3.mean(informTestingData['no-score']))||0;\n    informTestingData['low'] = Math.round(d3.mean(informTestingData['low']))||0;\n    informTestingData['medium'] = Math.round(d3.mean(informTestingData['medium']))||0;\n    informTestingData['high'] = Math.round(d3.mean(informTestingData['high']))||0;\n    informTestingData['very-high'] = Math.round(d3.mean(informTestingData['very-high']))||0;\n\n    var maxhditest = d3.max([ hdiTestingData['low'],hdiTestingData['medium'],hdiTestingData['high'],hdiTestingData['very-high'] ]);\n    var maxinformtest = d3.max([ informTestingData['low'],informTestingData['medium'],informTestingData['high'],informTestingData['very-high'],informTestingData['no-score'] ]);\n\n    d3.select('#hdi5val-very-high tspan').text(addCommas(hdiTestingData['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-very-high').transition().duration(500).attr('width', (parse(hdiTestingData['very-high']/maxhditest)*70));\n    d3.select('#hdi5val-high tspan').text(addCommas(hdiTestingData['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-high').transition().duration(500).attr('width', (parse(hdiTestingData['high']/maxhditest)*70));\n    d3.select('#hdi5val-medium tspan').text(addCommas(hdiTestingData['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-medium').transition().duration(500).attr('width', (parse(hdiTestingData['medium']/maxhditest)*70));\n    d3.select('#hdi5val-low tspan').text(addCommas(hdiTestingData['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-low').transition().duration(500).attr('width', (parse(hdiTestingData['low']/maxhditest)*70));\n\n    d3.select('#inform5val-very-high tspan').text(addCommas(informTestingData['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-very-high').transition().duration(500).attr('width', (parse(informTestingData['very-high']/maxinformtest)*64));\n    d3.select('#inform5val-high tspan').text(addCommas(informTestingData['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-high').transition().duration(500).attr('width', (parse(informTestingData['high']/maxinformtest)*64));\n    d3.select('#inform5val-medium tspan').text(addCommas(informTestingData['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-medium').transition().duration(500).attr('width', (parse(informTestingData['medium']/maxinformtest)*64));\n    d3.select('#inform5val-low tspan').text(addCommas(informTestingData['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-low').transition().duration(500).attr('width', (parse(informTestingData['low']/maxinformtest)*64));\n    d3.select('#inform5val-no-score tspan').text(addCommas(informTestingData['no-score'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-no-score').transition().duration(500).attr('width', (parse(informTestingData['no-score']/maxinformtest)*64));\n\n    // num countries filtered (table)\n    d3.select('#countries_filtered tspan').text(numCountriesFiltered+' countries filtered').style('text-anchor', 'end').attr('dx', '105');\n\n  }\n\n  d3.select('#prev').style('cursor', 'pointer')\n  .attr('opacity', 0.5)\n  .on('click',function(){\n    if(options.page==1) return false;\n    options.page = options.page-1;\n    updateTable(data, options);\n  })\n\n\n  d3.select('#next').style('cursor', 'pointer').on('click',function(){\n    if(options.page==options.numPages) return false;\n    options.page = options.page+1;\n    updateTable(data, options);\n  })\n\n  async function updateTable(data, options){\n\n    // var lastRecord = data.vaccines_data_cumulative.filter(d=>d.date.getTime()==data.max_date.getTime());\n    // var vGroup = d3.flatGroup(lastRecord, d => d.iso_code);\n\n    // data.country.forEach(function(d,i){\n    //   var vaccine_acceptance_percent = (d.vaccine_acceptance_percent) || 0\n    //   if(!vGroup.some(item => item[0] === d.country_iso3)){\n    //     vGroup.push([d.country_iso3, [{\n    //       country_name: d.country_name,\n    //       country_code: d.country_iso2,\n    //       vaccine_acceptance_percent: vaccine_acceptance_percent\n    //     }]])\n    //   }\n    //   vGroup.forEach(function(dd,ii){\n    //     if(dd[0]==d.country_iso3){\n    //       dd[1][0].vaccine_acceptance_percent = vaccine_acceptance_percent;\n    //       dd[1][0].country_name = d.country_name;\n    //       dd[1][0].country_code = d.country_iso2;\n    //     }\n    //   })\n    // })\n\n    var sortKey;\n    if(options.table_sort=='col0_sort') sortKey = 'country_name';\n    if(options.table_sort=='col1_sort') sortKey = 'total_vaccinations_per_hundred';\n    if(options.table_sort=='col2_sort') sortKey = 'people_vaccinated_per_hundred';\n    if(options.table_sort=='col3_sort') sortKey = 'people_fully_vaccinated_per_hundred';\n    if(options.table_sort=='col4_sort') sortKey = 'vaccine_acceptance_percent';\n    if(options.table_sort=='col5_sort') sortKey = 'total_vaccinations';\n\n    for(var x = 0; x<6; x++){\n      d3.select('#col'+x+'_sort_desc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort_asc').attr('opacity', 0);\n    }\n\n    d3.select('#'+options.table_sort+'_'+options.table_sort_direction)\n    .attr('opacity', 1);\n\n    if(sortKey=='country_name'){\n      if(options.table_sort_direction=='asc') {\n        data.country.sort(function(b, a){\n          return a.country_name.localeCompare(b.country_name);\n        })\n      } else {\n        data.country.sort(function(a, b){\n          return a.country_name.localeCompare(b.country_name);\n        })    \n      }\n\n    } else {\n      if(options.table_sort_direction=='desc') {\n        data.country.sort(function(a,b){\n            return b[sortKey] - a[sortKey];\n        });\n      } else {\n        data.country.sort(function(b,a){\n          return b[sortKey] - a[sortKey];\n        });\n      }\n    }\n\n  //   data.vGroup = vGroup;\n\n  //   data.vGroup.forEach(function(d,i){\n  //     data.equity_data.forEach(function(dd,ii){\n  //         if(d[0] == dd.country_iso3){\n  //             dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n  //             dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n  //             dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n  //             dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n  //         }\n  //     })\n  // })\n\n\n    d3.selectAll('.tablerow').remove();\n    d3.selectAll('.col1bar').attr('opacity', 0);\n    d3.selectAll('.col2bar').attr('opacity', 0);\n    d3.selectAll('.col3bar').attr('opacity', 0);\n    d3.selectAll('.col4bar').attr('opacity', 0);\n    d3.selectAll('.colbg').attr('opacity', 0);\n    d3.selectAll('.table_country_name tspan').text('');\n\n    options.numPages = Math.ceil(data.country.length/10);\n\n    d3.select('#next').attr('opacity', function(){\n      if(options.page==options.numPages) return 0.5;\n      return 1;\n    })\n\n    d3.select('#prev')\n    .attr('opacity', function(){\n      if(options.page==1) return 0.5;\n      return 1;\n    })\n\n    d3.select('#pagination_text').attr('text-anchor', 'end');\n    d3.select('#pagination_text tspan').attr('x', 40);\n    d3.select('#pagination_text tspan').text('Page '+options.page + ' of '+options.numPages)\n\n    var i = 0;\n    var delay = 10;\n    const timer = ms => new Promise(res => setTimeout(res, ms));\n\n    for(let k = ((options.page-1)*10); k < ((options.page)*10); k++){\n\n      var d = data.country[k];\n      if(!data.country[k]) {\n        d3.select('#col1bar'+i)\n        .attr('width', 0);\n        d3.select('#col2bar'+i)\n        .attr('width', 0)\n        d3.select('#col3bar'+i)\n        .attr('width', 0)\n        d3.select('#col4bar'+i)\n        .attr('width', 0)\n        continue;\n      }\n\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow table_country_name')\n      .text(function(){\n        var name;\n        if(d.country_name) { name = d.country_name; } else {\n          name = d.country_code;\n        }\n        name = name.substring(0,17);\n        if(name.length==17)name=name+'.';\n        return name;\n      })\n      .attr('x', 0)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 1 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow table_country_name')\n      .text(function(){\n        var val = parseFloat(d.total_vaccinations_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 112)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 1 bar\n      d3.select('#col1bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.total_vaccinations_per_hundred;\n        if(d.total_vaccinations_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n\n      d3.select('#col1bg'+i)\n      .attr('opacity', 1);\n\n      // col 2 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.people_vaccinated_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 223)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 2 bar\n      d3.select('#col2bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.people_vaccinated_per_hundred;\n        if(d.people_vaccinated_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n\n      d3.select('#col2bg'+i)\n      .attr('opacity', 1);\n\n      // col 3 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.people_fully_vaccinated_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 335)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 3 bar\n      d3.select('#col3bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.people_fully_vaccinated_per_hundred;\n        if(d.people_fully_vaccinated_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n      \n      d3.select('#col3bg'+i)\n      .attr('opacity', 1);\n\n      // col 4 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.vaccine_acceptance_percent).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 450)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 4 bar\n      d3.select('#col4bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.vaccine_acceptance_percent;\n        if(d.vaccine_acceptance_percent>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n      \n      d3.select('#col4bg'+i)\n      .attr('opacity', 1);\n\n\n      var dayFormat = d3.timeFormat(\"%b %d\");\n      // col 5 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = (d.total_vaccinations);\n        if((isNaN(val))||(val==0)){ return ''} else { return nFormatter(val) }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 572)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n      \n      // col 6 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = (d.data_updated);\n        if((val)){ return dayFormat(val)} else { return '' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 620)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n      \n      i++;\n      \n      await timer(15);\n    }\n\n  }\n\n  function createSelects(){\n     // region select\n      $('#regionSelect').select2({\n        data: [{\n          id: 'regions',\n          text: 'IFRC Regions',\n          children: regionOptions\n        },{\n          id: 'countries',\n          text: 'Countries',\n          children: countryOptions\n        }],\n        placeholder: '',\n        scrollAfterSelect: true,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:unselecting', function() {\n          $(this).data('unselecting', true);\n      }).on('select2:opening', function(e) {\n          if ($(this).data('unselecting')) {\n              $(this).removeData('unselecting');\n              e.preventDefault();\n          }\n      });\n\n      $('#regionSelect').on('select2:select', function (e) {\n          var data = e.params.data;\n          filter([data.id]);\n      });\n\n      $('#regionSelect').on('select2:unselect', function (e) {\n        var data = e.params.data;\n        filter([data.id]);\n    });\n\n      // reset locations\n      d3.select('#reset_locations').style('cursor', 'pointer')\n      .on('click', function(){\n        filter('clear');\n      }); \n\n      // bubble map select color by\n      $('#colorSelect').select2({\n        scrollAfterSelect: true,\n        minimumResultsForSearch: -1,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:select', function(e) {\n        var d = e.params.data;\n        options.bubble_chart_color_by = d.id;\n        updateBubblechart(data, options, filter);\n      });\n\n      // bubble map select y-axis\n      $('#ySelect').select2({\n        scrollAfterSelect: true,\n        minimumResultsForSearch: -1,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:select', function(e) {\n        var d = e.params.data;\n        options.bubble_chart_y_axis = d.id;\n        updateBubblechart(data, options, filter);\n      });\n\n  }\n\n  function handleSelectLength(){\n    var values = $('#regionSelect').select2('data');\n    // handle height for many selections\n    var select2HeightRatio = $('#regionSelectContainer').width()/$('#regionSelectContainer').height();\n    if(select2HeightRatio<10){\n      $('.select2-selection__choice').hide();\n      $('.select2-search__field').attr('placeholder', values.length+' LOCATIONS SELECTED' ).css('width', '100%')\n    } else {\n      $('.select2-search__field').attr('placeholder', '' );\n      $('.select2-selection__choice').show();\n    }\n  }\n\n  useEffect(() => {\n    init();\n  }, [])\n\n\n  const selectStyle = {\n    control: (base, state) => ({\n      ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n          border: '1px solid #D8D8D8',\n      }\n  })\n  };\n\n  return (\n    <div>\n      <div id=\"loaderDiv\">\n        <div id=\"loaderText\">{loaderText}</div>\n        <div id=\"loaderBar\">\n          <div id=\"loaderProgress\" style={{width: progress*100+'%'}}></div>\n        </div>\n      </div>\n\n      <div id=\"regionSelectContainer\">\n        <select id=\"regionSelect\" className=\"js-example-responsive\" name=\"region[]\" multiple=\"multiple\"></select>\n        <div id=\"regionDrop\"></div>\n      </div>\n\n      <div id=\"bubbleSelectContainer\">\n        <div id=\"colorSelectContainer\">Color by&nbsp;&nbsp;\n        <select id=\"colorSelect\" className=\"js-example-responsive\" name=\"colorby[]\" defaultValue=\"hdi\">\n          <option value=\"region\">IFRC region</option>\n          <option value=\"hdi\">Human Development Index (HDI)</option>\n          <option value=\"inform-severity\">INFORM Severity Index</option>\n        </select>\n        <div id=\"colorDrop\"></div>\n        </div>\n        <div id=\"ySelectContainer\">\n          y-Axis&nbsp;&nbsp;\n        <select id=\"ySelect\" className=\"js-example-responsive\" name=\"yaxis[]\">\n          <option value=\"percent-vaccinated-at-least-1-dose\">% vaccinated at least 1 dose</option>\n          <option value=\"percent-fully-vaccinated\">% fully vaccinated</option>\n          <option value=\"percent-vaccine-acceptance\">% vaccine acceptance</option>\n        </select>\n        <div id=\"yDrop\"></div>\n        </div>\n      </div>\n\n\n    <div id=\"svg_container\" className=\"App\">\n\n    </div>\n    <div id=\"map_div_outer\">\n      <div id=\"map_div\">\n      </div>\n    </div>\n    \n    <div id=\"footer\">Data Sources - <a href=\"https://covid19.who.int/info/\" target=\"_blank\">WHO Daily cases and deaths by date, vaccination data</a>, <a href=\"https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations\" target=\"_blank\">OWID vaccinations csv</a></div>\n\n    </div>\n  );\n}\n\nfunction parse(p){\n  if(isNaN(p)){\n    return 0\n  } else {\n    return p;\n  }\n}\n\nexport default App;\n\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}