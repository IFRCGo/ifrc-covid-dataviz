{"version":3,"sources":["colors.js","HelperFunctions.js","Timechart.js","Regionchart.js","Layout.js","Bubblechart.js","Options.js","ParseData.js","Map.js","App.js","reportWebVitals.js","index.js"],"names":["colors","hdi_category","inform_severity","blue","lightblue","lightnavy","red","lightred","green","ifrcgreen","black","lightgrey","darkgrey","white","olive","purple","orange","pink","c","regions","addCommas","nStr","x","split","x1","x2","length","rgx","test","replace","nFormatter","num","digits","lookup","value","symbol","rx","item","slice","reverse","find","toFixed","yScaleCases","yScaleDeaths","yScaleVaccines","yAxisCases","yAxisDeaths","yAxisVaccines","yScaleCasesAxis","yScaleDeathsAxis","yScaleVaccinesAxis","xScale","xAxis","xScaleAxis","xScaleEvents","maxDate","minDate","md","vgroupedData","hoverBar","timelineTooltip","eventTooltip","tData","drawTimechart","data","options","Date","min_date","max_date","groupedData","who_data","forEach","d","i","timeline_frequency","date","week_start","month_start","ifrc_region","new_cases","new_deaths","cumulative_cases","cumulative_deaths","dd","ii","hasOwnProperty","total_new_cases","AF","AP","AM","EU","ME","OTH","total_cumulative_cases","total_new_deaths","total_cumulative_deaths","region","push","timeline_type","vaccines_data","new_vaccines","daily_vaccinations","cumulative_vaccines","total_new_vaccines","newVaccines","vData","clone","endOfWeekDate","moment","endOf","startOf","unix","maxDateUnix","endOfMonthDate","total_vaccinations","total_cumulative_vaccines","filter","el","numIntervals","d3","maxCases","maxDeaths","maxVaccines","toDate","add","svg","selectAll","remove","append","attr","barWidth","barSpacing","range","domain","scale","tickSize","tickPadding","ticks","tickFormat","yAxisGroup","xAxisCases","call","xAxisDeaths","xAxisVaccines","xAxisTimeline","barGroups","enter","totalNewCases","this","parentNode","datum","dp","y","totalNewDeaths","next","offset","vbarGroups","totalNewVaccines","timeline_data","document","getElementById","appendChild","node","on","event","coords","xDate","invert","getTime","style","tooltipStr","format","text","groupedDataFiltered","vgroupedDataFiltered","deaths","cases","vaccines","ratio","brushR","brushL","events","subtract","select","wrap","textwrap","bounds","height","width","method","description","bbox","getBBox","ys","parseInt","circles","brush","extent","parseFloat","viewBoxW","Math","round","brushScale","viewBoxX","gBrush","move","updateTimechart","transition","duration","maxVaccinations","xScaleCases","xScaleDeaths","xScaleVaccines","labelWidth","rcSize","margin","drawRegionchart","population","country","code","who_daily_latest","vaccine_daily_latest","cumulative_cases_per_100k","cumulative_deaths_per_100k","cumulative_vaccines_per_100k","isFinite","region_switch","regionChartContainer","rowHeight","rows","label","t","val","region_chart_toggle","isNaN","updateRegionchart","id","tween","floor","random","printing","selectedToggle","unselectedToggle","unselectedToggleText","selectedToggleText","Layout","updateTable","updateMap","bd","region_filter","map_toggle","tippy","content","placement","theme","arrow","delay","toggle","hdi_filter","inform_filter","tab_toggle","timechartContainer","tcSize","timechartSvg","layer1","tableRowHeight","tableBarYOffset","thisId","table_sort","table_sort_direction","page","setTimeout","html2canvas","querySelector","allowTaint","onclone","doc","useCORS","foreignObjectRendering","ignoreElements","element","scrollX","scrollY","logging","then","canvas","img","toDataURL","pdf","jsPDF","imgProps","getImageProperties","pdfWidth","internal","pageSize","getWidth","pdfHeight","addImage","save","link","createElement","download","href","click","collection","idx","indexOf","splice","yScale","zScale","maxX","maxY","maxZ","drawBubblechart","gni_2017","bubble_chart_y_axis","nice","join","people_vaccinated_per_hundred","people_fully_vaccinated_per_hundred","vaccine_acceptance_percent","bubble_chart_color_by","update","exit","country_name","toElement","updateBubblechart","country_filter","numPages","ParseData","sort","a","b","ns_involvement","equity_data","pop","vaccines_used","avg_tests_per_1000","number_vaccine_types_used","vaccines_per_100","vaccines_who_data","country_iso3","ISO3","NUMBER_VACCINES_TYPES_USED","TOTAL_VACCINATIONS_PER100","VACCINES_USED","map","trim","self_assessment","vaccine_acceptance","iso3","indicator_value","vaccine_acceptance_population","population_size","contract_tracing","toLowerCase","match","max","Date_reported","maxDateVaccines","min_vaccine_date","min","max_vaccine_date","country_code","Country_code","country_iso2","Cumulative_deaths","Cumulative_cases","New_cases","New_deaths","whoDataGrouped","flatGroup","datesToAdd","lastRecord","dayTotal","dayCheck","weekTotal","weekCheck","monthTotal","monthCheck","whoCountryCodes","dayOfYear","week","isoWeek","month","getMonth","year","getFullYear","undefined","includes","Country","WHO_region","iso_code","vaccineDataByCountry","newDays","hasDays","vDataFlat","lastDate","data_updated","day","setDate","getDate","newDay","totalVac","totalVac100","countryName","total_vaccinations_per_hundred","dailyVac","whoDataByCountry","countryCode","who_daily_7_days","who_daily_14_days","who_daily_21_days","who_daily_28_days","cumulative_deaths_7_days","cumulative_deaths_14_days","cumulative_deaths_21_days","cumulative_deaths_28_days","cumulative_cases_7_days","cumulative_cases_14_days","cumulative_cases_21_days","cumulative_cases_28_days","percentChange","percent_change","original","mapboxgl","accessToken","mapTooltip","createMap","setCenter","setZoom","Map","container","center","preserveDrawingBuffer","zoom","setRenderWorldCopies","addControl","NavigationControl","scrollZoom","disable","getCanvasContainer","e","setPaintProperty","setLayoutProperty","maxIncrease","maxDecrease","ceil","abs","colorScale","clamp","fillColorArray","maxValue","peoplevaccinated","features","queryRenderedFeatures","point","layer","properties","iso","countryfiltered","str","window","innerWidth","equityDataUrl","layoutUrl","whoDataUrl","vaccinesDataUrl","vaccinesWhoDataUrl","timelineDataUrl","selfAssessmentDataUrl","vaccineAcceptanceDataUrl","regionOptions","countryOptions","parse","p","App","useState","progress","setProgress","loaderText","setLoaderText","documentElement","createSelects","createCharts","updateTotals","hdi_countries","inform_countries","substring","countryIds","mergeFilter","concat","$","trigger","values","select2","hide","css","show","handleSelectLength","numCountriesFiltered","totalCases","textTween","totalDeaths","totalVaccinations","vaccinesPer100","vaccine_population","vaccineAcceptance","numNsInvolvedCountres","vaccine_types","ddd","iii","vaccinePer100ByPopulation","vaccineAcceptancePercent","vtooltipbbox","hdiData","hdiDataPopulation","hdiDataVaccines","hdiContactTracing","hdiTotalCasesData","hdiTestingData","informData","informDataPopulation","informDataVaccines","informContactTracing","informTotalCasesData","informTestingData","totalHdiPop","totalInformPop","maxhdivac","maxinformvac","maxhditest","maxinformtest","sortKey","localeCompare","timer","ms","Promise","res","k","name","dayFormat","children","placeholder","scrollAfterSelect","renderTemplate","dropdownParent","shouldFocusInput","templateResult","removeData","preventDefault","params","minimumResultsForSearch","useEffect","init","className","multiple","defaultValue","target","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.ff765e22.chunk.js","sourcesContent":["// default options\nconst colors = {\n    hdi_category: {\n        'very-high': '#D8EF8B', \n        'high': '#FDE08B', \n        'medium': '#FB8D59', \n        'low': '#D63127'\n    },\n    inform_severity: {\n        'very-high': '#D63127', \n        'high': '#FB8D59', \n        'medium': '#FDE08B', \n        'low': '#D8EF8B', \n        'no-score': '#DAE0EA', \n    },\n    blue: '#1F558C',\n    lightblue: '#E8EEF3',\n    lightnavy: '#799EAD',\n    // red: '#E02225',\n    red: '#EE3224',\n    lightred: '#FDEAE9',\n    green: '#D8EF8B',\n    ifrcgreen: '#87C400',\n    black: '#595454',\n    lightgrey: '#e8e8e8',\n    darkgrey: '#c1c1c1',\n    white: '#fff',\n    olive: '#87C400',\n    purple: '#771966',\n    orange: '#FF3500',\n    pink: '#FB0080'\n}\n\n// option 1\nvar c = ['#00ADED','#003A5A','#62D7F7','#799EAD','#BCCED6']\n// option 2\nvar c = ['#00ADED','#62D7F7','#003A5A','#799EAD','#FFDD00'];\n// option 3\nvar reds = ['#771912','#be281d','#ee3224','#f79992','#fcd6d3'];\nvar blues = ['#09192a','#163b62','#1f558c','#7999ba','#d2dde8'];\n\n\ncolors.regions = {\n        'AP': colors.orange, \n        'AM': colors.lightblue, \n        'EU': colors.ifrcgreen, \n        'ME': '#0A3248', \n        'AF': '#FCD204', \n    }\n\n    colors.regions = {\n        'AP': c[1], \n        'AM': c[0], \n        'EU': c[2], \n        'ME': c[3], \n        'AF': c[4], \n    }\n\n    // colors.regions = {\n    //     'AP': reds[3], \n    //     'AM': reds[0], \n    //     'EU': reds[1], \n    //     'ME': reds[2], \n    //     'AF': reds[4], \n    // }\n\n    // colors.regions_blue = {\n    //     'AP': blues[3], \n    //     'AM': blues[0], \n    //     'EU': blues[1], \n    //     'ME': blues[2], \n    //     'AF': blues[4], \n    // }\n\n\n\nexport default colors;\n","export function addCommas(nStr){\n    nStr += '';\n    let x = nStr.split('.');\n    let x1 = x[0];\n    let x2 = x.length > 1 ? '.' + x[1] : '';\n    var rgx = /(\\d+)(\\d{3})/;\n    while (rgx.test(x1)) {\n        x1 = x1.replace(rgx, '$1' + ',' + '$2');\n    }\n    return x1 + x2;\n}\n\nexport function nFormatter(num, digits = 1) {\n    const lookup = [\n      { value: 1, symbol: \"\" },\n      { value: 1e3, symbol: \"k\" },\n      { value: 1e6, symbol: \"M\" },\n      { value: 1e9, symbol: \"B\" },\n      { value: 1e12, symbol: \"T\" },\n      { value: 1e15, symbol: \"P\" },\n      { value: 1e18, symbol: \"E\" }\n    ];\n    const rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/;\n    var item = lookup.slice().reverse().find(function(item) {\n      return num >= item.value;\n    });\n    return item ? (num / item.value).toFixed(digits).replace(rx, \"$1\") + item.symbol : \"0\";\n\n\n  }\n  \n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {nFormatter} from './HelperFunctions';\nimport { selection, textwrap } from 'd3-textwrap';\nimport clone from 'just-clone';\n\nlet yScaleCases;\nlet yScaleDeaths;\nlet yScaleVaccines;\nlet yAxisCases;\nlet yAxisDeaths;\nlet yAxisVaccines;\nlet yScaleCasesAxis;\nlet yScaleDeathsAxis;\nlet yScaleVaccinesAxis;\nlet xScale;\nlet xAxis; \nlet xScaleAxis;\nlet xScaleEvents;\nlet maxDate; \nlet minDate;\nlet md; \nlet vgroupedData;\nlet hoverBar; \nlet timelineTooltip;\nlet eventTooltip;\nlet tData; \n\nconst regions = ['AF', 'AP', 'ME', 'EU', 'AM', 'OTH'];\n\nexport function drawTimechart(data, options) {\n\n    minDate = new Date(data.min_date);\n    maxDate = new Date(data.max_date);\n\n    const groupedData = [];\n\n    data.who_data.forEach(function(d,i){\n        if(!groupedData[d[options.timeline_frequency+'Total']])groupedData[d[options.timeline_frequency+'Total']] = {};\n        if(options.timeline_frequency==='day') groupedData[d[options.timeline_frequency+'Total']].date = d.date;\n        if(options.timeline_frequency==='week') groupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n        if(options.timeline_frequency==='month') groupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n        if(!groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_cases += d.new_cases;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_deaths += d.new_deaths;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_cases = 0;\n    });\n\n    // totals by date\n    groupedData.forEach(function(d,i){\n        regions.forEach(function(dd,ii){\n            if(!d.hasOwnProperty(dd)){\n               d[dd] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n            }\n            // if(dd!=='OTH') d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n            if(i>0){\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases + groupedData[i-1][dd].cumulative_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths + groupedData[i-1][dd].cumulative_deaths;\n            } else {\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths;\n            }\n        })\n\n        d.total_new_cases = d.AF.new_cases + d.AP.new_cases + d.AM.new_cases + d.EU.new_cases + d.ME.new_cases + d.OTH.new_cases; \n        d.total_cumulative_cases = d.AF.cumulative_cases + d.AP.cumulative_cases + d.AM.cumulative_cases + d.EU.cumulative_cases + d.ME.cumulative_cases + d.OTH.cumulative_cases; \n        d.total_new_deaths = d.AF.new_deaths + d.AP.new_deaths + d.AM.new_deaths + d.EU.new_deaths + d.ME.new_deaths + d.OTH.new_deaths; \n        d.total_cumulative_deaths = d.AF.cumulative_deaths + d.AP.cumulative_deaths + d.AM.cumulative_deaths + d.EU.cumulative_deaths + d.ME.cumulative_deaths + d.OTH.cumulative_deaths; \n        d.region = [];\n\n        regions.forEach(function(dd,ii){\n            d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n        })\n\n    });\n\n    vgroupedData = [];\n\n    if(options.timeline_type!='cumulative'){ // cumulative and stacked\n        // data.vaccines_data = data.vaccines_data_daily;\n        // data.vaccines_data_daily = clone(data.vaccines_data);\n        data.vaccines_data.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_vaccines += d.daily_vaccinations;\n        });\n\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {new_vaccines: 0, cumulative_vaccines: 0}\n                }\n            });\n            d.total_new_vaccines = d.AF.new_vaccines + d.AP.new_vaccines + d.AM.new_vaccines + d.EU.new_vaccines + d.ME.new_vaccines + d.OTH.new_vaccines; \n            d.region = [];\n\n            regions.forEach(function(dd,ii){\n                var newVaccines = 0;\n                if(d[dd].new_vaccines>0){\n                    newVaccines += d[dd].new_vaccines\n                }\n                d.region.push({'region': dd, 'new_vaccines': newVaccines });\n            })\n        });\n\n    } else{ // cumulative only\n        var vData = [];\n        if(options.timeline_frequency==='day') {\n            vData = clone(data.vaccines_data);\n        }\n        if(options.timeline_frequency==='week') {\n            data.vaccines_data.forEach(function(d,i){\n                var endOfWeekDate = moment(d.date).endOf('isoWeek').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfWeekDate)||(date==moment(data.max_date).startOf('day').unix())){\n                    vData.push(d);\n                }\n            })\n        }\n        if(options.timeline_frequency==='month') {\n            var maxDateUnix = moment(data.max_date).startOf('day').unix();\n            data.vaccines_data.forEach(function(d,i){\n                var endOfMonthDate = moment(d.date).endOf('month').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfMonthDate)||((moment(data.max_date).startOf('day').unix()!=endOfMonthDate)&&(date==maxDateUnix))){\n                    vData.push(d);\n                }\n            })\n        }\n\n        vData.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {cumulative_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_vaccines += d.total_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {cumulative_vaccines: 0}\n                }\n            });\n            d.total_cumulative_vaccines = d.AF.cumulative_vaccines + d.AP.cumulative_vaccines + d.AM.cumulative_vaccines + d.EU.cumulative_vaccines + d.ME.cumulative_vaccines + d.OTH.cumulative_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'cumulative_vaccines': d[dd].cumulative_vaccines});\n            })\n        });\n    }\n\n    vgroupedData = vgroupedData.filter(function(el) { return el; });\n\n    const numIntervals = d3.max(data.who_data, function(d,i){\n        return d[options.timeline_frequency+'Total'];\n    });\n\n    const maxCases = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_cases;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_cases;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxDeaths = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_deaths;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_deaths;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxVaccines = d3.max(vgroupedData, function(d,i){\n        if(d){\n            if(options.timeline_type==='non-cumulative') return d.total_new_vaccines;\n            if(options.timeline_type==='cumulative') return d.total_cumulative_vaccines;\n            if(options.timeline_type==='stacked') return 100;\n        }\n    })\n\n    // define date range\n    // const minDate = groupedData[0].date;\n    // const maxDate = groupedData[numIntervals].date;\n    // const minDate = groupedData[0].date;\n\n    // if(options.timeline_frequency==='month') md = md.add(1, 'months');\n    // if(options.timeline_frequency==='week') md = md.add(1, 'weeks');\n    if(options.timeline_frequency==='month') minDate = moment(minDate).startOf('month').startOf('day').toDate();\n    if(options.timeline_frequency==='month') maxDate = moment(maxDate).endOf('month').startOf('day').toDate();\n    if(options.timeline_frequency==='week') maxDate = moment(maxDate).endOf('isoWeek').startOf('day').toDate();\n\n    md = moment(maxDate);\n    if(options.timeline_frequency==='day') md = new Date(moment(maxDate).add(1, 'days').toDate());\n\n    const svg = d3.select('#timechart_svg');\n    svg.selectAll('g').remove();\n    d3.selectAll('#layout .yAxis').remove();\n    d3.selectAll('#yAxis').remove();\n    d3.selectAll('#layout .xAxis').remove();\n\n    //bg\n    svg.append('g').append('rect')\n    .attr('width', 2000)\n    .attr('height', '100%')\n    .attr('x', 0)\n    .attr('y', 0)\n    .attr('fill', '#FFF')\n    .attr('opacity', 0);\n\n    const width = 2000;\n    const barWidth = width/numIntervals;\n\n    let barSpacing = 0.04; \n    if(options.timeline_frequency==='month') barSpacing = 0.03;\n    if(options.timeline_frequency==='day') barSpacing = 0.02;\n\n    // define scales\n\n    xScale = d3.scaleTime()\n    .range([0,width])\n    .domain([minDate,md]);\n\n    xScaleAxis = d3.scaleTime()\n    .range([0,596])\n    .domain([minDate,md]);\n\n    yScaleCases = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxCases]);\n\n    yScaleCasesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxCases]);\n\n    yScaleDeaths = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxDeaths]);\n\n    yScaleDeathsAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxDeaths]);\n\n    yScaleVaccines = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxVaccines]);\n\n    yScaleVaccinesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxVaccines]);\n\n    // define axi\n    \n    xAxis = d3.axisBottom()\n    .scale(xScaleAxis)\n    .tickSize(2)\n    .tickPadding(3);\n\n    // if(options.timeline_frequency=='month')\n    // xAxis.ticks(d3.timeMonth.every(3)).tickFormat(d3.timeFormat(\"%b %Y\"));\n\n    // if(options.timeline_frequency=='week')\n    // xAxis.ticks(d3.timeWeek.every(10)).tickFormat(d3.timeFormat(\"%d %b %Y\"));\n\n    yAxisCases = d3.axisRight()\n    .scale(yScaleCasesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisDeaths = d3.axisRight()\n    .scale(yScaleDeathsAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisVaccines = d3.axisRight()\n    .scale(yScaleVaccinesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    // y-axis cases\n    var yAxisGroup = d3.select('#layout').append(\"g\").attr('id', 'yAxis').attr('clip-path', 'url(#mask)');\n\n    var yAxisCasesText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"casesAxis\")\n    .attr('transform', 'translate(620,363)')\n    .call(yAxisCases);\n\n    // y-axis deaths\n    var yAxisDeathsText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"deathsAxis\")\n    .attr('transform', 'translate(620,534)')\n    .call(yAxisDeaths);\n\n    // y-axis vaccines\n    var yAxisVaccinesText = yAxisGroup.append(\"g\")\n    .attr(\"class\", \"yAxis axis\")\n    .attr(\"id\", \"VaccinesAxis\")\n    .attr('transform', 'translate(620,707.5)')\n    .call(yAxisVaccines);\n\n    // x-axis cases\n    var xAxisCases = yAxisGroup.append('g')\n    .attr(\"id\", \"casesXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,504)')\n    .call(xAxis);\n\n    var xAxisDeaths = yAxisGroup.append('g')\n    .attr(\"id\", \"deathsXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,674)')\n    .call(xAxis);\n\n    var xAxisVaccines = yAxisGroup.append('g')\n    .attr(\"id\", \"vaccinesXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,848)')\n    .call(xAxis);\n\n    var xAxisTimeline = yAxisGroup.append('g')\n    .attr(\"id\", \"timelineXAxis\")\n    .attr('class', 'xAxis')\n    .attr('transform', 'translate(24,908)')\n    .call(xAxis);\n\n    // CASES\n    // loop through groupedData and draw bars\n    const barGroups = svg.selectAll('.bar_group')\n    .data(groupedData)\n    .enter()\n    .append('g')\n    .attr('class', 'bar_group')\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+')'\n    })\n\n    // CASES\n    barGroups.selectAll('.cases_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', function(d,i) { return 'timeBar cases_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_cases;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleCases(d.cumulative_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleCases(d.new_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_cases/totalNewCases))-((140*(dp/totalNewCases))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleCases(d.cumulative_cases);\n        if(options.timeline_type==='non-cumulative') y = yScaleCases(d.new_cases);\n        if(options.timeline_type==='stacked') y = (140*(d.new_cases/totalNewCases));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n    })\n\n    // DEATHS\n    barGroups.selectAll('.deaths_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', function(d,i) { return 'timeBar deaths_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_deaths;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleDeaths(d.cumulative_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleDeaths(d.new_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_deaths/totalNewDeaths))-((140*(dp/totalNewDeaths)))+170)\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleDeaths(d.cumulative_deaths);\n        if(options.timeline_type==='non-cumulative') y = yScaleDeaths(d.new_deaths);\n        if(options.timeline_type==='stacked') y = (140*(d.new_deaths/totalNewDeaths));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n    });\n\n    // bar size tweak for spacing\n    if(options.timeline_frequency==='month'){\n        barGroups.selectAll(\".timeBar\")\n        .attr(\"width\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(1-barSpacing);\n            })\n        .attr(\"x\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(barSpacing/2);\n            })\n        }\n\n    // VACCINES\n\n    const vbarGroups = svg.selectAll('.vbar_group')\n    .data(vgroupedData)\n    .enter()\n    .append('g')\n    .attr('class', 'vbar_group')\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+', 344)'\n    })\n  \n    vbarGroups.selectAll('.vaccines_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .enter()\n    .append('rect')\n    .attr('class', 'timeBar vaccines_bar')\n    .attr('class', function(d,i) { return 'timeBar vaccines_bar time_'+d.region })\n    .attr('x', (barWidth*barSpacing))\n    .attr('y', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_vaccines;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleVaccines(d.cumulative_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleVaccines(d.new_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_vaccines/totalNewVaccines))-((140*(dp/totalNewVaccines))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('width', barWidth-(barWidth*barSpacing*2))\n    .attr('height', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleVaccines(d.cumulative_vaccines);\n        if(options.timeline_type==='non-cumulative') y = yScaleVaccines(d.new_vaccines);\n        if(options.timeline_type==='stacked') y = (140*(d.new_vaccines/totalNewVaccines));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n        // return colors.regions_blue[d.region];\n    });\n\n    if(options.timeline_frequency==='month'){\n    vbarGroups.selectAll(\".timeBar\")\n    .attr(\"width\", function(d) {\n        var date = d3.select(this.parentNode).datum().date;\n        var next = d3.timeMonth.offset(date, 1);\n        return (xScale(next)- xScale(date))*(1-barSpacing);\n        })\n    .attr(\"x\", function(d) {\n        var date = d3.select(this.parentNode).datum().date;\n        var next = d3.timeMonth.offset(date, 1);\n        return (xScale(next)- xScale(date))*(barSpacing/2);\n        })\n    }\n\n    // bar size tweak for spacing\n    if(options.timeline_frequency==='month'){\n        barGroups.selectAll(\".timeBar\")\n        .attr(\"width\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(1-barSpacing);\n          })\n        .attr(\"x\", function(d) {\n            var date = d3.select(this.parentNode).datum().date;\n            var next = d3.timeMonth.offset(date, 1);\n            return (xScale(next)- xScale(date))*(barSpacing/2);\n          })\n        }\n\n        // tooltips\n\n        // events calendar timeline\n        tData = data.timeline_data;\n\n        xScaleEvents = d3.scaleTime()\n        .range([25,619])\n        .domain([minDate,md]);\n        \n        // bring to front\n       document.getElementById(\"svg\").appendChild(d3.select('#timeline_tooltip').node());\n       document.getElementById(\"svg\").appendChild(d3.select('#event_tooltip').node());\n       timelineTooltip = d3.select('#timeline_tooltip').attr('opacity', 0);\n       eventTooltip = d3.select('#event_tooltip').attr('opacity', 0);\n\n        // hover bar\n        hoverBar = svg.append('rect')\n        .attr('id','timechart_hover')\n        .attr('width', barWidth)\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('opacity', 0)\n        .attr('height', '100%')\n        .attr('fill', 'rgb(221 221 221 / 40%)')\n\n        d3.select('#timechart_svg').on('mouseover',  (event) => {\n\n            var coords = d3.pointer( event );\n            hoverBar.attr('opacity', 1)\n\n            var xDate = xScale.invert(coords[0]);\n\n            if(options.timeline_frequency=='week') {\n                xDate = moment(xDate).startOf('isoWeek');\n            }\n            if(options.timeline_frequency=='day') {\n                xDate = moment(xDate).startOf('day');\n            }\n            if(options.timeline_frequency=='month') {\n                xDate = moment(xDate).startOf('month');\n            }\n\n            if(coords[1]<470){\n                timelineTooltip.attr('opacity', 1).attr('display', 'inline');\n                hoverBar.attr('height', '100%');\n            } else if(coords[1]>510){\n                eventTooltip.attr('opacity', 1);\n                hoverBar.attr('height', '90%');\n            } else {\n                eventTooltip.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                hoverBar.attr('height', '100%');\n            }\n\n            if((xDate.toDate().getTime()<minDate.getTime())){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n            }\n\n            d3.select('#svg_container').style('z-index', 10);\n\n        }).on('mouseout',  (event) => {\n            hoverBar.attr('opacity', 0)\n            timelineTooltip.attr('opacity', 0).attr('display', 'none');\n            // timelineTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n            d3.select('#svg_container').style('z-index', 1);\n            eventTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n            d3.selectAll('.event_marker circle').style('stroke', colors.black);\n        })\n        .on('mousemove', (event) => {\n            var coords = d3.pointer( event );\n\n            var xDate = xScale.invert(coords[0]);\n\n            var tooltipStr = '';\n            if(options.timeline_frequency=='week') {\n                xDate = moment(xDate).startOf('isoWeek');\n                tooltipStr = xDate.format('ll');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            if(options.timeline_frequency=='day') {\n                xDate = moment(xDate).startOf('day');\n                tooltipStr = xDate.format('ll');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            if(options.timeline_frequency=='month') {\n                xDate = moment(xDate).startOf('month');\n                tooltipStr = xDate.format('MMMM YYYY');\n                d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n            }\n            hoverBar.attr('x', xScale(xDate.toDate()));\n\n            var groupedDataFiltered = groupedData.filter(function(d,i){\n                return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n            });\n            var vgroupedDataFiltered = vgroupedData.filter(function(d,i){\n                return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n            });\n\n            var deaths = '-';\n            var cases = '-';\n            var vaccines = '-';\n            if(options.timeline_type=='cumulative'){ \n                // cumulative\n                if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_cumulative_cases, 2);\n                if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_cumulative_deaths, 2);\n                if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_cumulative_vaccines, 2);\n            } else {\n                // non-cumulative/stacked\n                if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_new_cases, 2);\n                if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_new_deaths, 2);\n                if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_new_vaccines, 2);\n            }\n\n            if(deaths==0) deaths = '-';\n            if(cases==0) cases = '-';\n            if(vaccines==0) vaccines = '-';\n\n            d3.select('#tooltip_cases tspan').text((cases)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n            d3.select('#tooltip_deaths tspan').text((deaths)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n            d3.select('#tooltip_vaccines tspan').text((vaccines)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n\n            // if((xDate.toDate().getTime()>options.maxDate.getTime())){\n            //     hoverBar.attr('opacity', 0);\n            // // } else \n            if(((xDate.toDate().getTime()<minDate.getTime()))&&(options.timeline_frequency=='day')){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n            }\n\n            if(options.timeline_frequency=='month'){\n                hoverBar.attr('width', function(){\n                   return xScale(moment(xDate).endOf('month')) - xScale(moment(xDate).startOf('month'));\n                })\n            }\n            timelineTooltip.attr('transform', function(){\n                var bw = barWidth;\n                var ratio = (options.brushR - options.brushL)/600;\n                var offset = 0;\n                if(ratio<0.5) offset = 3;\n                if(ratio<0.3) offset = 12;\n                if(ratio<0.2) offset = 20;\n                if(ratio<0.15) offset = 21;\n                if(options.timeline_frequency=='month') { \n                    if(ratio<0.6) offset = 20;\n                    if(ratio<0.5) offset = 30;\n                    if(ratio<0.3) offset = 50;\n                    if(ratio<0.2) offset = 60;\n                    if(ratio<0.1) offset = 70;\n                    return 'translate('+(((xScaleEvents(xDate.toDate()))+(barWidth/3))+offset)+','+(coords[1]+353)+')';\n                }\n                return 'translate('+((xScaleEvents(xDate.toDate())+(18))+offset)+','+(coords[1]+353)+')';\n            })\n\n            if(coords[1]<470){\n                timelineTooltip.attr('opacity', 1);\n                hoverBar.attr('opacity', 1);\n                hoverBar.attr('height', '100%');\n            } else if(coords[1]>510){\n                eventTooltip.attr('opacity', 1);\n                hoverBar.attr('height', '90%');\n                var x = moment(xScale.invert(coords[0])).startOf('day');\n                var xx = (xScale.invert(coords[0]))\n                eventTooltip.attr('transform', function(){\n                    return 'translate('+(xScaleEvents(x.toDate())+(-3))+','+(817)+')';\n                });\n\n                var events = tData.filter(function(d,i){\n                    return moment(d.date).startOf('day').unix() == x.unix()\n                });\n\n                // select nearest neighbor for ux purposes \n                if(events.length==0){\n                    events = tData.filter(function(d,i){\n                        return ((moment(d.date).startOf('day').unix() <= moment(x).add(1, 'days').unix())&&(moment(d.date).startOf('day').unix() >= moment(x).subtract(1, 'days').unix()))\n                    });\n                }\n                \n                if(events.length>0){\n\n                    d3.select('#event-'+moment(events[0].date).startOf('day').unix()).select('path').style('stroke', '#000').attr('opacity', 1);\n                    tooltipStr = moment(events[0].date).startOf('day').format('ll');\n                    d3.select('#event_tooltip_date tspan').text(tooltipStr);\n\n                    var wrap = textwrap().bounds({height: 200, width: 230}).method('tspans');\n                    var event = d3.select('#event_tooltip_text').text(events[0].description)\n                    .attr('y', 18)\n                    .attr('x', 6)\n                    d3.select('#event_tooltip_text').call(wrap);\n\n                    d3.selectAll('#event_tooltip_text tspan').attr('dy', '1.3em');\n                    var bbox = d3.select('#event_tooltip_text').node().getBBox();\n                    d3.select('#event_tooltip_rect').attr('width', bbox.width+17)\n                    .attr('height', bbox.height +26 );\n\n                    var h = d3.select('#event_tooltip_rect').attr('height');\n                    var ys = 0;\n\n                    if(bbox.height<20){\n                        ys = 19;\n                    } else if(bbox.height<30){\n                        ys = 9;\n                    } else if(bbox.height<40){\n                        ys = 0;\n                    } else if(bbox.height<50){\n                        ys = -20;\n                    } else if(bbox.height<60){\n                        ys = -20;\n                    }\n\n                    var y = d3.select('#event_tooltip_rect').attr('y');\n\n                    d3.select('#event_tooltip_rect').attr('y', ys);\n                    \n                    d3.selectAll('#event_tooltip_text').attr('y', function(d,i){\n                        return parseInt(d3.select(this).attr('y')) + ys;\n                    });\n\n                    d3.selectAll('#event_tooltip_date tspan').attr('dy', function(d,i){\n                        return ys;\n                    });\n\n                    eventTooltip.attr('opacity', 1);\n\n                } else {\n                    d3.selectAll('.event_marker circle').style('stroke', colors.black)\n                    eventTooltip.attr('opacity', 0);\n                }\n            } else {\n                eventTooltip.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                hoverBar.attr('opacity', 0);\n                hoverBar.attr('height', '100%');\n            }\n\n            if((options.timeline_frequency=='day')&&((xDate.toDate().getTime()<minDate.getTime()))){\n                hoverBar.attr('opacity', 0);\n                timelineTooltip.attr('opacity', 0);\n                return false;\n            }\n        });\n\n        tData = tData.filter(d => d.date.length > 0);\n\n        // event lin\n\n        yAxisGroup.append('line')\n        .attr('id', 'event-line')\n        .attr('x1', 0)\n        .attr('x2', 620)\n        .attr('y1', 893)\n        .attr('y2', 893)\n        .attr('stroke-width', 2.5)\n        .attr('stroke', colors.black);\n\n        var circles = yAxisGroup.append('g').selectAll('.event_marker')\n        .data(tData)\n        .enter()\n        .append('g')\n        .attr('class', 'event_marker')\n        .attr('id', function(d,i){\n            return 'event-'+moment(d.date).startOf('day').unix();\n        })\n        .attr('transform', function(d){\n            var x = xScaleEvents(new Date(d.date));\n            return 'translate('+(x)+', 893)';\n        })\n        .style('cursor', 'pointer');\n        // .append('path')\n        // .attr('d', \"M0,-6L4,0 0,6 -4,0Z\")\n        \n        circles.append(\"circle\")\n        .style('stroke', colors.black)\n        .attr('opacity', 1)\n        .attr('r', 6.5)\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .style('stroke-width',2.2)\n        .style('fill', 'white');\n        circles\n        .append(\"circle\")\n        .attr('r', 2)\n        .attr('cx', 0)\n        .attr('cy', 0)\n        .attr('fill', colors.black)\n        .style('stroke', colors.black);\n\n\n        // create brush zoom\n        // reset\n        // options.brushL = 0;\n        // options.brushR = 600;\n        const brush = d3.brushX()\n        .extent([[0,0],[600,20]])\n        .on(\"start brush end\", brushed);\n\n        d3.select('.brush').remove();\n;\n        var gBrush = d3.select('#zoombar').append(\"g\")\n        .attr(\"class\", \"brush\")\n        .attr('opacity', 0.1)\n        .call(brush);\n\n\t\td3.selectAll('.handle rect').attr('fill-opacity', '1').style('visibility', 'visible').attr('width', 2).attr('fill', '#000').style('stroke-opacity', 0);\n\n        var brushScale = d3.scaleLinear()\n        .domain([-3, 597])\n        .range([0,2000]);\n\n        gBrush.call(brush.move, [options.brushL,options.brushR]);\n\n        function brushed(){\n            var x = parseFloat(d3.select('.handle--w').attr('x'));\n            var x2 = parseFloat(d3.select('.handle--e').attr('x'));\n            if((x2-x)<40) return false;\n            var w = d3.select('.selection').attr('width');\n            d3.select('#zoomL').attr('transform', 'translate('+x+',0)');\n            d3.select('#zoomR').attr('transform', 'translate('+(x2)+',0)');\n            d3.select('#zoomOverlay').attr('width', (x2-x));\n            d3.select('#zoomOverlay').attr('x', (x));\n            d3.select('#zoomOverlay').attr('transform', 'translate(3,0)');\n            var viewBoxW = Math.round(brushScale(x2)-brushScale(x));\n            var viewBoxX = Math.round(brushScale(x));\n            options.brushL = x+3;\n            options.brushR = x2+3;\n\n            xScaleAxis = d3.scaleTime()\n            .range([0,596])\n            .domain([new Date(xScale.invert(brushScale(x))),new Date(xScale.invert(brushScale(x2)))]);\n\n            xScaleEvents = d3.scaleTime()\n            .range([25,619])\n            // .domain([minDate,md]);\n            .domain([new Date(xScale.invert(brushScale(x))),new Date(xScale.invert(brushScale(x2)))]);\n\n            d3.selectAll('.event_marker')\n            .attr('transform', function(d){\n                var x = xScaleEvents(new Date(d.date));\n                return 'translate('+(x)+', 893)';\n            });\n\n            xAxis = d3.axisBottom()\n            .ticks(5)\n            .scale(xScaleAxis);\n\n            xAxisCases.call(xAxis);\n            xAxisDeaths.call(xAxis);\n            xAxisVaccines.call(xAxis);\n            xAxisTimeline.call(xAxis);\n            \n            d3.select('#timechart_svg').attr('viewBox', viewBoxX + ' 0 '+ viewBoxW + ' 553')\n        }\n\n}\n\nexport function updateTimechart(data, options) {\n\n    const groupedData = [];\n\n    data.who_data.forEach(function(d,i){\n        if(!groupedData[d[options.timeline_frequency+'Total']])groupedData[d[options.timeline_frequency+'Total']] = {};\n        if(options.timeline_frequency==='day') groupedData[d[options.timeline_frequency+'Total']].date = d.date;\n        if(options.timeline_frequency==='week') groupedData[d[options.timeline_frequency+'Total']].date = d.week_start;\n        if(options.timeline_frequency==='month') groupedData[d[options.timeline_frequency+'Total']].date = d.month_start;\n        if(!groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_cases += d.new_cases;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_deaths += d.new_deaths;\n        groupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_cases = 0;\n    });\n\n    // totals by date\n    groupedData.forEach(function(d,i){\n        regions.forEach(function(dd,ii){\n            if(!d.hasOwnProperty(dd)){\n               d[dd] = {new_cases: 0, new_deaths: 0, cumulative_cases: 0, cumulative_deaths: 0};\n            }\n            // if(dd!=='OTH') d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n            if(i>0){\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases + groupedData[i-1][dd].cumulative_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths + groupedData[i-1][dd].cumulative_deaths;\n            } else {\n                d[dd].cumulative_cases = groupedData[i][dd].new_cases;\n                d[dd].cumulative_deaths = groupedData[i][dd].new_deaths;\n            }\n        })\n\n        d.total_new_cases = d.AF.new_cases + d.AP.new_cases + d.AM.new_cases + d.EU.new_cases + d.ME.new_cases + d.OTH.new_cases; \n        d.total_cumulative_cases = d.AF.cumulative_cases + d.AP.cumulative_cases + d.AM.cumulative_cases + d.EU.cumulative_cases + d.ME.cumulative_cases + d.OTH.cumulative_cases; \n        d.total_new_deaths = d.AF.new_deaths + d.AP.new_deaths + d.AM.new_deaths + d.EU.new_deaths + d.ME.new_deaths + d.OTH.new_deaths; \n        d.total_cumulative_deaths = d.AF.cumulative_deaths + d.AP.cumulative_deaths + d.AM.cumulative_deaths + d.EU.cumulative_deaths + d.ME.cumulative_deaths + d.OTH.cumulative_deaths; \n        d.region = [];\n\n        regions.forEach(function(dd,ii){\n            d.region.push({'region': dd, 'new_cases': d[dd].new_cases, 'new_deaths': d[dd].new_deaths, 'cumulative_cases': d[dd].cumulative_cases, 'cumulative_deaths': d[dd].cumulative_deaths});\n        })\n    });\n\n    vgroupedData = [];\n\n    if(options.timeline_type!='cumulative'){ // non-cumulative and stacked\n        // data.vaccines_data = data.vaccines_data_daily;\n        data.vaccines_data.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('isoWeek').toDate();\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('month').toDate();\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {new_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].new_vaccines += d.daily_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {new_vaccines: 0, cumulative_vaccines: 0}\n                }\n            });\n            d.total_new_vaccines = d.AF.new_vaccines + d.AP.new_vaccines + d.AM.new_vaccines + d.EU.new_vaccines + d.ME.new_vaccines + d.OTH.new_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'new_vaccines': d[dd].new_vaccines});\n            })\n        });\n\n    } else{ // cumulative only\n        var vData = [];\n        if(options.timeline_frequency==='day') {\n            vData = clone(data.vaccines_data);\n        }\n        if(options.timeline_frequency==='week') {\n            data.vaccines_data.forEach(function(d,i){\n                var endOfWeekDate = moment(d.date).endOf('isoWeek').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfWeekDate)||(date==moment(data.max_date).startOf('day').unix())){\n                    vData.push(d);\n                }\n            })\n        }\n        if(options.timeline_frequency==='month') {\n            var maxDateUnix = moment(data.max_date).startOf('day').unix();\n            data.vaccines_data.forEach(function(d,i){\n                var endOfMonthDate = moment(d.date).endOf('month').startOf('day').unix();\n                var date = moment(d.date).startOf('day').unix();\n                if((date==endOfMonthDate)||((moment(data.max_date).startOf('day').unix()!=endOfMonthDate)&&(date==maxDateUnix))){\n                    vData.push(d);\n                }\n            })\n        }\n\n        vData.forEach(function(d,i){\n            if(!vgroupedData[d[options.timeline_frequency+'Total']])vgroupedData[d[options.timeline_frequency+'Total']] = {};\n            if(options.timeline_frequency==='day') vgroupedData[d[options.timeline_frequency+'Total']].date = d.date;\n            if(options.timeline_frequency==='week') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('isoWeek').toDate();\n            if(options.timeline_frequency==='month') vgroupedData[d[options.timeline_frequency+'Total']].date = moment(d.date).startOf('month').toDate();\n            if(!vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region]) vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region] = {cumulative_vaccines: 0};\n            vgroupedData[d[options.timeline_frequency+'Total']][d.ifrc_region].cumulative_vaccines += d.total_vaccinations;\n        });\n        // totals by date\n        vgroupedData.forEach(function(d,i){\n            regions.forEach(function(dd,ii){\n                if(!d[dd]){\n                    d[dd] = {cumulative_vaccines: 0}\n                }\n            });\n            d.total_cumulative_vaccines = d.AF.cumulative_vaccines + d.AP.cumulative_vaccines + d.AM.cumulative_vaccines + d.EU.cumulative_vaccines + d.ME.cumulative_vaccines + d.OTH.cumulative_vaccines; \n            d.region = [];\n            regions.forEach(function(dd,ii){\n                d.region.push({'region': dd, 'cumulative_vaccines': d[dd].cumulative_vaccines});\n            })\n        });\n    }\n\n    vgroupedData = vgroupedData.filter(function(el) { return el; });\n\n    const numIntervals = d3.max(data.who_data, function(d,i){\n        return d[options.timeline_frequency+'Total'];\n    });\n\n    const maxCases = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_cases;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_cases;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxDeaths = d3.max(groupedData, function(d,i){\n        if(options.timeline_type==='non-cumulative') return d.total_new_deaths;\n        if(options.timeline_type==='cumulative') return d.total_cumulative_deaths;\n        if(options.timeline_type==='stacked') return 100;\n    })\n\n    const maxVaccines = d3.max(vgroupedData, function(d,i){\n        if(d){\n            if(options.timeline_type==='non-cumulative') return d.total_new_vaccines;\n            if(options.timeline_type==='cumulative') return d.total_cumulative_vaccines;\n            if(options.timeline_type==='stacked') return 100;\n        }\n    })\n\n    const svg = d3.select('#timechart_svg');\n\n    const width = 2000;\n    const barWidth = width/numIntervals;\n\n    let barSpacing = 0.04; \n    if(options.timeline_frequency==='month') barSpacing = 0.03;\n    if(options.timeline_frequency==='day') barSpacing = 0;\n\n    // define scales\n\n    // xScale = d3.scaleTime()\n    // .range([0,width])\n    // .domain([minDate,md]);\n\n    // xScaleAxis = d3.scaleTime()\n    // .range([23,596])\n    // .domain([minDate,md]);\n\n    yScaleCases = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxCases]);\n\n    yScaleCasesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxCases]);\n\n    yScaleDeaths = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxDeaths]);\n\n    yScaleDeathsAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxDeaths]);\n\n    yScaleVaccines = d3.scaleLinear()\n    .range([0,140])\n    .domain([0,maxVaccines]);\n\n    yScaleVaccinesAxis = d3.scaleLinear()\n    .range([140,0])\n    .domain([0,maxVaccines]);\n\n    // define axi\n    yAxisCases = d3.axisRight()\n    .scale(yScaleCasesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisDeaths = d3.axisRight()\n    .scale(yScaleDeathsAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    yAxisVaccines = d3.axisRight()\n    .scale(yScaleVaccinesAxis)\n    .ticks(3)\n    .tickSize(3)\n    .tickPadding(3)\n    .tickFormat(function(d){\n        if(options.timeline_type=='stacked') return nFormatter(d)+'%';\n        return nFormatter(d);\n    })\n\n    // y-axis cases\n    var yAxisCasesText = d3.select('#casesAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisCases);\n\n    // y-axis deaths\n    var yAxisDeathsText = d3.select('#deathsAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisDeaths);\n\n    // y-axis vaccines\n    var yAxisVaccinesText = d3.select('#VaccinesAxis')\n    .transition()\n    .duration(500)\n    .call(yAxisVaccines);\n\n    // CASES\n    // loop through groupedData and draw bars\n    const barGroups = svg.selectAll('.bar_group')\n    .data(groupedData)\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+')'\n    })\n\n    // CASES\n    barGroups.selectAll('.cases_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_cases;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_cases;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleCases(d.cumulative_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleCases(d.new_cases)-(yScaleCases(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_cases/totalNewCases))-((140*(dp/totalNewCases))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewCases = d3.select(this.parentNode).datum().total_new_cases - d3.select(this.parentNode).datum().OTH.new_cases;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleCases(d.cumulative_cases);\n        if(options.timeline_type==='non-cumulative') y = yScaleCases(d.new_cases);\n        if(options.timeline_type==='stacked') y = (140*(d.new_cases/totalNewCases));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('fill', function(d,i){\n        return colors.regions[d.region];\n        return 'blue'\n    })\n\n    // // DEATHS\n    barGroups.selectAll('.deaths_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_deaths;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_deaths;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleDeaths(d.cumulative_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleDeaths(d.new_deaths)-(yScaleDeaths(dp))+170)\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_deaths/totalNewDeaths))-((140*(dp/totalNewDeaths)))+170)\n        // if(options.timeline_type==='non-cumulative') if(y>310) return 0;\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewDeaths = d3.select(this.parentNode).datum().total_new_deaths - d3.select(this.parentNode).datum().OTH.new_deaths;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleDeaths(d.cumulative_deaths);\n        if(options.timeline_type==='non-cumulative') y = yScaleDeaths(d.new_deaths);\n        if(options.timeline_type==='stacked') y = (140*(d.new_deaths/totalNewDeaths));\n        if(options.timeline_type==='non-cumulative') if(y<0) return 0;\n\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n\n    if(groupedData.length==0){\n        d3.selectAll('.cases_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140)\n        .attr('height', 0)\n\n        d3.selectAll('.deaths_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140+170)\n        .attr('height', 0)\n        \n    }\n    // // VACCINES\n\n    const vbarGroups = svg.selectAll('.vbar_group')\n    .data(vgroupedData)\n    .attr('transform', function(d,i){ \n        return 'translate('+xScale(d.date)+', 344)'\n    })\n\n    vbarGroups.selectAll('.vaccines_bar')\n    .data(function(d,i){ return d.region.filter(function(dd,ii){\n        return dd.region!=='OTH';\n    })})\n    .transition()\n    .duration(500)\n    .attr('y', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let dp = 0;\n        if(i>0){\n            for(let ii=1;ii<=i;ii++){\n                if(options.timeline_type==='cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].cumulative_vaccines;\n                if(options.timeline_type==='non-cumulative') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n                if(options.timeline_type==='stacked') dp += d3.select(this.parentNode).datum().region[ii-1].new_vaccines;\n            }\n        }\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = (140-yScaleVaccines(d.cumulative_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='non-cumulative') y = (140-yScaleVaccines(d.new_vaccines)-(yScaleVaccines(dp)))\n        if(options.timeline_type==='stacked') y = (140-(140*(d.new_vaccines/totalNewVaccines))-((140*(dp/totalNewVaccines))))\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    })\n    .attr('height', function(d,i){\n        const totalNewVaccines = d3.select(this.parentNode).datum().total_new_vaccines - d3.select(this.parentNode).datum().OTH.new_vaccines;\n        let y = 0;\n        if(options.timeline_type==='cumulative') y = yScaleVaccines(d.cumulative_vaccines);\n        if(options.timeline_type==='non-cumulative') y = yScaleVaccines(d.new_vaccines);\n        if(options.timeline_type==='stacked') y = (140*(d.new_vaccines/totalNewVaccines));\n        if(y){ if(y>0) { return y} else { return 0}; } else { return 0};\n    });\n\n    if(vgroupedData.length==0){\n        d3.selectAll('.vaccines_bar')\n        .transition()\n        .duration(500)\n        .attr('y', 140)\n        .attr('height', 0)\n    }\n   \n    // // bar size tweak for spacing\n    // if(options.timeline_frequency==='month'){\n    //     barGroups.selectAll(\".timeBar\")\n    //     .attr(\"width\", function(d) {\n    //         var date = d3.select(this.parentNode).datum().date;\n    //         var next = d3.timeMonth.offset(date, 1);\n    //         return (xScale(next)- xScale(date))*(1-barSpacing);\n    //       })\n    //     .attr(\"x\", function(d) {\n    //         var date = d3.select(this.parentNode).datum().date;\n    //         var next = d3.timeMonth.offset(date, 1);\n    //         return (xScale(next)- xScale(date))*(barSpacing/2);\n    //       })\n    //     }\n\n    d3.select('#timechart_svg').on('mouseover',  (event) => {\n\n        var coords = d3.pointer( event );\n        hoverBar.attr('opacity', 1)\n\n        var xDate = xScale.invert(coords[0]);\n\n        if(options.timeline_frequency=='week') {\n            xDate = moment(xDate).startOf('isoWeek');\n        }\n        if(options.timeline_frequency=='day') {\n            xDate = moment(xDate).startOf('day');\n        }\n        if(options.timeline_frequency=='month') {\n            xDate = moment(xDate).startOf('month');\n        }\n\n        if(coords[1]<470){\n            timelineTooltip.attr('opacity', 1).attr('display', 'inline');\n            hoverBar.attr('height', '100%');\n        } else if(coords[1]>510){\n            eventTooltip.attr('opacity', 1);\n            hoverBar.attr('height', '90%');\n        } else {\n            eventTooltip.attr('opacity', 0);\n            timelineTooltip.attr('opacity', 0);\n            hoverBar.attr('height', '100%');\n        }\n\n        if((xDate.toDate().getTime()<minDate.getTime())){\n            hoverBar.attr('opacity', 0);\n            timelineTooltip.attr('opacity', 0);\n        }\n\n        d3.select('#svg_container').style('z-index', 10);\n\n    }).on('mouseout',  (event) => {\n        hoverBar.attr('opacity', 0)\n        timelineTooltip.attr('opacity', 0).attr('display', 'none');\n        // timelineTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n        d3.select('#svg_container').style('z-index', 1);\n        eventTooltip.attr('opacity', 0).attr('transform', 'translate(0,0)');\n        d3.selectAll('.event_marker circle').style('stroke', colors.black);\n    })\n    .on('mousemove', (event) => {\n        var coords = d3.pointer( event );\n\n        var xDate = xScale.invert(coords[0]);\n\n        var tooltipStr = '';\n        if(options.timeline_frequency=='week') {\n            xDate = moment(xDate).startOf('isoWeek');\n            tooltipStr = xDate.format('ll');\n            d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n        }\n        if(options.timeline_frequency=='day') {\n            xDate = moment(xDate).startOf('day');\n            tooltipStr = xDate.format('ll');\n            d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n        }\n        if(options.timeline_frequency=='month') {\n            xDate = moment(xDate).startOf('month');\n            tooltipStr = xDate.format('MMMM YYYY');\n            d3.select('#timeline_tooltip_date tspan').text(tooltipStr);\n        }\n        hoverBar.attr('x', xScale(xDate.toDate()));\n\n        var groupedDataFiltered = groupedData.filter(function(d,i){\n            return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n        });\n        var vgroupedDataFiltered = vgroupedData.filter(function(d,i){\n            return moment(d.date).startOf('day').unix() == xDate.startOf('day').unix();\n        });\n\n        var deaths = '-';\n        var cases = '-';\n        var vaccines = '-';\n        if(options.timeline_type=='cumulative'){ \n            // cumulative\n            if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_cumulative_cases, 2);\n            if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_cumulative_deaths, 2);\n            if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_cumulative_vaccines, 2);\n        } else {\n            // non-cumulative/stacked\n            if(groupedDataFiltered[0]) cases = nFormatter(groupedDataFiltered[0].total_new_cases, 2);\n            if(groupedDataFiltered[0]) deaths = nFormatter(groupedDataFiltered[0].total_new_deaths, 2);\n            if(vgroupedDataFiltered[0]) vaccines = nFormatter(vgroupedDataFiltered[0].total_new_vaccines, 2);\n        }\n\n        if(deaths==0) deaths = '-';\n        if(cases==0) cases = '-';\n        if(vaccines==0) vaccines = '-';\n\n        d3.select('#tooltip_cases tspan').text((cases)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n        d3.select('#tooltip_deaths tspan').text((deaths)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n        d3.select('#tooltip_vaccines tspan').text((vaccines)).attr(\"text-anchor\", \"end\").attr('dx', 32)\n\n        // if((xDate.toDate().getTime()>options.maxDate.getTime())){\n        //     hoverBar.attr('opacity', 0);\n        // // } else \n        if(((xDate.toDate().getTime()<minDate.getTime()))&&(options.timeline_frequency=='day')){\n            hoverBar.attr('opacity', 0);\n            timelineTooltip.attr('opacity', 0);\n        }\n\n        if(options.timeline_frequency=='month'){\n            hoverBar.attr('width', function(){\n               return xScale(moment(xDate).endOf('month')) - xScale(moment(xDate).startOf('month'));\n            })\n        }\n        timelineTooltip.attr('transform', function(){\n            var bw = barWidth;\n            var ratio = (options.brushR - options.brushL)/600;\n            var offset = 0;\n            if(ratio<0.5) offset = 3;\n            if(ratio<0.3) offset = 12;\n            if(ratio<0.2) offset = 20;\n            if(ratio<0.15) offset = 21;\n            if(options.timeline_frequency=='month') { \n                if(ratio<0.6) offset = 20;\n                if(ratio<0.5) offset = 30;\n                if(ratio<0.3) offset = 50;\n                if(ratio<0.2) offset = 60;\n                if(ratio<0.1) offset = 70;\n                return 'translate('+(((xScaleEvents(xDate.toDate()))+(barWidth/3))+offset)+','+(coords[1]+353)+')';\n            }\n            return 'translate('+((xScaleEvents(xDate.toDate())+(18))+offset)+','+(coords[1]+353)+')';\n        })\n\n        if(coords[1]<470){\n            timelineTooltip.attr('opacity', 1);\n            hoverBar.attr('opacity', 1);\n            hoverBar.attr('height', '100%');\n        } else if(coords[1]>510){\n            eventTooltip.attr('opacity', 1);\n            hoverBar.attr('height', '90%');\n            var x = moment(xScale.invert(coords[0])).startOf('day');\n            var xx = (xScale.invert(coords[0]))\n            eventTooltip.attr('transform', function(){\n                return 'translate('+(xScaleEvents(x.toDate())+(-3))+','+(817)+')';\n            });\n\n            var events = tData.filter(function(d,i){\n                return moment(d.date).startOf('day').unix() == x.unix()\n            });\n\n            // select nearest neighbor for ux purposes \n            if(events.length==0){\n                events = tData.filter(function(d,i){\n                    return ((moment(d.date).startOf('day').unix() <= moment(x).add(1, 'days').unix())&&(moment(d.date).startOf('day').unix() >= moment(x).subtract(1, 'days').unix()))\n                });\n            }\n            \n            if(events.length>0){\n\n                d3.select('#event-'+moment(events[0].date).startOf('day').unix()).select('path').style('stroke', '#000').attr('opacity', 1);\n                tooltipStr = moment(events[0].date).startOf('day').format('ll');\n                d3.select('#event_tooltip_date tspan').text(tooltipStr);\n\n                var wrap = textwrap().bounds({height: 200, width: 230}).method('tspans');\n                var event = d3.select('#event_tooltip_text').text(events[0].description)\n                .attr('y', 18)\n                .attr('x', 6)\n                d3.select('#event_tooltip_text').call(wrap);\n\n                d3.selectAll('#event_tooltip_text tspan').attr('dy', '1.3em');\n                var bbox = d3.select('#event_tooltip_text').node().getBBox();\n                d3.select('#event_tooltip_rect').attr('width', bbox.width+17)\n                .attr('height', bbox.height +26 );\n\n                var h = d3.select('#event_tooltip_rect').attr('height');\n                var ys = 0;\n\n                if(bbox.height<20){\n                    ys = 19;\n                } else if(bbox.height<30){\n                    ys = 9;\n                } else if(bbox.height<40){\n                    ys = 0;\n                } else if(bbox.height<50){\n                    ys = -20;\n                } else if(bbox.height<60){\n                    ys = -20;\n                }\n\n                var y = d3.select('#event_tooltip_rect').attr('y');\n\n                d3.select('#event_tooltip_rect').attr('y', ys);\n                \n                d3.selectAll('#event_tooltip_text').attr('y', function(d,i){\n                    return parseInt(d3.select(this).attr('y')) + ys;\n                });\n\n                d3.selectAll('#event_tooltip_date tspan').attr('dy', function(d,i){\n                    return ys;\n                });\n\n                eventTooltip.attr('opacity', 1);\n\n            } else {\n                d3.selectAll('.event_marker circle').style('stroke', colors.black)\n                eventTooltip.attr('opacity', 0);\n            }\n        } else {\n            eventTooltip.attr('opacity', 0);\n            timelineTooltip.attr('opacity', 0);\n            hoverBar.attr('opacity', 0);\n            hoverBar.attr('height', '100%');\n        }\n\n        if((options.timeline_frequency=='day')&&((xDate.toDate().getTime()<minDate.getTime()))){\n            hoverBar.attr('opacity', 0);\n            timelineTooltip.attr('opacity', 0);\n            return false;\n        }\n    });\n\n}\n\nexport default drawTimechart;\n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxCases;\nlet maxDeaths;\nlet maxVaccinations;\nlet xScaleCases; \nlet xScaleDeaths;\nlet xScaleVaccines;\nlet labelWidth; \nconst margin = { left: 20, top: 0, right: 58 };\nlet rcSize; \nlet groupedData = [];\n\nexport function drawRegionchart(data, options, filter) {\n\n    const barSpacing = 0.1;\n\n    // reset region values to zero\n    data.regions.forEach(function(d,i){\n        d.population = 0;\n        d.cumulative_deaths = 0;\n        d.cumulative_cases = 0;\n        d.cumulative_vaccines = 0;\n    })\n\n    // loop through countries and calculate region totals\n    data.country.forEach(function(d,i){\n        data.regions.forEach(function(dd,ii){\n            if((dd.code==d.ifrc_region)){ \n                if((d.population>0)&&(d.who_daily_latest)){\n                    if(d.who_daily_latest.cumulative_cases>0)\n                    dd.cumulative_cases += d.who_daily_latest.cumulative_cases;\n                    if(d.who_daily_latest.cumulative_deaths>0)\n                    dd.cumulative_deaths += d.who_daily_latest.cumulative_deaths||0;\n                    dd.population += d.population;\n                }\n                if((d.population>0)&&(d.vaccine_daily_latest)){\n                    dd.cumulative_vaccines += (d.vaccine_daily_latest.total_vaccinations)||0;\n                }\n            }\n        });\n    });\n\n    // calculate regions per 100k values using total population for each region\n    data.regions.forEach(function(d,i){\n        d.cumulative_cases_per_100k = d.cumulative_cases/(d.population/100000)\n        d.cumulative_deaths_per_100k = d.cumulative_deaths/(d.population/100000);\n        d.cumulative_vaccines_per_100k = d.cumulative_vaccines/(d.population/100000);\n        if(!isFinite(d.cumulative_cases_per_100k)) d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k)) d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k)) d.cumulative_vaccines_per_100k = 0;\n    })\n\n    // get maximum values for each series\n    if(options.region_switch=='per100'){\n        // get maximum values for each series\n        maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines_per_100k;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases_per_100k;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        });\n    } else {\n         // get maximum values for each series\n         maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths;\n        });\n    }\n\n    // append region chart container\n    const regionChartContainer = d3.select('#layout #region_chart_container').attr('opacity', 0);\n\n    // get dimensions\n    rcSize = {\n        x: regionChartContainer.attr('x'), y: regionChartContainer.attr('y'), width: regionChartContainer.attr('width'), height: regionChartContainer.attr('height')\n    }\n\n    // create svg container\n    const svg = d3.select('#layout').append('g').attr('transform', 'translate('+rcSize.x+', '+rcSize.y+')')\n    .attr('id', 'region_chart');\n\n    // calculate chart row height\n\tvar rowHeight = rcSize.height/(data.regions.length-1); // remove OTH\n\n    // create rows\n    var rows = svg.selectAll('.bar-row')\n\t.data(data.regions.filter(d=>d.code!=='OTH'))\n\t.enter()\n\t.append('g')\n\t.attr('class', 'bar-row')\n\t.attr('transform', function(d,i){\n\t\treturn 'translate(0,' + ((i*rowHeight) + margin.top) + ')';\n\t});\n\n    // create region labels\n    var label = rows.append('text')\n\t.attr('y', rowHeight/2 )\n    .attr('x', margin.left-5)\n\t.attr('class', function(d,i){ return 'bar-labels bar-label-'+d.code })\n\t.style('alignment-baseline', 'middle')\n\t.style('font-size', '11px')\n    .attr('opacity', 1)\n\t.attr('fill', '#000')\n\t.text(function(d,i){\n\t\tif(d.code==='AM') return 'Americas';\n\t\tif(d.code==='EU') return 'Europe';\n\t\tif(d.code==='AF') return 'Africa';\n\t\tif(d.code==='ME') return 'Middle East and North Africa';\n\t\tif(d.code==='AP') return 'Asia-Pacific';\n\t}).style('text-anchor', 'end');\n\n    // get label node width for use in scale\n    labelWidth = rows.node().getBBox().width + margin.left;\n\tlabel.attr('x', labelWidth+89);\n\tlabelWidth = labelWidth + 94;\n    d3.selectAll('.timeBar').attr('opacity',1);\n    \n    // create fading background click area\n    var rowBg = rows.append('rect')\n\t.attr('y', 0)\n\t.attr('x', 0)\n\t.attr('width', labelWidth)\n\t.attr('height', rowHeight-2)\n\t.style('opacity', 0)\n    .attr('fill', 'grey')\n\t.style('cursor', 'pointer')\n\t.attr('class', function(d,i){ return 'bar-bg-'+d.code })\n\t.attr('data-id', function(d,i){ return d.code })\n\t.on('mouseover', function(d){\n\t\td3.select(this).style('opacity', 0.1);\n\t})\n\t.on('mouseout', function(){\n\t\td3.select(this).style('opacity', 0);\n\t})\n\t.on('click', function(d,i){\n        var t = d3.select(this).attr('data-id');\n        filter([t],'regionchart');\n    });\n\n    // define scales\n    xScaleCases = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxCases]);\n\n    xScaleDeaths = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxDeaths]);\n\n    xScaleVaccines = d3.scaleLinear()\n\t.range([labelWidth, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxVaccinations]);\n\n    var bars = rows.append('rect')\n    .attr('id', function(d,i){\n        return 'bar-'+d.code;\n    })\n\t.attr('data-id', function(d,i){ return d.code })\n    .attr('class', 'region-bar')\n    .attr('width', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k);\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k);\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k);\n        } else {\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases);\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths);\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines);                \n        }\n        if(!isNaN(val)) { return parseFloat(val) } else { return 0}\n    })\n    .attr('x', labelWidth)\n    .style('outline', 'none')\n    .style('cursor', 'pointer')\n    .attr('y', rowHeight*barSpacing - 1)\n    .attr('height', rowHeight-((rowHeight*barSpacing)*2))\n    .style('fill', function(d){\n        return colors.regions[d.code]\n    })\n    .attr('opacity',1)\n    .on('click', function(d,i){\n        var t = d3.select(this).attr('data-id');\n        filter([t],'regionchart');\n    })\n    .on('mouseover', function(d){\n        var dat = d3.select(this.parentNode).datum();\n        // d3.selectAll('.timeBar:not(.time_'+dat.region).transition().duration(500).attr('opacity', 0.3);\n        // d3.selectAll('.time_'+dat.region).attr('opacity', 1);\n\t})\n\t.on('mouseout', function(){\n        // d3.selectAll('.timeBar').transition().duration(500).attr('opacity', 1);\n\t})\n\n    // create data value labels\n    var dataLabel = rows.append('text')\n\t.text(function(d){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases_per_100k));\n            if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths_per_100k));\n            if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines_per_100k));\n        } else {\n            if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases));\n            if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths));\n            if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines));             \n        }\n        return addCommas(val);\n    })\n\t.attr('id', function(d,i){\n\t\treturn 'data-label'+d.code;\n\t})\n    .attr('data-id', function(d,i){ return d.code })\n\t.attr('class', 'data-label')\n\t.attr('y', rowHeight/2)\n\t.style('alignment-baseline', 'middle')\n\t.style('text-anchor', 'start')\n\t.attr('x', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k)+labelWidth+5;\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k)+labelWidth+5;\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k)+labelWidth+5;\n        } else {\n            if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases)+labelWidth+5;\n            if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths)+labelWidth+5;\n            if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines)+labelWidth+5;               \n        }\n        return val;\n    })\n    .attr('opacity', function(d,i){\n        var val = 0;\n        if(options.region_switch=='per100'){\n            if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases_per_100k);\n            if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths_per_100k);\n            if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines_per_100k);\n        } else {\n            if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases);\n            if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths);\n            if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines);\n        }\n        if(val>0){ return 1 } else { return 0}\n    })\n\t.style('fill', '#696969')\n\t.style('font-weight', 'normal')\n\t.style('font-size', '10px');\n\n}\n\nexport function updateRegionchart(options,data) {\n    \n    // reset region values to zero\n    data.regions.forEach(function(d,i){\n        d.population = 0;\n        d.cumulative_deaths = 0;\n        d.cumulative_cases = 0;\n        d.cumulative_vaccines = 0;\n    })\n\n    // loop through countries and calculate region totals\n    data.country.forEach(function(d,i){\n        data.regions.forEach(function(dd,ii){\n            if((dd.code==d.ifrc_region)){ \n                if((d.population>0)&&(d.who_daily_latest)){\n                    if(d.who_daily_latest.cumulative_cases>0)\n                    dd.cumulative_cases += d.who_daily_latest.cumulative_cases;\n                    if(d.who_daily_latest.cumulative_deaths>0)\n                    dd.cumulative_deaths += d.who_daily_latest.cumulative_deaths||0;\n                    dd.population += d.population;\n                }\n                if((d.population>0)&&(d.vaccine_daily_latest)){\n                    dd.cumulative_vaccines += (d.vaccine_daily_latest.total_vaccinations)||0;\n                }\n            }\n        });\n    });\n\n    // calculate regions per 100k values using total population for each region\n    data.regions.forEach(function(d,i){\n        d.cumulative_cases_per_100k = d.cumulative_cases/(d.population/100000)\n        d.cumulative_deaths_per_100k = d.cumulative_deaths/(d.population/100000);\n        d.cumulative_vaccines_per_100k = d.cumulative_vaccines/(d.population/100000);\n        if(!isFinite(d.cumulative_cases_per_100k)) d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k)) d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k)) d.cumulative_vaccines_per_100k = 0;\n    })\n\n    if(options.region_switch=='per100'){\n        // get maximum values for each series\n        maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines_per_100k;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases_per_100k;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        });\n    } else {\n         // get maximum values for each series\n         maxVaccinations = d3.max(data.regions, function(d,i){\n            return d.cumulative_vaccines;\n        })\n\n        maxCases = d3.max(data.regions, function(d,i){\n            return d.cumulative_cases;\n        })\n\n        maxDeaths = d3.max(data.regions, function(d,i){\n            return d.cumulative_deaths;\n        });\n    }\n\n    // redefine scales using new extent\n    xScaleCases = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxCases]);\n\n    xScaleDeaths = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxDeaths]);\n\n    xScaleVaccines = d3.scaleLinear()\n\t.range([0, rcSize.width - margin.right - labelWidth])\n\t.domain([0, maxVaccinations]);\n\n    // update bars\n    if((maxVaccinations==0)&&(maxCases==0)&&(maxDeaths==0)){\n        d3.selectAll('.region-bar')\n        .transition().duration(500)\n        .attr('width', 0);\n\n        d3.selectAll('.data-label')\n        .transition()\n          .duration(500) \n          .attr('x', labelWidth)\n          .attr('opacity', 0);\n    } else {\n        d3.selectAll('.region-bar')\n        .transition().duration(500)\n        .style('fill', function(d){\n            return colors.regions[d.code];\n            if(options.region_chart_toggle=='vaccines'){\n                return colors.regions_blue[d.code]\n            } else {\n                return colors.regions[d.code]\n            }\n        })\n        .attr('width', function(d,i){\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k);\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k);\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k);\n            } else {\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases);\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths);\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines);                \n            }\n            if(!isNaN(val)) { return parseFloat(val) } else { return 0}\n        })   \n        d3.selectAll('.data-label')\n        .transition()\n          .duration(500)\n          .tween(\"text\", function(d,i) {\n            var val = 0;\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases_per_100k));\n                if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths_per_100k));\n                if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines_per_100k));\n            } else {\n                if(options.region_chart_toggle == 'cases') val = (Math.round(d.cumulative_cases));\n                if(options.region_chart_toggle == 'deaths') val = (Math.round(d.cumulative_deaths));\n                if(options.region_chart_toggle == 'vaccines') val = (Math.round(d.cumulative_vaccines));             \n            }\n            var i = d3.interpolate(Math.floor((Math.random() * 2346) + 9345), val);\n            return function(t) {\n              d3.select(this).text(addCommas(Math.round(i(t))));\n            };\n          })\n        .attr('x', function(d,i){\n            var id = d3.select(this).attr('data-id');\n            var d;\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases_per_100k)+labelWidth+5;\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths_per_100k)+labelWidth+5;\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines_per_100k)+labelWidth+5;\n            } else {\n                if(options.region_chart_toggle == 'cases') val = xScaleCases(d.cumulative_cases)+labelWidth+5;\n                if(options.region_chart_toggle == 'deaths') val = xScaleDeaths(d.cumulative_deaths)+labelWidth+5;\n                if(options.region_chart_toggle == 'vaccines') val = xScaleVaccines(d.cumulative_vaccines)+labelWidth+5;               \n            }\n            return val;\n        })\n        .attr('opacity', function(d,i){\n            var d;\n            var id = d3.select(this).attr('data-id');\n            groupedData.forEach(function(dd,ii){\n                if(dd.code == id){\n                    d = dd;\n                }\n            })\n            var val = 0;\n            if(options.region_switch=='per100'){\n                if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases_per_100k);\n                if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths_per_100k);\n                if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines_per_100k);\n            } else {\n                if(options.region_chart_toggle == 'cases') val = (d.cumulative_cases);\n                if(options.region_chart_toggle == 'deaths') val = (d.cumulative_deaths);\n                if(options.region_chart_toggle == 'vaccines') val = (d.cumulative_vaccines);\n            }\n            if(val>0){ return 1 } else { return 0}\n        })\n\n    }\n\n}\n\nexport default drawRegionchart;\n","import * as d3 from \"d3\";\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {updateRegionchart} from './Regionchart';\nimport colors from './colors';\nimport tippy from 'tippy.js';\nimport 'tippy.js/dist/svg-arrow.css';\nimport 'tippy.js/themes/light.css';\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from 'html2canvas';\n\nconst selectedToggle = '#595454';\nconst unselectedToggle = '#EAEAEA';\nconst unselectedToggleText = '#000';\nconst selectedToggleText = '#FFF';\n\nfunction Layout(svg, options, data, filter, updateTable, updateMap) {\n\n  // vaccine info\n  d3.select('#vaccine_tooltip').attr('opacity', 0).style('display', 'none');\n  d3.select('#vaccine_info path').attr('fill', colors.black);\n\n  svg.select('#vaccine_info').style('cursor', 'pointer')\n  .on('mouseover', function(event, bd){\n    d3.select('#svg_container').style('z-index', 10);\n    d3.select('#vaccine_tooltip').style('display', 'inline').transition().duration(500).attr('opacity', 1);\n    d3.select('#vaccine_info path').transition().duration(200).attr('fill', colors.blue);\n  }).on('mouseout', function(event, d){\n    d3.select('#svg_container').style('z-index', 1);\n    d3.select('#vaccine_tooltip').style('display', 'none').attr('opacity', 0);\n    d3.select('#vaccine_info path').transition().duration(500).attr('fill', colors.black);\n  })\n\n  // region chart toggle\n  svg.select('#region_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n    options.region_filter = []; \n    filter('clear-region');\n  });\n\n  svg.select('#region_switch').style('cursor', 'pointer').on('click', function(d,i){\n    if(options.region_switch=='total'){\n      options.region_switch = 'per100';\n      d3.select('#region_switch_toggle').transition().duration(200).attr('x', 15.1);\n    } else {\n      options.region_switch = 'total';\n      d3.select('#region_switch_toggle').transition().duration(200).attr('x', 3.1);\n    }\n    updateRegionchart(options,data);\n  })\n\n  svg.select('#region-chart-toggle #region-chart-toggle-cases').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'cases') return false;\n    options.region_chart_toggle = 'cases';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-cases rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-cases text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  svg.select('#region-chart-toggle #region-chart-toggle-deaths').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'deaths') return false;\n    options.region_chart_toggle = 'deaths';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-deaths rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-deaths text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  svg.select('#region-chart-toggle #region-chart-toggle-vaccines').style('cursor', 'pointer').on('click', function(d){\n    if(options.region_chart_toggle === 'vaccines') return false;\n    options.region_chart_toggle = 'vaccines';\n    svg.selectAll('#region-chart-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#region-chart-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#region-chart-toggle-vaccines rect').attr('fill', selectedToggle);\n    svg.select('#region-chart-toggle-vaccines text').attr('fill', selectedToggleText);\n    updateRegionchart(options,data);\n  });\n\n  // map toggle\n  svg.select('#map-toggle #map-toggle-bi-weekly-change').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'bi-weekly-change') return false;\n    options.map_toggle = 'bi-weekly-change';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-bi-weekly-change rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-bi-weekly-change text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-cases').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'cases') return false;\n    options.map_toggle = 'cases';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-cases rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-cases text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-deaths').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'deaths') return false;\n    options.map_toggle = 'deaths';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-deaths rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-deaths text').attr('fill', selectedToggleText);\n    // update map legend\n\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-percent-fully-vaccinated').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'percent-fully-vaccinated') return false;\n    options.map_toggle = 'percent-fully-vaccinated';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-percent-fully-vaccinated rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-percent-fully-vaccinated text').attr('fill', selectedToggleText);\n    // update map legend\n    updateMap(data, options, 700);\n  });\n\n  svg.select('#map-toggle #map-toggle-percent-vaccine-acceptance').style('cursor', 'pointer').on('click', function(d){\n    if(options.map_toggle === 'percent-vaccine-acceptance') return false;\n    options.map_toggle = 'percent-vaccine-acceptance';\n    svg.selectAll('#map-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#map-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#map-toggle-percent-vaccine-acceptance rect').attr('fill', selectedToggle);\n    svg.select('#map-toggle-percent-vaccine-acceptance text').attr('fill', selectedToggleText);\n    // update map legend\n    updateMap(data, options, 700);\n  });\n\n    // time chart type \n    svg.select('#timechart-type-toggle #timechart-type-toggle-cumulative').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'cumulative') return false;\n      options.timeline_type = 'cumulative';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-cumulative rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-cumulative polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggle);\n      updateTimechart(data, options);\n    });\n  \n    tippy('#timechart-type-toggle-cumulative', {\n      content: 'Cumulative',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n    svg.select('#timechart-type-toggle #timechart-type-toggle-non-cumulative').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'non-cumulative') return false;\n      options.timeline_type = 'non-cumulative';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-non-cumulative rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-non-cumulative polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggle);\n      updateTimechart(data, options);\n    });\n\n    tippy('#timechart-type-toggle-non-cumulative', {\n      content: 'Non-cumulative',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n    svg.select('#timechart-type-toggle #timechart-type-toggle-stacked').style('cursor', 'pointer').on('click', function(d){\n      if(options.timeline_type === 'stacked') return false;\n      options.timeline_type = 'stacked';\n      svg.selectAll('#timechart-type-toggle rect').attr('fill', unselectedToggle);\n      svg.selectAll('#timechart-type-toggle polyline').attr('stroke', unselectedToggleText);\n      svg.select('#timechart-type-toggle-stacked rect').attr('fill', selectedToggle);\n      svg.select('#timechart-type-toggle-stacked polyline').attr('stroke', selectedToggleText);\n      svg.selectAll('#timechart-type-toggle-stacked polygon').attr('fill', selectedToggleText);\n      updateTimechart(data, options);\n    });\n\n    tippy('#timechart-type-toggle-stacked', {\n      content: 'Stacked 100%',\n      duration: 0,\n      placement: 'bottom',\n      theme: 'light',\n      arrow: true,\n      delay: [500, 200],\n    });\n\n  // time chart frequency toggle\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-day').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'day') return false;\n    options.timeline_frequency = 'day';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-day rect').attr('fill', selectedToggle);\n    svg.select('#timechart-frequency-toggle-day text').attr('fill', selectedToggleText);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('DAY');\n    drawTimechart(data, options);\n  });\n\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-week').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'week') return false;\n    options.timeline_frequency = 'week';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-week rect').attr('fill', selectedToggle);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('WEEK');\n    svg.select('#timechart-frequency-toggle-week text').attr('fill', selectedToggleText);\n    drawTimechart(data, options);\n  });\n\n  svg.select('#timechart-frequency-toggle #timechart-frequency-toggle-month').style('cursor', 'pointer').on('click', function(d){\n    if(options.timeline_frequency === 'month') return false;\n    options.timeline_frequency = 'month';\n    svg.selectAll('#timechart-frequency-toggle rect').attr('fill', unselectedToggle);\n    svg.selectAll('#timechart-frequency-toggle text').attr('fill', unselectedToggleText);\n    svg.select('#timechart-frequency-toggle-month rect').attr('fill', selectedToggle);\n    svg.select('#tooltip_frequency tspan').attr('text-anchor', 'end').attr('dx', 20).text('MONTH');\n    svg.select('#timechart-frequency-toggle-month text').attr('fill', selectedToggleText);\n    drawTimechart(data, options);\n  });\n\n    // HDI toggle\n\n    svg.select('#hdi_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n      d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);\n      filter('clear-hdi');\n    });\n\n    svg.select('#hdi-toggle #hdi-toggle-very-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'very-high');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n\n    svg.select('#hdi-toggle #hdi-toggle-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'high');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n    svg.select('#hdi-toggle #hdi-toggle-medium').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'medium');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1); }\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n    svg.select('#hdi-toggle #hdi-toggle-low').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.hdi_filter, 'low');\n      if(options.hdi_filter.length === 4) { options.hdi_filter = []; d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length === 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 1);}\n      else if(options.hdi_filter.length > 0) { d3.selectAll('#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low').attr('opacity', 0.3);}\n      if(options.hdi_filter.length > 0){\n        options.hdi_filter.forEach(function(d,i){\n          d3.select('#hdi-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('hdi');\n    });\n\n    // inform severity toggle\n\n    svg.select('#inform_remove_filter').attr('opacity', 0).style('cursor', 'pointer').on('click', function(d,i){\n      d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);\n      filter('clear-inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-no-score').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'no-score');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-low').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'low');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-medium').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'medium');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'high');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n\n    svg.select('#inform-toggle #inform-toggle-very-high').style('cursor', 'pointer').on('click', function(d){\n      toggle(options.inform_filter, 'very-high');\n      if(options.inform_filter.length === 5) { options.inform_filter = []; d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length === 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 1);}\n      else if(options.inform_filter.length > 0) { d3.selectAll('#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score').attr('opacity', 0.3);}\n      if(options.inform_filter.length > 0){\n        options.inform_filter.forEach(function(d,i){\n          d3.select('#inform-toggle-'+d).attr('opacity', 1);\n        })\n      }\n      filter('inform');\n    });\n  \n  // tabs\n\n  d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n  d3.select('#vac-tab').attr('opacity', 1).select('#vac-tab-content').attr('display', 'inline');\n  d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n  d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  svg.select('#tabs #vaccination-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'vaccination-data') return false;\n    options.tab_toggle = 'vaccination-data';\n    d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n    d3.select('#vac-tab').attr('opacity', 1).select('#vac-tab-content').attr('display', 'inline');\n    d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#vaccination-tab rect').attr('fill', selectedToggle);\n    svg.select('#vaccination-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  });\n\n  svg.select('#tabs #indicators-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'indicators') return false;\n    options.tab_toggle = 'indicators';\n    d3.select('#additional-indicators-tab').attr('opacity', 1).select('#additional-indicators-tab-content').attr('display', 'inline');\n    d3.select('#vac-tab').attr('opacity', 0).select('#vac-tab-content').attr('display', 'none');\n    d3.select('#bubblechart-tab').attr('opacity', 0).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'none');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#indicators-tab rect').attr('fill', selectedToggle);\n    svg.select('#indicators-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'none');\n\n  });\n\n  svg.select('#tabs #bubble-chart-tab').style('cursor', 'pointer').on('click', function(d){\n    if(options.tab_toggle === 'bubble-chartt') return false;\n    options.tab_toggle = 'bubble-chart';\n    d3.select('#additional-indicators-tab').attr('opacity', 0).select('#additional-indicators-tab-content').attr('display', 'none');\n    d3.select('#vac-tab').attr('opacity', 0).select('#vac-tab-content').attr('display', 'none');\n    d3.select('#bubblechart-tab').attr('opacity', 1).selectAll('#bubblechart, #bubblechart-tab-content').attr('display', 'inline');\n    svg.selectAll('#tabs rect').attr('fill', unselectedToggle);\n    svg.selectAll('#tabs text').attr('fill', unselectedToggleText);\n    svg.select('#bubble-chart-tab rect').attr('fill', selectedToggle);\n    svg.select('#bubble-chart-tab text').attr('fill', selectedToggleText);\n    d3.select('#bubbleSelectContainer').style('display', 'inline-block');\n\n  });\n\n  // time chart mask\n    d3.select('#svg defs').append('clipPath').attr('id', 'mask')\n    .append('rect')\n    .attr('y', 340)\n    .attr('height', 590)\n    .attr('width', 660)\n    .attr('x', 22);\n\n  \n  // append timechart svg\n  const timechartContainer = svg.select('#timechart_container').attr('opacity', 0);\n  const tcSize = {\n    x: timechartContainer.attr('x'), y: timechartContainer.attr('y'), width: timechartContainer.attr('width'), height: timechartContainer.attr('height')\n  }\n\n  const timechartSvg = svg.append('svg').attr('id', 'timechart_svg').attr('viewBox', '0 0 '+2000 +' '+ tcSize.height)\n  .attr('preserveAspectRatio', \"none\")\n  .attr('x', tcSize.x)\n  .attr('y', tcSize.y)\n  .attr('width', tcSize.width)\n  .attr('height', tcSize.height)\n\n  const layer1 = timechartSvg\n  .append('g')\n  .attr('id', 'layer1')\n\n  const timechartBg = timechartSvg.append('g').attr('id', 'layer0');\n\n  layer1.append('rect')\n  .attr('x', 0)\n  .attr('y', 0)\n  .attr('width', '100%')\n  .attr('height', '100%')\n  .attr('opacity', 0)\n  .style('fill', 'transparent');\n  \n  // table bars\n\n  var tableRowHeight = 18;\n  var tableBarYOffset = 68;\n\n  for(let i = 0; i < 10; i++){\n\n    // col 1 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col1bg colbg')\n    .attr('id','col1bg'+i)\n    .attr('x', 120)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 1 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col1bar')\n    .attr('id','col1bar'+i)\n    .attr('x', 120)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 2 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col2bg colbg')\n    .attr('id','col2bg'+i)\n    .attr('x', 230)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 2 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col2bar')\n    .attr('id','col2bar'+i)\n    .attr('x', 230)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 3 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col3bg colbg')\n    .attr('id','col3bg'+i)\n    .attr('x', 340)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 3 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col3bar')\n    .attr('id','col3bar'+i)\n    .attr('x', 340)\n    .attr('y', function(){\n      return tableBarYOffset+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    // col 4 bg\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col4bg colbg')\n    .attr('id','col4bg'+i)\n    .attr('x', 454)\n    .attr('y', function(){\n      return 67+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 68)\n    .attr('fill', colors.lightgrey)\n\n    // col 3 bar\n    d3.select('#vac-tab').append('rect')\n    .attr('class','col4bar')\n    .attr('id','col4bar'+i)\n    .attr('x', 454)\n    .attr('y', function(){\n      return 67+(i*24.8);\n    })\n    .attr('height', tableRowHeight)\n    .attr('width', 0)\n    .attr('fill', colors.blue);\n\n    for(var x = 0; x<6; x++){\n      d3.select('#col'+x+'_sort_desc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort_asc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort').style('cursor', 'pointer')\n      .on('click', function(){\n        var thisId = d3.select(this).attr('id');\n        if(options.table_sort==thisId){\n          if(options.table_sort_direction=='desc'){\n            options.table_sort_direction = 'asc';\n          } else {\n            options.table_sort_direction = 'desc';\n          }\n        } else {\n          options.table_sort = thisId;\n          options.table_sort_direction = 'desc';\n        }\n        options.page = 1;\n        updateTable(data, options);\n    })\n    // d3.select('#col1_sort_desc').attr('opacity', 1);\n    }\n  }\n\n  d3.select('#reset_locations').attr('display', 'none');\n\n  printCopySave();\n\n}\n\n// print copy save\n\nvar printing;\n\nfunction printCopySave(){\n\n  tippy('#button-png', {\n    content: 'Save as PNG',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  tippy('#button-copy', {\n    content: 'Copy to clipboard',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  tippy('#button-print', {\n    content: 'Print to PDF',\n    duration: 0,\n    placement: 'bottom',\n    theme: 'light',\n    arrow: true,\n    delay: [500, 200],\n  });\n\n  d3.select('#button-print').on('click', function(){\n\n    if(printing) return false;\n    printing = true;\n\n    setTimeout(function(){\n      html2canvas(document.querySelector(\"#root\"),{\n            allowTaint: true,\n            onclone: function(doc){\n\n            },\n            useCORS: false,\n            foreignObjectRendering: true,\n            ignoreElements: function(element){\n              // if(element.id=='adm-toggle') return true;\n              // if($(element).hasClass('select2')) return true;\n            return false;\n            },\n            scale: 2,\n            x: 0,\n            y: 0,\n            scrollX: 0,\n            scrollY: 0,\n            logging: false\n        }).then(canvas => {\n          var img = canvas.toDataURL(\"image/png\");\n          var pdf = new jsPDF(\"l\", \"mm\", \"a4\");\n          var imgProps= pdf.getImageProperties(img);\n          var pdfWidth = pdf.internal.pageSize.getWidth();\n          var pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;\n          pdf.addImage(img, 'JPEG', 10, 10, pdfWidth-20, pdfHeight-30);\n          pdf.save('deep-pdf-export.pdf');\n          printing = false;\n      },200);\n    });\n  });\n\n  d3.select('#button-png').on('click',function(){\n\n    if(printing) return false;\n    printing = true;\n\n    setTimeout(function(){\n      html2canvas(document.querySelector(\"#root\"),{\n            allowTaint: true,\n            onclone: function(doc){\n\n            },\n            useCORS: false,\n            foreignObjectRendering: true,\n            ignoreElements: function(element){\n              // if(element.id=='adm-toggle') return true;\n              // if($(element).hasClass('select2')) return true;\n            return false;\n            },\n            scale: 2,\n            x: 0,\n            y: 0,\n            scrollX: 0,\n            scrollY: 0,\n            logging: false\n        }).then(canvas => {\n\n      var img = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n      var link = document.createElement('a');\n      link.download = 'dashboard-export.png';\n      link.href = img;\n      link.click();\n      link.remove();\n\n      printing = false;\n      },200);\n    });\n  });\n\n  \n//   d3.select('#button-copy').on('click',function(){\n\n//     if(printing) return false;\n//     printing = true;\n\n//     setTimeout(function(){\n//       html2canvas(document.querySelector(\"#root\"),{\n//             allowTaint: true,\n//             onclone: function(doc){\n\n//             },\n//             useCORS: false,\n//             foreignObjectRendering: true,\n//             ignoreElements: function(element){\n//               // if(element.id=='adm-toggle') return true;\n//               // if($(element).hasClass('select2')) return true;\n//             return false;\n//             },\n//             scale: 1.8,\n//             windowWidth: 2800,\n//             windowHeight: 2000,\n//             logging: false\n//         }).then(canvas => {\n//           canvas.toBlob(blob, function(){\n//             navigator.clipboard.write([\n//               new ClipboardItem({\n//                 [blob.type]: blob\n//               })\n//             ]).then(() => {\n\n//             })\n//           })\n//         // copied to clipboard\n//         printing = false;\n//       });\n//       },200);\n//     });\n}\n\n\nexport default Layout;\n\nfunction toggle(collection, item) {\n  var idx = collection.indexOf(item);\n  if (idx !== -1) {\n    collection.splice(idx, 1);\n  } else {\n    collection.push(item);\n  }\n}\n\n/*\n\n#timechart-type-toggle #timechart-type-toggle-stacked\n#timechart-type-toggle #timechart-type-toggle-non-cumulative\n#timechart-type-toggle #timechart-type-toggle-cumulative\n\n#timechart-frequency-toggle #timechart-frequency-toggle-day\n#timechart-frequency-toggle #timechart-frequency-toggle-week\n#timechart-frequency-toggle #timechart-frequency-toggle-month\n\n#map-toggle #map-toggle-bi-weekly-change\n#map-toggle #map-toggle-deaths\n#map-toggle #map-toggle-percent-fully-vaccinated\n#map-toggle #map-toggle-percent-vaccine-acceptance\n#map-toggle #map-toggle-cases\n\n#tabs #bubble-chart-tab\n#tabs #indicators-tab\n#tabs #vaccination-tab\n\n#hdi-toggle #hdi-toggle-very-high\n#hdi-toggle #hdi-toggle-high\n#hdi-toggle #hdi-toggle-medium\n#hdi-toggle #hdi-toggle-low\n\n\n#inform-toggle #inform-toggle-no-score\n#inform-toggle #inform-toggle-low\n#inform-toggle #inform-toggle-medium\n#inform-toggle #inform-toggle-high\n#inform-toggle #inform-toggle-very-high\n\n*/","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxX =1000;\nlet maxY = 100;\nlet maxZ = 1000000;\nlet xScale; \nlet yScale; \nlet zScale; \nlet groupedData = [];\nlet width = 600;\nlet height = 233;\nlet x = 35;\nlet y = 58;\nlet bubbles;\n\nexport function drawBubblechart(data, options, filter) {\n\n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        // if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return 100;\n        // if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return 100;\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return 100;\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]).nice();\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart-tab').append('g').attr('transform', 'translate('+x+', '+y+')')\n    .attr('id', 'bubblechart');\n\n    // create y-axis\n    svg.append(\"g\")\n    .attr('id', 'bubbley')\n    .call(d3.axisLeft(yScale).ticks(3).tickSize(3));\n\n    // create x-axis\n    svg.append(\"g\")\n    .attr('id', 'bubblex')\n    .attr('class', 'xAxis')\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(xScale).ticks(4).tickSize(3));\n\n    // Add dots\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        }).attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    d3.select('#bubblechart_tooltip').attr('display', 'none');\n\n    d3.select('#bubble_y_axis_label').attr('text-anchor', 'middle').select('tspan').attr('dx', 50);\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n\n\n}\n\nexport function updateBubblechart(data,options,filter) {\n    \n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccine_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart');\n\n    // create y-axis\n    svg.select('#bubbley')\n    .transition().duration(800)\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.select('#bubblex')\n    .transition().duration(800)\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"cx\", function (d) { return xScale(maxX)})\n        .attr(\"cy\", function (d) { return yScale(maxY)})\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .transition().duration(800)\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            if(yScale.invert(val)==0) return 'none';\n            return 'inline';\n        }).attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        \n        \n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n    \n    \n\n\n}\n\nexport default drawBubblechart;\n","// default options\nconst options = {\n    region_chart_toggle: 'cases', // cases, deaths, vaccines\n    region_switch: 'total', // total, per100\n    region_filter: [],\n    country_filter: [],\n    hdi_filter: [], // very-high, high, medium, low\n    inform_filter: [], // no-score, low, medium, high, very-high\n    timeline_type: 'non-cumulative', // cumulative, non-cumulative, stacked \n    timeline_frequency: 'week', // day, week, month\n    map_toggle: 'cases', // bi-weekly-change, cases, deaths, percent-fully-vaccinated, percent-vaccine-acceptance\n    tab_toggle: 'vaccination-data', // vaccination-data, indicators, bubble-chart\n    table_sort: 'col1_sort',\n    table_sort_direction: 'desc',\n    bubble_chart_color_by: 'hdi', // hdi, inform-severity, region\n    bubble_chart_y_axis: 'percent-vaccinated-at-least-1-dose', // percent-vaccinated-at-least-1-dose, percent-fully-vaccinated, percent-vaccine-acceptance\n    brushL: 0,\n    brushR: 600,\n    page: 1,\n    numPages: 1\n}\n\nexport default options;\n","import {min,max,group,flatGroup} from \"d3\";\nimport moment from 'moment';\nimport clone from 'just-clone';\nimport { data } from \"jquery\";\n\nexport function ParseData(data, options) {\n\n    //*********************\n    // create regions\n    //*********************\n    data.regions = [\n        {sort: 5, 'code': 'AF', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 3, 'code': 'ME', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 4, 'code': 'AP', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 2, 'code': 'EU', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 1, 'code': 'AM', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0},\n        {sort: 6, 'code': 'OTH', cumulative_cases: 0, cumulative_deaths: 0, cumulative_vaccines: 0, population: 0}\n    ]\n\n    data.regions.sort(function(a,b){\n        return (a.sort) - (b.sort);\n    });\n\n    //*********************\n    // clean up country data\n    //*********************\n    data.ns_involvement = [];\n    data.country = data.equity_data;\n    data.country.forEach(function(d,i){\n\n        // if not an IFRC region then set to OTH\n        if((d.ifrc_region!='AF')&&(d.ifrc_region!='ME')&&(d.ifrc_region!='AP')&&(d.ifrc_region!='EU')&&(d.ifrc_region!='AM')){\n            d.ifrc_region = 'OTH';\n        }\n        \n        // parse country population\n        d.population = parseInt(d.population)||0;\n        var pop = 0;\n        if(d.population>0) pop = d.population;\n\n        // sum up ifrc region population \n        data.regions.forEach(function(dd,ii){\n            if(dd.code==d.ifrc_region){\n                dd.population += pop\n            }\n        });\n\n        // get WHO vaccine data (vaccine types used, vaccines_per_100\n        d.vaccines_used = [];\n        d.avg_tests_per_1000 = parseFloat(d.avg_tests_per_1000)||0;\n        d.number_vaccine_types_used = 0;\n        d.vaccines_per_100 = 0;\n        d.number_vaccine_types_used = parseInt(d.avg_tests_per_1000);\n        data.vaccines_who_data.forEach(function(dd,ii){\n            if(d.country_iso3==dd.ISO3){\n                // d.data_updated = moment(dd.DATE_UPDATED).startOf('day').toDate();\n                d.number_vaccine_types_used = parseInt(dd.NUMBER_VACCINES_TYPES_USED);\n                d.vaccines_per_100 = parseFloat(dd.TOTAL_VACCINATIONS_PER100);\n                if(isNaN(d.vaccines_per_100))d.vaccines_per_100 = 0;\n                d.vaccines_used = dd.VACCINES_USED.split(',').map(function(item) {\n                    return item.trim();\n                  });\n            }\n        })\n\n        // get ns involvement in activities\n        d.ns_involvement = 0;\n        data.self_assessment.forEach(function(dd,ii){\n            if((d.country_iso3==dd.ISO3)&&(d.country_iso3!='')){\n                if(dd['Final involvement']=='Yes') {\n                    d.ns_involvement = 1;\n                    data.ns_involvement.push(d.country_iso3);\n                }\n            }\n        });\n\n        d.vaccine_acceptance_percent = 0;\n        // get vaccine acceptance\n        data.vaccine_acceptance.forEach(function(dd,ii){\n            if(d.country_iso3==dd.iso3){\n                // if(dd['Final involvement']=='Yes') d.ns_involvement = 1;\n                d.vaccine_acceptance_percent = parseFloat(dd.indicator_value)*100;\n                d.vaccine_acceptance_population = parseInt(dd.population_size);\n            }\n        })\n\n        // get contrat tracing\n        if((d.contract_tracing.toLowerCase()=='all')||(d.contract_tracing.toLowerCase()=='some')){\n            d.contract_tracing = 1;\n        } else {\n            d.contract_tracing = 0\n        }\n\n        // parse equity data inform/hdi indexes\n        if(d.hdi_category.match(/very high/i)){\n            d.hdi_category = 'very-high'\n        }\n        else if(d.hdi_category.match(/high/i)){\n            d.hdi_category = 'high'\n        }\n        else if(d.hdi_category.match(/medium/i)){\n            d.hdi_category = 'medium'\n        }\n        else if(d.hdi_category.match(/low/i)){\n            d.hdi_category = 'low'\n        }\n        if(d.inform_severity.match(/very high/i)){\n            d.inform_severity = 'very-high'\n        }\n        else if(d.inform_severity.match(/high/i)){\n            d.inform_severity = 'high'\n        }\n        else if(d.inform_severity.match(/medium/i)){\n            d.inform_severity = 'medium'\n        }\n        else if(d.inform_severity.match(/low/i)){\n            d.inform_severity = 'low'\n        }\n        else if(d.inform_severity.match(/no/i)){\n            d.inform_severity = 'no-score'\n        }\n\n    });\n\n    //*********************\n    // get min/max dates\n    //*********************\n\n    // get min and max dates from daily who data\n    let maxDate = moment(new Date(max(data.who_data, function(d){\n        return d.Date_reported;\n    }))).startOf('day');\n\n    // override min date to week start\n    data.min_date = moment('2019-12-31').startOf('day').toDate();\n\n    let maxDateVaccines = moment(new Date(max(data.vaccines_data, function(d){\n        return d.date;\n    }))).startOf('day');\n\n    data.min_vaccine_date = moment(new Date(min(data.vaccines_data, function(d){\n        return d.date;\n    }))).startOf('day').toDate();\n\n    data.max_vaccine_date = maxDateVaccines.toDate();\n\n    if(maxDateVaccines.unix()>maxDate.unix()) {\n        maxDate = maxDateVaccines;\n    }\n\n    data.max_date = maxDate.toDate();\n\n    //*********************\n    // parse who data\n    //*********************\n\n    data.who_data.forEach(function(d,i){\n        // parse dates\n        d.date = moment(d.Date_reported).startOf('day').toDate();\n        // override country name and code\n        d.country_code = d.Country_code;\n        d.country_name = null;\n        data.country.forEach(function(dd,ii){\n            if(dd.country_iso2===d.country_code){\n                d.ifrc_region = dd.ifrc_region;\n                d.country_name = dd.country_name;\n            }\n        })\n\n        // parse cases and deaths\n        d.cumulative_deaths = parseInt(d.Cumulative_deaths);\n        d.cumulative_cases = parseInt(d.Cumulative_cases);\n        d.new_cases = parseInt(d.New_cases);\n        d.new_deaths = parseInt(d.New_deaths);\n        \n    });\n\n    // sort by date\n    data.who_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.Date_reported);\n    });\n    \n    //*************************\n    // check for missing who dates and fill in the max date\n    //*************************\n\n    // group by country\n    var whoDataGrouped = flatGroup(data.who_data, d => d.country_code);\n\n    var datesToAdd = [];\n\n    whoDataGrouped.forEach(function(d,i){\n        \n        var maxDate = moment(max(d[1], d=>d.date)).startOf('day');\n        \n        var lastRecord = clone(d[1][d[1].length-1]);\n\n        if(maxDate.unix()!=data.max_date.getTime()){\n            lastRecord.date = new Date(data.max_date);\n            lastRecord.new_cases = 0;\n            lastRecord.new_deaths = 0;\n            datesToAdd.push(lastRecord);\n        }\n\n    })\n\n    data.who_data.push(...datesToAdd);\n\n    data.who_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // set count for incremental day/week/month numbers\n    let dayTotal = -1;\n    let dayCheck = 0;\n    let weekTotal = -1;\n    let weekCheck = -1;\n    let monthTotal = 0;\n    let monthCheck = 0;\n\n    // parse and clean up WHO data\n    let whoCountryCodes = [];\n    data.who_data.forEach(function(d,i){\n        // parse dates\n        // d.date = moment(d.Date_reported).startOf('day').toDate();\n        d.dayOfYear =  moment(d.date).dayOfYear();\n        if(d.dayOfYear!==dayCheck) dayTotal++;\n        d.dayTotal = dayTotal;\n        d.week = moment(d.date).isoWeek();\n        if(d.week!==weekCheck) weekTotal++;\n        d.weekTotal = weekTotal;\n        d.month = d.date.getMonth();\n        if(d.month!==monthCheck) monthTotal++;\n        d.monthTotal = monthTotal;\n        d.year = d.date.getFullYear();\n        d.week_start = new Date(moment(d.date).startOf('isoWeek').startOf('day').toDate());\n        d.month_start = new Date(moment(d.date).startOf('month').startOf('day').toDate());\n\n        // set negative values to zero for new cases/deaths\n        if(d.new_deaths<0)d.new_deaths = 0;\n        if(d.new_cases<0)d.new_cases = 0;\n\n        if(d.ifrc_region==undefined) d.ifrc_region = 'OTH';\n\n        // add country code to array so we know it is used\n        if((!whoCountryCodes.includes(d.country_code))&&(d.country_code.length>1)) {\n            whoCountryCodes.push(d.country_code);\n        }\n\n        // delete old unused keys\n        delete d.Date_reported;\n        delete d.Country;\n        delete d.New_cases;\n        delete d.New_deaths;\n        delete d.Country_code;\n        delete d.Cumulative_deaths;\n        delete d.Cumulative_cases;\n        delete d.Country_code;\n        delete d.WHO_region;\n        delete d.Country;\n        \n        // set incremental count\n        dayCheck = d.dayOfYear;\n        weekCheck = d.week;\n        monthCheck = d.month;\n    })\n   \n    //*********************\n    // parse vaccine cumulative data\n    //*********************\n\n    // clean up values\n    data.vaccines_data.forEach(function(d,i){\n        d.date = moment(d.date).startOf('day').toDate();\n    });\n    \n    data.vaccines_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // filter out vaccine data to only include records with ISO3 country codes\n    data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        return d.iso_code.length===3 && d.total_vaccinations > 0;\n    })\n\n    var vaccineDataByCountry = flatGroup(data.vaccines_data, d => d.iso_code);\n\n    // fill out missing vaccinations date records (extend cumulative from last data date)\n    var newDays = [];\n    var hasDays = [];\n    var lastRecord = {};\n    var vDataFlat = [];\n\n    vaccineDataByCountry.forEach(function(d,i){\n\n        var minDt = new Date(data.min_date);\n        var maxDt = new Date(data.max_date);\n\n        hasDays = [];\n        newDays = [];\n\n        // set the last recorded date fo this country\n        d.lastDate = moment(max(d[1], function(d,i){ return d.date })).startOf('day').toDate();\n        \n        // reset country name and code using country table\n        data.country.forEach(function(dd,ii){\n            if(dd.country_iso3===d[0]){\n                d.ifrc_region = dd.ifrc_region;\n                d.country_name = dd.country_name;\n                d.country_code = dd.country_iso2;\n                dd.data_updated = d.lastDate;\n\n            }\n        })\n\n        // loop through all date records for this country and add to hasDays array\n        d[1].forEach(function(dd,ii){\n            dd.total_vaccinations = parseInt(dd.total_vaccinations);\n            dd.daily_vaccinations = parseInt(dd.daily_vaccinations);\n            hasDays.push(new Date(dd.date).getTime());\n        })\n\n        // fill in missing dates\n        // d[1].forEach(function(dd,ii){\n            for (var day = new Date(data.min_vaccine_date);day <= data.max_date; day.setDate(day.getDate() + 1)) {\n                var newDay = new Date(day).getTime();\n                if(!hasDays.includes(newDay)){\n                    newDays.push({date: new Date(day), total_vaccinations: null, daily_vaccinations: 0})\n                }\n            }\n        // });\n\n        d[1].push(...newDays);\n        d[1].sort(function(a,b){\n            return new Date(a.date) - new Date(b.date);\n        });\n\n        // loop through dates and fill in missing cumulative values\n        var totalVac = 0;\n        var totalVac100 = 0;\n        var people_vaccinated_per_hundred = 0;\n        var people_fully_vaccinated_per_hundred = 0;\n        d[1].forEach(function(dd,ii){\n            if(dd.total_vaccinations){\n                totalVac = dd.total_vaccinations;\n            } else {\n                dd.total_vaccinations = totalVac;\n            }\n            if(dd.total_vaccinations_per_hundred){\n                totalVac100 = dd.total_vaccinations_per_hundred\n            } else {\n                dd.total_vaccinations_per_hundred = totalVac100;\n            }\n            if(dd.people_vaccinated_per_hundred){\n                people_vaccinated_per_hundred = dd.people_vaccinated_per_hundred;\n            } else {\n                dd.people_vaccinated_per_hundred = people_vaccinated_per_hundred;\n            }\n            if(dd.people_fully_vaccinated_per_hundred){\n                people_fully_vaccinated_per_hundred = dd.people_fully_vaccinated_per_hundred;\n            } else {\n                dd.people_fully_vaccinated_per_hundred = people_fully_vaccinated_per_hundred;\n            }\n\n            var countryName;\n            if(d.country_name==null) { countryName = d[0];\n            } else {\n                countryName = d.country_name\n            }\n            var dailyVac = 0;\n            if((dd.daily_vaccinations)&&(dd.daily_vaccinations>0)) dailyVac = dd.daily_vaccinations;\n\n            vDataFlat.push({\n                date: new Date(dd.date),\n                lastDate: d.lastDate,\n                total_vaccinations_per_hundred: parseFloat(totalVac100),\n                people_vaccinated_per_hundred: parseFloat(people_vaccinated_per_hundred),\n                people_fully_vaccinated_per_hundred: parseFloat(people_fully_vaccinated_per_hundred),\n                iso_code: d[0], \n                ifrc_region: d.ifrc_region,\n                country_name: countryName,\n                country_code: d.country_code, \n                total_vaccinations: totalVac,\n                daily_vaccinations: dailyVac\n            })\n        })\n    });\n\n    data.vaccines_data = vDataFlat;\n\n    data.vaccines_data.sort(function(a,b){\n        return new Date(a.date) - new Date(b.date);\n    });\n\n    // reset count for incremental day/week/month numbers\n    dayTotal = -1;\n    dayCheck = 0;\n    weekTotal = -1;\n    weekCheck = -1;\n    monthTotal = 0;\n    monthCheck = 0;\n    \n    data.vaccines_data.forEach(function(d,i){\n        if(d.ifrc_region==undefined) d.ifrc_region = 'OTH';\n        d.dayOfYear =  moment(d.date).dayOfYear();\n        if(d.dayOfYear!==dayCheck) dayTotal++;\n        d.dayTotal = dayTotal;\n        d.week = moment(d.date).isoWeek();\n        if(d.week!==weekCheck) weekTotal++;\n        d.weekTotal = weekTotal;\n        d.month = d.date.getMonth();\n        if(d.month!==monthCheck) monthTotal++;\n        d.monthTotal = monthTotal;\n        d.year = d.date.getFullYear();\n        dayCheck = d.dayOfYear;\n        weekCheck = d.week;\n        monthCheck = d.month;\n        d.week_start = new Date(moment(d.date).startOf('isoWeek').toDate());\n        d.month_start = new Date(moment(d.date).startOf('month').toDate());\n    })\n\n    //*********************\n    // add most recent owid vaccine data record to data.country\n    //*********************\n\n    // group who data by country\n    var vaccineDataByCountry = flatGroup(data.vaccines_data, d => d.country_code);\n\n    //*********************\n    // add most recent records from both datasets to data.country\n    //*********************\n\n    // first group who data by country\n    var whoDataByCountry = flatGroup(data.who_data, d => d.country_code);\n\n    data.country.forEach(function(d,i){\n        d.cumulative_cases_per_100k = 0;\n        d.cumulative_deaths_per_100k = 0;\n        d.cumulative_vaccines_per_100k = 0;\n        d.people_fully_vaccinated_per_hundred = 0;\n        d.people_vaccinated_per_hundred = 0;\n        d.total_vaccinations_per_hundred = 0;\n        var countryCode = d.country_iso2;\n\n        // calculate latest date and at weekly intervals (for bi-weekly percent change calculation)\n        whoDataByCountry.forEach(function(dd,ii){\n            if(dd[0]==countryCode){\n                d.who_daily_latest = dd[1][dd[1].length-1];\n                d.who_daily_7_days = dd[1][dd[1].length-8];\n                d.who_daily_14_days = dd[1][dd[1].length-15];\n                d.who_daily_21_days = dd[1][dd[1].length-22];\n                d.who_daily_28_days = dd[1][dd[1].length-29];\n                d.cumulative_cases_per_100k = (d.who_daily_latest.cumulative_cases/(d.population/100000));\n                d.cumulative_deaths_per_100k = (d.who_daily_latest.cumulative_deaths/(d.population/100000));\n                d.cumulative_cases = d.who_daily_latest.cumulative_cases;\n                d.cumulative_deaths = d.who_daily_latest.cumulative_deaths;\n                d.cumulative_deaths_7_days = d.who_daily_7_days.cumulative_deaths;\n                d.cumulative_deaths_14_days = d.who_daily_14_days.cumulative_deaths;\n                d.cumulative_deaths_21_days = d.who_daily_21_days.cumulative_deaths;\n                d.cumulative_deaths_28_days = d.who_daily_28_days.cumulative_deaths;\n                d.cumulative_cases_7_days = d.who_daily_7_days.cumulative_cases;\n                d.cumulative_cases_14_days = d.who_daily_14_days.cumulative_cases;\n                d.cumulative_cases_21_days = d.who_daily_21_days.cumulative_cases;\n                d.cumulative_cases_28_days = d.who_daily_28_days.cumulative_cases;\n                var percentChange = parseFloat(((d.cumulative_cases - d.cumulative_cases_14_days)-(d.cumulative_cases_14_days-d.cumulative_cases_28_days))/(d.cumulative_cases_14_days-d.cumulative_cases_28_days));\n                if(isFinite(percentChange)) { d.percent_change = percentChange; } else { d.percent_change = 0 }\n            }\n        })\n\n        vaccineDataByCountry.forEach(function(dd,ii){\n            if(dd[0]==countryCode){\n                if(typeof(dd[0]!='undefined')){\n                    d.vaccine_daily_latest = dd[1][dd[1].length-1];\n                    d.cumulative_vaccines_per_100k = (d.vaccine_daily_latest.total_vaccinations/(d.population/100000));\n                    d.people_fully_vaccinated_per_hundred = d.vaccine_daily_latest.people_fully_vaccinated_per_hundred;\n                    d.people_vaccinated_per_hundred = d.vaccine_daily_latest.people_vaccinated_per_hundred;\n                    d.total_vaccinations_per_hundred = d.vaccine_daily_latest.total_vaccinations_per_hundred;\n                    d.total_vaccinations = d.vaccine_daily_latest.total_vaccinations;\n                }\n            }\n        })\n\n        if(!isFinite(d.cumulative_cases_per_100k))d.cumulative_cases_per_100k = 0;\n        if(!isFinite(d.cumulative_deaths_per_100k))d.cumulative_deaths_per_100k = 0;\n        if(!isFinite(d.cumulative_vaccines_per_100k))d.cumulative_vaccines_per_100k = 0;\n        d.country_code = d.country_iso2;\n\n    })\n\n    data.original = clone(data);\n\n}\n\nexport default ParseData;\n","import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {filter} from './App';\nimport mapboxgl from '!mapbox-gl'; // eslint-disable-line import/no-webpack-loader-syntax\nimport 'mapbox-gl/dist/mapbox-gl.css';\nimport {addCommas} from './HelperFunctions';\n\nmapboxgl.accessToken = 'pk.eyJ1IjoiZ28taWZyYyIsImEiOiJjams3b2ZhZWswMGFvM3hxeHp2ZHFhOTRrIn0._pqO9OQ2iNeDGrpopJNjpg';\nvar mapboxStyle = 'mapbox://styles/go-ifrc/ckqrsg27f1cwu17pex8w2de2e';\n\nlet map;\nlet dots; \nlet maxSize = 15; \nlet mapTooltip;\n\nexport function createMap(data, options, filter) {\n\n    d3.select('#map-refresh').attr('display', 'none').style('cursor', 'pointer')\n    .on('click', function(d,i){\n        map.setCenter([8, 22]);\n        map.setZoom(0);\n        d3.select('#map-refresh').attr('display', 'none');\n    })\n    \n    map = new mapboxgl.Map({\n        container: 'map_div', // container ID\n        style: mapboxStyle, // style URL\n        center: [8, 22], // starting position [lng, lat]\n        preserveDrawingBuffer: true,\n        zoom: 0 // starting zoom\n    });\n\n    map.setRenderWorldCopies(false);\n    map.addControl(new mapboxgl.NavigationControl());\n    \n    // disable map zoom when using scroll\n    map.scrollZoom.disable();\n\n    map.on('zoom', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('touchmove', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('wheel', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    map.on('drag', function() {\n        d3.select('#map_tooltip').attr('display', 'none');\n        d3.select('#map-refresh').attr('display', 'inline');\n    });\n\n    var container = map.getCanvasContainer();\n\n    var svg = d3\n    .select(container)\n    .append(\"svg\")\n    .attr('id', 'mapoverlay')\n    .attr(\"width\", \"100%\")\n    .attr(\"height\", \"24vw\")\n    .style(\"position\", \"absolute\")\n    .style(\"z-index\", 2);\n\n    mapTooltip = d3.select('#map_tooltip').attr('opacity', 1).attr('transform', 'translate(0,0)').attr('display', 'inline');\n\n    // dots = svg\n    // .selectAll(\".country-map\")\n    // .data(data.world)\n    // .enter()\n    // .append(\"circle\")\n    // .attr('class', 'country-map')\n    // .attr('id', function(d,i){ return 'country-map-'+d.iso2 })\n    // .attr(\"r\", 0)\n    \n\n    // var maxValue = d3.max(data.country, function(d,i){\n    //     return d[1].cumulative_cases;\n    // })\n\n    // var rScale = d3.scalePow().exponent(0.5)\n    //   .domain([0, maxValue])\n    //   .range([0, 15]);\n\n    // data.country.forEach(function(d,i){\n    //     d3.select('#country-'+d[0]).attr('r', rScale(d[1].cumulative_cases))\n    //     .attr('data-name', d[1].country)\n    // })\n    \n    d3.select(\"#map_div\").append('svg')\n    .attr('width', '18vw')\n    .attr('height', '1.5vw')\n    .attr('id', 'maplegend')\n    .attr('viewBox', '-3 0 227 18')\n    .style('background-color', 'rgba(255,255,255,0.8)')\n\n    document.getElementById(\"maplegend\").appendChild(d3.select('#red_legend').node());\n    document.getElementById(\"maplegend\").appendChild(d3.select('#blue_legend').node());\n    document.getElementById(\"maplegend\").appendChild(d3.select('#bi_legend').node());\n\n    d3.select('#red_legend').attr('transform', 'translate(20,0)');\n    d3.select('#blue_legend').attr('transform', 'translate(20,0)');\n    d3.select('#bi_legend').attr('transform', 'translate(0,0)');\n\n    d3.select('#bi_legend').attr('display', 'none');\n    d3.select('#blue_legend').attr('display', 'none');\n\n    document.getElementById(\"mapoverlay\").appendChild(d3.select('#map_tooltip').node());\n    mapTooltip.attr('display', 'none')  \n\n    map.on('load', function (e) {\n\n        map.setPaintProperty('countries', 'fill-opacity-transition', {duration: 0, delay: 0});\n\n        updateMap(data, options) ;\n\n    });\n\n}\n\nexport function updateMap(data, options) {\n   \n    var duration = 800;\n    var delay = 10;\n\n    map.setLayoutProperty(\n        'countries',\n        'visibility',\n        'none'\n    );\n\n    if(options.map_toggle == 'bi-weekly-change'){\n        \n        var maxIncrease = d3.max(data.country, function(d,i){\n            return d.percent_change;\n        })\n\n        var maxDecrease = d3.min(data.country, function(d,i){\n            return d.percent_change;\n        })\n\n        d3.select('#bi_legend').attr('display', 'inline');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'none');\n\n        maxIncrease = (Math.ceil(maxIncrease/0.1))*0.1;\n        maxDecrease = (Math.floor(maxDecrease/0.1))*0.1;\n\n        if(maxIncrease>1) maxIncrease = 1;\n        if(maxDecrease<-1) maxDecrease = -1;\n\n        d3.select('#bi_legend_dec_val').attr('text-anchor', 'end');\n        if(maxIncrease<1){\n            d3.select('#bi_legend_inc_val tspan').text(Math.round(maxIncrease*100)+'%');\n        } else {\n            d3.select('#bi_legend_inc_val tspan').text(Math.round(maxIncrease*100)+'% +');\n        }\n        if(maxDecrease>-1){\n            d3.select('#bi_legend_dec_val tspan').text(Math.round(Math.abs(maxDecrease)*100)+'%').attr('dx', 14);\n        } else {\n            d3.select('#bi_legend_dec_val tspan').text(Math.round(Math.abs(maxDecrease)*100)+'% +').attr('dx', 14);\n        }\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([-1, 0, 1])\n        // .range([maxSize, 0, maxSize])\n        // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].percent_change))\n        //     .style('stroke', function(){\n        //         // if(d[1].percent_change>1){ return '#E02225'} else { return '#1F558C'}\n        //         return '#FFF'\n        //     }).style('fill', function(){\n        //         if(d[1].percent_change>0){ return colors.red } else { return colors.blue}\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([-1, 0, 1])\n        // .domain([maxDecrease, 0, maxIncrease])\n        .range([colors.blue, colors.lightgrey, colors.red])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            if(isFinite(d.percent_change)){\n                fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                fillColorArray.push(colorScale(d.percent_change));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n        \n    }\n\n    if(options.map_toggle == 'cases'){\n\n        var maxValue = d3.max(data.country, function(d,i){\n            return d.cumulative_cases_per_100k;\n        });\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'inline');\n\n        d3.select('#red_legend_title tspan').text('Cases per 100k');\n\n        if(maxValue>1000){\n            maxValue = (Math.ceil(maxValue/100))*100;\n        } else {\n            maxValue = (Math.ceil(maxValue/10))*10;\n        }\n\n        d3.select('#red_legend_val tspan').text(addCommas(maxValue));\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([0, maxValue])\n        // .range([0, maxSize]);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].cumulative_cases))\n        //     .style('fill', colors.red)\n        //     .style('stroke', '#FFF');\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, maxValue])\n        .range([colors.lightred, colors.red]);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n            fillColorArray.push(colorScale(d.cumulative_cases_per_100k));\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n\n    }\n    \n    if(options.map_toggle == 'deaths'){\n\n        var maxValue = d3.max(data.country, function(d,i){\n            return d.cumulative_deaths_per_100k;\n        })\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'none');\n        d3.select('#red_legend').attr('display', 'inline');\n\n        d3.select('#red_legend_title tspan').text('Deaths per 100k');\n\n        if(maxValue>1000){\n            maxValue = (Math.ceil(maxValue/100))*100;\n        } else {\n            maxValue = (Math.ceil(maxValue/10))*10;\n        }\n\n        d3.select('#red_legend_val tspan').text(addCommas(maxValue));\n\n        // var rScale = d3.scalePow().exponent(0.5)\n        // .domain([0, maxValue])\n        // .range([0, maxSize]);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.country.forEach(function(d,i){\n        //     d3.select('#country-map-'+d[0])\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(d[1].cumulative_deaths))\n        //     .style('fill', colors.red)\n        //     .style('stroke', '#FFF');\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, maxValue])\n        .range([colors.lightred, colors.red]);\n\n        var fillColorArray = ['case']\n\n        data.country.forEach(function(d,i){\n            fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n            fillColorArray.push(colorScale(d.cumulative_deaths_per_100k));\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        }\n    }\n\n    if(options.map_toggle == 'percent-fully-vaccinated'){\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'inline');\n        d3.select('#red_legend').attr('display', 'none');\n        d3.select('#blue_legend_title tspan').text('Percent fully vaccinated');\n        d3.select('#blue_legend_val tspan').text('100%');\n\n        // var rScale = d3.scalePow().exponent(0.55)\n        // .domain([0, 1])\n        // .range([1, maxSize])\n        // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.vGroup.forEach(function(d,i){\n        //     var peoplevaccinated = parseFloat(d[1][0].people_fully_vaccinated_per_hundred)/100;\n        //     if(isNaN(peoplevaccinated)) peoplevaccinated = 0;\n        //     d3.select('#country-map-'+d[1][0].country_code)\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(peoplevaccinated))\n        //     .style('stroke', '#FFF')\n        //     .style('fill', function(){\n        //         return colors.blue;\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, 1])\n        .range([colors.lightblue, colors.blue])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            var peoplevaccinated = parseFloat(d.people_fully_vaccinated_per_hundred)/100;\n            if(isNaN(peoplevaccinated)) peoplevaccinated = 0;\n            if(peoplevaccinated>0){\n                if(d.country_code) fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                if(d.country_code) fillColorArray.push(colorScale(peoplevaccinated));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        } else {\n            map.setPaintProperty(\n                'countries', \n                'fill-color',\n                colors.darkgrey\n            );\n        }\n        \n    }\n\n    if(options.map_toggle == 'percent-vaccine-acceptance'){\n\n        d3.select('#bi_legend').attr('display', 'none');\n        d3.select('#blue_legend').attr('display', 'inline');\n        d3.select('#red_legend').attr('display', 'none');\n        d3.select('#blue_legend_title tspan').text('% vaccine acceptance');\n        d3.select('#blue_legend_val tspan').text('100%');\n        \n        // var rScale = d3.scalePow().exponent(1)\n        // .domain([0, 1])\n        // .range([1, maxSize*.7])\n        // // .clamp(true);\n\n        // d3.selectAll('.country-map').transition('c').duration(duration/1.7).attr('r',0);\n\n        // data.vGroup.forEach(function(d,i){\n        //     var vaccine_acceptance_percent = parseFloat(d[1][0].vaccine_acceptance_percent/100);\n            \n        //     if(isNaN(vaccine_acceptance_percent)) vaccine_acceptance_percent = 0;\n\n        //     d3.select('#country-map-'+d[1][0].country_code)\n        //     .transition('c').duration(duration).delay(delay)\n        //     .attr('r', rScale(vaccine_acceptance_percent))\n        //     .style('stroke', '#FFF')\n        //     .style('fill', function(){\n        //         return colors.blue;\n        //     })\n        // })\n\n        var colorScale = d3.scaleLinear()\n        .domain([0, 1])\n        .range([colors.lightblue, colors.blue])\n        .clamp(true);\n\n        var fillColorArray = ['case']\n        data.country.forEach(function(d,i){\n            var vaccine_acceptance_percent = parseFloat(d.vaccine_acceptance_percent)/100;\n            if(isNaN(vaccine_acceptance_percent)) vaccine_acceptance_percent = 0;\n            if(vaccine_acceptance_percent>0){\n                if(d.country_code) fillColorArray.push(['==', ['get', \"iso\"], d.country_code]);\n                if(d.country_code) fillColorArray.push(colorScale(vaccine_acceptance_percent));\n            }\n        });\n\n        if(fillColorArray.length>1){\n            fillColorArray.push(colors.darkgrey)\n            map.setPaintProperty(\n                'countries', \n                'fill-color', fillColorArray\n            );\n        } else {\n            map.setPaintProperty(\n                'countries', \n                'fill-color',\n                colors.darkgrey\n            );\n        }\n\n    }\n\n    mapTooltip.attr('display', 'none')  \n\n    map.on('mousemove', function (e) {\n        var features = map.queryRenderedFeatures(e.point);\n         \n        var displayProperties = [\n        'type',\n        'properties',\n        'id',\n        'layer',\n        'source',\n        'sourceLayer',\n        'state'\n        ];\n         \n        if((features.length==1)&&(features[0].layer.id=='countries')){\n\n            var id = features[0].properties.iso;\n            var countryfiltered = data.equity_data.filter(d=>d.country_iso2 == id);\n            var countryName;\n            if(countryfiltered[0]) countryName = countryfiltered[0].country_name;\n    \n            mapTooltip.select('#map_tooltip_name tspan').text(countryName);\n  \n            if(mapTooltip.select('#map_tooltip_name tspan').text().length==0){\n                mapTooltip\n                .attr('display', 'none');\n            };\n            \n            if(options.map_toggle=='cases'){\n                var country = data.country.filter(d=>d.country_code == id)[0];\n                if((!country)||(country.length==0)) return false;\n                mapTooltip.select('#map_tooltip_val tspan').text(addCommas(Math.round(country.cumulative_cases_per_100k))+' cases per 100k');\n            }\n    \n            if(options.map_toggle=='deaths'){\n                var country = data.country.filter(d=>d.country_code == id)[0];\n                if((!country)||(country.length==0)) return false;\n                mapTooltip.select('#map_tooltip_val tspan').text(addCommas(Math.round(country.cumulative_deaths_per_100k))+' deaths per 100k');\n            }\n    \n            if(options.map_toggle=='bi-weekly-change'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = ((country[0].percent_change)*100).toFixed(1);\n                var str = '';\n                if(val>=0){\n                    str = '% increase';\n                } else {\n                    str = '% decrease';\n                }\n                mapTooltip.select('#map_tooltip_val tspan').text(Math.abs(val)+str);\n            }\n    \n            if(options.map_toggle=='percent-fully-vaccinated'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = parseFloat(country[0].people_fully_vaccinated_per_hundred).toFixed(2)\n                if(isNaN(val)||(val==0)){ val = '-' } else { val = val + '% fully vaccinated'}\n                mapTooltip.select('#map_tooltip_val tspan').text(val);\n            }\n    \n            if(options.map_toggle=='percent-vaccine-acceptance'){\n                var country = data.country.filter(d=>d.country_code == id);\n                if((!country)||(country.length==0)) return false;\n                var val = parseFloat(country[0].vaccine_acceptance_percent).toFixed(2)\n                if(isNaN(val)||(val==0)){ val = '-' } else { val = val + '% vaccine acceptance'}\n                mapTooltip.select('#map_tooltip_val tspan').text(val);\n            }\n    \n            var str = mapTooltip.select('#map_tooltip_val tspan').text();\n            if(str.includes('NaN')) mapTooltip.attr('display', 'none')\n\n            d3.select('#map_tooltip_bg').attr('width', 20)\n\n            var scale = window.innerWidth/1329;\n            mapTooltip\n            .attr('display', 'inline')\n            .attr('transform', 'translate('+(e.point.x+20)+','+e.point.y+')scale('+scale+')');\n            var heightOffset = mapTooltip.node().getBBox();\n\n            var bbox = d3.select('#map_tooltip').node().getBBox();\n            d3.select('#map_tooltip_bg').attr('width', (parseFloat(bbox.width)+2))\n\n            if(mapTooltip.select('#map_tooltip_name tspan').text().length==0){\n                mapTooltip\n                .attr('display', 'none');\n            };\n\n            // mapTooltip.attr('transform', 'translate('+(project(([d.lng, d.lat])).x+3)+','+(project(([d.lng, d.lat])).y+2-heightOffset.height/2)+')scale('+scale+')');\n        } else {\n            mapTooltip.attr('display', 'none')\n        }\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        mapTooltip.attr('display', 'none');\n    })\n\n\n    // function render() {\n    //     dots\n    //       .attr(\"cx\", function(d) {\n    //         return project(([d.lng, d.lat])).x;\n    //       })\n    //       .attr(\"cy\", function(d) {\n    //         return project(([d.lng, d.lat])).y;\n    //       });\n    //   }\n\n    // map.on(\"viewreset\", render);\n    // map.on(\"move\", render);\n    // map.on(\"moveend\", render);\n    // render(); // Call once to render\n\n    // tooltips\n\n    // var mapTooltip = d3.select('#map_tooltip').attr('opacity', 1).attr('transform', 'translate(0,0)').attr('display', 'none');\n\n    // d3.selectAll('.country-map').on('mousemove', function(event, d){\n\n    //     var id = d3.select(this).attr('id').substr(12,2);\n    //     var countryfiltered = data.equity_data.filter(d=>d.country_iso2 == id);\n    //     var countryName;\n    //     if(countryfiltered[0]) countryName = countryfiltered[0].country_name;\n\n    //     mapTooltip.select('#map_tooltip_name tspan').text(countryName);\n\n    //     if(options.map_toggle=='cases'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(addCommas(country[1].cumulative_cases)+' cases');\n    //     }\n\n    //     if(options.map_toggle=='deaths'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(addCommas(country[1].cumulative_deaths)+' deaths');\n    //     }\n\n    //     if(options.map_toggle=='bi-weekly-change'){\n    //         var country = data.country.filter(d=>d.country_code == id)[0];\n    //         if((!country)||(country.length==0)) return false;\n    //         var val = ((country[1].percent_change)*100).toFixed(1);\n    //         var str = '';\n    //         if(val>=0){\n    //             str = '% increase';\n    //         } else {\n    //             str = '% decrease';\n    //         }\n    //         mapTooltip.select('#map_tooltip_val tspan').text(Math.abs(val)+str);\n    //     }\n\n    //     if(options.map_toggle=='percent-fully-vaccinated'){\n    //         var country = data.vGroup.filter(d=>d[1][0].country_code == id)[0][1];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(parseFloat(country[0].people_fully_vaccinated_per_hundred).toFixed(1)+'% fully vaccinated');\n    //     }\n\n    //     if(options.map_toggle=='percent-vaccine-acceptance'){\n    //         var country = data.vGroup.filter(d=>d[1][0].country_code == id)[0][1];\n    //         if((!country)||(country.length==0)) return false;\n    //         mapTooltip.select('#map_tooltip_val tspan').text(parseFloat(country[0].vaccine_acceptance_percent).toFixed(1)+'% vaccine acceptance');\n    //     }\n\n\n    //     d3.select('#map_tooltip_bg').attr('width', 0)\n\n    //     var bbox = mapTooltip.node().getBBox();\n    //     d3.select('#map_tooltip_bg').attr('width', (parseFloat(bbox.width)+2))\n    //     var scale = window.innerWidth/1329;\n    //     mapTooltip\n    //     .attr('display', 'inline')\n    //     .attr('transform', 'translate('+project(([d.lng, d.lat])).x+','+project(([d.lng, d.lat])).y+')scale('+scale+')');\n\n    //     var heightOffset = mapTooltip.node().getBBox();\n    //     mapTooltip.attr('transform', 'translate('+(project(([d.lng, d.lat])).x+3)+','+(project(([d.lng, d.lat])).y+2-heightOffset.height/2)+')scale('+scale+')');\n\n   \n\n    map.setLayoutProperty(\n        'countries',\n        'visibility',\n        'visible'\n    );\n\n}\n\n// function project(d) {\n//     return map.project(new mapboxgl.LngLat(d[0], d[1]));\n// }\n\nexport default createMap;\n","import React, { useEffect, useState } from \"react\";\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {drawRegionchart, updateRegionchart} from './Regionchart';\nimport {drawBubblechart, updateBubblechart} from './Bubblechart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css'\nimport $ from \"jquery\";\nimport select2 from 'select2';\nimport 'select2/dist/css/select2.min.css'\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport { createMap, updateMap } from './Map';\nimport moment from 'moment';\n\n  /* \n  add this attribute to package.json when deploying to github pages.\n \"homepage\": \"https://ifrcgo.github.io/ifrc-covid-dataviz/build\", \n  */\n\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\nconst whoDataUrl = \"./data/who_global_cases.csv\";\n// const whoDataUrl = \"http://covid19.who.int/WHO-COVID-19-global-data.csv\";\nconst vaccinesDataUrl = \"./data/owid_vaccinations.csv\";\n// const vaccinesDataUrl = \"http://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations.csv\";\nconst vaccinesWhoDataUrl = \"./data/who_vaccination_data.csv\";\n// const vaccinesWhoDataUrl = \"http://covid19.who.int/who-data/vaccination-data.csv\";\nconst timelineDataUrl = \"./data/timeline.csv\";\nconst selfAssessmentDataUrl = \"./data/self_assessment.csv\";\nconst vaccineAcceptanceDataUrl = \"./data/vaccine_acceptance.csv\";\n\nconst data = {};\n\nconst regionOptions = [\n  { id: 'AM', text: 'Americas' },\n  { id: 'EU', text: 'Europe' },\n  { id: 'AP', text: 'Asia-Pacific' },\n  { id: 'ME', text: 'Middle East and North Africa'},\n  { id: 'AF', text: 'Africa' }\n]\n\nconst countryOptions = [];\n\nfunction App() {\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...');\n\n  async function init(){\n\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function(d){\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', '100%').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      svg.attr('id', 'svg');\n      Layout(svg, options, data, filter, updateTable, updateMap);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...');\n      // data source 2: equity_data.csv\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function(d){\n        data.equity_data = d;\n        d.forEach(function(d,i){\n          countryOptions.push({'text': d.country_name, 'id': 'Country-'+d.country_iso2 })\n        })\n        createSelects();\n        setProgress(0.1);\n        setLoaderText('Loading WHO data CSV...');\n        // data source 1: owid_vaccines.csv\n        const vaccinesData = d3.csv(vaccinesDataUrl);\n          vaccinesData.then(function(d){\n            data.vaccines_data = d;\n            setProgress(0.07);\n            setLoaderText('Loading OWID vaccines data...');\n             // data source 2: vaccinesWhoData.csv\n             const vaccinesWhoData = d3.csv(vaccinesWhoDataUrl);\n             vaccinesWhoData.then(function(d){\n               data.vaccines_who_data = d;\n               setProgress(0.15);\n               setLoaderText('Loading OWID vaccines data...');\n                // data source 3: self_assessment.csv\n                const selfAssessmentData = d3.csv(selfAssessmentDataUrl);\n                selfAssessmentData.then(function(d){\n                  data.self_assessment = d;\n                  setProgress(0.22);\n                  setLoaderText('Loading self assessment...');\n                  // data source 4: vaccine_acceptance.csv\n                  const vaccineAcceptanceData = d3.csv(vaccineAcceptanceDataUrl);\n                  vaccineAcceptanceData.then(function(d){\n                    data.vaccine_acceptance = d;\n                    setProgress(0.3);\n                      setLoaderText('Loading vaccine acceptance data...');\n                      // data source 3: timeline.csv\n                      const timelineData = d3.csv(timelineDataUrl);\n                      timelineData.then(function(d){\n                        data.timeline_data = d;\n                        setProgress(0.4);\n                        setLoaderText('Loading WHO daily data...');\n                          // data source 5: who_global_cases.csv\n                          const whoData = d3.csv(whoDataUrl);\n                          whoData.then(function(d){\n                            data.who_data = d;\n                            setProgress(0.8);\n                              setLoaderText('Loading complete.');\n                              setProgress(1);\n                              ParseData(data, options);\n                              createCharts();\n                              d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n                    });\n                  });\n                });\n              });\n            });\n          });\n      });\n    })\n  }\n  \n  function createCharts(){\n    d3.select('#who_data_date tspan').text(moment(data.max_date).format('ll'));\n    d3.select('#owid_data_date tspan').text(moment(data.max_vaccine_date).format('ll'));\n    drawTimechart(data, options);\n    drawRegionchart(data, options, filter);\n    updateTable(data, options);\n    updateTotals(data, options);\n    createMap(data, options, filter);\n    drawBubblechart(data, options, filter);\n  }\n\n  function filter(id,e){\n    options.page = 1;\n    if(id=='clear'){\n      options.region_filter = [];\n      options.country_filter = [];\n      d3.select('#reset_locations').attr('display', 'none');\n    } \n    if(id=='clear-region'){\n      options.region_filter = [];\n    } \n\n    if(id=='clear-hdi'){\n      options.hdi_filter = [];\n    } \n\n    if(id=='clear-inform'){\n      options.inform_filter = [];\n    } \n\n    if((id.length==1)&&(id[0].length==2)&&(id!='filter')){\n      if(options.region_filter.includes(id[0])){\n        options.region_filter = options.region_filter.filter(d=>d!==id[0])\n      } else {\n        options.region_filter.push(id[0]);\n      }\n    }\n\n    if(options.region_filter.length==5) options.region_filter = [];\n\n    if(options.region_filter.length>0){\n      d3.select('#region_remove_filter').attr('opacity', 1);\n\n      d3.selectAll('.bar-labels').attr('opacity', 0.5);\n      options.region_filter.forEach(function(d,i){\n        d3.select('.bar-label-'+d).attr('opacity', 1);\n      })\n    } else {\n        d3.select('#region_remove_filter').attr('opacity', 0);\n        d3.selectAll('.bar-labels').attr('opacity', 1);\n    }\n\n    data.country = data.original.country;\n\n    var hdi_countries = [];\n    if(options.hdi_filter.length>0){\n      d3.select('#hdi_remove_filter').attr('opacity', 1);\n      data.country.forEach(function(d,i){\n        if(options.hdi_filter.includes(d.hdi_category)){\n          hdi_countries.push(d.country_iso2);\n        }\n      })\n    } else {\n      d3.select('#hdi_remove_filter').attr('opacity', 0);\n    }\n\n    var inform_countries = [];\n    if(options.inform_filter.length>0){\n      d3.select('#inform_remove_filter').attr('opacity', 1);\n      data.country.forEach(function(d,i){\n        if(options.inform_filter.includes(d.inform_severity)){\n          inform_countries.push(d.country_iso2);\n        }\n      })\n    } else {\n      d3.select('#inform_remove_filter').attr('opacity', 0);\n    }\n\n    if((id.length==1)&&(id[0].length>2)){\n      var code = id[0].substring(8);\n      if(options.country_filter.includes(code)){\n        options.country_filter = options.country_filter.filter(d=>d!==code)\n      } else {\n        options.country_filter.push(code);\n      }\n    }\n\n    if((options.region_filter.length==0)&&(options.country_filter.length==0)){\n      d3.select('#reset_locations').attr('display', 'none');\n    }\n\n    var countryIds = [];\n    options.country_filter.forEach(function(d,i){\n      countryIds.push('Country-'+d);\n    })\n\n    if((options.region_filter.length>0)||(options.country_filter.length>0)) {\n        d3.select('#reset_locations').attr('display', 'inline')\n      } else {\n        d3.select('#reset_locations').attr('display', 'none')\n      }\n\n    var mergeFilter = options.region_filter.concat(countryIds);\n    $('#regionSelect').val(mergeFilter)\n    $('#regionSelect').trigger('change');\n\n    // update data\n    data.who_data = data.original.who_data;\n\n    if(inform_countries.length>0){\n      data.who_data = data.who_data.filter(function(d,i){\n        return inform_countries.includes(d.country_code)\n      })\n    }\n    \n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.who_data = data.who_data.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code)))&&(hdi_countries.includes(d.country_code))\n          } else {\n            return (hdi_countries.includes(d.country_code))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code))\n        }\n      })\n    }\n    data.vaccines_data = data.original.vaccines_data;\n\n    if(inform_countries.length>0){\n      data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        return inform_countries.includes(d.country_code)\n      })\n    }\n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.vaccines_data = data.vaccines_data.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code)))&&(hdi_countries.includes(d.country_code))\n          } else {\n            return (hdi_countries.includes(d.country_code))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_code))\n        }\n      })\n    }\n\n    if(inform_countries.length>0){\n      data.country = data.country.filter(function(d,i){\n        return inform_countries.includes(d.country_iso2)\n      })\n    } \n    if((options.region_filter.length>0)||(options.country_filter.length>0)||(hdi_countries.length>0)){\n      data.country = data.country.filter(function(d,i){\n        if(hdi_countries.length>0){\n          if((options.region_filter.length>0)||(options.country_filter.length>0)){\n            return (options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_iso2)))&&(hdi_countries.includes(d.country_iso2))\n          } else {\n            return (hdi_countries.includes(d.country_iso2))\n          }\n        } else {\n          return options.region_filter.includes(d.ifrc_region)||(options.country_filter.includes(d.country_iso2))\n        }\n      })\n    }\n\n    handleSelectLength();\n    updateCharts();\n\n  }\n  function updateCharts(){\n    updateRegionchart(options,data);\n    updateTable(data, options);\n    updateTotals(data, options);\n    updateTimechart(data, options);\n    updateMap(data,options);\n    updateBubblechart(data, options, filter);\n  }\n\n  function updateTotals(data,options){\n\n    var numCountriesFiltered = data.country.length;\n\n    // total cases\n    var totalCases = d3.sum(data.country, d => d.cumulative_cases);\n    d3.select('#total_cases tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalCases)(t))\n      };\n    });\n\n    // hide bars when zero cases\n    if(totalCases==0){\n      d3.selectAll('.bar_group').attr('opacity',0);\n    } else {\n      d3.selectAll('.bar_group').attr('opacity',1);\n    }\n\n    // total new cases\n    var totalNewCases = totalCases - d3.sum(data.country, d => d.cumulative_cases_7_days);\n    d3.select('#total_new_cases tspan').text('-');\n    d3.select('#total_new_cases tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalNewCases)(t))\n      };\n    })\n\n    // total deaths\n    var totalDeaths = d3.sum(data.country, d => d.cumulative_deaths);\n    d3.select('#total_deaths tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalDeaths)(t))\n      };\n    })\n\n    var totalVaccinations = d3.sum(data.country, d => d.total_vaccinations);\n    d3.select('#total_vaccines tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return nFormatter(d3.interpolate(0, totalVaccinations)(t))\n      };\n    })\n\n    //***************************\n    // vaccies per 100 / acceptance / vaccine types / ns involvemnt\n    //***************************\n    var vaccinesPer100 = {population: 0, vaccine_population: 0};\n    var vaccineAcceptance = {population: 0, vaccine_acceptance_population: 0};\n    var numNsInvolvedCountres = 0;\n    data.vaccine_types = [];\n    data.country.forEach(function(dd,ii){\n      // vaccine per 100 including country population weight\n      if((dd.vaccines_per_100>0)&&(dd.population>0)) {\n        vaccinesPer100.population += dd.population;\n        vaccinesPer100.vaccine_population += dd.population*dd.vaccines_per_100;\n      }\n      // vaccine acceptance including country population weight\n      if(dd.vaccine_acceptance_population>0) {\n        vaccineAcceptance.population += dd.vaccine_acceptance_population;\n        vaccineAcceptance.vaccine_acceptance_population += dd.vaccine_acceptance_population*dd.vaccine_acceptance_percent;\n      }\n      // vacine types data\n      dd.vaccines_used.forEach(function(ddd){\n        if((!data.vaccine_types.includes(ddd))&&(ddd.length>1)&&(!ddd.includes('nactiv'))) data.vaccine_types.push(ddd);\n      })\n      // ns involved countries\n      // if(dd.ns_involvement>0){\n      //   numNsInvolvedCountres++;\n      // }\n      data.ns_involvement.forEach(function(ddd,iii){\n        if(ddd==dd.country_iso3){\n            numNsInvolvedCountres++;\n        }\n      })\n    });\n\n    // update total doses per 100 total\n    d3.select('#total_vac_100 tspan').text('-');\n    var vaccinePer100ByPopulation = vaccinesPer100.vaccine_population / vaccinesPer100.population;\n    if(vaccinePer100ByPopulation){\n      d3.select('#total_vac_100 tspan').transition().duration(500)\n      .textTween(function() {\n        return function(t) {\n          return (d3.interpolate(0, vaccinePer100ByPopulation)(t).toFixed(1))\n        };\n      })\n    }\n\n    // update vaccine acceptance percent total\n    d3.select('#percent_acceptance tspan').text('-');\n    var vaccineAcceptancePercent = vaccineAcceptance.vaccine_acceptance_population / vaccineAcceptance.population;\n    if(vaccineAcceptancePercent){\n      d3.select('#percent_acceptance tspan').transition().duration(500)\n      .textTween(function() {\n        return function(t) {\n          return Math.round(d3.interpolate(0, Math.round(vaccineAcceptancePercent))(t))+'%';\n        };\n      })\n    }\n\n    // update ns involved total\n    d3.select('#total_ns_countries tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return Math.round(d3.interpolate(0, numNsInvolvedCountres)(t))\n      };\n    })\n\n    // update num types of vaccines total\n    d3.select('#num_vaccines tspan').transition().duration(500)\n    .textTween(function() {\n      return function(t) {\n        return Math.round(d3.interpolate(0, data.vaccine_types.length)(t))\n      };\n    })\n\n    // vaccine type tooltip list\n    d3.selectAll('.vaccine_type').remove();\n    d3.select('#vaccine_tooltip_bg').attr('height', 1);\n    data.vaccine_types.forEach(function(d,i){\n      d3.select(\"#vaccine_tooltip\").append('text')\n      .attr('font-size', 9)\n      .attr('fill', '#000')\n      .attr('class', 'vaccine_type')\n      .append('tspan').text(d)\n      .attr('dx', 6)\n      .attr('dy',((i*1.3)+1.8)+'em')\n    });\n\n    var vtooltipbbox = d3.select('#vaccine_tooltip').node().getBBox();\n    d3.select('#vaccine_tooltip_bg').attr('height', vtooltipbbox.height+6);\n\n    //***************************\n    // update hdi / inform numbers\n    //***************************\n\n    // define empty objects\n    var hdiData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiDataPopulation = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiDataVaccines = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiContactTracing = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiTotalCasesData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0};\n    var hdiTestingData = {'very-high':[], 'high': [], 'medium': [], 'low': []};\n    var informData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informDataPopulation = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informDataVaccines = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informContactTracing = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informTotalCasesData = {'very-high':0, 'high': 0, 'medium': 0, 'low': 0, 'no-score': 0};\n    var informTestingData = {'very-high':[], 'high': [], 'medium': [], 'low': [], 'no-score': []};\n    var totalRecordedPopulation = 0;\n\n    if(totalCases>0){\n      data.country.forEach(function(dd,ii){\n          \n          hdiData[dd.hdi_category] += 1;\n          hdiDataPopulation[dd.hdi_category] += parseInt(dd.population);\n          hdiDataVaccines[dd.hdi_category] += parseInt(dd.total_vaccinations)||0;\n\n          informData[dd.inform_severity] += 1;\n          \n          informContactTracing[dd.inform_severity] += dd.contract_tracing;\n          hdiContactTracing[dd.hdi_category] += dd.contract_tracing;\n\n          if((dd.hdi_category=='very-high')||(dd.hdi_category=='high')||(dd.hdi_category=='medium')||(dd.hdi_category=='low'))\n          hdiTestingData[dd.hdi_category].push(dd.avg_tests_per_1000);\n          if((dd.inform_severity=='very-high')||(dd.inform_severity=='high')||(dd.inform_severity=='medium')||(dd.inform_severity=='low')||(dd.inform_severity=='no-score'))\n          informTestingData[dd.inform_severity].push(dd.avg_tests_per_1000);\n\n          informDataPopulation[dd.inform_severity] += parseInt(dd.population);\n          informDataVaccines[dd.inform_severity] += parseInt(dd.total_vaccinations)||0;\n          // hdi index\n          hdiTotalCasesData[dd.hdi_category] += dd.cumulative_cases || 0;\n          informTotalCasesData[dd.inform_severity] += dd.cumulative_cases || 0;\n      })\n    }\n\n    var totalHdiPop = hdiDataPopulation['very-high']+hdiDataPopulation['high']+hdiDataPopulation['medium']+hdiDataPopulation['low'];\n    var totalInformPop = informDataPopulation['very-high']+informDataPopulation['high']+informDataPopulation['medium']+informDataPopulation['low']+informDataPopulation['no-score'];\n\n    // update additional indicators\n    // row 0 percent of vaccinations by hdi\n    d3.select('#hdi-percent-val-very-high tspan').text(parse((hdiTotalCasesData['very-high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-very-high').transition().duration(500).attr('width', (parse(hdiTotalCasesData['very-high']/totalCases)*70));\n    d3.select('#hdi-percent-val-high tspan').text(parse((hdiTotalCasesData['high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-high').transition().duration(500).attr('width', (parse(hdiTotalCasesData['high']/totalCases)*70));\n    d3.select('#hdi-percent-val-medium tspan').text(parse((hdiTotalCasesData['medium']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-medium').transition().duration(500).attr('width', (parse(hdiTotalCasesData['medium']/totalCases)*70));\n    d3.select('#hdi-percent-val-low tspan').text(parse((hdiTotalCasesData['low']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#hdi-percent-bar-low').transition().duration(500).attr('width', (parse(hdiTotalCasesData['low']/totalCases)*70));\n\n    d3.select('#inform-percent-val-very-high tspan').text(parse((informTotalCasesData['very-high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-very-high').transition().duration(500).attr('width', (parse(informTotalCasesData['very-high']/totalCases)*64));\n    d3.select('#inform-percent-val-high tspan').text(parse((informTotalCasesData['high']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-high').transition().duration(500).attr('width', (parse(informTotalCasesData['high']/totalCases)*64));\n    d3.select('#inform-percent-val-medium tspan').text(parse((informTotalCasesData['medium']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-medium').transition().duration(500).attr('width', (parse(informTotalCasesData['medium']/totalCases)*64));\n    d3.select('#inform-percent-val-low tspan').text(parse((informTotalCasesData['low']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-low').transition().duration(500).attr('width', (parse(informTotalCasesData['low']/totalCases)*64));\n    d3.select('#inform-percent-val-no-score tspan').text(parse((informTotalCasesData['no-score']/totalCases)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '16');\n    d3.select('#inform-percent-bar-no-score').transition().duration(500).attr('width', (parse(informTotalCasesData['no-score']/totalCases)*64));\n\n    d3.select('#hdi-toggle-very-high-val tspan').text(hdiData['very-high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-high-val tspan').text(hdiData['high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-medium-val tspan').text(hdiData['medium']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#hdi-toggle-low-val tspan').text(hdiData['low']).style('text-anchor', 'end').attr('dx', '10');\n\n    d3.select('#inform-toggle-very-high-val tspan').text(informData['very-high']).style('text-anchor', 'end').attr('dx', '6');\n    d3.select('#inform-toggle-high-val tspan').text(informData['high']).style('text-anchor', 'end').attr('dx', '10');\n    d3.select('#inform-toggle-medium-val tspan').text(informData['medium']).style('text-anchor', 'end').attr('dx', '9');\n    d3.select('#inform-toggle-low-val tspan').text(informData['low']).style('text-anchor', 'end').attr('dx', '7');\n    d3.select('#inform-toggle-no-score-val tspan').text(informData['no-score']).style('text-anchor', 'end').attr('dx', '13');\n\n    // row 1 percnet of vaccinations by hdi\n    d3.select('#hdi1val-very-high tspan').text(parse((hdiDataPopulation['very-high']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-very-high').transition().duration(500).attr('width', (parse(hdiDataPopulation['very-high']/totalHdiPop)*70));\n    d3.select('#hdi1val-high tspan').text(parse((hdiDataPopulation['high']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-high').transition().duration(500).attr('width', (parse(hdiDataPopulation['high']/totalHdiPop)*70));\n    d3.select('#hdi1val-medium tspan').text(parse((hdiDataPopulation['medium']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-medium').transition().duration(500).attr('width', (parse(hdiDataPopulation['medium']/totalHdiPop)*70));\n    d3.select('#hdi1val-low tspan').text(parse((hdiDataPopulation['low']/totalHdiPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi1bar-low').transition().duration(500).attr('width', (parse(hdiDataPopulation['low']/totalHdiPop)*70));\n\n    d3.select('#inform1val-very-high tspan').text(parse((informDataPopulation['very-high']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-very-high').transition().duration(500).attr('width', (parse(informDataPopulation['very-high']/totalInformPop)*64));\n    d3.select('#inform1val-high tspan').text(parse((informDataPopulation['high']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-high').transition().duration(500).attr('width', (parse(informDataPopulation['high']/totalInformPop)*64));\n    d3.select('#inform1val-medium tspan').text(parse((informDataPopulation['medium']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-medium').transition().duration(500).attr('width', (parse(informDataPopulation['medium']/totalInformPop)*64));\n    d3.select('#inform1val-low tspan').text(parse((informDataPopulation['low']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-low').transition().duration(500).attr('width', (parse(informDataPopulation['low']/totalInformPop)*64));\n    d3.select('#inform1val-no-score tspan').text(parse((informDataPopulation['no-score']/totalInformPop)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform1bar-no-score').transition().duration(500).attr('width', (parse(informDataPopulation['no-score']/totalInformPop)*64));\n\n    // row 2 percent of total vaccinations\n    d3.select('#hdi2val-very-high tspan').text(parse((hdiDataVaccines['very-high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-very-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['very-high']/totalVaccinations)*70));\n    d3.select('#hdi2val-high tspan').text(parse((hdiDataVaccines['high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['high']/totalVaccinations)*70));\n    d3.select('#hdi2val-medium tspan').text(parse((hdiDataVaccines['medium']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-medium').transition().duration(500).attr('width', (parse(hdiDataVaccines['medium']/totalVaccinations)*70));\n    d3.select('#hdi2val-low tspan').text(parse((hdiDataVaccines['low']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi2bar-low').transition().duration(500).attr('width', (parse(hdiDataVaccines['low']/totalVaccinations)*70));\n\n    d3.select('#inform2val-very-high tspan').text(parse((informDataVaccines['very-high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-very-high').transition().duration(500).attr('width', (parse(informDataVaccines['very-high']/totalVaccinations)*64));\n    d3.select('#inform2val-high tspan').text(parse((informDataVaccines['high']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-high').transition().duration(500).attr('width', (parse(informDataVaccines['high']/totalVaccinations)*64));\n    d3.select('#inform2val-medium tspan').text(parse((informDataVaccines['medium']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-medium').transition().duration(500).attr('width', (parse(informDataVaccines['medium']/totalVaccinations)*64));\n    d3.select('#inform2val-low tspan').text(parse((informDataVaccines['low']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-low').transition().duration(500).attr('width', (parse(informDataVaccines['low']/totalVaccinations)*64));\n    d3.select('#inform2val-no-score tspan').text(parse((informDataVaccines['no-score']/totalVaccinations)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform2bar-no-score').transition().duration(500).attr('width', (parse(informDataVaccines['no-score']/totalVaccinations)*64));\n\n    // row 3 total doses by hdi/inform\n    var maxhdivac = d3.max([ hdiDataVaccines['low'],hdiDataVaccines['medium'],hdiDataVaccines['high'],hdiDataVaccines['very-high'] ]);\n    var maxinformvac = d3.max([ informDataVaccines['low'],informDataVaccines['medium'],informDataVaccines['high'],informDataVaccines['very-high'],informDataVaccines['no-score'] ]);\n\n    d3.select('#hdi3val-very-high tspan').text(nFormatter(hdiDataVaccines['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-very-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['very-high']/maxhdivac)*70));\n    d3.select('#hdi3val-high tspan').text(nFormatter(hdiDataVaccines['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-high').transition().duration(500).attr('width', (parse(hdiDataVaccines['high']/maxhdivac)*70));\n    d3.select('#hdi3val-medium tspan').text(nFormatter(hdiDataVaccines['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-medium').transition().duration(500).attr('width', (parse(hdiDataVaccines['medium']/maxhdivac)*70));\n    d3.select('#hdi3val-low tspan').text(nFormatter(hdiDataVaccines['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi3bar-low').transition().duration(500).attr('width', (parse(hdiDataVaccines['low']/maxhdivac)*70));\n\n    d3.select('#inform3val-very-high tspan').text(nFormatter(informDataVaccines['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-very-high').transition().duration(500).attr('width', (parse(informDataVaccines['very-high']/maxinformvac)*64));\n    d3.select('#inform3val-high tspan').text(nFormatter(informDataVaccines['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-high').transition().duration(500).attr('width', (parse(informDataVaccines['high']/maxinformvac)*64));\n    d3.select('#inform3val-medium tspan').text(nFormatter(informDataVaccines['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-medium').transition().duration(500).attr('width', (parse(informDataVaccines['medium']/maxinformvac)*64));\n    d3.select('#inform3val-low tspan').text(nFormatter(informDataVaccines['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-low').transition().duration(500).attr('width', (parse(informDataVaccines['low']/maxinformvac)*64));\n    d3.select('#inform3val-no-score tspan').text(nFormatter(informDataVaccines['no-score'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform3bar-no-score').transition().duration(500).attr('width', (parse(informDataVaccines['no-score']/maxinformvac)*64));\n\n    // row 4 total vaccinations\n    d3.select('#hdi4val-very-high tspan').text(parse((hdiContactTracing['very-high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-very-high').transition().duration(500).attr('width', (parse(hdiContactTracing['very-high']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-high tspan').text(parse((hdiContactTracing['high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-high').transition().duration(500).attr('width', (parse(hdiContactTracing['high']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-medium tspan').text(parse((hdiContactTracing['medium']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-medium').transition().duration(500).attr('width', (parse(hdiContactTracing['medium']/numCountriesFiltered)*70));\n    d3.select('#hdi4val-low tspan').text(parse((hdiContactTracing['low']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi4bar-low').transition().duration(500).attr('width', (parse(hdiContactTracing['low']/numCountriesFiltered)*70));\n\n    d3.select('#inform4val-very-high tspan').text(parse((informContactTracing['very-high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-very-high').transition().duration(500).attr('width', (parse(informContactTracing['very-high']/numCountriesFiltered)*64));\n    d3.select('#inform4val-high tspan').text(parse((informContactTracing['high']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-high').transition().duration(500).attr('width', (parse(informContactTracing['high']/numCountriesFiltered)*64));\n    d3.select('#inform4val-medium tspan').text(parse((informContactTracing['medium']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-medium').transition().duration(500).attr('width', (parse(informContactTracing['medium']/numCountriesFiltered)*64));\n    d3.select('#inform4val-low tspan').text(parse((informContactTracing['low']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-low').transition().duration(500).attr('width', (parse(informContactTracing['low']/numCountriesFiltered)*64));\n    d3.select('#inform4val-no-score tspan').text(parse((informContactTracing['no-score']/numCountriesFiltered)*100).toFixed(0)+'%').style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform4bar-no-score').transition().duration(500).attr('width', (parse(informContactTracing['no-score']/numCountriesFiltered)*64));\n\n    // row 5 average testing\n    hdiTestingData['low'] = Math.round(d3.mean(hdiTestingData['low']))||0;\n    hdiTestingData['medium'] = Math.round(d3.mean(hdiTestingData['medium']))||0;\n    hdiTestingData['high'] = Math.round(d3.mean(hdiTestingData['high']))||0;\n    hdiTestingData['very-high'] = Math.round(d3.mean(hdiTestingData['very-high']))||0;\n    informTestingData['no-score'] = Math.round(d3.mean(informTestingData['no-score']))||0;\n    informTestingData['low'] = Math.round(d3.mean(informTestingData['low']))||0;\n    informTestingData['medium'] = Math.round(d3.mean(informTestingData['medium']))||0;\n    informTestingData['high'] = Math.round(d3.mean(informTestingData['high']))||0;\n    informTestingData['very-high'] = Math.round(d3.mean(informTestingData['very-high']))||0;\n\n    var maxhditest = d3.max([ hdiTestingData['low'],hdiTestingData['medium'],hdiTestingData['high'],hdiTestingData['very-high'] ]);\n    var maxinformtest = d3.max([ informTestingData['low'],informTestingData['medium'],informTestingData['high'],informTestingData['very-high'],informTestingData['no-score'] ]);\n\n    d3.select('#hdi5val-very-high tspan').text(addCommas(hdiTestingData['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-very-high').transition().duration(500).attr('width', (parse(hdiTestingData['very-high']/maxhditest)*70));\n    d3.select('#hdi5val-high tspan').text(addCommas(hdiTestingData['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-high').transition().duration(500).attr('width', (parse(hdiTestingData['high']/maxhditest)*70));\n    d3.select('#hdi5val-medium tspan').text(addCommas(hdiTestingData['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-medium').transition().duration(500).attr('width', (parse(hdiTestingData['medium']/maxhditest)*70));\n    d3.select('#hdi5val-low tspan').text(addCommas(hdiTestingData['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#hdi5bar-low').transition().duration(500).attr('width', (parse(hdiTestingData['low']/maxhditest)*70));\n\n    d3.select('#inform5val-very-high tspan').text(addCommas(informTestingData['very-high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-very-high').transition().duration(500).attr('width', (parse(informTestingData['very-high']/maxinformtest)*64));\n    d3.select('#inform5val-high tspan').text(addCommas(informTestingData['high'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-high').transition().duration(500).attr('width', (parse(informTestingData['high']/maxinformtest)*64));\n    d3.select('#inform5val-medium tspan').text(addCommas(informTestingData['medium'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-medium').transition().duration(500).attr('width', (parse(informTestingData['medium']/maxinformtest)*64));\n    d3.select('#inform5val-low tspan').text(addCommas(informTestingData['low'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-low').transition().duration(500).attr('width', (parse(informTestingData['low']/maxinformtest)*64));\n    d3.select('#inform5val-no-score tspan').text(addCommas(informTestingData['no-score'])).style('text-anchor', 'end').attr('dx', '');\n    d3.select('#inform5bar-no-score').transition().duration(500).attr('width', (parse(informTestingData['no-score']/maxinformtest)*64));\n\n    // num countries filtered (table)\n    d3.select('#countries_filtered tspan').text(numCountriesFiltered+' countries filtered').style('text-anchor', 'end').attr('dx', '105');\n\n  }\n\n  d3.select('#prev').style('cursor', 'pointer')\n  .attr('opacity', 0.5)\n  .on('click',function(){\n    if(options.page==1) return false;\n    options.page = options.page-1;\n    updateTable(data, options);\n  })\n\n\n  d3.select('#next').style('cursor', 'pointer').on('click',function(){\n    if(options.page==options.numPages) return false;\n    options.page = options.page+1;\n    updateTable(data, options);\n  })\n\n  async function updateTable(data, options){\n\n    // var lastRecord = data.vaccines_data_cumulative.filter(d=>d.date.getTime()==data.max_date.getTime());\n    // var vGroup = d3.flatGroup(lastRecord, d => d.iso_code);\n\n    // data.country.forEach(function(d,i){\n    //   var vaccine_acceptance_percent = (d.vaccine_acceptance_percent) || 0\n    //   if(!vGroup.some(item => item[0] === d.country_iso3)){\n    //     vGroup.push([d.country_iso3, [{\n    //       country_name: d.country_name,\n    //       country_code: d.country_iso2,\n    //       vaccine_acceptance_percent: vaccine_acceptance_percent\n    //     }]])\n    //   }\n    //   vGroup.forEach(function(dd,ii){\n    //     if(dd[0]==d.country_iso3){\n    //       dd[1][0].vaccine_acceptance_percent = vaccine_acceptance_percent;\n    //       dd[1][0].country_name = d.country_name;\n    //       dd[1][0].country_code = d.country_iso2;\n    //     }\n    //   })\n    // })\n\n    var sortKey;\n    if(options.table_sort=='col0_sort') sortKey = 'country_name';\n    if(options.table_sort=='col1_sort') sortKey = 'total_vaccinations_per_hundred';\n    if(options.table_sort=='col2_sort') sortKey = 'people_vaccinated_per_hundred';\n    if(options.table_sort=='col3_sort') sortKey = 'people_fully_vaccinated_per_hundred';\n    if(options.table_sort=='col4_sort') sortKey = 'vaccine_acceptance_percent';\n    if(options.table_sort=='col5_sort') sortKey = 'total_vaccinations';\n\n    for(var x = 0; x<6; x++){\n      d3.select('#col'+x+'_sort_desc').attr('opacity', 0);\n      d3.select('#col'+x+'_sort_asc').attr('opacity', 0);\n    }\n\n    d3.select('#'+options.table_sort+'_'+options.table_sort_direction)\n    .attr('opacity', 1);\n\n    if(sortKey=='country_name'){\n      if(options.table_sort_direction=='asc') {\n        data.country.sort(function(b, a){\n          return a.country_name.localeCompare(b.country_name);\n        })\n      } else {\n        data.country.sort(function(a, b){\n          return a.country_name.localeCompare(b.country_name);\n        })    \n      }\n\n    } else {\n      if(options.table_sort_direction=='desc') {\n        data.country.sort(function(a,b){\n            return b[sortKey] - a[sortKey];\n        });\n      } else {\n        data.country.sort(function(b,a){\n          return b[sortKey] - a[sortKey];\n        });\n      }\n    }\n\n  //   data.vGroup = vGroup;\n\n  //   data.vGroup.forEach(function(d,i){\n  //     data.equity_data.forEach(function(dd,ii){\n  //         if(d[0] == dd.country_iso3){\n  //             dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n  //             dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n  //             dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n  //             dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n  //         }\n  //     })\n  // })\n\n\n    d3.selectAll('.tablerow').remove();\n    d3.selectAll('.col1bar').attr('opacity', 0);\n    d3.selectAll('.col2bar').attr('opacity', 0);\n    d3.selectAll('.col3bar').attr('opacity', 0);\n    d3.selectAll('.col4bar').attr('opacity', 0);\n    d3.selectAll('.colbg').attr('opacity', 0);\n    d3.selectAll('.table_country_name tspan').text('');\n\n    options.numPages = Math.ceil(data.country.length/10);\n\n    d3.select('#next').attr('opacity', function(){\n      if(options.page==options.numPages) return 0.5;\n      return 1;\n    })\n\n    d3.select('#prev')\n    .attr('opacity', function(){\n      if(options.page==1) return 0.5;\n      return 1;\n    })\n\n    d3.select('#pagination_text').attr('text-anchor', 'end');\n    d3.select('#pagination_text tspan').attr('x', 40);\n    d3.select('#pagination_text tspan').text('Page '+options.page + ' of '+options.numPages)\n\n    var i = 0;\n    var delay = 10;\n    const timer = ms => new Promise(res => setTimeout(res, ms));\n\n    for(let k = ((options.page-1)*10); k < ((options.page)*10); k++){\n\n      var d = data.country[k];\n      if(!data.country[k]) {\n        d3.select('#col1bar'+i)\n        .attr('width', 0);\n        d3.select('#col2bar'+i)\n        .attr('width', 0)\n        d3.select('#col3bar'+i)\n        .attr('width', 0)\n        d3.select('#col4bar'+i)\n        .attr('width', 0)\n        continue;\n      }\n\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow table_country_name')\n      .text(function(){\n        var name;\n        if(d.country_name) { name = d.country_name; } else {\n          name = d.country_code;\n        }\n        name = name.substring(0,17);\n        if(name.length==17)name=name+'.';\n        return name;\n      })\n      .attr('x', 0)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 1 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow table_country_name')\n      .text(function(){\n        var val = parseFloat(d.total_vaccinations_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 112)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 1 bar\n      d3.select('#col1bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.total_vaccinations_per_hundred;\n        if(d.total_vaccinations_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n\n      d3.select('#col1bg'+i)\n      .attr('opacity', 1);\n\n      // col 2 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.people_vaccinated_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 223)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 2 bar\n      d3.select('#col2bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.people_vaccinated_per_hundred;\n        if(d.people_vaccinated_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n\n      d3.select('#col2bg'+i)\n      .attr('opacity', 1);\n\n      // col 3 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.people_fully_vaccinated_per_hundred).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 335)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 3 bar\n      d3.select('#col3bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.people_fully_vaccinated_per_hundred;\n        if(d.people_fully_vaccinated_per_hundred>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n      \n      d3.select('#col3bg'+i)\n      .attr('opacity', 1);\n\n      // col 4 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = parseFloat(d.vaccine_acceptance_percent).toFixed(1);\n        if((isNaN(val))||(val==0)){ return ''} else { return val+'%' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 450)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n\n      // col 4 bar\n      d3.select('#col4bar'+i)\n      .attr('opacity', 1)\n      .transition()\n      .duration(200)\n      .attr('width', function(){\n        var val = d.vaccine_acceptance_percent;\n        if(d.vaccine_acceptance_percent>100){\n          val = 100\n        } \n        if(isNaN(val)){ return 0} else { return 68*(val/100) }\n      });\n      \n      d3.select('#col4bg'+i)\n      .attr('opacity', 1);\n\n\n      var dayFormat = d3.timeFormat(\"%b %d\");\n      // col 5 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = (d.total_vaccinations);\n        if((isNaN(val))||(val==0)){ return ''} else { return nFormatter(val) }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 572)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n      \n      // col 6 val\n      d3.select('#vac-tab').append('text')\n      .attr('class','tablerow')\n      .text(function(){\n        var val = (d.data_updated);\n        if((val)){ return dayFormat(val)} else { return '' }\n      })\n      .style('text-anchor', 'end')\n      .attr('x', 620)\n      .attr('y', function(){\n        return 80+(i*24.8);\n      })\n      .style('fill', '#000')\n      .style('font-size', '9px');\n      \n      i++;\n      \n      await timer(15);\n    }\n\n  }\n\n  function createSelects(){\n     // region select\n      $('#regionSelect').select2({\n        data: [{\n          id: 'regions',\n          text: 'IFRC Regions',\n          children: regionOptions\n        },{\n          id: 'countries',\n          text: 'Countries',\n          children: countryOptions\n        }],\n        placeholder: '',\n        scrollAfterSelect: true,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:unselecting', function() {\n          $(this).data('unselecting', true);\n      }).on('select2:opening', function(e) {\n          if ($(this).data('unselecting')) {\n              $(this).removeData('unselecting');\n              e.preventDefault();\n          }\n      });\n\n      $('#regionSelect').on('select2:select', function (e) {\n          var data = e.params.data;\n          filter([data.id]);\n      });\n\n      $('#regionSelect').on('select2:unselect', function (e) {\n        var data = e.params.data;\n        filter([data.id]);\n    });\n\n      // reset locations\n      d3.select('#reset_locations').style('cursor', 'pointer')\n      .on('click', function(){\n        filter('clear');\n      }); \n\n      // bubble map select color by\n      $('#colorSelect').select2({\n        scrollAfterSelect: true,\n        minimumResultsForSearch: -1,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:select', function(e) {\n        var d = e.params.data;\n        options.bubble_chart_color_by = d.id;\n        updateBubblechart(data, options, filter);\n      });\n\n      // bubble map select y-axis\n      $('#ySelect').select2({\n        scrollAfterSelect: true,\n        minimumResultsForSearch: -1,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      }).on('select2:select', function(e) {\n        var d = e.params.data;\n        options.bubble_chart_y_axis = d.id;\n        updateBubblechart(data, options, filter);\n      });\n\n  }\n\n  function handleSelectLength(){\n    var values = $('#regionSelect').select2('data');\n    // handle height for many selections\n    var select2HeightRatio = $('#regionSelectContainer').width()/$('#regionSelectContainer').height();\n    if(select2HeightRatio<10){\n      $('.select2-selection__choice').hide();\n      $('.select2-search__field').attr('placeholder', values.length+' LOCATIONS SELECTED' ).css('width', '100%')\n    } else {\n      $('.select2-search__field').attr('placeholder', '' );\n      $('.select2-selection__choice').show();\n    }\n  }\n\n  useEffect(() => {\n    init();\n  }, [])\n\n\n  const selectStyle = {\n    control: (base, state) => ({\n      ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n          border: '1px solid #D8D8D8',\n      }\n  })\n  };\n\n  return (\n    <div>\n      <div id=\"loaderDiv\">\n        <div id=\"loaderText\">{loaderText}</div>\n        <div id=\"loaderBar\">\n          <div id=\"loaderProgress\" style={{width: progress*100+'%'}}></div>\n        </div>\n      </div>\n\n      <div id=\"regionSelectContainer\">\n        <select id=\"regionSelect\" className=\"js-example-responsive\" name=\"region[]\" multiple=\"multiple\"></select>\n        <div id=\"regionDrop\"></div>\n      </div>\n\n      <div id=\"bubbleSelectContainer\">\n        <div id=\"colorSelectContainer\">Color by&nbsp;&nbsp;\n        <select id=\"colorSelect\" className=\"js-example-responsive\" name=\"colorby[]\" defaultValue=\"hdi\">\n          <option value=\"region\">IFRC region</option>\n          <option value=\"hdi\">Human Development Index (HDI)</option>\n          <option value=\"inform-severity\">INFORM Severity Index</option>\n        </select>\n        <div id=\"colorDrop\"></div>\n        </div>\n        <div id=\"ySelectContainer\">\n          y-Axis&nbsp;&nbsp;\n        <select id=\"ySelect\" className=\"js-example-responsive\" name=\"yaxis[]\">\n          <option value=\"percent-vaccinated-at-least-1-dose\">% vaccinated at least 1 dose</option>\n          <option value=\"percent-fully-vaccinated\">% fully vaccinated</option>\n          <option value=\"percent-vaccine-acceptance\">% vaccine acceptance</option>\n        </select>\n        <div id=\"yDrop\"></div>\n        </div>\n      </div>\n\n\n    <div id=\"svg_container\" className=\"App\">\n\n    </div>\n    <div id=\"map_div_outer\">\n      <div id=\"map_div\">\n      </div>\n    </div>\n    \n    <div id=\"footer\">Data Sources - <a href=\"https://covid19.who.int/info/\" target=\"_blank\">WHO Daily cases and deaths by date, vaccination data</a>, <a href=\"https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations\" target=\"_blank\">OWID vaccinations csv</a></div>\n\n    </div>\n  );\n}\n\nfunction parse(p){\n  if(isNaN(p)){\n    return 0\n  } else {\n    return p;\n  }\n}\n\nexport default App;\n\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}