(this["webpackJsonpifrc-covid-dataviz"]=this["webpackJsonpifrc-covid-dataviz"]||[]).push([[0],{128:function(t,e,a){},134:function(t,e,a){"use strict";a.r(e);var n=a(6),i=a.n(n),r=a(38),o=a.n(r),c=a(5),l=a.n(c),s=(a(24),a(25)),u=a(4),_=a(0),d=a(1),h=a.n(d),p={hdi_category:{"very-high":"#D8EF8B",high:"#FDE08B",medium:"#FB8D59",low:"#D63127"},inform_severity:{"very-high":"#D63127",high:"#FB8D59",medium:"#FDE08B",low:"#D8EF8B","no-score":"#DAE0EA"},blue:"#1F558C",lightblue:"#62D7F7",lightnavy:"#799EAD",red:"#EE3224",green:"#D8EF8B",ifrcgreen:"#87C400",black:"#595454",lightgrey:"#e8e8e8",darkgrey:"#c1c1c1",white:"#fff",olive:"#87C400",purple:"#771966",orange:"#FF3500",pink:"#FB0080"},g=["#00ADED","#62D7F7","#003A5A","#799EAD","#FFDD00"];p.regions={AP:p.orange,AM:p.lightblue,EU:p.ifrcgreen,ME:"#0A3248",AF:"#FCD204"},p.regions={AP:g[1],AM:g[0],EU:g[2],ME:g[3],AF:g[4]};var m=p;function f(t){for(var e=(t+="").split("."),a=e[0],n=e.length>1?"."+e[1]:"",i=/(\d+)(\d{3})/;i.test(a);)a=a.replace(i,"$1,$2");return a+n}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"B"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}],n=/\.0+$|(\.[0-9]*[1-9])0+$/,i=a.slice().reverse().find((function(e){return t>=e.value}));return i?(t/i.value).toFixed(e).replace(n,"$1")+i.symbol:"0"}var v,b,x,w,k,F,O,A,E,q,T,D,N,M,j,P,C,S,I,H,B,z=a(26),R=a(10),L=a.n(R),W=["AF","AP","ME","EU","AM","OTH"];function U(t,e){j=new Date(t.min_date),M=new Date(t.max_date);var a=[];if(t.who_data.forEach((function(t,n){a[t[e.timeline_frequency+"Total"]]||(a[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.month_start),a[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(a[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_cases+=t.new_cases,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_deaths+=t.new_deaths,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_cases=0})),a.forEach((function(t,e){W.forEach((function(n,i){t.hasOwnProperty(n)||(t[n]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),e>0?(t[n].cumulative_cases=a[e][n].new_cases+a[e-1][n].cumulative_cases,t[n].cumulative_deaths=a[e][n].new_deaths+a[e-1][n].cumulative_deaths):(t[n].cumulative_cases=a[e][n].new_cases,t[n].cumulative_deaths=a[e][n].new_deaths)})),t.total_new_cases=t.AF.new_cases+t.AP.new_cases+t.AM.new_cases+t.EU.new_cases+t.ME.new_cases+t.OTH.new_cases,t.total_cumulative_cases=t.AF.cumulative_cases+t.AP.cumulative_cases+t.AM.cumulative_cases+t.EU.cumulative_cases+t.ME.cumulative_cases+t.OTH.cumulative_cases,t.total_new_deaths=t.AF.new_deaths+t.AP.new_deaths+t.AM.new_deaths+t.EU.new_deaths+t.ME.new_deaths+t.OTH.new_deaths,t.total_cumulative_deaths=t.AF.cumulative_deaths+t.AP.cumulative_deaths+t.AM.cumulative_deaths+t.EU.cumulative_deaths+t.ME.cumulative_deaths+t.OTH.cumulative_deaths,t.region=[],W.forEach((function(e,a){t.region.push({region:e,new_cases:t[e].new_cases,new_deaths:t[e].new_deaths,cumulative_cases:t[e].cumulative_cases,cumulative_deaths:t[e].cumulative_deaths})}))})),C=[],"cumulative"!=e.timeline_type)t.vaccines_data.forEach((function(t,a){C[t[e.timeline_frequency+"Total"]]||(C[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.month_start),C[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(C[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_vaccines:0}),C[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_vaccines+=t.daily_vaccinations})),C.forEach((function(t,e){W.forEach((function(e,a){t[e]||(t[e]={new_vaccines:0,cumulative_vaccines:0})})),t.total_new_vaccines=t.AF.new_vaccines+t.AP.new_vaccines+t.AM.new_vaccines+t.EU.new_vaccines+t.ME.new_vaccines+t.OTH.new_vaccines,t.region=[],W.forEach((function(e,a){var n=0;t[e].new_vaccines>0&&(n+=t[e].new_vaccines),t.region.push({region:e,new_vaccines:n})}))}));else{var n=[];if("day"===e.timeline_frequency&&(n=L()(t.vaccines_data)),"week"===e.timeline_frequency&&t.vaccines_data.forEach((function(e,a){var i=h()(e.date).endOf("isoWeek").startOf("day").unix(),r=h()(e.date).startOf("day").unix();r!=i&&r!=h()(t.max_date).startOf("day").unix()||n.push(e)})),"month"===e.timeline_frequency){var i=h()(t.max_date).startOf("day").unix();t.vaccines_data.forEach((function(e,a){var r=h()(e.date).endOf("month").startOf("day").unix(),o=h()(e.date).startOf("day").unix();(o==r||h()(t.max_date).startOf("day").unix()!=r&&o==i)&&n.push(e)}))}n.forEach((function(t,a){C[t[e.timeline_frequency+"Total"]]||(C[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.month_start),C[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(C[t[e.timeline_frequency+"Total"]][t.ifrc_region]={cumulative_vaccines:0}),C[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_vaccines+=t.total_vaccinations})),C.forEach((function(t,e){W.forEach((function(e,a){t[e]||(t[e]={cumulative_vaccines:0})})),t.total_cumulative_vaccines=t.AF.cumulative_vaccines+t.AP.cumulative_vaccines+t.AM.cumulative_vaccines+t.EU.cumulative_vaccines+t.ME.cumulative_vaccines+t.OTH.cumulative_vaccines,t.region=[],W.forEach((function(e,a){t.region.push({region:e,cumulative_vaccines:t[e].cumulative_vaccines})}))}))}C=C.filter((function(t){return t}));var r=_.h(t.who_data,(function(t,a){return t[e.timeline_frequency+"Total"]})),o=_.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_cases:"cumulative"===e.timeline_type?t.total_cumulative_cases:"stacked"===e.timeline_type?100:void 0})),c=_.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_deaths:"cumulative"===e.timeline_type?t.total_cumulative_deaths:"stacked"===e.timeline_type?100:void 0})),l=_.h(C,(function(t,a){if(t){if("non-cumulative"===e.timeline_type)return t.total_new_vaccines;if("cumulative"===e.timeline_type)return t.total_cumulative_vaccines;if("stacked"===e.timeline_type)return 100}}));"month"===e.timeline_frequency&&(j=h()(j).startOf("month").startOf("day").toDate()),"month"===e.timeline_frequency&&(M=h()(M).endOf("month").startOf("day").toDate()),"week"===e.timeline_frequency&&(M=h()(M).endOf("isoWeek").startOf("day").toDate()),P=h()(M),"day"===e.timeline_frequency&&(P=new Date(h()(M).add(1,"days").toDate()));var s=_.o("#timechart_svg");s.selectAll("g").remove(),_.p("#layout .yAxis").remove(),_.p("#yAxis").remove(),_.p("#layout .xAxis").remove(),s.append("g").append("rect").attr("width",2e3).attr("height","100%").attr("x",0).attr("y",0).attr("fill","#FFF").attr("opacity",0);var u=2e3/r,d=.04;"month"===e.timeline_frequency&&(d=.03),"day"===e.timeline_frequency&&(d=.02),q=_.n().range([0,2e3]).domain([j,P]),D=_.n().range([0,596]).domain([j,P]),v=_.l().range([0,140]).domain([0,o]),O=_.l().range([140,0]).domain([0,o]),b=_.l().range([0,140]).domain([0,c]),A=_.l().range([140,0]).domain([0,c]),x=_.l().range([0,140]).domain([0,l]),E=_.l().range([140,0]).domain([0,l]),T=_.a().scale(D).tickSize(2).tickPadding(3),w=_.c().scale(O).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)})),k=_.c().scale(A).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)})),F=_.c().scale(E).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)}));var p=_.o("#layout").append("g").attr("id","yAxis").attr("clip-path","url(#mask)"),g=(p.append("g").attr("class","yAxis axis").attr("id","casesAxis").attr("transform","translate(620,363)").call(w),p.append("g").attr("class","yAxis axis").attr("id","deathsAxis").attr("transform","translate(620,534)").call(k),p.append("g").attr("class","yAxis axis").attr("id","VaccinesAxis").attr("transform","translate(620,707.5)").call(F),p.append("g").attr("id","casesXAxis").attr("class","xAxis").attr("transform","translate(24,504)").call(T)),f=p.append("g").attr("id","deathsXAxis").attr("class","xAxis").attr("transform","translate(24,674)").call(T),R=p.append("g").attr("id","vaccinesXAxis").attr("class","xAxis").attr("transform","translate(24,848)").call(T),U=p.append("g").attr("id","timelineXAxis").attr("class","xAxis").attr("transform","translate(24,908)").call(T),Y=s.selectAll(".bar_group").data(a).enter().append("g").attr("class","bar_group").attr("transform",(function(t,e){return"translate("+q(t.date)+")"}));Y.selectAll(".cases_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class",(function(t,e){return"timeBar cases_bar time_"+t.region})).attr("x",u*d).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_cases-_.o(this.parentNode).datum().OTH.new_cases,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_cases),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_cases),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_cases);var o=0;return"cumulative"===e.timeline_type&&(o=140-v(t.cumulative_cases)-v(i)),"non-cumulative"===e.timeline_type&&(o=140-v(t.new_cases)-v(i)),"stacked"===e.timeline_type&&(o=140-t.new_cases/n*140-i/n*140),o&&o>0?o:0})).attr("width",u-u*d*2).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_cases-_.o(this.parentNode).datum().OTH.new_cases,i=0;return"cumulative"===e.timeline_type&&(i=v(t.cumulative_cases)),"non-cumulative"===e.timeline_type&&(i=v(t.new_cases)),"stacked"===e.timeline_type&&(i=t.new_cases/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return m.regions[t.region]})),Y.selectAll(".deaths_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class",(function(t,e){return"timeBar deaths_bar time_"+t.region})).attr("x",u*d).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_deaths-_.o(this.parentNode).datum().OTH.new_deaths,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_deaths),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_deaths),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_deaths);var o=0;return"cumulative"===e.timeline_type&&(o=140-b(t.cumulative_deaths)-b(i)+170),"non-cumulative"===e.timeline_type&&(o=140-b(t.new_deaths)-b(i)+170),"stacked"===e.timeline_type&&(o=140-t.new_deaths/n*140-i/n*140+170),o&&o>0?o:0})).attr("width",u-u*d*2).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_deaths-_.o(this.parentNode).datum().OTH.new_deaths,i=0;return"cumulative"===e.timeline_type&&(i=b(t.cumulative_deaths)),"non-cumulative"===e.timeline_type&&(i=b(t.new_deaths)),"stacked"===e.timeline_type&&(i=t.new_deaths/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return m.regions[t.region]})),"month"===e.timeline_frequency&&Y.selectAll(".timeBar").attr("width",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(1-d)})).attr("x",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(d/2)}));var V=s.selectAll(".vbar_group").data(C).enter().append("g").attr("class","vbar_group").attr("transform",(function(t,e){return"translate("+q(t.date)+", 344)"}));V.selectAll(".vaccines_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class","timeBar vaccines_bar").attr("class",(function(t,e){return"timeBar vaccines_bar time_"+t.region})).attr("x",u*d).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_vaccines-_.o(this.parentNode).datum().OTH.new_vaccines,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_vaccines),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_vaccines),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_vaccines);var o=0;return"cumulative"===e.timeline_type&&(o=140-x(t.cumulative_vaccines)-x(i)),"non-cumulative"===e.timeline_type&&(o=140-x(t.new_vaccines)-x(i)),"stacked"===e.timeline_type&&(o=140-t.new_vaccines/n*140-i/n*140),o&&o>0?o:0})).attr("width",u-u*d*2).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_vaccines-_.o(this.parentNode).datum().OTH.new_vaccines,i=0;return"cumulative"===e.timeline_type&&(i=x(t.cumulative_vaccines)),"non-cumulative"===e.timeline_type&&(i=x(t.new_vaccines)),"stacked"===e.timeline_type&&(i=t.new_vaccines/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return m.regions[t.region]})),"month"===e.timeline_frequency&&V.selectAll(".timeBar").attr("width",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(1-d)})).attr("x",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(d/2)})),"month"===e.timeline_frequency&&Y.selectAll(".timeBar").attr("width",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(1-d)})).attr("x",(function(t){var e=_.o(this.parentNode).datum().date,a=_.s.offset(e,1);return(q(a)-q(e))*(d/2)})),B=t.timeline_data,N=_.n().range([25,619]).domain([j,P]),document.getElementById("svg").appendChild(_.o("#timeline_tooltip").node()),document.getElementById("svg").appendChild(_.o("#event_tooltip").node()),I=_.o("#timeline_tooltip").attr("opacity",0),H=_.o("#event_tooltip").attr("opacity",0),S=s.append("rect").attr("id","timechart_hover").attr("width",u).attr("x",0).attr("y",0).attr("opacity",0).attr("height","100%").attr("fill","rgb(221 221 221 / 40%)"),_.o("#timechart_svg").on("mouseover",(function(t){var a=_.k(t);S.attr("opacity",1);var n=q.invert(a[0]);"week"==e.timeline_frequency&&(n=h()(n).startOf("isoWeek")),"day"==e.timeline_frequency&&(n=h()(n).startOf("day")),"month"==e.timeline_frequency&&(n=h()(n).startOf("month")),a[1]<470?(I.attr("opacity",1).attr("display","inline"),S.attr("height","100%")):a[1]>510?(H.attr("opacity",1),S.attr("height","90%")):(H.attr("opacity",0),I.attr("opacity",0),S.attr("height","100%")),n.toDate().getTime()<j.getTime()&&(S.attr("opacity",0),I.attr("opacity",0)),_.o("#svg_container").style("z-index",10)})).on("mouseout",(function(t){S.attr("opacity",0),I.attr("opacity",0).attr("display","none"),_.o("#svg_container").style("z-index",1),H.attr("opacity",0).attr("transform","translate(0,0)"),_.p(".event_marker circle").style("stroke",m.black)})).on("mousemove",(function(t){var n=_.k(t),i=q.invert(n[0]),r="";"week"==e.timeline_frequency&&(r=(i=h()(i).startOf("isoWeek")).format("ll"),_.o("#timeline_tooltip_date tspan").text(r)),"day"==e.timeline_frequency&&(r=(i=h()(i).startOf("day")).format("ll"),_.o("#timeline_tooltip_date tspan").text(r)),"month"==e.timeline_frequency&&(r=(i=h()(i).startOf("month")).format("MMMM YYYY"),_.o("#timeline_tooltip_date tspan").text(r)),S.attr("x",q(i.toDate()));var o=a.filter((function(t,e){return h()(t.date).startOf("day").unix()==i.startOf("day").unix()})),c=C.filter((function(t,e){return h()(t.date).startOf("day").unix()==i.startOf("day").unix()})),l="-",s="-",d="-";if("cumulative"==e.timeline_type?(o[0]&&(s=y(o[0].total_cumulative_cases,2)),o[0]&&(l=y(o[0].total_cumulative_deaths,2)),c[0]&&(d=y(c[0].total_cumulative_vaccines,2))):(o[0]&&(s=y(o[0].total_new_cases,2)),o[0]&&(l=y(o[0].total_new_deaths,2)),c[0]&&(d=y(c[0].total_new_vaccines,2))),0==l&&(l="-"),0==s&&(s="-"),0==d&&(d="-"),_.o("#tooltip_cases tspan").text(s).attr("text-anchor","end").attr("dx",32),_.o("#tooltip_deaths tspan").text(l).attr("text-anchor","end").attr("dx",32),_.o("#tooltip_vaccines tspan").text(d).attr("text-anchor","end").attr("dx",32),i.toDate().getTime()<j.getTime()&&"day"==e.timeline_frequency&&(S.attr("opacity",0),I.attr("opacity",0)),"month"==e.timeline_frequency&&S.attr("width",(function(){return q(h()(i).endOf("month"))-q(h()(i).startOf("month"))})),I.attr("transform",(function(){var t=(e.brushR-e.brushL)/600,a=0;return t<.5&&(a=3),t<.3&&(a=12),t<.2&&(a=20),t<.15&&(a=21),"month"==e.timeline_frequency?(t<.6&&(a=20),t<.5&&(a=30),t<.3&&(a=50),t<.2&&(a=60),t<.1&&(a=70),"translate("+(N(i.toDate())+u/3+a)+","+(n[1]+353)+")"):"translate("+(N(i.toDate())+18+a)+","+(n[1]+353)+")"})),n[1]<470)I.attr("opacity",1),S.attr("opacity",1),S.attr("height","100%");else if(n[1]>510){H.attr("opacity",1),S.attr("height","90%");var p=h()(q.invert(n[0])).startOf("day");q.invert(n[0]);H.attr("transform",(function(){return"translate("+(N(p.toDate())+-3)+",817)"}));var g=B.filter((function(t,e){return h()(t.date).startOf("day").unix()==p.unix()}));if(0==g.length&&(g=B.filter((function(t,e){return h()(t.date).startOf("day").unix()<=h()(p).add(1,"days").unix()&&h()(t.date).startOf("day").unix()>=h()(p).subtract(1,"days").unix()}))),g.length>0){_.o("#event-"+h()(g[0].date).startOf("day").unix()).select("path").style("stroke","#000").attr("opacity",1),r=h()(g[0].date).startOf("day").format("ll"),_.o("#event_tooltip_date tspan").text(r);var f=Object(z.textwrap)().bounds({height:200,width:230}).method("tspans");t=_.o("#event_tooltip_text").text(g[0].description).attr("y",18).attr("x",6);_.o("#event_tooltip_text").call(f),_.p("#event_tooltip_text tspan").attr("dy","1.3em");var v=_.o("#event_tooltip_text").node().getBBox();_.o("#event_tooltip_rect").attr("width",v.width+17).attr("height",v.height+26);_.o("#event_tooltip_rect").attr("height");var b=0;v.height<20?b=19:v.height<30?b=9:v.height<40?b=0:(v.height<50||v.height<60)&&(b=-20);_.o("#event_tooltip_rect").attr("y");_.o("#event_tooltip_rect").attr("y",b),_.p("#event_tooltip_text").attr("y",(function(t,e){return parseInt(_.o(this).attr("y"))+b})),_.p("#event_tooltip_date tspan").attr("dy",(function(t,e){return b})),H.attr("opacity",1)}else _.p(".event_marker circle").style("stroke",m.black),H.attr("opacity",0)}else H.attr("opacity",0),I.attr("opacity",0),S.attr("opacity",0),S.attr("height","100%");if("day"==e.timeline_frequency&&i.toDate().getTime()<j.getTime())return S.attr("opacity",0),I.attr("opacity",0),!1})),B=B.filter((function(t){return t.date.length>0})),p.append("line").attr("id","event-line").attr("x1",0).attr("x2",620).attr("y1",893).attr("y2",893).attr("stroke-width",2.5).attr("stroke",m.black);var Z=p.append("g").selectAll(".event_marker").data(B).enter().append("g").attr("class","event_marker").attr("id",(function(t,e){return"event-"+h()(t.date).startOf("day").unix()})).attr("transform",(function(t){return"translate("+N(new Date(t.date))+", 893)"})).style("cursor","pointer");Z.append("circle").style("stroke",m.black).attr("opacity",1).attr("r",6.5).attr("cx",0).attr("cy",0).style("stroke-width",2.2).style("fill","white"),Z.append("circle").attr("r",2).attr("cx",0).attr("cy",0).attr("fill",m.black).style("stroke",m.black);var $=_.d().extent([[0,0],[600,20]]).on("start brush end",(function(){var t=parseFloat(_.o(".handle--w").attr("x")),a=parseFloat(_.o(".handle--e").attr("x"));if(a-t<40)return!1;_.o(".selection").attr("width");_.o("#zoomL").attr("transform","translate("+t+",0)"),_.o("#zoomR").attr("transform","translate("+a+",0)"),_.o("#zoomOverlay").attr("width",a-t),_.o("#zoomOverlay").attr("x",t),_.o("#zoomOverlay").attr("transform","translate(3,0)");var n=Math.round(X(a)-X(t)),i=Math.round(X(t));e.brushL=t+3,e.brushR=a+3,D=_.n().range([0,596]).domain([new Date(q.invert(X(t))),new Date(q.invert(X(a)))]),N=_.n().range([25,619]).domain([new Date(q.invert(X(t))),new Date(q.invert(X(a)))]),_.p(".event_marker").attr("transform",(function(t){return"translate("+N(new Date(t.date))+", 893)"})),T=_.a().ticks(5).scale(D),g.call(T),f.call(T),R.call(T),U.call(T),_.o("#timechart_svg").attr("viewBox",i+" 0 "+n+" 553")}));_.o(".brush").remove();var J=_.o("#zoombar").append("g").attr("class","brush").attr("opacity",.1).call($);_.p(".handle rect").attr("fill-opacity","1").style("visibility","visible").attr("width",2).attr("fill","#000").style("stroke-opacity",0);var X=_.l().domain([-3,597]).range([0,2e3]);J.call($.move,[e.brushL,e.brushR])}function Y(t,e){var a=[];if(t.who_data.forEach((function(t,n){a[t[e.timeline_frequency+"Total"]]||(a[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.month_start),a[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(a[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_cases+=t.new_cases,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_deaths+=t.new_deaths,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_cases=0})),a.forEach((function(t,e){W.forEach((function(n,i){t.hasOwnProperty(n)||(t[n]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),e>0?(t[n].cumulative_cases=a[e][n].new_cases+a[e-1][n].cumulative_cases,t[n].cumulative_deaths=a[e][n].new_deaths+a[e-1][n].cumulative_deaths):(t[n].cumulative_cases=a[e][n].new_cases,t[n].cumulative_deaths=a[e][n].new_deaths)})),t.total_new_cases=t.AF.new_cases+t.AP.new_cases+t.AM.new_cases+t.EU.new_cases+t.ME.new_cases+t.OTH.new_cases,t.total_cumulative_cases=t.AF.cumulative_cases+t.AP.cumulative_cases+t.AM.cumulative_cases+t.EU.cumulative_cases+t.ME.cumulative_cases+t.OTH.cumulative_cases,t.total_new_deaths=t.AF.new_deaths+t.AP.new_deaths+t.AM.new_deaths+t.EU.new_deaths+t.ME.new_deaths+t.OTH.new_deaths,t.total_cumulative_deaths=t.AF.cumulative_deaths+t.AP.cumulative_deaths+t.AM.cumulative_deaths+t.EU.cumulative_deaths+t.ME.cumulative_deaths+t.OTH.cumulative_deaths,t.region=[],W.forEach((function(e,a){t.region.push({region:e,new_cases:t[e].new_cases,new_deaths:t[e].new_deaths,cumulative_cases:t[e].cumulative_cases,cumulative_deaths:t[e].cumulative_deaths})}))})),C=[],"cumulative"!=e.timeline_type)t.vaccines_data.forEach((function(t,a){C[t[e.timeline_frequency+"Total"]]||(C[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=h()(t.date).startOf("isoWeek").toDate()),"month"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=h()(t.date).startOf("month").toDate()),C[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(C[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_vaccines:0}),C[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_vaccines+=t.daily_vaccinations})),C.forEach((function(t,e){W.forEach((function(e,a){t[e]||(t[e]={new_vaccines:0,cumulative_vaccines:0})})),t.total_new_vaccines=t.AF.new_vaccines+t.AP.new_vaccines+t.AM.new_vaccines+t.EU.new_vaccines+t.ME.new_vaccines+t.OTH.new_vaccines,t.region=[],W.forEach((function(e,a){t.region.push({region:e,new_vaccines:t[e].new_vaccines})}))}));else{var n=[];if("day"===e.timeline_frequency&&(n=L()(t.vaccines_data)),"week"===e.timeline_frequency&&t.vaccines_data.forEach((function(e,a){var i=h()(e.date).endOf("isoWeek").startOf("day").unix(),r=h()(e.date).startOf("day").unix();r!=i&&r!=h()(t.max_date).startOf("day").unix()||n.push(e)})),"month"===e.timeline_frequency){var i=h()(t.max_date).startOf("day").unix();t.vaccines_data.forEach((function(e,a){var r=h()(e.date).endOf("month").startOf("day").unix(),o=h()(e.date).startOf("day").unix();(o==r||h()(t.max_date).startOf("day").unix()!=r&&o==i)&&n.push(e)}))}n.forEach((function(t,a){C[t[e.timeline_frequency+"Total"]]||(C[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=h()(t.date).startOf("isoWeek").toDate()),"month"===e.timeline_frequency&&(C[t[e.timeline_frequency+"Total"]].date=h()(t.date).startOf("month").toDate()),C[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(C[t[e.timeline_frequency+"Total"]][t.ifrc_region]={cumulative_vaccines:0}),C[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_vaccines+=t.total_vaccinations})),C.forEach((function(t,e){W.forEach((function(e,a){t[e]||(t[e]={cumulative_vaccines:0})})),t.total_cumulative_vaccines=t.AF.cumulative_vaccines+t.AP.cumulative_vaccines+t.AM.cumulative_vaccines+t.EU.cumulative_vaccines+t.ME.cumulative_vaccines+t.OTH.cumulative_vaccines,t.region=[],W.forEach((function(e,a){t.region.push({region:e,cumulative_vaccines:t[e].cumulative_vaccines})}))}))}C=C.filter((function(t){return t}));var r=_.h(t.who_data,(function(t,a){return t[e.timeline_frequency+"Total"]})),o=_.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_cases:"cumulative"===e.timeline_type?t.total_cumulative_cases:"stacked"===e.timeline_type?100:void 0})),c=_.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_deaths:"cumulative"===e.timeline_type?t.total_cumulative_deaths:"stacked"===e.timeline_type?100:void 0})),l=_.h(C,(function(t,a){if(t){if("non-cumulative"===e.timeline_type)return t.total_new_vaccines;if("cumulative"===e.timeline_type)return t.total_cumulative_vaccines;if("stacked"===e.timeline_type)return 100}})),s=_.o("#timechart_svg"),u=2e3/r;e.timeline_frequency,e.timeline_frequency,v=_.l().range([0,140]).domain([0,o]),O=_.l().range([140,0]).domain([0,o]),b=_.l().range([0,140]).domain([0,c]),A=_.l().range([140,0]).domain([0,c]),x=_.l().range([0,140]).domain([0,l]),E=_.l().range([140,0]).domain([0,l]),w=_.c().scale(O).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)})),k=_.c().scale(A).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)})),F=_.c().scale(E).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?y(t)+"%":y(t)}));_.o("#casesAxis").transition().duration(500).call(w),_.o("#deathsAxis").transition().duration(500).call(k),_.o("#VaccinesAxis").transition().duration(500).call(F);var d=s.selectAll(".bar_group").data(a).attr("transform",(function(t,e){return"translate("+q(t.date)+")"}));d.selectAll(".cases_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_cases-_.o(this.parentNode).datum().OTH.new_cases,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_cases),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_cases),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_cases);var o=0;return"cumulative"===e.timeline_type&&(o=140-v(t.cumulative_cases)-v(i)),"non-cumulative"===e.timeline_type&&(o=140-v(t.new_cases)-v(i)),"stacked"===e.timeline_type&&(o=140-t.new_cases/n*140-i/n*140),o&&o>0?o:0})).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_cases-_.o(this.parentNode).datum().OTH.new_cases,i=0;return"cumulative"===e.timeline_type&&(i=v(t.cumulative_cases)),"non-cumulative"===e.timeline_type&&(i=v(t.new_cases)),"stacked"===e.timeline_type&&(i=t.new_cases/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return m.regions[t.region]})),d.selectAll(".deaths_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_deaths-_.o(this.parentNode).datum().OTH.new_deaths,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_deaths),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_deaths),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_deaths);var o=0;return"cumulative"===e.timeline_type&&(o=140-b(t.cumulative_deaths)-b(i)+170),"non-cumulative"===e.timeline_type&&(o=140-b(t.new_deaths)-b(i)+170),"stacked"===e.timeline_type&&(o=140-t.new_deaths/n*140-i/n*140+170),o&&o>0?o:0})).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_deaths-_.o(this.parentNode).datum().OTH.new_deaths,i=0;return"cumulative"===e.timeline_type&&(i=b(t.cumulative_deaths)),"non-cumulative"===e.timeline_type&&(i=b(t.new_deaths)),"stacked"===e.timeline_type&&(i=t.new_deaths/n*140),"non-cumulative"===e.timeline_type&&i<0?0:i&&i>0?i:0})),0==a.length&&(_.p(".cases_bar").transition().duration(500).attr("y",140).attr("height",0),_.p(".deaths_bar").transition().duration(500).attr("y",310).attr("height",0)),s.selectAll(".vbar_group").data(C).attr("transform",(function(t,e){return"translate("+q(t.date)+", 344)"})).selectAll(".vaccines_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){var n=_.o(this.parentNode).datum().total_new_vaccines-_.o(this.parentNode).datum().OTH.new_vaccines,i=0;if(a>0)for(var r=1;r<=a;r++)"cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].cumulative_vaccines),"non-cumulative"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_vaccines),"stacked"===e.timeline_type&&(i+=_.o(this.parentNode).datum().region[r-1].new_vaccines);var o=0;return"cumulative"===e.timeline_type&&(o=140-x(t.cumulative_vaccines)-x(i)),"non-cumulative"===e.timeline_type&&(o=140-x(t.new_vaccines)-x(i)),"stacked"===e.timeline_type&&(o=140-t.new_vaccines/n*140-i/n*140),o&&o>0?o:0})).attr("height",(function(t,a){var n=_.o(this.parentNode).datum().total_new_vaccines-_.o(this.parentNode).datum().OTH.new_vaccines,i=0;return"cumulative"===e.timeline_type&&(i=x(t.cumulative_vaccines)),"non-cumulative"===e.timeline_type&&(i=x(t.new_vaccines)),"stacked"===e.timeline_type&&(i=t.new_vaccines/n*140),i&&i>0?i:0})),0==C.length&&_.p(".vaccines_bar").transition().duration(500).attr("y",140).attr("height",0),_.o("#timechart_svg").on("mouseover",(function(t){var a=_.k(t);S.attr("opacity",1);var n=q.invert(a[0]);"week"==e.timeline_frequency&&(n=h()(n).startOf("isoWeek")),"day"==e.timeline_frequency&&(n=h()(n).startOf("day")),"month"==e.timeline_frequency&&(n=h()(n).startOf("month")),a[1]<470?(I.attr("opacity",1).attr("display","inline"),S.attr("height","100%")):a[1]>510?(H.attr("opacity",1),S.attr("height","90%")):(H.attr("opacity",0),I.attr("opacity",0),S.attr("height","100%")),n.toDate().getTime()<j.getTime()&&(S.attr("opacity",0),I.attr("opacity",0)),_.o("#svg_container").style("z-index",10)})).on("mouseout",(function(t){S.attr("opacity",0),I.attr("opacity",0).attr("display","none"),_.o("#svg_container").style("z-index",1),H.attr("opacity",0).attr("transform","translate(0,0)"),_.p(".event_marker circle").style("stroke",m.black)})).on("mousemove",(function(t){var n=_.k(t),i=q.invert(n[0]),r="";"week"==e.timeline_frequency&&(r=(i=h()(i).startOf("isoWeek")).format("ll"),_.o("#timeline_tooltip_date tspan").text(r)),"day"==e.timeline_frequency&&(r=(i=h()(i).startOf("day")).format("ll"),_.o("#timeline_tooltip_date tspan").text(r)),"month"==e.timeline_frequency&&(r=(i=h()(i).startOf("month")).format("MMMM YYYY"),_.o("#timeline_tooltip_date tspan").text(r)),S.attr("x",q(i.toDate()));var o=a.filter((function(t,e){return h()(t.date).startOf("day").unix()==i.startOf("day").unix()})),c=C.filter((function(t,e){return h()(t.date).startOf("day").unix()==i.startOf("day").unix()})),l="-",s="-",d="-";if("cumulative"==e.timeline_type?(o[0]&&(s=y(o[0].total_cumulative_cases,2)),o[0]&&(l=y(o[0].total_cumulative_deaths,2)),c[0]&&(d=y(c[0].total_cumulative_vaccines,2))):(o[0]&&(s=y(o[0].total_new_cases,2)),o[0]&&(l=y(o[0].total_new_deaths,2)),c[0]&&(d=y(c[0].total_new_vaccines,2))),0==l&&(l="-"),0==s&&(s="-"),0==d&&(d="-"),_.o("#tooltip_cases tspan").text(s).attr("text-anchor","end").attr("dx",32),_.o("#tooltip_deaths tspan").text(l).attr("text-anchor","end").attr("dx",32),_.o("#tooltip_vaccines tspan").text(d).attr("text-anchor","end").attr("dx",32),i.toDate().getTime()<j.getTime()&&"day"==e.timeline_frequency&&(S.attr("opacity",0),I.attr("opacity",0)),"month"==e.timeline_frequency&&S.attr("width",(function(){return q(h()(i).endOf("month"))-q(h()(i).startOf("month"))})),I.attr("transform",(function(){var t=(e.brushR-e.brushL)/600,a=0;return t<.5&&(a=3),t<.3&&(a=12),t<.2&&(a=20),t<.15&&(a=21),"month"==e.timeline_frequency?(t<.6&&(a=20),t<.5&&(a=30),t<.3&&(a=50),t<.2&&(a=60),t<.1&&(a=70),"translate("+(N(i.toDate())+u/3+a)+","+(n[1]+353)+")"):"translate("+(N(i.toDate())+18+a)+","+(n[1]+353)+")"})),n[1]<470)I.attr("opacity",1),S.attr("opacity",1),S.attr("height","100%");else if(n[1]>510){H.attr("opacity",1),S.attr("height","90%");var p=h()(q.invert(n[0])).startOf("day");q.invert(n[0]);H.attr("transform",(function(){return"translate("+(N(p.toDate())+-3)+",817)"}));var g=B.filter((function(t,e){return h()(t.date).startOf("day").unix()==p.unix()}));if(0==g.length&&(g=B.filter((function(t,e){return h()(t.date).startOf("day").unix()<=h()(p).add(1,"days").unix()&&h()(t.date).startOf("day").unix()>=h()(p).subtract(1,"days").unix()}))),g.length>0){_.o("#event-"+h()(g[0].date).startOf("day").unix()).select("path").style("stroke","#000").attr("opacity",1),r=h()(g[0].date).startOf("day").format("ll"),_.o("#event_tooltip_date tspan").text(r);var f=Object(z.textwrap)().bounds({height:200,width:230}).method("tspans");t=_.o("#event_tooltip_text").text(g[0].description).attr("y",18).attr("x",6);_.o("#event_tooltip_text").call(f),_.p("#event_tooltip_text tspan").attr("dy","1.3em");var v=_.o("#event_tooltip_text").node().getBBox();_.o("#event_tooltip_rect").attr("width",v.width+17).attr("height",v.height+26);_.o("#event_tooltip_rect").attr("height");var b=0;v.height<20?b=19:v.height<30?b=9:v.height<40?b=0:(v.height<50||v.height<60)&&(b=-20);_.o("#event_tooltip_rect").attr("y");_.o("#event_tooltip_rect").attr("y",b),_.p("#event_tooltip_text").attr("y",(function(t,e){return parseInt(_.o(this).attr("y"))+b})),_.p("#event_tooltip_date tspan").attr("dy",(function(t,e){return b})),H.attr("opacity",1)}else _.p(".event_marker circle").style("stroke",m.black),H.attr("opacity",0)}else H.attr("opacity",0),I.attr("opacity",0),S.attr("opacity",0),S.attr("height","100%");if("day"==e.timeline_frequency&&i.toDate().getTime()<j.getTime())return S.attr("opacity",0),I.attr("opacity",0),!1}))}var V,Z,$,J,X,G,K,Q,tt=20,et=0,at=58,nt=[];function it(t,e,a){t.regions.forEach((function(t,e){t.population=0,t.cumulative_deaths=0,t.cumulative_cases=0,t.cumulative_vaccines=0})),t.country.forEach((function(e,a){t.regions.forEach((function(t,a){t.code==e.ifrc_region&&(e.population>0&&e.who_daily_latest&&(e.who_daily_latest.cumulative_cases>0&&(t.cumulative_cases+=e.who_daily_latest.cumulative_cases),e.who_daily_latest.cumulative_deaths>0&&(t.cumulative_deaths+=e.who_daily_latest.cumulative_deaths||0),t.population+=e.population),e.population>0&&e.vaccine_daily_latest&&(t.cumulative_vaccines+=e.vaccine_daily_latest.total_vaccinations||0))}))})),t.regions.forEach((function(t,e){t.cumulative_cases_per_100k=t.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.cumulative_deaths/(t.population/1e5),t.cumulative_vaccines_per_100k=t.cumulative_vaccines/(t.population/1e5),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0)})),"per100"==e.region_switch?($=_.h(t.regions,(function(t,e){return t.cumulative_vaccines_per_100k})),V=_.h(t.regions,(function(t,e){return t.cumulative_cases_per_100k})),Z=_.h(t.regions,(function(t,e){return t.cumulative_deaths_per_100k}))):($=_.h(t.regions,(function(t,e){return t.cumulative_vaccines})),V=_.h(t.regions,(function(t,e){return t.cumulative_cases})),Z=_.h(t.regions,(function(t,e){return t.cumulative_deaths})));var n=_.o("#layout #region_chart_container").attr("opacity",0);Q={x:n.attr("x"),y:n.attr("y"),width:n.attr("width"),height:n.attr("height")};var i=_.o("#layout").append("g").attr("transform","translate("+Q.x+", "+Q.y+")").attr("id","region_chart"),r=Q.height/(t.regions.length-1),o=i.selectAll(".bar-row").data(t.regions.filter((function(t){return"OTH"!==t.code}))).enter().append("g").attr("class","bar-row").attr("transform",(function(t,e){return"translate(0,"+(e*r+et)+")"})),c=o.append("text").attr("y",r/2).attr("x",tt-5).attr("class",(function(t,e){return"bar-labels bar-label-"+t.code})).style("alignment-baseline","middle").style("font-size","11px").attr("opacity",1).attr("fill","#000").text((function(t,e){return"AM"===t.code?"Americas":"EU"===t.code?"Europe":"AF"===t.code?"Africa":"ME"===t.code?"Middle East and North Africa":"AP"===t.code?"Asia-Pacific":void 0})).style("text-anchor","end");K=o.node().getBBox().width+tt,c.attr("x",K+89),K+=94,_.p(".timeBar").attr("opacity",1);o.append("rect").attr("y",0).attr("x",0).attr("width",K).attr("height",r-2).style("opacity",0).attr("fill","grey").style("cursor","pointer").attr("class",(function(t,e){return"bar-bg-"+t.code})).attr("data-id",(function(t,e){return t.code})).on("mouseover",(function(t){_.o(this).style("opacity",.1)})).on("mouseout",(function(){_.o(this).style("opacity",0)})).on("click",(function(t,e){var n=_.o(this).attr("data-id");a([n],"regionchart")}));J=_.l().range([0,Q.width-at-K]).domain([0,V]),X=_.l().range([0,Q.width-at-K]).domain([0,Z]),G=_.l().range([K,Q.width-at-K]).domain([0,$]);o.append("rect").attr("id",(function(t,e){return"bar-"+t.code})).attr("data-id",(function(t,e){return t.code})).attr("class","region-bar").attr("width",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=J(t.cumulative_cases_per_100k)),"deaths"==e.region_chart_toggle&&(n=X(t.cumulative_deaths_per_100k)),"vaccines"==e.region_chart_toggle&&(n=G(t.cumulative_vaccines_per_100k))):("cases"==e.region_chart_toggle&&(n=J(t.cumulative_cases)),"deaths"==e.region_chart_toggle&&(n=X(t.cumulative_deaths)),"vaccines"==e.region_chart_toggle&&(n=G(t.cumulative_vaccines))),isNaN(n)?0:parseFloat(n)})).attr("x",K).style("outline","none").style("cursor","pointer").attr("y",.1*r-1).attr("height",r-.1*r*2).style("fill",(function(t){return m.regions[t.code]})).attr("opacity",1).on("click",(function(t,e){var n=_.o(this).attr("data-id");a([n],"regionchart")})).on("mouseover",(function(t){_.o(this.parentNode).datum()})).on("mouseout",(function(){})),o.append("text").text((function(t){var a=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(a=Math.round(t.cumulative_cases_per_100k)),"deaths"==e.region_chart_toggle&&(a=Math.round(t.cumulative_deaths_per_100k)),"vaccines"==e.region_chart_toggle&&(a=Math.round(t.cumulative_vaccines_per_100k))):("cases"==e.region_chart_toggle&&(a=Math.round(t.cumulative_cases)),"deaths"==e.region_chart_toggle&&(a=Math.round(t.cumulative_deaths)),"vaccines"==e.region_chart_toggle&&(a=Math.round(t.cumulative_vaccines))),f(a)})).attr("id",(function(t,e){return"data-label"+t.code})).attr("data-id",(function(t,e){return t.code})).attr("class","data-label").attr("y",r/2).style("alignment-baseline","middle").style("text-anchor","start").attr("x",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=J(t.cumulative_cases_per_100k)+K+5),"deaths"==e.region_chart_toggle&&(n=X(t.cumulative_deaths_per_100k)+K+5),"vaccines"==e.region_chart_toggle&&(n=G(t.cumulative_vaccines_per_100k)+K+5)):("cases"==e.region_chart_toggle&&(n=J(t.cumulative_cases)+K+5),"deaths"==e.region_chart_toggle&&(n=X(t.cumulative_deaths)+K+5),"vaccines"==e.region_chart_toggle&&(n=G(t.cumulative_vaccines)+K+5)),n})).attr("opacity",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=t.cumulative_cases_per_100k),"deaths"==e.region_chart_toggle&&(n=t.cumulative_deaths_per_100k),"vaccines"==e.region_chart_toggle&&(n=t.cumulative_vaccines_per_100k)):("cases"==e.region_chart_toggle&&(n=t.cumulative_cases),"deaths"==e.region_chart_toggle&&(n=t.cumulative_deaths),"vaccines"==e.region_chart_toggle&&(n=t.cumulative_vaccines)),n>0?1:0})).style("fill","#696969").style("font-weight","normal").style("font-size","10px")}function rt(t,e){e.regions.forEach((function(t,e){t.population=0,t.cumulative_deaths=0,t.cumulative_cases=0,t.cumulative_vaccines=0})),e.country.forEach((function(t,a){e.regions.forEach((function(e,a){e.code==t.ifrc_region&&(t.population>0&&t.who_daily_latest&&(t.who_daily_latest.cumulative_cases>0&&(e.cumulative_cases+=t.who_daily_latest.cumulative_cases),t.who_daily_latest.cumulative_deaths>0&&(e.cumulative_deaths+=t.who_daily_latest.cumulative_deaths||0),e.population+=t.population),t.population>0&&t.vaccine_daily_latest&&(e.cumulative_vaccines+=t.vaccine_daily_latest.total_vaccinations||0))}))})),e.regions.forEach((function(t,e){t.cumulative_cases_per_100k=t.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.cumulative_deaths/(t.population/1e5),t.cumulative_vaccines_per_100k=t.cumulative_vaccines/(t.population/1e5),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0)})),"per100"==t.region_switch?($=_.h(e.regions,(function(t,e){return t.cumulative_vaccines_per_100k})),V=_.h(e.regions,(function(t,e){return t.cumulative_cases_per_100k})),Z=_.h(e.regions,(function(t,e){return t.cumulative_deaths_per_100k}))):($=_.h(e.regions,(function(t,e){return t.cumulative_vaccines})),V=_.h(e.regions,(function(t,e){return t.cumulative_cases})),Z=_.h(e.regions,(function(t,e){return t.cumulative_deaths}))),J=_.l().range([0,Q.width-at-K]).domain([0,V]),X=_.l().range([0,Q.width-at-K]).domain([0,Z]),G=_.l().range([0,Q.width-at-K]).domain([0,$]),0==$&&0==V&&0==Z?(_.p(".region-bar").transition().duration(500).attr("width",0),_.p(".data-label").transition().duration(500).attr("x",K).attr("opacity",0)):(_.p(".region-bar").transition().duration(500).style("fill",(function(t){return m.regions[t.code]})).attr("width",(function(e,a){var n=_.o(this).attr("data-id");nt.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=J(e.cumulative_cases_per_100k)),"deaths"==t.region_chart_toggle&&(i=X(e.cumulative_deaths_per_100k)),"vaccines"==t.region_chart_toggle&&(i=G(e.cumulative_vaccines_per_100k))):("cases"==t.region_chart_toggle&&(i=J(e.cumulative_cases)),"deaths"==t.region_chart_toggle&&(i=X(e.cumulative_deaths)),"vaccines"==t.region_chart_toggle&&(i=G(e.cumulative_vaccines))),isNaN(i)?0:parseFloat(i)})),_.p(".data-label").transition().duration(500).tween("text",(function(e,a){var n=0,i=_.o(this).attr("data-id");nt.forEach((function(t,a){t.code==i&&(e=t)})),"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(n=Math.round(e.cumulative_cases_per_100k)),"deaths"==t.region_chart_toggle&&(n=Math.round(e.cumulative_deaths_per_100k)),"vaccines"==t.region_chart_toggle&&(n=Math.round(e.cumulative_vaccines_per_100k))):("cases"==t.region_chart_toggle&&(n=Math.round(e.cumulative_cases)),"deaths"==t.region_chart_toggle&&(n=Math.round(e.cumulative_deaths)),"vaccines"==t.region_chart_toggle&&(n=Math.round(e.cumulative_vaccines)));a=_.g(Math.floor(2346*Math.random()+9345),n);return function(t){_.o(this).text(f(Math.round(a(t))))}})).attr("x",(function(e,a){var n=_.o(this).attr("data-id");nt.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=J(e.cumulative_cases_per_100k)+K+5),"deaths"==t.region_chart_toggle&&(i=X(e.cumulative_deaths_per_100k)+K+5),"vaccines"==t.region_chart_toggle&&(i=G(e.cumulative_vaccines_per_100k)+K+5)):("cases"==t.region_chart_toggle&&(i=J(e.cumulative_cases)+K+5),"deaths"==t.region_chart_toggle&&(i=X(e.cumulative_deaths)+K+5),"vaccines"==t.region_chart_toggle&&(i=G(e.cumulative_vaccines)+K+5)),i})).attr("opacity",(function(e,a){var n=_.o(this).attr("data-id");nt.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=e.cumulative_cases_per_100k),"deaths"==t.region_chart_toggle&&(i=e.cumulative_deaths_per_100k),"vaccines"==t.region_chart_toggle&&(i=e.cumulative_vaccines_per_100k)):("cases"==t.region_chart_toggle&&(i=e.cumulative_cases),"deaths"==t.region_chart_toggle&&(i=e.cumulative_deaths),"vaccines"==t.region_chart_toggle&&(i=e.cumulative_vaccines)),i>0?1:0})))}var ot,ct=a(7),lt=(a(126),a(127),a(39)),st=a(17),ut=a.n(st),_t="#595454",dt="#EAEAEA",ht="#000",pt="#FFF";var gt=function(t,e,a,n,i,r){_.o("#vaccine_tooltip").attr("opacity",0).style("display","none"),_.o("#vaccine_info path").attr("fill",m.black),t.select("#vaccine_info").style("cursor","pointer").on("mouseover",(function(t,e){_.o("#svg_container").style("z-index",10),_.o("#vaccine_tooltip").style("display","inline").transition().duration(500).attr("opacity",1),_.o("#vaccine_info path").transition().duration(200).attr("fill",m.blue)})).on("mouseout",(function(t,e){_.o("#svg_container").style("z-index",1),_.o("#vaccine_tooltip").style("display","none").attr("opacity",0),_.o("#vaccine_info path").transition().duration(500).attr("fill",m.black)})),t.select("#region_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,a){e.region_filter=[],n("clear-region")})),t.select("#region_switch").style("cursor","pointer").on("click",(function(t,n){"total"==e.region_switch?(e.region_switch="per100",_.o("#region_switch_toggle").transition().duration(200).attr("x",15.1)):(e.region_switch="total",_.o("#region_switch_toggle").transition().duration(200).attr("x",3.1)),rt(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-cases").style("cursor","pointer").on("click",(function(n){if("cases"===e.region_chart_toggle)return!1;e.region_chart_toggle="cases",t.selectAll("#region-chart-toggle rect").attr("fill",dt),t.selectAll("#region-chart-toggle text").attr("fill",ht),t.select("#region-chart-toggle-cases rect").attr("fill",_t),t.select("#region-chart-toggle-cases text").attr("fill",pt),rt(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-deaths").style("cursor","pointer").on("click",(function(n){if("deaths"===e.region_chart_toggle)return!1;e.region_chart_toggle="deaths",t.selectAll("#region-chart-toggle rect").attr("fill",dt),t.selectAll("#region-chart-toggle text").attr("fill",ht),t.select("#region-chart-toggle-deaths rect").attr("fill",_t),t.select("#region-chart-toggle-deaths text").attr("fill",pt),rt(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-vaccines").style("cursor","pointer").on("click",(function(n){if("vaccines"===e.region_chart_toggle)return!1;e.region_chart_toggle="vaccines",t.selectAll("#region-chart-toggle rect").attr("fill",dt),t.selectAll("#region-chart-toggle text").attr("fill",ht),t.select("#region-chart-toggle-vaccines rect").attr("fill",_t),t.select("#region-chart-toggle-vaccines text").attr("fill",pt),rt(e,a)})),t.select("#map-toggle #map-toggle-bi-weekly-change").style("cursor","pointer").on("click",(function(n){if("bi-weekly-change"===e.map_toggle)return!1;e.map_toggle="bi-weekly-change",t.selectAll("#map-toggle rect").attr("fill",dt),t.selectAll("#map-toggle text").attr("fill",ht),t.select("#map-toggle-bi-weekly-change rect").attr("fill",_t),t.select("#map-toggle-bi-weekly-change text").attr("fill",pt),r(a,e,700)})),t.select("#map-toggle #map-toggle-cases").style("cursor","pointer").on("click",(function(n){if("cases"===e.map_toggle)return!1;e.map_toggle="cases",t.selectAll("#map-toggle rect").attr("fill",dt),t.selectAll("#map-toggle text").attr("fill",ht),t.select("#map-toggle-cases rect").attr("fill",_t),t.select("#map-toggle-cases text").attr("fill",pt),r(a,e,700)})),t.select("#map-toggle #map-toggle-deaths").style("cursor","pointer").on("click",(function(n){if("deaths"===e.map_toggle)return!1;e.map_toggle="deaths",t.selectAll("#map-toggle rect").attr("fill",dt),t.selectAll("#map-toggle text").attr("fill",ht),t.select("#map-toggle-deaths rect").attr("fill",_t),t.select("#map-toggle-deaths text").attr("fill",pt),r(a,e,700)})),t.select("#map-toggle #map-toggle-percent-fully-vaccinated").style("cursor","pointer").on("click",(function(n){if("percent-fully-vaccinated"===e.map_toggle)return!1;e.map_toggle="percent-fully-vaccinated",t.selectAll("#map-toggle rect").attr("fill",dt),t.selectAll("#map-toggle text").attr("fill",ht),t.select("#map-toggle-percent-fully-vaccinated rect").attr("fill",_t),t.select("#map-toggle-percent-fully-vaccinated text").attr("fill",pt),r(a,e,700)})),t.select("#map-toggle #map-toggle-percent-vaccine-acceptance").style("cursor","pointer").on("click",(function(n){if("percent-vaccine-acceptance"===e.map_toggle)return!1;e.map_toggle="percent-vaccine-acceptance",t.selectAll("#map-toggle rect").attr("fill",dt),t.selectAll("#map-toggle text").attr("fill",ht),t.select("#map-toggle-percent-vaccine-acceptance rect").attr("fill",_t),t.select("#map-toggle-percent-vaccine-acceptance text").attr("fill",pt),r(a,e,700)})),t.select("#timechart-type-toggle #timechart-type-toggle-cumulative").style("cursor","pointer").on("click",(function(n){if("cumulative"===e.timeline_type)return!1;e.timeline_type="cumulative",t.selectAll("#timechart-type-toggle rect").attr("fill",dt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ht),t.select("#timechart-type-toggle-cumulative rect").attr("fill",_t),t.select("#timechart-type-toggle-cumulative polyline").attr("stroke",pt),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",_t),Y(a,e)})),Object(ct.a)("#timechart-type-toggle-cumulative",{content:"Cumulative",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-type-toggle #timechart-type-toggle-non-cumulative").style("cursor","pointer").on("click",(function(n){if("non-cumulative"===e.timeline_type)return!1;e.timeline_type="non-cumulative",t.selectAll("#timechart-type-toggle rect").attr("fill",dt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ht),t.select("#timechart-type-toggle-non-cumulative rect").attr("fill",_t),t.select("#timechart-type-toggle-non-cumulative polyline").attr("stroke",pt),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",_t),Y(a,e)})),Object(ct.a)("#timechart-type-toggle-non-cumulative",{content:"Non-cumulative",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-type-toggle #timechart-type-toggle-stacked").style("cursor","pointer").on("click",(function(n){if("stacked"===e.timeline_type)return!1;e.timeline_type="stacked",t.selectAll("#timechart-type-toggle rect").attr("fill",dt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ht),t.select("#timechart-type-toggle-stacked rect").attr("fill",_t),t.select("#timechart-type-toggle-stacked polyline").attr("stroke",pt),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",pt),Y(a,e)})),Object(ct.a)("#timechart-type-toggle-stacked",{content:"Stacked 100%",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-day").style("cursor","pointer").on("click",(function(n){if("day"===e.timeline_frequency)return!1;e.timeline_frequency="day",t.selectAll("#timechart-frequency-toggle rect").attr("fill",dt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ht),t.select("#timechart-frequency-toggle-day rect").attr("fill",_t),t.select("#timechart-frequency-toggle-day text").attr("fill",pt),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("DAY"),U(a,e)})),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-week").style("cursor","pointer").on("click",(function(n){if("week"===e.timeline_frequency)return!1;e.timeline_frequency="week",t.selectAll("#timechart-frequency-toggle rect").attr("fill",dt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ht),t.select("#timechart-frequency-toggle-week rect").attr("fill",_t),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("WEEK"),t.select("#timechart-frequency-toggle-week text").attr("fill",pt),U(a,e)})),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-month").style("cursor","pointer").on("click",(function(n){if("month"===e.timeline_frequency)return!1;e.timeline_frequency="month",t.selectAll("#timechart-frequency-toggle rect").attr("fill",dt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ht),t.select("#timechart-frequency-toggle-month rect").attr("fill",_t),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("MONTH"),t.select("#timechart-frequency-toggle-month text").attr("fill",pt),U(a,e)})),t.select("#hdi_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,e){_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1),n("clear-hdi")})),t.select("#hdi-toggle #hdi-toggle-very-high").style("cursor","pointer").on("click",(function(t){mt(e.hdi_filter,"very-high"),4===e.hdi_filter.length?(e.hdi_filter=[],_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){_.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-high").style("cursor","pointer").on("click",(function(t){mt(e.hdi_filter,"high"),4===e.hdi_filter.length?(e.hdi_filter=[],_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){_.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-medium").style("cursor","pointer").on("click",(function(t){mt(e.hdi_filter,"medium"),4===e.hdi_filter.length?(e.hdi_filter=[],_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){_.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-low").style("cursor","pointer").on("click",(function(t){mt(e.hdi_filter,"low"),4===e.hdi_filter.length?(e.hdi_filter=[],_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&_.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){_.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#inform_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,e){_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1),n("clear-inform")})),t.select("#inform-toggle #inform-toggle-no-score").style("cursor","pointer").on("click",(function(t){mt(e.inform_filter,"no-score"),5===e.inform_filter.length?(e.inform_filter=[],_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){_.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-low").style("cursor","pointer").on("click",(function(t){mt(e.inform_filter,"low"),5===e.inform_filter.length?(e.inform_filter=[],_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){_.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-medium").style("cursor","pointer").on("click",(function(t){mt(e.inform_filter,"medium"),5===e.inform_filter.length?(e.inform_filter=[],_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){_.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-high").style("cursor","pointer").on("click",(function(t){mt(e.inform_filter,"high"),5===e.inform_filter.length?(e.inform_filter=[],_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){_.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-very-high").style("cursor","pointer").on("click",(function(t){mt(e.inform_filter,"very-high"),5===e.inform_filter.length?(e.inform_filter=[],_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&_.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){_.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),_.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),_.o("#vac-tab").attr("opacity",1).select("#vac-tab-content").attr("display","inline"),_.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),_.o("#bubbleSelectContainer").style("display","none"),t.select("#tabs #vaccination-tab").style("cursor","pointer").on("click",(function(a){if("vaccination-data"===e.tab_toggle)return!1;e.tab_toggle="vaccination-data",_.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),_.o("#vac-tab").attr("opacity",1).select("#vac-tab-content").attr("display","inline"),_.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),t.selectAll("#tabs rect").attr("fill",dt),t.selectAll("#tabs text").attr("fill",ht),t.select("#vaccination-tab rect").attr("fill",_t),t.select("#vaccination-tab text").attr("fill",pt),_.o("#bubbleSelectContainer").style("display","none")})),t.select("#tabs #indicators-tab").style("cursor","pointer").on("click",(function(a){if("indicators"===e.tab_toggle)return!1;e.tab_toggle="indicators",_.o("#additional-indicators-tab").attr("opacity",1).select("#additional-indicators-tab-content").attr("display","inline"),_.o("#vac-tab").attr("opacity",0).select("#vac-tab-content").attr("display","none"),_.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),t.selectAll("#tabs rect").attr("fill",dt),t.selectAll("#tabs text").attr("fill",ht),t.select("#indicators-tab rect").attr("fill",_t),t.select("#indicators-tab text").attr("fill",pt),_.o("#bubbleSelectContainer").style("display","none")})),t.select("#tabs #bubble-chart-tab").style("cursor","pointer").on("click",(function(a){if("bubble-chartt"===e.tab_toggle)return!1;e.tab_toggle="bubble-chart",_.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),_.o("#vac-tab").attr("opacity",0).select("#vac-tab-content").attr("display","none"),_.o("#bubblechart-tab").attr("opacity",1).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","inline"),t.selectAll("#tabs rect").attr("fill",dt),t.selectAll("#tabs text").attr("fill",ht),t.select("#bubble-chart-tab rect").attr("fill",_t),t.select("#bubble-chart-tab text").attr("fill",pt),_.o("#bubbleSelectContainer").style("display","inline-block")})),_.o("#svg defs").append("clipPath").attr("id","mask").append("rect").attr("y",340).attr("height",590).attr("width",660).attr("x",22);var o=t.select("#timechart_container").attr("opacity",0),c={x:o.attr("x"),y:o.attr("y"),width:o.attr("width"),height:o.attr("height")},l=t.append("svg").attr("id","timechart_svg").attr("viewBox","0 0 2000 "+c.height).attr("preserveAspectRatio","none").attr("x",c.x).attr("y",c.y).attr("width",c.width).attr("height",c.height),s=l.append("g").attr("id","layer1");l.append("g").attr("id","layer0"),s.append("rect").attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").attr("opacity",0).style("fill","transparent");for(var u=18,d=68,h=function(t){for(_.o("#vac-tab").append("rect").attr("class","col1bg colbg").attr("id","col1bg"+t).attr("x",120).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",68).attr("fill",m.lightgrey),_.o("#vac-tab").append("rect").attr("class","col1bar").attr("id","col1bar"+t).attr("x",120).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",0).attr("fill",m.blue),_.o("#vac-tab").append("rect").attr("class","col2bg colbg").attr("id","col2bg"+t).attr("x",230).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",68).attr("fill",m.lightgrey),_.o("#vac-tab").append("rect").attr("class","col2bar").attr("id","col2bar"+t).attr("x",230).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",0).attr("fill",m.blue),_.o("#vac-tab").append("rect").attr("class","col3bg colbg").attr("id","col3bg"+t).attr("x",340).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",68).attr("fill",m.lightgrey),_.o("#vac-tab").append("rect").attr("class","col3bar").attr("id","col3bar"+t).attr("x",340).attr("y",(function(){return d+24.8*t})).attr("height",u).attr("width",0).attr("fill",m.blue),_.o("#vac-tab").append("rect").attr("class","col4bg colbg").attr("id","col4bg"+t).attr("x",454).attr("y",(function(){return 67+24.8*t})).attr("height",u).attr("width",68).attr("fill",m.lightgrey),_.o("#vac-tab").append("rect").attr("class","col4bar").attr("id","col4bar"+t).attr("x",454).attr("y",(function(){return 67+24.8*t})).attr("height",u).attr("width",0).attr("fill",m.blue),g=0;g<6;g++)_.o("#col"+g+"_sort_desc").attr("opacity",0),_.o("#col"+g+"_sort_asc").attr("opacity",0),_.o("#col"+g+"_sort").style("cursor","pointer").on("click",(function(){var t=_.o(this).attr("id");e.table_sort==t?"desc"==e.table_sort_direction?e.table_sort_direction="asc":e.table_sort_direction="desc":(e.table_sort=t,e.table_sort_direction="desc"),e.page=1,i(a,e)}))},p=0;p<10;p++){var g;h(p)}_.o("#reset_locations").attr("display","none"),Object(ct.a)("#button-png",{content:"Save as PNG",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),Object(ct.a)("#button-copy",{content:"Copy to clipboard",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),Object(ct.a)("#button-print",{content:"Print to PDF",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),_.o("#button-print").on("click",(function(){if(ot)return!1;ot=!0,setTimeout((function(){ut()(document.querySelector("#root"),{allowTaint:!0,onclone:function(t){},useCORS:!1,foreignObjectRendering:!0,ignoreElements:function(t){return!1},scale:2,x:0,y:0,scrollX:0,scrollY:0,logging:!1}).then((function(t){var e=t.toDataURL("image/png"),a=new lt.a("l","mm","a4"),n=a.getImageProperties(e),i=a.internal.pageSize.getWidth(),r=n.height*i/n.width;a.addImage(e,"JPEG",10,10,i-20,r-30),a.save("deep-pdf-export.pdf"),ot=!1}),200)}))})),_.o("#button-png").on("click",(function(){if(ot)return!1;ot=!0,setTimeout((function(){ut()(document.querySelector("#root"),{allowTaint:!0,onclone:function(t){},useCORS:!1,foreignObjectRendering:!0,ignoreElements:function(t){return!1},scale:2,x:0,y:0,scrollX:0,scrollY:0,logging:!1}).then((function(t){var e=t.toDataURL("image/png").replace("image/png","image/octet-stream"),a=document.createElement("a");a.download="dashboard-export.png",a.href=e,a.click(),a.remove(),ot=!1}),200)}))}))};function mt(t,e){var a=t.indexOf(e);-1!==a?t.splice(a,1):t.push(e)}var ft,yt,vt,bt=1e3,xt=100,wt=1e6;function kt(t,e,a){bt=_.h(t.country,(function(t,e){return parseFloat(t.gni_2017)})),xt=_.h(t.country,(function(t,a){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis||"percent-fully-vaccinated"==e.bubble_chart_y_axis||"percent-vaccine-acceptance"==e.bubble_chart_y_axis?100:void 0})),wt=_.h(t.country,(function(t,e){return parseFloat(t.population)})),ft=_.l().range([0,600]).domain([0,bt]).nice(),yt=_.l().range([233,0]).domain([0,xt]),vt=_.m().domain([0,wt]).range([1,20]);var n=_.o("#bubblechart-tab").append("g").attr("transform","translate(35, 58)").attr("id","bubblechart");n.append("g").attr("id","bubbley").call(_.b(yt).ticks(3).tickSize(3)),n.append("g").attr("id","bubblex").attr("class","xAxis").attr("transform","translate(0,233)").call(_.a(ft).ticks(4).tickSize(3)),_.o("#bubblechart").selectAll(".bubble").data(t.country).join((function(t){t.append("circle").attr("class",(function(t){return"bubble"})).attr("cx",(function(t){return ft(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?yt(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?yt(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?yt(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return vt(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&m.regions[t.ifrc_region]?m.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&m.hdi_category[t.hdi_category]?m.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&m.inform_severity[t.inform_severity]?m.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).style("stroke-width",1).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.transition().duration(800).attr("cx",(function(t){return ft(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?yt(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?yt(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?yt(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return vt(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&m.regions[t.ifrc_region]?m.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&m.hdi_category[t.hdi_category]?m.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&m.inform_severity[t.inform_severity]?m.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.remove()})),_.o("#bubblechart").selectAll(".bubble").on("mousemove",(function(t,a){_.o("#bubbleSelectContainer").style("z-index",1),_.o("#bubblechart_tooltip_title tspan").text(a.country_name),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% vaccinated at least 1 dose"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% fully vaccinated"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_fully_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% vaccine acceptance"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.vaccine_acceptance_percent).toFixed(2)+"%").attr("text-anchor","end").attr("dx",37)),_.o("#bubblechart_tooltip_gni tspan").text("$"+f(Math.round(parseFloat(a.gni_2017)))).attr("text-anchor","end").attr("dx",37),_.o("#bubblechart_tooltip_population tspan").text(y(Math.round(parseInt(a.population)))).attr("text-anchor","end").attr("dx",37);var n=_.k(t,_.o("#svg").node());n[0]<1110?(_.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]+20)+","+(n[1]+58-90)+")").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_left").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_right").attr("display","none")):(_.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]-220)+","+(n[1]+58-90)+")").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_left").attr("display","none"),_.o("#bubblechart_tooltip_arrow_right").attr("display","inline")),_.p(".bubble").attr("opacity",.4),_.o(this).attr("opacity",1).style("stroke-width",2)})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;_.o("#bubbleSelectContainer").style("z-index",2),_.o("#bubblechart_tooltip").attr("display","none"),_.p(".bubble").attr("opacity",1).style("stroke-width",1)})),_.o("#bubblechart_tooltip").attr("display","none"),_.o("#bubble_y_axis_label").attr("text-anchor","middle").select("tspan").attr("dx",50),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% vaccinated at least 1 dose"),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% fully vaccinated"),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% vaccine acceptance")}function Ft(t,e,a){bt=_.h(t.country,(function(t,e){return parseFloat(t.gni_2017)})),xt=_.h(t.country,(function(t,a){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?parseFloat(t.people_vaccinated_per_hundred):"percent-fully-vaccinated"==e.bubble_chart_y_axis?parseFloat(t.people_fully_vaccinated_per_hundred):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?parseFloat(t.vaccine_acceptance_percent):void 0})),wt=_.h(t.country,(function(t,e){return parseFloat(t.population)})),ft=_.l().range([0,600]).domain([0,bt]),yt=_.l().range([233,0]).domain([0,xt]),vt=_.m().domain([0,wt]).range([1,20]);var n=_.o("#bubblechart");n.select("#bubbley").transition().duration(800).call(_.b(yt).ticks(3)),n.select("#bubblex").transition().duration(800).call(_.a(ft).ticks(3)),_.o("#bubblechart").selectAll(".bubble").data(t.country).join((function(t){t.append("circle").attr("cx",(function(t){return ft(bt)})).attr("cy",(function(t){return yt(xt)})).attr("class",(function(t){return"bubble"})).transition().duration(800).attr("cx",(function(t){return ft(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?yt(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?yt(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?yt(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return vt(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&m.regions[t.ifrc_region]?m.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&m.hdi_category[t.hdi_category]?m.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&m.inform_severity[t.inform_severity]?m.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).style("stroke-width",1).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)||0==yt.invert(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=yt(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&m.regions[t.ifrc_region]?m.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&m.hdi_category[t.hdi_category]?m.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&m.inform_severity[t.inform_severity]?m.inform_severity[t.inform_severity]:"transparent"})).transition().duration(800).attr("cx",(function(t){return ft(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?yt(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?yt(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?yt(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return vt(parseFloat(t.population))}))}),(function(t){t.remove()})),_.o("#bubblechart").selectAll(".bubble").on("mousemove",(function(t,a){_.o("#bubbleSelectContainer").style("z-index",1),_.o("#bubblechart_tooltip_title tspan").text(a.country_name),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% vaccinated at least 1 dose"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% fully vaccinated"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_fully_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(_.o("#bubblechart_tooltip_label tspan").text("% vaccine acceptance"),_.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.vaccine_acceptance_percent).toFixed(2)+"%").attr("text-anchor","end").attr("dx",37)),_.o("#bubblechart_tooltip_gni tspan").text("$"+f(Math.round(parseFloat(a.gni_2017)))).attr("text-anchor","end").attr("dx",37),_.o("#bubblechart_tooltip_population tspan").text(y(Math.round(parseInt(a.population)))).attr("text-anchor","end").attr("dx",37);var n=_.k(t,_.o("#svg").node());n[0]<1110?(_.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]+20)+","+(n[1]+58-90)+")").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_left").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_right").attr("display","none")):(_.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]-220)+","+(n[1]+58-90)+")").attr("display","inline"),_.o("#bubblechart_tooltip_arrow_left").attr("display","none"),_.o("#bubblechart_tooltip_arrow_right").attr("display","inline")),_.p(".bubble").attr("opacity",.4),_.o(this).attr("opacity",1).style("stroke-width",2)})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;_.o("#bubbleSelectContainer").style("z-index",2),_.o("#bubblechart_tooltip").attr("display","none"),_.p(".bubble").attr("opacity",1).style("stroke-width",1)})),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% vaccinated at least 1 dose"),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% fully vaccinated"),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&_.o("#bubble_y_axis_label tspan").text("% vaccine acceptance")}var Ot={region_chart_toggle:"cases",region_switch:"total",region_filter:[],country_filter:[],hdi_filter:[],inform_filter:[],timeline_type:"non-cumulative",timeline_frequency:"week",map_toggle:"cases",tab_toggle:"vaccination-data",table_sort:"col1_sort",table_sort_direction:"desc",bubble_chart_color_by:"hdi",bubble_chart_y_axis:"percent-vaccinated-at-least-1-dose",brushL:0,brushR:600,page:1,numPages:1},At=a(18),Et=a(3),qt=a.n(Et);var Tt=function(t,e){var a;t.regions=[{sort:5,code:"AF",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:3,code:"ME",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:4,code:"AP",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:2,code:"EU",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:1,code:"AM",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:6,code:"OTH",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0}],t.regions.sort((function(t,e){return t.sort-e.sort})),t.country=t.equity_data,t.country.forEach((function(e,a){"AF"!=e.ifrc_region&&"ME"!=e.ifrc_region&&"AP"!=e.ifrc_region&&"EU"!=e.ifrc_region&&"AM"!=e.ifrc_region&&(e.ifrc_region="OTH"),e.population=parseInt(e.population)||0;var n=0;e.population>0&&(n=e.population),t.regions.forEach((function(t,a){t.code==e.ifrc_region&&(t.population+=n)})),e.vaccines_used=[],e.avg_tests_per_1000=parseFloat(e.avg_tests_per_1000)||0,e.number_vaccine_types_used=0,e.vaccines_per_100=0,e.number_vaccine_types_used=parseInt(e.avg_tests_per_1000),t.vaccines_who_data.forEach((function(t,a){e.country_iso3==t.ISO3&&(e.number_vaccine_types_used=parseInt(t.NUMBER_VACCINES_TYPES_USED),e.vaccines_per_100=parseFloat(t.TOTAL_VACCINATIONS_PER100),isNaN(e.vaccines_per_100)&&(e.vaccines_per_100=0),e.vaccines_used=t.VACCINES_USED.split(",").map((function(t){return t.trim()})))})),e.ns_involvement=0,t.self_assessment.forEach((function(t,a){e.country_iso3==t.ISO3&&""!=e.country_iso3&&"Yes"==t["Final involvement"]&&(e.ns_involvement=1)})),e.vaccine_acceptance_percent=0,t.vaccine_acceptance.forEach((function(t,a){e.country_iso3==t.iso3&&(e.vaccine_acceptance_percent=100*parseFloat(t.indicator_value),e.vaccine_acceptance_population=parseInt(t.population_size))})),"all"==e.contract_tracing.toLowerCase()||"some"==e.contract_tracing.toLowerCase()?e.contract_tracing=1:e.contract_tracing=0,e.hdi_category.match(/very high/i)?e.hdi_category="very-high":e.hdi_category.match(/high/i)?e.hdi_category="high":e.hdi_category.match(/medium/i)?e.hdi_category="medium":e.hdi_category.match(/low/i)&&(e.hdi_category="low"),e.inform_severity.match(/very high/i)?e.inform_severity="very-high":e.inform_severity.match(/high/i)?e.inform_severity="high":e.inform_severity.match(/medium/i)?e.inform_severity="medium":e.inform_severity.match(/low/i)?e.inform_severity="low":e.inform_severity.match(/no/i)&&(e.inform_severity="no-score")}));var n=h()(new Date(Object(_.h)(t.who_data,(function(t){return t.Date_reported})))).startOf("day");t.min_date=h()("2019-12-31").startOf("day").toDate();var i=h()(new Date(Object(_.h)(t.vaccines_data,(function(t){return t.date})))).startOf("day");t.min_vaccine_date=h()(new Date(Object(_.j)(t.vaccines_data,(function(t){return t.date})))).startOf("day").toDate(),t.max_vaccine_date=i.toDate(),i.unix()>n.unix()&&(n=i),t.max_date=n.toDate(),t.who_data.forEach((function(e,a){e.date=h()(e.Date_reported).startOf("day").toDate(),e.country_code=e.Country_code,e.country_name=null,t.country.forEach((function(t,a){t.country_iso2===e.country_code&&(e.ifrc_region=t.ifrc_region,e.country_name=t.country_name)})),e.cumulative_deaths=parseInt(e.Cumulative_deaths),e.cumulative_cases=parseInt(e.Cumulative_cases),e.new_cases=parseInt(e.New_cases),e.new_deaths=parseInt(e.New_deaths)})),t.who_data.sort((function(t,e){return new Date(t.date)-new Date(e.Date_reported)}));var r=Object(_.f)(t.who_data,(function(t){return t.country_code})),o=[];r.forEach((function(e,a){var n=h()(Object(_.h)(e[1],(function(t){return t.date}))).startOf("day"),i=L()(e[1][e[1].length-1]);n.unix()!=t.max_date.getTime()&&(i.date=new Date(t.max_date),i.new_cases=0,i.new_deaths=0,o.push(i))})),(a=t.who_data).push.apply(a,o),t.who_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)}));var c=-1,l=0,s=-1,u=-1,d=0,p=0,g=[];t.who_data.forEach((function(t,e){t.dayOfYear=h()(t.date).dayOfYear(),t.dayOfYear!==l&&c++,t.dayTotal=c,t.week=h()(t.date).isoWeek(),t.week!==u&&s++,t.weekTotal=s,t.month=t.date.getMonth(),t.month!==p&&d++,t.monthTotal=d,t.year=t.date.getFullYear(),t.week_start=new Date(h()(t.date).startOf("isoWeek").startOf("day").toDate()),t.month_start=new Date(h()(t.date).startOf("month").startOf("day").toDate()),t.new_deaths<0&&(t.new_deaths=0),t.new_cases<0&&(t.new_cases=0),void 0==t.ifrc_region&&(t.ifrc_region="OTH"),!g.includes(t.country_code)&&t.country_code.length>1&&g.push(t.country_code),delete t.Date_reported,delete t.Country,delete t.New_cases,delete t.New_deaths,delete t.Country_code,delete t.Cumulative_deaths,delete t.Cumulative_cases,delete t.Country_code,delete t.WHO_region,delete t.Country,l=t.dayOfYear,u=t.week,p=t.month})),t.vaccines_data.forEach((function(t,e){t.date=h()(t.date).startOf("day").toDate()})),t.vaccines_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)})),t.vaccines_data=t.vaccines_data.filter((function(t,e){return 3===t.iso_code.length&&t.total_vaccinations>0}));var m=Object(_.f)(t.vaccines_data,(function(t){return t.iso_code})),f=[],y=[],v=[];m.forEach((function(e,a){var n;new Date(t.min_date),new Date(t.max_date);y=[],f=[],e.lastDate=h()(Object(_.h)(e[1],(function(t,e){return t.date}))).startOf("day").toDate(),t.country.forEach((function(t,a){t.country_iso3===e[0]&&(e.ifrc_region=t.ifrc_region,e.country_name=t.country_name,e.country_code=t.country_iso2,t.data_updated=e.lastDate)})),e[1].forEach((function(t,e){t.total_vaccinations=parseInt(t.total_vaccinations),t.daily_vaccinations=parseInt(t.daily_vaccinations),y.push(new Date(t.date).getTime())}));for(var i=new Date(t.min_vaccine_date);i<=t.max_date;i.setDate(i.getDate()+1)){var r=new Date(i).getTime();y.includes(r)||f.push({date:new Date(i),total_vaccinations:null,daily_vaccinations:0})}(n=e[1]).push.apply(n,Object(At.a)(f)),e[1].sort((function(t,e){return new Date(t.date)-new Date(e.date)}));var o=0,c=0,l=0,s=0;e[1].forEach((function(t,a){var n;t.total_vaccinations?o=t.total_vaccinations:t.total_vaccinations=o,t.total_vaccinations_per_hundred?c=t.total_vaccinations_per_hundred:t.total_vaccinations_per_hundred=c,t.people_vaccinated_per_hundred?l=t.people_vaccinated_per_hundred:t.people_vaccinated_per_hundred=l,t.people_fully_vaccinated_per_hundred?s=t.people_fully_vaccinated_per_hundred:t.people_fully_vaccinated_per_hundred=s,n=null==e.country_name?e[0]:e.country_name;var i=0;t.daily_vaccinations&&t.daily_vaccinations>0&&(i=t.daily_vaccinations),v.push({date:new Date(t.date),lastDate:e.lastDate,total_vaccinations_per_hundred:parseFloat(c),people_vaccinated_per_hundred:parseFloat(l),people_fully_vaccinated_per_hundred:parseFloat(s),iso_code:e[0],ifrc_region:e.ifrc_region,country_name:n,country_code:e.country_code,total_vaccinations:o,daily_vaccinations:i})}))})),t.vaccines_data=v,t.vaccines_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)})),c=-1,l=0,s=-1,u=-1,d=0,p=0,t.vaccines_data.forEach((function(t,e){void 0==t.ifrc_region&&(t.ifrc_region="OTH"),t.dayOfYear=h()(t.date).dayOfYear(),t.dayOfYear!==l&&c++,t.dayTotal=c,t.week=h()(t.date).isoWeek(),t.week!==u&&s++,t.weekTotal=s,t.month=t.date.getMonth(),t.month!==p&&d++,t.monthTotal=d,t.year=t.date.getFullYear(),l=t.dayOfYear,u=t.week,p=t.month,t.week_start=new Date(h()(t.date).startOf("isoWeek").toDate()),t.month_start=new Date(h()(t.date).startOf("month").toDate())})),m=Object(_.f)(t.vaccines_data,(function(t){return t.country_code}));var b=Object(_.f)(t.who_data,(function(t){return t.country_code}));t.country.forEach((function(t,e){t.cumulative_cases_per_100k=0,t.cumulative_deaths_per_100k=0,t.cumulative_vaccines_per_100k=0,t.people_fully_vaccinated_per_hundred=0,t.people_vaccinated_per_hundred=0,t.total_vaccinations_per_hundred=0;var a=t.country_iso2;b.forEach((function(e,n){if(e[0]==a){t.who_daily_latest=e[1][e[1].length-1],t.who_daily_7_days=e[1][e[1].length-8],t.who_daily_14_days=e[1][e[1].length-15],t.who_daily_21_days=e[1][e[1].length-22],t.who_daily_28_days=e[1][e[1].length-29],t.cumulative_cases_per_100k=t.who_daily_latest.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.who_daily_latest.cumulative_deaths/(t.population/1e5),t.cumulative_cases=t.who_daily_latest.cumulative_cases,t.cumulative_deaths=t.who_daily_latest.cumulative_deaths,t.cumulative_deaths_7_days=t.who_daily_7_days.cumulative_deaths,t.cumulative_deaths_14_days=t.who_daily_14_days.cumulative_deaths,t.cumulative_deaths_21_days=t.who_daily_21_days.cumulative_deaths,t.cumulative_deaths_28_days=t.who_daily_28_days.cumulative_deaths,t.cumulative_cases_7_days=t.who_daily_7_days.cumulative_cases,t.cumulative_cases_14_days=t.who_daily_14_days.cumulative_cases,t.cumulative_cases_21_days=t.who_daily_21_days.cumulative_cases,t.cumulative_cases_28_days=t.who_daily_28_days.cumulative_cases;var i=parseFloat((t.cumulative_cases-t.cumulative_cases_14_days-(t.cumulative_cases_14_days-t.cumulative_cases_28_days))/(t.cumulative_cases_14_days-t.cumulative_cases_28_days));isFinite(i)?t.percent_change=i:t.percent_change=0}})),m.forEach((function(e,n){e[0]==a&&(e[0],t.vaccine_daily_latest=e[1][e[1].length-1],t.cumulative_vaccines_per_100k=t.vaccine_daily_latest.total_vaccinations/(t.population/1e5),t.people_fully_vaccinated_per_hundred=t.vaccine_daily_latest.people_fully_vaccinated_per_hundred,t.people_vaccinated_per_hundred=t.vaccine_daily_latest.people_vaccinated_per_hundred,t.total_vaccinations_per_hundred=t.vaccine_daily_latest.total_vaccinations_per_hundred,t.total_vaccinations=t.vaccine_daily_latest.total_vaccinations)})),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0),t.country_code=t.country_iso2})),t.original=L()(t)},Dt=(a(128),a(129),a(130),a(19)),Nt=a.n(Dt);a(131);Nt.a.accessToken="pk.eyJ1IjoiZ28taWZyYyIsImEiOiJjams3b2ZhZWswMGFvM3hxeHp2ZHFhOTRrIn0._pqO9OQ2iNeDGrpopJNjpg";var Mt,jt;function Pt(t,e,a){_.o("#map-refresh").attr("display","none").style("cursor","pointer").on("click",(function(t,e){Mt.setCenter([8,22]),Mt.setZoom(0),_.o("#map-refresh").attr("display","none")})),(Mt=new Nt.a.Map({container:"map_div",style:"mapbox://styles/go-ifrc/ckqrsg27f1cwu17pex8w2de2e",center:[8,22],preserveDrawingBuffer:!0,zoom:0})).setRenderWorldCopies(!1),Mt.addControl(new Nt.a.NavigationControl),Mt.scrollZoom.disable(),Mt.on("zoom",(function(){_.o("#map_tooltip").attr("display","none"),_.o("#map-refresh").attr("display","inline")})),Mt.on("touchmove",(function(){_.o("#map_tooltip").attr("display","none"),_.o("#map-refresh").attr("display","inline")})),Mt.on("wheel",(function(){_.o("#map_tooltip").attr("display","none"),_.o("#map-refresh").attr("display","inline")})),Mt.on("drag",(function(){_.o("#map_tooltip").attr("display","none"),_.o("#map-refresh").attr("display","inline")}));var n=Mt.getCanvasContainer();_.o(n).append("svg").attr("id","mapoverlay").attr("width","100%").attr("height","24vw").style("position","absolute").style("z-index",2);jt=_.o("#map_tooltip").attr("opacity",1).attr("transform","translate(0,0)").attr("display","inline"),_.o("#map_div").append("svg").attr("width","18vw").attr("height","1.5vw").attr("id","maplegend").attr("viewBox","-3 0 227 18").style("background-color","rgba(255,255,255,0.8)"),document.getElementById("maplegend").appendChild(_.o("#red_legend").node()),document.getElementById("maplegend").appendChild(_.o("#blue_legend").node()),document.getElementById("maplegend").appendChild(_.o("#bi_legend").node()),_.o("#red_legend").attr("transform","translate(20,0)"),_.o("#blue_legend").attr("transform","translate(20,0)"),_.o("#bi_legend").attr("transform","translate(0,0)"),_.o("#bi_legend").attr("display","none"),_.o("#blue_legend").attr("display","none"),document.getElementById("mapoverlay").appendChild(_.o("#map_tooltip").node()),jt.attr("display","none"),Mt.on("load",(function(a){Mt.setPaintProperty("countries","fill-opacity-transition",{duration:0,delay:0}),Ct(t,e)}))}function Ct(t,e){if(Mt.setLayoutProperty("countries","visibility","none"),"bi-weekly-change"==e.map_toggle){var a=_.h(t.country,(function(t,e){return t.percent_change})),n=_.j(t.country,(function(t,e){return t.percent_change}));_.o("#bi_legend").attr("display","inline"),_.o("#blue_legend").attr("display","none"),_.o("#red_legend").attr("display","none"),(a=.1*Math.ceil(a/.1))>1&&(a=1),(n=.1*Math.floor(n/.1))<-1&&(n=-1),_.o("#bi_legend_dec_val").attr("text-anchor","end"),a<1?_.o("#bi_legend_inc_val tspan").text(Math.round(100*a)+"%"):_.o("#bi_legend_inc_val tspan").text(Math.round(100*a)+"% +"),n>-1?_.o("#bi_legend_dec_val tspan").text(Math.round(100*Math.abs(n))+"%").attr("dx",14):_.o("#bi_legend_dec_val tspan").text(Math.round(100*Math.abs(n))+"% +").attr("dx",14);var i=_.l().domain([-1,0,1]).range([m.blue,m.lightgrey,m.red]).clamp(!0),r=["case"];t.country.forEach((function(t,e){isFinite(t.percent_change)&&(r.push(["==",["get","iso"],t.country_code]),r.push(i(t.percent_change)))})),r.length>1&&(r.push(m.darkgrey),Mt.setPaintProperty("countries","fill-color",r))}if("cases"==e.map_toggle){var o=_.h(t.country,(function(t,e){return t.cumulative_cases_per_100k}));_.o("#bi_legend").attr("display","none"),_.o("#blue_legend").attr("display","none"),_.o("#red_legend").attr("display","inline"),_.o("#red_legend_title tspan").text("Cases per 100k"),o=o>1e3?100*Math.ceil(o/100):10*Math.ceil(o/10),_.o("#red_legend_val tspan").text(f(o));i=_.l().domain([0,o]).range([m.lightgrey,m.red]),r=["case"];t.country.forEach((function(t,e){r.push(["==",["get","iso"],t.country_code]),r.push(i(t.cumulative_cases_per_100k))})),r.length>1&&(r.push(m.darkgrey),Mt.setPaintProperty("countries","fill-color",r))}if("deaths"==e.map_toggle){o=_.h(t.country,(function(t,e){return t.cumulative_deaths_per_100k}));_.o("#bi_legend").attr("display","none"),_.o("#blue_legend").attr("display","none"),_.o("#red_legend").attr("display","inline"),_.o("#red_legend_title tspan").text("Deaths per 100k"),o=o>1e3?100*Math.ceil(o/100):10*Math.ceil(o/10),_.o("#red_legend_val tspan").text(f(o));i=_.l().domain([0,o]).range([m.lightgrey,m.red]),r=["case"];t.country.forEach((function(t,e){r.push(["==",["get","iso"],t.country_code]),r.push(i(t.cumulative_deaths_per_100k))})),r.length>1&&(r.push(m.darkgrey),Mt.setPaintProperty("countries","fill-color",r))}if("percent-fully-vaccinated"==e.map_toggle){_.o("#bi_legend").attr("display","none"),_.o("#blue_legend").attr("display","inline"),_.o("#red_legend").attr("display","none"),_.o("#blue_legend_title tspan").text("Percent fully vaccinated"),_.o("#blue_legend_val tspan").text("100%");i=_.l().domain([0,1]).range([m.lightgrey,m.blue]).clamp(!0),r=["case"];t.country.forEach((function(t,e){var a=parseFloat(t.people_fully_vaccinated_per_hundred)/100;isNaN(a)&&(a=0),a>0&&(t.country_code&&r.push(["==",["get","iso"],t.country_code]),t.country_code&&r.push(i(a)))})),r.length>1?(r.push(m.darkgrey),Mt.setPaintProperty("countries","fill-color",r)):Mt.setPaintProperty("countries","fill-color",m.darkgrey)}if("percent-vaccine-acceptance"==e.map_toggle){_.o("#bi_legend").attr("display","none"),_.o("#blue_legend").attr("display","inline"),_.o("#red_legend").attr("display","none"),_.o("#blue_legend_title tspan").text("% vaccine acceptance"),_.o("#blue_legend_val tspan").text("100%");i=_.l().domain([0,1]).range([m.lightgrey,m.blue]).clamp(!0),r=["case"];t.country.forEach((function(t,e){var a=parseFloat(t.vaccine_acceptance_percent)/100;isNaN(a)&&(a=0),a>0&&(t.country_code&&r.push(["==",["get","iso"],t.country_code]),t.country_code&&r.push(i(a)))})),r.length>1?(r.push(m.darkgrey),Mt.setPaintProperty("countries","fill-color",r)):Mt.setPaintProperty("countries","fill-color",m.darkgrey)}jt.attr("display","none"),Mt.on("mousemove",(function(a){var n=Mt.queryRenderedFeatures(a.point);if(1==n.length&&"countries"==n[0].layer.id){var i,r=n[0].properties.iso,o=t.equity_data.filter((function(t){return t.country_iso2==r}));if(o[0]&&(i=o[0].country_name),jt.select("#map_tooltip_name tspan").text(i),0==jt.select("#map_tooltip_name tspan").text().length&&jt.attr("display","none"),"cases"==e.map_toggle){if(!(s=t.country.filter((function(t){return t.country_code==r}))[0])||0==s.length)return!1;jt.select("#map_tooltip_val tspan").text(f(Math.round(s.cumulative_cases_per_100k))+" cases per 100k")}if("deaths"==e.map_toggle){if(!(s=t.country.filter((function(t){return t.country_code==r}))[0])||0==s.length)return!1;jt.select("#map_tooltip_val tspan").text(f(Math.round(s.cumulative_deaths_per_100k))+" deaths per 100k")}if("bi-weekly-change"==e.map_toggle){if(!(s=t.country.filter((function(t){return t.country_code==r})))||0==s.length)return!1;var c="";c=(l=(100*s[0].percent_change).toFixed(1))>=0?"% increase":"% decrease",jt.select("#map_tooltip_val tspan").text(Math.abs(l)+c)}if("percent-fully-vaccinated"==e.map_toggle){if(!(s=t.country.filter((function(t){return t.country_code==r})))||0==s.length)return!1;var l=parseFloat(s[0].people_fully_vaccinated_per_hundred).toFixed(1);isNaN(l)||0==l?l="-":l+="% fully vaccinated",jt.select("#map_tooltip_val tspan").text(l)}if("percent-vaccine-acceptance"==e.map_toggle){var s;if(!(s=t.country.filter((function(t){return t.country_code==r})))||0==s.length)return!1;l=parseFloat(s[0].vaccine_acceptance_percent).toFixed(1);isNaN(l)||0==l?l="-":l+="% vaccine acceptance",jt.select("#map_tooltip_val tspan").text(l)}(c=jt.select("#map_tooltip_val tspan").text()).includes("NaN")&&jt.attr("display","none"),_.o("#map_tooltip_bg").attr("width",20);var u=window.innerWidth/1329;jt.attr("display","inline").attr("transform","translate("+(a.point.x+20)+","+a.point.y+")scale("+u+")");jt.node().getBBox();var d=_.o("#map_tooltip").node().getBBox();_.o("#map_tooltip_bg").attr("width",parseFloat(d.width)+2),0==jt.select("#map_tooltip_name tspan").text().length&&jt.attr("display","none")}else jt.attr("display","none")})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;jt.attr("display","none")})),Mt.setLayoutProperty("countries","visibility","visible")}var St=a(2),It="./data/equity_data.csv",Ht="./images/layout.svg",Bt="./data/who_global_cases.csv",zt="./data/owid_vaccinations.csv",Rt="./data/who_vaccination_data.csv",Lt="./data/timeline.csv",Wt="./data/self_assessment.csv",Ut="./data/vaccine_acceptance.csv",Yt={},Vt=[{id:"AM",text:"Americas"},{id:"EU",text:"Europe"},{id:"AP",text:"Asia-Pacific"},{id:"ME",text:"Middle East and North Africa"},{id:"AF",text:"Africa"}],Zt=[];function $t(t){return isNaN(t)?0:t}var Jt=function(){var t=Object(n.useState)(0),e=Object(u.a)(t,2),a=e[0],i=e[1],r=Object(n.useState)("Loading SVG layout..."),o=Object(u.a)(r,2),c=o[0],d=o[1];function p(){return(p=Object(s.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:_.t(Ht).then((function(t){_.o("#svg_container").node().append(_.o(t.documentElement).attr("width","100%").attr("height","100%").node());var e=_.o("#svg_container svg");e.select("title").remove(),e.attr("id","svg"),gt(e,Ot,Yt,m,b,Ct),i(.1),d("Loading equity data CSV..."),_.e(It).then((function(t){Yt.equity_data=t,t.forEach((function(t,e){Zt.push({text:t.country_name,id:"Country-"+t.country_iso2})})),w(),i(.1),d("Loading WHO data CSV..."),_.e(zt).then((function(t){Yt.vaccines_data=t,i(.07),d("Loading OWID vaccines data..."),_.e(Rt).then((function(t){Yt.vaccines_who_data=t,i(.15),d("Loading OWID vaccines data..."),_.e(Wt).then((function(t){Yt.self_assessment=t,i(.22),d("Loading self assessment..."),_.e(Ut).then((function(t){Yt.vaccine_acceptance=t,i(.3),d("Loading vaccine acceptance data..."),_.e(Lt).then((function(t){Yt.timeline_data=t,i(.4),d("Loading WHO daily data..."),_.e(Bt).then((function(t){Yt.who_data=t,i(.8),d("Loading complete."),i(1),Tt(Yt,Ot),g(),_.o("#loaderDiv").transition().duration(1e3).style("opacity",0).on("end",(function(){return _.o("#loaderDiv").remove()}))}))}))}))}))}))}))}))}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(){_.o("#who_data_date tspan").text(h()(Yt.max_date).format("ll")),_.o("#owid_data_date tspan").text(h()(Yt.max_vaccine_date).format("ll")),U(Yt,Ot),it(Yt,Ot,m),b(Yt,Ot),v(Yt,Ot),Pt(Yt,Ot),kt(Yt,Ot)}function m(t,e){Ot.page=1,"clear"==t&&(Ot.region_filter=[],Ot.country_filter=[],_.o("#reset_locations").attr("display","none")),"clear-region"==t&&(Ot.region_filter=[]),"clear-hdi"==t&&(Ot.hdi_filter=[]),"clear-inform"==t&&(Ot.inform_filter=[]),1==t.length&&2==t[0].length&&"filter"!=t&&(Ot.region_filter.includes(t[0])?Ot.region_filter=Ot.region_filter.filter((function(e){return e!==t[0]})):Ot.region_filter.push(t[0])),5==Ot.region_filter.length&&(Ot.region_filter=[]),Ot.region_filter.length>0?(_.o("#region_remove_filter").attr("opacity",1),_.p(".bar-labels").attr("opacity",.5),Ot.region_filter.forEach((function(t,e){_.o(".bar-label-"+t).attr("opacity",1)}))):(_.o("#region_remove_filter").attr("opacity",0),_.p(".bar-labels").attr("opacity",1)),Yt.country=Yt.original.country;var a=[];Ot.hdi_filter.length>0?(_.o("#hdi_remove_filter").attr("opacity",1),Yt.country.forEach((function(t,e){Ot.hdi_filter.includes(t.hdi_category)&&a.push(t.country_iso2)}))):_.o("#hdi_remove_filter").attr("opacity",0);var n=[];if(Ot.inform_filter.length>0?(_.o("#inform_remove_filter").attr("opacity",1),Yt.country.forEach((function(t,e){Ot.inform_filter.includes(t.inform_severity)&&n.push(t.country_iso2)}))):_.o("#inform_remove_filter").attr("opacity",0),1==t.length&&t[0].length>2){var i=t[0].substring(8);Ot.country_filter.includes(i)?Ot.country_filter=Ot.country_filter.filter((function(t){return t!==i})):Ot.country_filter.push(i)}0==Ot.region_filter.length&&0==Ot.country_filter.length&&_.o("#reset_locations").attr("display","none");var r=[];Ot.country_filter.forEach((function(t,e){r.push("Country-"+t)})),Ot.region_filter.length>0||Ot.country_filter.length>0?_.o("#reset_locations").attr("display","inline"):_.o("#reset_locations").attr("display","none");var o=Ot.region_filter.concat(r);qt()("#regionSelect").val(o),qt()("#regionSelect").trigger("change"),Yt.who_data=Yt.original.who_data,n.length>0&&(Yt.who_data=Yt.who_data.filter((function(t,e){return n.includes(t.country_code)}))),(Ot.region_filter.length>0||Ot.country_filter.length>0||a.length>0)&&(Yt.who_data=Yt.who_data.filter((function(t,e){return a.length>0?Ot.region_filter.length>0||Ot.country_filter.length>0?(Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_code))&&a.includes(t.country_code):a.includes(t.country_code):Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_code)}))),Yt.vaccines_data=Yt.original.vaccines_data,n.length>0&&(Yt.vaccines_data=Yt.vaccines_data.filter((function(t,e){return n.includes(t.country_code)}))),(Ot.region_filter.length>0||Ot.country_filter.length>0||a.length>0)&&(Yt.vaccines_data=Yt.vaccines_data.filter((function(t,e){return a.length>0?Ot.region_filter.length>0||Ot.country_filter.length>0?(Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_code))&&a.includes(t.country_code):a.includes(t.country_code):Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_code)}))),n.length>0&&(Yt.country=Yt.country.filter((function(t,e){return n.includes(t.country_iso2)}))),(Ot.region_filter.length>0||Ot.country_filter.length>0||a.length>0)&&(Yt.country=Yt.country.filter((function(t,e){return a.length>0?Ot.region_filter.length>0||Ot.country_filter.length>0?(Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_iso2))&&a.includes(t.country_iso2):a.includes(t.country_iso2):Ot.region_filter.includes(t.ifrc_region)||Ot.country_filter.includes(t.country_iso2)}))),function(){var t=qt()("#regionSelect").select2("data");qt()("#regionSelectContainer").width()/qt()("#regionSelectContainer").height()<10?(qt()(".select2-selection__choice").hide(),qt()(".select2-search__field").attr("placeholder",t.length+" LOCATIONS SELECTED").css("width","100%")):(qt()(".select2-search__field").attr("placeholder",""),qt()(".select2-selection__choice").show())}(),rt(Ot,Yt),b(Yt,Ot),v(Yt,Ot),Y(Yt,Ot),Ct(Yt,Ot),Ft(Yt,Ot)}function v(t,e){var a=t.country.length,n=_.q(t.country,(function(t){return t.cumulative_cases}));_.o("#total_cases tspan").transition().duration(500).textTween((function(){return function(t){return y(_.g(0,n)(t))}})),0==n?_.p(".bar_group").attr("opacity",0):_.p(".bar_group").attr("opacity",1);var i=n-_.q(t.country,(function(t){return t.cumulative_cases_7_days}));_.o("#total_new_cases tspan").text("-"),_.o("#total_new_cases tspan").transition().duration(500).textTween((function(){return function(t){return y(_.g(0,i)(t))}}));var r=_.q(t.country,(function(t){return t.cumulative_deaths}));_.o("#total_deaths tspan").transition().duration(500).textTween((function(){return function(t){return y(_.g(0,r)(t))}}));var o=_.q(t.country,(function(t){return t.total_vaccinations}));_.o("#total_vaccines tspan").transition().duration(500).textTween((function(){return function(t){return y(_.g(0,o)(t))}}));var c={population:0,vaccine_population:0},l={population:0,vaccine_acceptance_population:0},s=0;t.vaccine_types=[],t.country.forEach((function(e,a){e.vaccines_per_100>0&&e.population>0&&(c.population+=e.population,c.vaccine_population+=e.population*e.vaccines_per_100),e.vaccine_acceptance_population>0&&(l.population+=e.vaccine_acceptance_population,l.vaccine_acceptance_population+=e.vaccine_acceptance_population*e.vaccine_acceptance_percent),e.vaccines_used.forEach((function(e){!t.vaccine_types.includes(e)&&e.length>1&&!e.includes("nactiv")&&t.vaccine_types.push(e)})),e.ns_involvement>0&&s++})),_.o("#total_vac_100 tspan").text("-");var u=c.vaccine_population/c.population;u&&_.o("#total_vac_100 tspan").transition().duration(500).textTween((function(){return function(t){return _.g(0,u)(t).toFixed(1)}})),_.o("#percent_acceptance tspan").text("-");var d=l.vaccine_acceptance_population/l.population;d&&_.o("#percent_acceptance tspan").transition().duration(500).textTween((function(){return function(t){return Math.round(_.g(0,Math.round(d))(t))+"%"}})),_.o("#total_ns_countries tspan").transition().duration(500).textTween((function(){return function(t){return Math.round(_.g(0,s)(t))}})),_.o("#num_vaccines tspan").transition().duration(500).textTween((function(){return function(e){return Math.round(_.g(0,t.vaccine_types.length)(e))}})),_.p(".vaccine_type").remove(),_.o("#vaccine_tooltip_bg").attr("height",1),t.vaccine_types.forEach((function(t,e){_.o("#vaccine_tooltip").append("text").attr("font-size",9).attr("fill","#000").attr("class","vaccine_type").append("tspan").text(t).attr("dx",6).attr("dy",1.3*e+1.8+"em")}));var h=_.o("#vaccine_tooltip").node().getBBox();_.o("#vaccine_tooltip_bg").attr("height",h.height+6);var p={"very-high":0,high:0,medium:0,low:0},g={"very-high":0,high:0,medium:0,low:0},m={"very-high":0,high:0,medium:0,low:0},v={"very-high":0,high:0,medium:0,low:0},b={"very-high":0,high:0,medium:0,low:0},x={"very-high":[],high:[],medium:[],low:[]},w={"very-high":0,high:0,medium:0,low:0,"no-score":0},k={"very-high":0,high:0,medium:0,low:0,"no-score":0},F={"very-high":0,high:0,medium:0,low:0,"no-score":0},O={"very-high":0,high:0,medium:0,low:0,"no-score":0},A={"very-high":0,high:0,medium:0,low:0,"no-score":0},E={"very-high":[],high:[],medium:[],low:[],"no-score":[]};n>0&&t.country.forEach((function(t,e){p[t.hdi_category]+=1,g[t.hdi_category]+=parseInt(t.population),m[t.hdi_category]+=parseInt(t.total_vaccinations)||0,w[t.inform_severity]+=1,O[t.inform_severity]+=t.contract_tracing,v[t.hdi_category]+=t.contract_tracing,"very-high"!=t.hdi_category&&"high"!=t.hdi_category&&"medium"!=t.hdi_category&&"low"!=t.hdi_category||x[t.hdi_category].push(t.avg_tests_per_1000),"very-high"!=t.inform_severity&&"high"!=t.inform_severity&&"medium"!=t.inform_severity&&"low"!=t.inform_severity&&"no-score"!=t.inform_severity||E[t.inform_severity].push(t.avg_tests_per_1000),k[t.inform_severity]+=parseInt(t.population),F[t.inform_severity]+=parseInt(t.total_vaccinations)||0,b[t.hdi_category]+=t.cumulative_cases||0,A[t.inform_severity]+=t.cumulative_cases||0}));var q=g["very-high"]+g.high+g.medium+g.low,T=k["very-high"]+k.high+k.medium+k.low+k["no-score"];_.o("#hdi-percent-val-very-high tspan").text($t(b["very-high"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#hdi-percent-bar-very-high").transition().duration(500).attr("width",70*$t(b["very-high"]/n)),_.o("#hdi-percent-val-high tspan").text($t(b.high/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#hdi-percent-bar-high").transition().duration(500).attr("width",70*$t(b.high/n)),_.o("#hdi-percent-val-medium tspan").text($t(b.medium/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#hdi-percent-bar-medium").transition().duration(500).attr("width",70*$t(b.medium/n)),_.o("#hdi-percent-val-low tspan").text($t(b.low/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#hdi-percent-bar-low").transition().duration(500).attr("width",70*$t(b.low/n)),_.o("#inform-percent-val-very-high tspan").text($t(A["very-high"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#inform-percent-bar-very-high").transition().duration(500).attr("width",64*$t(A["very-high"]/n)),_.o("#inform-percent-val-high tspan").text($t(A.high/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#inform-percent-bar-high").transition().duration(500).attr("width",64*$t(A.high/n)),_.o("#inform-percent-val-medium tspan").text($t(A.medium/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#inform-percent-bar-medium").transition().duration(500).attr("width",64*$t(A.medium/n)),_.o("#inform-percent-val-low tspan").text($t(A.low/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#inform-percent-bar-low").transition().duration(500).attr("width",64*$t(A.low/n)),_.o("#inform-percent-val-no-score tspan").text($t(A["no-score"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),_.o("#inform-percent-bar-no-score").transition().duration(500).attr("width",64*$t(A["no-score"]/n)),_.o("#hdi-toggle-very-high-val tspan").text(p["very-high"]).style("text-anchor","end").attr("dx","10"),_.o("#hdi-toggle-high-val tspan").text(p.high).style("text-anchor","end").attr("dx","10"),_.o("#hdi-toggle-medium-val tspan").text(p.medium).style("text-anchor","end").attr("dx","10"),_.o("#hdi-toggle-low-val tspan").text(p.low).style("text-anchor","end").attr("dx","10"),_.o("#inform-toggle-very-high-val tspan").text(w["very-high"]).style("text-anchor","end").attr("dx","6"),_.o("#inform-toggle-high-val tspan").text(w.high).style("text-anchor","end").attr("dx","10"),_.o("#inform-toggle-medium-val tspan").text(w.medium).style("text-anchor","end").attr("dx","9"),_.o("#inform-toggle-low-val tspan").text(w.low).style("text-anchor","end").attr("dx","7"),_.o("#inform-toggle-no-score-val tspan").text(w["no-score"]).style("text-anchor","end").attr("dx","13"),_.o("#hdi1val-very-high tspan").text($t(g["very-high"]/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi1bar-very-high").transition().duration(500).attr("width",70*$t(g["very-high"]/q)),_.o("#hdi1val-high tspan").text($t(g.high/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi1bar-high").transition().duration(500).attr("width",70*$t(g.high/q)),_.o("#hdi1val-medium tspan").text($t(g.medium/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi1bar-medium").transition().duration(500).attr("width",70*$t(g.medium/q)),_.o("#hdi1val-low tspan").text($t(g.low/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi1bar-low").transition().duration(500).attr("width",70*$t(g.low/q)),_.o("#inform1val-very-high tspan").text($t(k["very-high"]/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform1bar-very-high").transition().duration(500).attr("width",64*$t(k["very-high"]/T)),_.o("#inform1val-high tspan").text($t(k.high/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform1bar-high").transition().duration(500).attr("width",64*$t(k.high/T)),_.o("#inform1val-medium tspan").text($t(k.medium/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform1bar-medium").transition().duration(500).attr("width",64*$t(k.medium/T)),_.o("#inform1val-low tspan").text($t(k.low/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform1bar-low").transition().duration(500).attr("width",64*$t(k.low/T)),_.o("#inform1val-no-score tspan").text($t(k["no-score"]/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform1bar-no-score").transition().duration(500).attr("width",64*$t(k["no-score"]/T)),_.o("#hdi2val-very-high tspan").text($t(m["very-high"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi2bar-very-high").transition().duration(500).attr("width",70*$t(m["very-high"]/o)),_.o("#hdi2val-high tspan").text($t(m.high/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi2bar-high").transition().duration(500).attr("width",70*$t(m.high/o)),_.o("#hdi2val-medium tspan").text($t(m.medium/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi2bar-medium").transition().duration(500).attr("width",70*$t(m.medium/o)),_.o("#hdi2val-low tspan").text($t(m.low/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi2bar-low").transition().duration(500).attr("width",70*$t(m.low/o)),_.o("#inform2val-very-high tspan").text($t(F["very-high"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform2bar-very-high").transition().duration(500).attr("width",64*$t(F["very-high"]/o)),_.o("#inform2val-high tspan").text($t(F.high/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform2bar-high").transition().duration(500).attr("width",64*$t(F.high/o)),_.o("#inform2val-medium tspan").text($t(F.medium/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform2bar-medium").transition().duration(500).attr("width",64*$t(F.medium/o)),_.o("#inform2val-low tspan").text($t(F.low/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform2bar-low").transition().duration(500).attr("width",64*$t(F.low/o)),_.o("#inform2val-no-score tspan").text($t(F["no-score"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform2bar-no-score").transition().duration(500).attr("width",64*$t(F["no-score"]/o));var D=_.h([m.low,m.medium,m.high,m["very-high"]]),N=_.h([F.low,F.medium,F.high,F["very-high"],F["no-score"]]);_.o("#hdi3val-very-high tspan").text(y(m["very-high"])).style("text-anchor","end").attr("dx",""),_.o("#hdi3bar-very-high").transition().duration(500).attr("width",70*$t(m["very-high"]/D)),_.o("#hdi3val-high tspan").text(y(m.high)).style("text-anchor","end").attr("dx",""),_.o("#hdi3bar-high").transition().duration(500).attr("width",70*$t(m.high/D)),_.o("#hdi3val-medium tspan").text(y(m.medium)).style("text-anchor","end").attr("dx",""),_.o("#hdi3bar-medium").transition().duration(500).attr("width",70*$t(m.medium/D)),_.o("#hdi3val-low tspan").text(y(m.low)).style("text-anchor","end").attr("dx",""),_.o("#hdi3bar-low").transition().duration(500).attr("width",70*$t(m.low/D)),_.o("#inform3val-very-high tspan").text(y(F["very-high"])).style("text-anchor","end").attr("dx",""),_.o("#inform3bar-very-high").transition().duration(500).attr("width",64*$t(F["very-high"]/N)),_.o("#inform3val-high tspan").text(y(F.high)).style("text-anchor","end").attr("dx",""),_.o("#inform3bar-high").transition().duration(500).attr("width",64*$t(F.high/N)),_.o("#inform3val-medium tspan").text(y(F.medium)).style("text-anchor","end").attr("dx",""),_.o("#inform3bar-medium").transition().duration(500).attr("width",64*$t(F.medium/N)),_.o("#inform3val-low tspan").text(y(F.low)).style("text-anchor","end").attr("dx",""),_.o("#inform3bar-low").transition().duration(500).attr("width",64*$t(F.low/N)),_.o("#inform3val-no-score tspan").text(y(F["no-score"])).style("text-anchor","end").attr("dx",""),_.o("#inform3bar-no-score").transition().duration(500).attr("width",64*$t(F["no-score"]/N)),_.o("#hdi4val-very-high tspan").text($t(v["very-high"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi4bar-very-high").transition().duration(500).attr("width",70*$t(v["very-high"]/a)),_.o("#hdi4val-high tspan").text($t(v.high/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi4bar-high").transition().duration(500).attr("width",70*$t(v.high/a)),_.o("#hdi4val-medium tspan").text($t(v.medium/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi4bar-medium").transition().duration(500).attr("width",70*$t(v.medium/a)),_.o("#hdi4val-low tspan").text($t(v.low/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#hdi4bar-low").transition().duration(500).attr("width",70*$t(v.low/a)),_.o("#inform4val-very-high tspan").text($t(O["very-high"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform4bar-very-high").transition().duration(500).attr("width",64*$t(O["very-high"]/a)),_.o("#inform4val-high tspan").text($t(O.high/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform4bar-high").transition().duration(500).attr("width",64*$t(O.high/a)),_.o("#inform4val-medium tspan").text($t(O.medium/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform4bar-medium").transition().duration(500).attr("width",64*$t(O.medium/a)),_.o("#inform4val-low tspan").text($t(O.low/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform4bar-low").transition().duration(500).attr("width",64*$t(O.low/a)),_.o("#inform4val-no-score tspan").text($t(O["no-score"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),_.o("#inform4bar-no-score").transition().duration(500).attr("width",64*$t(O["no-score"]/a)),x.low=Math.round(_.i(x.low))||0,x.medium=Math.round(_.i(x.medium))||0,x.high=Math.round(_.i(x.high))||0,x["very-high"]=Math.round(_.i(x["very-high"]))||0,E["no-score"]=Math.round(_.i(E["no-score"]))||0,E.low=Math.round(_.i(E.low))||0,E.medium=Math.round(_.i(E.medium))||0,E.high=Math.round(_.i(E.high))||0,E["very-high"]=Math.round(_.i(E["very-high"]))||0;var M=_.h([x.low,x.medium,x.high,x["very-high"]]),j=_.h([E.low,E.medium,E.high,E["very-high"],E["no-score"]]);_.o("#hdi5val-very-high tspan").text(f(x["very-high"])).style("text-anchor","end").attr("dx",""),_.o("#hdi5bar-very-high").transition().duration(500).attr("width",70*$t(x["very-high"]/M)),_.o("#hdi5val-high tspan").text(f(x.high)).style("text-anchor","end").attr("dx",""),_.o("#hdi5bar-high").transition().duration(500).attr("width",70*$t(x.high/M)),_.o("#hdi5val-medium tspan").text(f(x.medium)).style("text-anchor","end").attr("dx",""),_.o("#hdi5bar-medium").transition().duration(500).attr("width",70*$t(x.medium/M)),_.o("#hdi5val-low tspan").text(f(x.low)).style("text-anchor","end").attr("dx",""),_.o("#hdi5bar-low").transition().duration(500).attr("width",70*$t(x.low/M)),_.o("#inform5val-very-high tspan").text(f(E["very-high"])).style("text-anchor","end").attr("dx",""),_.o("#inform5bar-very-high").transition().duration(500).attr("width",64*$t(E["very-high"]/j)),_.o("#inform5val-high tspan").text(f(E.high)).style("text-anchor","end").attr("dx",""),_.o("#inform5bar-high").transition().duration(500).attr("width",64*$t(E.high/j)),_.o("#inform5val-medium tspan").text(f(E.medium)).style("text-anchor","end").attr("dx",""),_.o("#inform5bar-medium").transition().duration(500).attr("width",64*$t(E.medium/j)),_.o("#inform5val-low tspan").text(f(E.low)).style("text-anchor","end").attr("dx",""),_.o("#inform5bar-low").transition().duration(500).attr("width",64*$t(E.low/j)),_.o("#inform5val-no-score tspan").text(f(E["no-score"])).style("text-anchor","end").attr("dx",""),_.o("#inform5bar-no-score").transition().duration(500).attr("width",64*$t(E["no-score"]/j)),_.o("#countries_filtered tspan").text(a+" countries filtered").style("text-anchor","end").attr("dx","105")}function b(t,e){return x.apply(this,arguments)}function x(){return(x=Object(s.a)(l.a.mark((function t(e,a){var n,i,r,o,c,s,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for("col0_sort"==a.table_sort&&(n="country_name"),"col1_sort"==a.table_sort&&(n="total_vaccinations_per_hundred"),"col2_sort"==a.table_sort&&(n="people_vaccinated_per_hundred"),"col3_sort"==a.table_sort&&(n="people_fully_vaccinated_per_hundred"),"col4_sort"==a.table_sort&&(n="vaccine_acceptance_percent"),"col5_sort"==a.table_sort&&(n="total_vaccinations"),i=0;i<6;i++)_.o("#col"+i+"_sort_desc").attr("opacity",0),_.o("#col"+i+"_sort_asc").attr("opacity",0);_.o("#"+a.table_sort+"_"+a.table_sort_direction).attr("opacity",1),"country_name"==n?"asc"==a.table_sort_direction?e.country.sort((function(t,e){return e.country_name.localeCompare(t.country_name)})):e.country.sort((function(t,e){return t.country_name.localeCompare(e.country_name)})):"desc"==a.table_sort_direction?e.country.sort((function(t,e){return e[n]-t[n]})):e.country.sort((function(t,e){return t[n]-e[n]})),_.p(".tablerow").remove(),_.p(".col1bar").attr("opacity",0),_.p(".col2bar").attr("opacity",0),_.p(".col3bar").attr("opacity",0),_.p(".col4bar").attr("opacity",0),_.p(".colbg").attr("opacity",0),_.p(".table_country_name tspan").text(""),a.numPages=Math.ceil(e.country.length/10),_.o("#next").attr("opacity",(function(){return a.page==a.numPages?.5:1})),_.o("#prev").attr("opacity",(function(){return 1==a.page?.5:1})),_.o("#pagination_text").attr("text-anchor","end"),_.o("#pagination_text tspan").attr("x",40),_.o("#pagination_text tspan").text("Page "+a.page+" of "+a.numPages),r=0,10,o=function(t){return new Promise((function(e){return setTimeout(e,t)}))},c=10*(a.page-1);case 26:if(!(c<10*a.page)){t.next=56;break}if(s=e.country[c],e.country[c]){t.next=34;break}return _.o("#col1bar"+r).attr("width",0),_.o("#col2bar"+r).attr("width",0),_.o("#col3bar"+r).attr("width",0),_.o("#col4bar"+r).attr("width",0),t.abrupt("continue",53);case 34:return _.o("#vac-tab").append("text").attr("class","tablerow table_country_name").text((function(){var t;return 17==(t=(t=s.country_name?s.country_name:s.country_code).substring(0,17)).length&&(t+="."),t})).attr("x",0).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#vac-tab").append("text").attr("class","tablerow table_country_name").text((function(){var t=parseFloat(s.total_vaccinations_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t})).style("text-anchor","end").attr("x",112).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#col1bar"+r).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=s.total_vaccinations_per_hundred;return s.total_vaccinations_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),_.o("#col1bg"+r).attr("opacity",1),_.o("#vac-tab").append("text").attr("class","tablerow").text((function(){var t=parseFloat(s.people_vaccinated_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",223).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#col2bar"+r).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=s.people_vaccinated_per_hundred;return s.people_vaccinated_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),_.o("#col2bg"+r).attr("opacity",1),_.o("#vac-tab").append("text").attr("class","tablerow").text((function(){var t=parseFloat(s.people_fully_vaccinated_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",335).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#col3bar"+r).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=s.people_fully_vaccinated_per_hundred;return s.people_fully_vaccinated_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),_.o("#col3bg"+r).attr("opacity",1),_.o("#vac-tab").append("text").attr("class","tablerow").text((function(){var t=parseFloat(s.vaccine_acceptance_percent).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",450).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#col4bar"+r).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=s.vaccine_acceptance_percent;return s.vaccine_acceptance_percent>100&&(t=100),isNaN(t)?0:t/100*68})),_.o("#col4bg"+r).attr("opacity",1),u=_.r("%b %d"),_.o("#vac-tab").append("text").attr("class","tablerow").text((function(){var t=s.total_vaccinations;return isNaN(t)||0==t?"":y(t)})).style("text-anchor","end").attr("x",572).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),_.o("#vac-tab").append("text").attr("class","tablerow").text((function(){var t=s.data_updated;return t?u(t):""})).style("text-anchor","end").attr("x",620).attr("y",(function(){return 80+24.8*r})).style("fill","#000").style("font-size","9px"),r++,t.next=53,o(15);case 53:c++,t.next=26;break;case 56:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(){qt()("#regionSelect").select2({data:[{id:"regions",text:"IFRC Regions",children:Vt},{id:"countries",text:"Countries",children:Zt}],placeholder:"",scrollAfterSelect:!0,renderTemplate:function(t){return t.text||"\u200b"},dropdownParent:qt()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return qt()("<span>"+t.text+"<span>")}}).on("select2:unselecting",(function(){qt()(this).data("unselecting",!0)})).on("select2:opening",(function(t){qt()(this).data("unselecting")&&(qt()(this).removeData("unselecting"),t.preventDefault())})),qt()("#regionSelect").on("select2:select",(function(t){m([t.params.data.id])})),qt()("#regionSelect").on("select2:unselect",(function(t){m([t.params.data.id])})),_.o("#reset_locations").style("cursor","pointer").on("click",(function(){m("clear")})),qt()("#colorSelect").select2({scrollAfterSelect:!0,minimumResultsForSearch:-1,renderTemplate:function(t){return t.text||"\u200b"},dropdownParent:qt()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return qt()("<span>"+t.text+"<span>")}}).on("select2:select",(function(t){var e=t.params.data;Ot.bubble_chart_color_by=e.id,Ft(Yt,Ot)})),qt()("#ySelect").select2({scrollAfterSelect:!0,minimumResultsForSearch:-1,renderTemplate:function(t){return t.text||"\u200b"},dropdownParent:qt()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return qt()("<span>"+t.text+"<span>")}}).on("select2:select",(function(t){var e=t.params.data;Ot.bubble_chart_y_axis=e.id,Ft(Yt,Ot)}))}return _.o("#prev").style("cursor","pointer").attr("opacity",.5).on("click",(function(){if(1==Ot.page)return!1;Ot.page=Ot.page-1,b(Yt,Ot)})),_.o("#next").style("cursor","pointer").on("click",(function(){if(Ot.page==Ot.numPages)return!1;Ot.page=Ot.page+1,b(Yt,Ot)})),Object(n.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[]),Object(St.jsxs)("div",{children:[Object(St.jsxs)("div",{id:"loaderDiv",children:[Object(St.jsx)("div",{id:"loaderText",children:c}),Object(St.jsx)("div",{id:"loaderBar",children:Object(St.jsx)("div",{id:"loaderProgress",style:{width:100*a+"%"}})})]}),Object(St.jsxs)("div",{id:"regionSelectContainer",children:[Object(St.jsx)("select",{id:"regionSelect",className:"js-example-responsive",name:"region[]",multiple:"multiple"}),Object(St.jsx)("div",{id:"regionDrop"})]}),Object(St.jsxs)("div",{id:"bubbleSelectContainer",children:[Object(St.jsxs)("div",{id:"colorSelectContainer",children:["Color by\xa0\xa0",Object(St.jsxs)("select",{id:"colorSelect",className:"js-example-responsive",name:"colorby[]",defaultValue:"hdi",children:[Object(St.jsx)("option",{value:"region",children:"IFRC region"}),Object(St.jsx)("option",{value:"hdi",children:"Human Development Index (HDI)"}),Object(St.jsx)("option",{value:"inform-severity",children:"INFORM Severity Index"})]}),Object(St.jsx)("div",{id:"colorDrop"})]}),Object(St.jsxs)("div",{id:"ySelectContainer",children:["y-Axis\xa0\xa0",Object(St.jsxs)("select",{id:"ySelect",className:"js-example-responsive",name:"yaxis[]",children:[Object(St.jsx)("option",{value:"percent-vaccinated-at-least-1-dose",children:"% vaccinated at least 1 dose"}),Object(St.jsx)("option",{value:"percent-fully-vaccinated",children:"% fully vaccinated"}),Object(St.jsx)("option",{value:"percent-vaccine-acceptance",children:"% vaccine acceptance"})]}),Object(St.jsx)("div",{id:"yDrop"})]})]}),Object(St.jsx)("div",{id:"svg_container",className:"App"}),Object(St.jsx)("div",{id:"map_div_outer",children:Object(St.jsx)("div",{id:"map_div"})}),Object(St.jsxs)("div",{id:"footer",children:["Data Sources - ",Object(St.jsx)("a",{href:"https://covid19.who.int/info/",target:"_blank",children:"WHO Daily cases and deaths by date, vaccination data"}),", ",Object(St.jsx)("a",{href:"https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations",target:"_blank",children:"OWID vaccinations csv"})]})]})},Xt=function(t){t&&t instanceof Function&&a.e(5).then(a.bind(null,512)).then((function(e){var a=e.getCLS,n=e.getFID,i=e.getFCP,r=e.getLCP,o=e.getTTFB;a(t),n(t),i(t),r(t),o(t)}))};o.a.render(Object(St.jsx)(i.a.StrictMode,{children:Object(St.jsx)(Jt,{})}),document.getElementById("root")),Xt()}},[[134,1,3]]]);
//# sourceMappingURL=main.71807b34.chunk.js.map