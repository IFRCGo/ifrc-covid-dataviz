(this["webpackJsonpifrc-covid-dataviz"]=this["webpackJsonpifrc-covid-dataviz"]||[]).push([[0],{121:function(t,e,a){},127:function(t,e,a){"use strict";a.r(e);var n=a(5),i=a.n(n),r=a(33),o=a.n(r),c=a(0),l=a(1),s=a.n(l);const u={hdi_category:{"very-high":"#D8EF8B",high:"#FDE08B",medium:"#FB8D59",low:"#D63127"},inform_severity:{"very-high":"#D63127",high:"#FB8D59",medium:"#FDE08B",low:"#D8EF8B","no-score":"#DAE0EA"},blue:"#1F558C",lightblue:"#E8EEF3",lightnavy:"#799EAD",red:"#EE3224",lightred:"#FDEAE9",green:"#D8EF8B",ifrcgreen:"#87C400",black:"#595454",lightgrey:"#e8e8e8",darkgrey:"#c1c1c1",white:"#fff",olive:"#87C400",purple:"#771966",orange:"#FF3500",pink:"#FB0080"};var d=["#00ADED","#62D7F7","#003A5A","#799EAD","#FFDD00"];u.regions={AP:u.orange,AM:u.lightblue,EU:u.ifrcgreen,ME:"#0A3248",AF:"#FCD204"},u.regions={AP:d[1],AM:d[0],EU:d[2],ME:d[3],AF:d[4]};var _=u;function h(t){let e=(t+="").split("."),a=e[0],n=e.length>1?"."+e[1]:"";for(var i=/(\d+)(\d{3})/;i.test(a);)a=a.replace(i,"$1,$2");return a+n}function p(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var a=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"B"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}].slice().reverse().find((function(e){return t>=e.value}));return a?(t/a.value).toFixed(e).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+a.symbol:"0"}var g=a(21),m=a(7),f=a.n(m);let y,v,b,x,w,k,F,O,A,E,q,T,D,N,M,j,P,C,S,I,H;const B=["AF","AP","ME","EU","AM","OTH"];function z(t,e){M=new Date(t.min_date),N=new Date(t.max_date);const a=[];if(t.who_data.forEach((function(t,n){a[t[e.timeline_frequency+"Total"]]||(a[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.month_start),a[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(a[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_cases+=t.new_cases,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_deaths+=t.new_deaths,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_cases=0})),a.forEach((function(t,e){B.forEach((function(n,i){t.hasOwnProperty(n)||(t[n]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),e>0?(t[n].cumulative_cases=a[e][n].new_cases+a[e-1][n].cumulative_cases,t[n].cumulative_deaths=a[e][n].new_deaths+a[e-1][n].cumulative_deaths):(t[n].cumulative_cases=a[e][n].new_cases,t[n].cumulative_deaths=a[e][n].new_deaths)})),t.total_new_cases=t.AF.new_cases+t.AP.new_cases+t.AM.new_cases+t.EU.new_cases+t.ME.new_cases+t.OTH.new_cases,t.total_cumulative_cases=t.AF.cumulative_cases+t.AP.cumulative_cases+t.AM.cumulative_cases+t.EU.cumulative_cases+t.ME.cumulative_cases+t.OTH.cumulative_cases,t.total_new_deaths=t.AF.new_deaths+t.AP.new_deaths+t.AM.new_deaths+t.EU.new_deaths+t.ME.new_deaths+t.OTH.new_deaths,t.total_cumulative_deaths=t.AF.cumulative_deaths+t.AP.cumulative_deaths+t.AM.cumulative_deaths+t.EU.cumulative_deaths+t.ME.cumulative_deaths+t.OTH.cumulative_deaths,t.region=[],B.forEach((function(e,a){t.region.push({region:e,new_cases:t[e].new_cases,new_deaths:t[e].new_deaths,cumulative_cases:t[e].cumulative_cases,cumulative_deaths:t[e].cumulative_deaths})}))})),P=[],"cumulative"!=e.timeline_type)t.vaccines_data.forEach((function(t,a){P[t[e.timeline_frequency+"Total"]]||(P[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.month_start),P[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(P[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_vaccines:0}),P[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_vaccines+=t.daily_vaccinations})),P.forEach((function(t,e){B.forEach((function(e,a){t[e]||(t[e]={new_vaccines:0,cumulative_vaccines:0})})),t.total_new_vaccines=t.AF.new_vaccines+t.AP.new_vaccines+t.AM.new_vaccines+t.EU.new_vaccines+t.ME.new_vaccines+t.OTH.new_vaccines,t.region=[],B.forEach((function(e,a){var n=0;t[e].new_vaccines>0&&(n+=t[e].new_vaccines),t.region.push({region:e,new_vaccines:n})}))}));else{var n=[];if("day"===e.timeline_frequency&&(n=f()(t.vaccines_data)),"week"===e.timeline_frequency&&t.vaccines_data.forEach((function(e,a){var i=s()(e.date).endOf("isoWeek").startOf("day").unix(),r=s()(e.date).startOf("day").unix();r!=i&&r!=s()(t.max_date).startOf("day").unix()||n.push(e)})),"month"===e.timeline_frequency){var i=s()(t.max_date).startOf("day").unix();t.vaccines_data.forEach((function(e,a){var r=s()(e.date).endOf("month").startOf("day").unix(),o=s()(e.date).startOf("day").unix();(o==r||s()(t.max_date).startOf("day").unix()!=r&&o==i)&&n.push(e)}))}n.forEach((function(t,a){P[t[e.timeline_frequency+"Total"]]||(P[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.month_start),P[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(P[t[e.timeline_frequency+"Total"]][t.ifrc_region]={cumulative_vaccines:0}),P[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_vaccines+=t.total_vaccinations})),P.forEach((function(t,e){B.forEach((function(e,a){t[e]||(t[e]={cumulative_vaccines:0})})),t.total_cumulative_vaccines=t.AF.cumulative_vaccines+t.AP.cumulative_vaccines+t.AM.cumulative_vaccines+t.EU.cumulative_vaccines+t.ME.cumulative_vaccines+t.OTH.cumulative_vaccines,t.region=[],B.forEach((function(e,a){t.region.push({region:e,cumulative_vaccines:t[e].cumulative_vaccines})}))}))}P=P.filter((function(t){return t}));const r=c.h(t.who_data,(function(t,a){return t[e.timeline_frequency+"Total"]})),o=c.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_cases:"cumulative"===e.timeline_type?t.total_cumulative_cases:"stacked"===e.timeline_type?100:void 0})),l=c.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_deaths:"cumulative"===e.timeline_type?t.total_cumulative_deaths:"stacked"===e.timeline_type?100:void 0})),u=c.h(P,(function(t,a){if(t){if("non-cumulative"===e.timeline_type)return t.total_new_vaccines;if("cumulative"===e.timeline_type)return t.total_cumulative_vaccines;if("stacked"===e.timeline_type)return 100}}));"month"===e.timeline_frequency&&(M=s()(M).startOf("month").startOf("day").toDate()),"month"===e.timeline_frequency&&(N=s()(N).endOf("month").startOf("day").toDate()),"week"===e.timeline_frequency&&(N=s()(N).endOf("isoWeek").startOf("day").toDate()),j=s()(N),"day"===e.timeline_frequency&&(j=new Date(s()(N).add(1,"days").toDate()));const d=c.o("#timechart_svg");d.selectAll("g").remove(),c.p("#layout .yAxis").remove(),c.p("#yAxis").remove(),c.p("#layout .xAxis").remove(),d.append("g").append("rect").attr("width",2e3).attr("height","100%").attr("x",0).attr("y",0).attr("fill","#FFF").attr("opacity",0);const h=2e3/r;let m=.04;"month"===e.timeline_frequency&&(m=.03),"day"===e.timeline_frequency&&(m=.02),E=c.n().range([0,2e3]).domain([M,j]),T=c.n().range([0,596]).domain([M,j]),y=c.l().range([0,140]).domain([0,o]),F=c.l().range([140,0]).domain([0,o]),v=c.l().range([0,140]).domain([0,l]),O=c.l().range([140,0]).domain([0,l]),b=c.l().range([0,140]).domain([0,u]),A=c.l().range([140,0]).domain([0,u]),q=c.a().scale(T).tickSize(2).tickPadding(3),x=c.c().scale(F).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)})),w=c.c().scale(O).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)})),k=c.c().scale(A).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)}));var z=c.o("#layout").append("g").attr("id","yAxis").attr("clip-path","url(#mask)"),R=(z.append("g").attr("class","yAxis axis").attr("id","casesAxis").attr("transform","translate(620,363)").call(x),z.append("g").attr("class","yAxis axis").attr("id","deathsAxis").attr("transform","translate(620,534)").call(w),z.append("g").attr("class","yAxis axis").attr("id","VaccinesAxis").attr("transform","translate(620,707.5)").call(k),z.append("g").attr("id","casesXAxis").attr("class","xAxis").attr("transform","translate(24,504)").call(q)),L=z.append("g").attr("id","deathsXAxis").attr("class","xAxis").attr("transform","translate(24,674)").call(q),W=z.append("g").attr("id","vaccinesXAxis").attr("class","xAxis").attr("transform","translate(24,848)").call(q),U=z.append("g").attr("id","timelineXAxis").attr("class","xAxis").attr("transform","translate(24,908)").call(q);const Y=d.selectAll(".bar_group").data(a).enter().append("g").attr("class","bar_group").attr("transform",(function(t,e){return e<10&&console.log(t),"translate("+E(t.date)+")"}));Y.selectAll(".cases_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class",(function(t,e){return"timeBar cases_bar time_"+t.region})).attr("x",h*m).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_cases-c.o(this.parentNode).datum().OTH.new_cases;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_cases),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_cases),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_cases);let r=0;return"cumulative"===e.timeline_type&&(r=140-y(t.cumulative_cases)-y(i)),"non-cumulative"===e.timeline_type&&(r=140-y(t.new_cases)-y(i)),"stacked"===e.timeline_type&&(r=140-t.new_cases/n*140-i/n*140),r&&r>0?r:0})).attr("width",h-h*m*2).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_cases-c.o(this.parentNode).datum().OTH.new_cases;let i=0;return"cumulative"===e.timeline_type&&(i=y(t.cumulative_cases)),"non-cumulative"===e.timeline_type&&(i=y(t.new_cases)),"stacked"===e.timeline_type&&(i=t.new_cases/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return _.regions[t.region]})),Y.selectAll(".deaths_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class",(function(t,e){return"timeBar deaths_bar time_"+t.region})).attr("x",h*m).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_deaths-c.o(this.parentNode).datum().OTH.new_deaths;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_deaths),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_deaths),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_deaths);let r=0;return"cumulative"===e.timeline_type&&(r=140-v(t.cumulative_deaths)-v(i)+170),"non-cumulative"===e.timeline_type&&(r=140-v(t.new_deaths)-v(i)+170),"stacked"===e.timeline_type&&(r=140-t.new_deaths/n*140-i/n*140+170),r&&r>0?r:0})).attr("width",h-h*m*2).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_deaths-c.o(this.parentNode).datum().OTH.new_deaths;let i=0;return"cumulative"===e.timeline_type&&(i=v(t.cumulative_deaths)),"non-cumulative"===e.timeline_type&&(i=v(t.new_deaths)),"stacked"===e.timeline_type&&(i=t.new_deaths/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return _.regions[t.region]})),"month"===e.timeline_frequency&&Y.selectAll(".timeBar").attr("width",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(1-m)})).attr("x",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(m/2)}));const V=d.selectAll(".vbar_group").data(P).enter().append("g").attr("class","vbar_group").attr("transform",(function(t,e){return"translate("+E(t.date)+", 344)"}));V.selectAll(".vaccines_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).enter().append("rect").attr("class","timeBar vaccines_bar").attr("class",(function(t,e){return"timeBar vaccines_bar time_"+t.region})).attr("x",h*m).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_vaccines-c.o(this.parentNode).datum().OTH.new_vaccines;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_vaccines),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_vaccines),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_vaccines);let r=0;return"cumulative"===e.timeline_type&&(r=140-b(t.cumulative_vaccines)-b(i)),"non-cumulative"===e.timeline_type&&(r=140-b(t.new_vaccines)-b(i)),"stacked"===e.timeline_type&&(r=140-t.new_vaccines/n*140-i/n*140),r&&r>0?r:0})).attr("width",h-h*m*2).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_vaccines-c.o(this.parentNode).datum().OTH.new_vaccines;let i=0;return"cumulative"===e.timeline_type&&(i=b(t.cumulative_vaccines)),"non-cumulative"===e.timeline_type&&(i=b(t.new_vaccines)),"stacked"===e.timeline_type&&(i=t.new_vaccines/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return _.regions[t.region]})),"month"===e.timeline_frequency&&V.selectAll(".timeBar").attr("width",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(1-m)})).attr("x",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(m/2)})),"month"===e.timeline_frequency&&Y.selectAll(".timeBar").attr("width",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(1-m)})).attr("x",(function(t){var e=c.o(this.parentNode).datum().date,a=c.s.offset(e,1);return(E(a)-E(e))*(m/2)})),H=t.timeline_data,D=c.n().range([25,619]).domain([M,j]),document.getElementById("svg").appendChild(c.o("#timeline_tooltip").node()),document.getElementById("svg").appendChild(c.o("#event_tooltip").node()),S=c.o("#timeline_tooltip").attr("opacity",0),I=c.o("#event_tooltip").attr("opacity",0),C=d.append("rect").attr("id","timechart_hover").attr("width",h).attr("x",0).attr("y",0).attr("opacity",0).attr("height","100%").attr("fill","rgb(221 221 221 / 40%)"),c.o("#timechart_svg").on("mouseover",(t=>{var a=c.k(t);C.attr("opacity",1);var n=E.invert(a[0]);"week"==e.timeline_frequency&&(n=s()(n).startOf("isoWeek")),"day"==e.timeline_frequency&&(n=s()(n).startOf("day")),"month"==e.timeline_frequency&&(n=s()(n).startOf("month")),a[1]<470?(S.attr("opacity",1).attr("display","inline"),C.attr("height","100%")):a[1]>510?(I.attr("opacity",1),C.attr("height","90%")):(I.attr("opacity",0),S.attr("opacity",0),C.attr("height","100%")),n.toDate().getTime()<M.getTime()&&(C.attr("opacity",0),S.attr("opacity",0)),c.o("#svg_container").style("z-index",10)})).on("mouseout",(t=>{C.attr("opacity",0),S.attr("opacity",0).attr("display","none"),c.o("#svg_container").style("z-index",1),I.attr("opacity",0).attr("transform","translate(0,0)"),c.p(".event_marker circle").style("stroke",_.black)})).on("mousemove",(t=>{var n=c.k(t),i=E.invert(n[0]),r="";"week"==e.timeline_frequency&&(r=(i=s()(i).startOf("isoWeek")).format("ll"),c.o("#timeline_tooltip_date tspan").text(r)),"day"==e.timeline_frequency&&(r=(i=s()(i).startOf("day")).format("ll"),c.o("#timeline_tooltip_date tspan").text(r)),"month"==e.timeline_frequency&&(r=(i=s()(i).startOf("month")).format("MMMM YYYY"),c.o("#timeline_tooltip_date tspan").text(r)),C.attr("x",E(i.toDate()));var o=a.filter((function(t,e){return s()(t.date).startOf("day").unix()==i.startOf("day").unix()})),l=P.filter((function(t,e){return s()(t.date).startOf("day").unix()==i.startOf("day").unix()})),u="-",d="-",m="-";if("cumulative"==e.timeline_type?(o[0]&&(d=p(o[0].total_cumulative_cases,2)),o[0]&&(u=p(o[0].total_cumulative_deaths,2)),l[0]&&(m=p(l[0].total_cumulative_vaccines,2))):(o[0]&&(d=p(o[0].total_new_cases,2)),o[0]&&(u=p(o[0].total_new_deaths,2)),l[0]&&(m=p(l[0].total_new_vaccines,2))),0==u&&(u="-"),0==d&&(d="-"),0==m&&(m="-"),c.o("#tooltip_cases tspan").text(d).attr("text-anchor","end").attr("dx",32),c.o("#tooltip_deaths tspan").text(u).attr("text-anchor","end").attr("dx",32),c.o("#tooltip_vaccines tspan").text(m).attr("text-anchor","end").attr("dx",32),i.toDate().getTime()<M.getTime()&&"day"==e.timeline_frequency&&(C.attr("opacity",0),S.attr("opacity",0)),"month"==e.timeline_frequency&&C.attr("width",(function(){return E(s()(i).endOf("month"))-E(s()(i).startOf("month"))})),S.attr("transform",(function(){var t=(e.brushR-e.brushL)/600,a=0;return t<.5&&(a=3),t<.3&&(a=12),t<.2&&(a=20),t<.15&&(a=21),"month"==e.timeline_frequency?(t<.6&&(a=20),t<.5&&(a=30),t<.3&&(a=50),t<.2&&(a=60),t<.1&&(a=70),"translate("+(D(i.toDate())+h/3+a)+","+(n[1]+353)+")"):"translate("+(D(i.toDate())+18+a)+","+(n[1]+353)+")"})),n[1]<470)S.attr("opacity",1),C.attr("opacity",1),C.attr("height","100%");else if(n[1]>510){I.attr("opacity",1),C.attr("height","90%");var f=s()(E.invert(n[0])).startOf("day");E.invert(n[0]);I.attr("transform",(function(){return"translate("+(D(f.toDate())+-3)+",817)"}));var y=H.filter((function(t,e){return s()(t.date).startOf("day").unix()==f.unix()}));if(0==y.length&&(y=H.filter((function(t,e){return s()(t.date).startOf("day").unix()<=s()(f).add(1,"days").unix()&&s()(t.date).startOf("day").unix()>=s()(f).subtract(1,"days").unix()}))),y.length>0){c.o("#event-"+s()(y[0].date).startOf("day").unix()).select("path").style("stroke","#000").attr("opacity",1),r=s()(y[0].date).startOf("day").format("ll"),c.o("#event_tooltip_date tspan").text(r);var v=Object(g.textwrap)().bounds({height:200,width:230}).method("tspans");t=c.o("#event_tooltip_text").text(y[0].description).attr("y",18).attr("x",6);c.o("#event_tooltip_text").call(v),c.p("#event_tooltip_text tspan").attr("dy","1.3em");var b=c.o("#event_tooltip_text").node().getBBox();c.o("#event_tooltip_rect").attr("width",b.width+17).attr("height",b.height+26);c.o("#event_tooltip_rect").attr("height");var x=0;b.height<20?x=19:b.height<30?x=9:b.height<40?x=0:(b.height<50||b.height<60)&&(x=-20);c.o("#event_tooltip_rect").attr("y");c.o("#event_tooltip_rect").attr("y",x),c.p("#event_tooltip_text").attr("y",(function(t,e){return parseInt(c.o(this).attr("y"))+x})),c.p("#event_tooltip_date tspan").attr("dy",(function(t,e){return x})),I.attr("opacity",1)}else c.p(".event_marker circle").style("stroke",_.black),I.attr("opacity",0)}else I.attr("opacity",0),S.attr("opacity",0),C.attr("opacity",0),C.attr("height","100%");if("day"==e.timeline_frequency&&i.toDate().getTime()<M.getTime())return C.attr("opacity",0),S.attr("opacity",0),!1})),H=H.filter((t=>t.date.length>0)),z.append("line").attr("id","event-line").attr("x1",0).attr("x2",620).attr("y1",893).attr("y2",893).attr("stroke-width",2.5).attr("stroke",_.black);var Z=z.append("g").selectAll(".event_marker").data(H).enter().append("g").attr("class","event_marker").attr("id",(function(t,e){return"event-"+s()(t.date).startOf("day").unix()})).attr("transform",(function(t){return"translate("+D(new Date(t.date))+", 893)"})).style("cursor","pointer");Z.append("circle").style("stroke",_.black).attr("opacity",1).attr("r",6.5).attr("cx",0).attr("cy",0).style("stroke-width",2.2).style("fill","white"),Z.append("circle").attr("r",2).attr("cx",0).attr("cy",0).attr("fill",_.black).style("stroke",_.black);const $=c.d().extent([[0,0],[600,20]]).on("start brush end",(function(){var t=parseFloat(c.o(".handle--w").attr("x")),a=parseFloat(c.o(".handle--e").attr("x"));if(a-t<40)return!1;c.o(".selection").attr("width");c.o("#zoomL").attr("transform","translate("+t+",0)"),c.o("#zoomR").attr("transform","translate("+a+",0)"),c.o("#zoomOverlay").attr("width",a-t),c.o("#zoomOverlay").attr("x",t),c.o("#zoomOverlay").attr("transform","translate(3,0)");var n=Math.round(X(a)-X(t)),i=Math.round(X(t));e.brushL=t+3,e.brushR=a+3,T=c.n().range([0,596]).domain([new Date(E.invert(X(t))),new Date(E.invert(X(a)))]),D=c.n().range([25,619]).domain([new Date(E.invert(X(t))),new Date(E.invert(X(a)))]),c.p(".event_marker").attr("transform",(function(t){return"translate("+D(new Date(t.date))+", 893)"})),q=c.a().ticks(5).scale(T),R.call(q),L.call(q),W.call(q),U.call(q),c.o("#timechart_svg").attr("viewBox",i+" 0 "+n+" 553")}));c.o(".brush").remove();var J=c.o("#zoombar").append("g").attr("class","brush").attr("opacity",.1).call($);c.p(".handle rect").attr("fill-opacity","1").style("visibility","visible").attr("width",2).attr("fill","#000").style("stroke-opacity",0);var X=c.l().domain([-3,597]).range([0,2e3]);J.call($.move,[e.brushL,e.brushR])}function R(t,e){const a=[];if(t.who_data.forEach((function(t,n){a[t[e.timeline_frequency+"Total"]]||(a[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.week_start),"month"===e.timeline_frequency&&(a[t[e.timeline_frequency+"Total"]].date=t.month_start),a[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(a[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_cases+=t.new_cases,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_deaths+=t.new_deaths,a[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_cases=0})),a.forEach((function(t,e){B.forEach((function(n,i){t.hasOwnProperty(n)||(t[n]={new_cases:0,new_deaths:0,cumulative_cases:0,cumulative_deaths:0}),e>0?(t[n].cumulative_cases=a[e][n].new_cases+a[e-1][n].cumulative_cases,t[n].cumulative_deaths=a[e][n].new_deaths+a[e-1][n].cumulative_deaths):(t[n].cumulative_cases=a[e][n].new_cases,t[n].cumulative_deaths=a[e][n].new_deaths)})),t.total_new_cases=t.AF.new_cases+t.AP.new_cases+t.AM.new_cases+t.EU.new_cases+t.ME.new_cases+t.OTH.new_cases,t.total_cumulative_cases=t.AF.cumulative_cases+t.AP.cumulative_cases+t.AM.cumulative_cases+t.EU.cumulative_cases+t.ME.cumulative_cases+t.OTH.cumulative_cases,t.total_new_deaths=t.AF.new_deaths+t.AP.new_deaths+t.AM.new_deaths+t.EU.new_deaths+t.ME.new_deaths+t.OTH.new_deaths,t.total_cumulative_deaths=t.AF.cumulative_deaths+t.AP.cumulative_deaths+t.AM.cumulative_deaths+t.EU.cumulative_deaths+t.ME.cumulative_deaths+t.OTH.cumulative_deaths,t.region=[],B.forEach((function(e,a){t.region.push({region:e,new_cases:t[e].new_cases,new_deaths:t[e].new_deaths,cumulative_cases:t[e].cumulative_cases,cumulative_deaths:t[e].cumulative_deaths})}))})),P=[],"cumulative"!=e.timeline_type)t.vaccines_data.forEach((function(t,a){P[t[e.timeline_frequency+"Total"]]||(P[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=s()(t.date).startOf("isoWeek").toDate()),"month"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=s()(t.date).startOf("month").toDate()),P[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(P[t[e.timeline_frequency+"Total"]][t.ifrc_region]={new_vaccines:0}),P[t[e.timeline_frequency+"Total"]][t.ifrc_region].new_vaccines+=t.daily_vaccinations})),P.forEach((function(t,e){B.forEach((function(e,a){t[e]||(t[e]={new_vaccines:0,cumulative_vaccines:0})})),t.total_new_vaccines=t.AF.new_vaccines+t.AP.new_vaccines+t.AM.new_vaccines+t.EU.new_vaccines+t.ME.new_vaccines+t.OTH.new_vaccines,t.region=[],B.forEach((function(e,a){t.region.push({region:e,new_vaccines:t[e].new_vaccines})}))}));else{var n=[];if("day"===e.timeline_frequency&&(n=f()(t.vaccines_data)),"week"===e.timeline_frequency&&t.vaccines_data.forEach((function(e,a){var i=s()(e.date).endOf("isoWeek").startOf("day").unix(),r=s()(e.date).startOf("day").unix();r!=i&&r!=s()(t.max_date).startOf("day").unix()||n.push(e)})),"month"===e.timeline_frequency){var i=s()(t.max_date).startOf("day").unix();t.vaccines_data.forEach((function(e,a){var r=s()(e.date).endOf("month").startOf("day").unix(),o=s()(e.date).startOf("day").unix();(o==r||s()(t.max_date).startOf("day").unix()!=r&&o==i)&&n.push(e)}))}n.forEach((function(t,a){P[t[e.timeline_frequency+"Total"]]||(P[t[e.timeline_frequency+"Total"]]={}),"day"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=t.date),"week"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=s()(t.date).startOf("isoWeek").toDate()),"month"===e.timeline_frequency&&(P[t[e.timeline_frequency+"Total"]].date=s()(t.date).startOf("month").toDate()),P[t[e.timeline_frequency+"Total"]][t.ifrc_region]||(P[t[e.timeline_frequency+"Total"]][t.ifrc_region]={cumulative_vaccines:0}),P[t[e.timeline_frequency+"Total"]][t.ifrc_region].cumulative_vaccines+=t.total_vaccinations})),P.forEach((function(t,e){B.forEach((function(e,a){t[e]||(t[e]={cumulative_vaccines:0})})),t.total_cumulative_vaccines=t.AF.cumulative_vaccines+t.AP.cumulative_vaccines+t.AM.cumulative_vaccines+t.EU.cumulative_vaccines+t.ME.cumulative_vaccines+t.OTH.cumulative_vaccines,t.region=[],B.forEach((function(e,a){t.region.push({region:e,cumulative_vaccines:t[e].cumulative_vaccines})}))}))}P=P.filter((function(t){return t}));const r=c.h(t.who_data,(function(t,a){return t[e.timeline_frequency+"Total"]})),o=c.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_cases:"cumulative"===e.timeline_type?t.total_cumulative_cases:"stacked"===e.timeline_type?100:void 0})),l=c.h(a,(function(t,a){return"non-cumulative"===e.timeline_type?t.total_new_deaths:"cumulative"===e.timeline_type?t.total_cumulative_deaths:"stacked"===e.timeline_type?100:void 0})),u=c.h(P,(function(t,a){if(t){if("non-cumulative"===e.timeline_type)return t.total_new_vaccines;if("cumulative"===e.timeline_type)return t.total_cumulative_vaccines;if("stacked"===e.timeline_type)return 100}})),d=c.o("#timechart_svg"),h=2e3/r;let m=.04;"month"===e.timeline_frequency&&(m=.03),"day"===e.timeline_frequency&&(m=0),y=c.l().range([0,140]).domain([0,o]),F=c.l().range([140,0]).domain([0,o]),v=c.l().range([0,140]).domain([0,l]),O=c.l().range([140,0]).domain([0,l]),b=c.l().range([0,140]).domain([0,u]),A=c.l().range([140,0]).domain([0,u]),x=c.c().scale(F).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)})),w=c.c().scale(O).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)})),k=c.c().scale(A).ticks(3).tickSize(3).tickPadding(3).tickFormat((function(t){return"stacked"==e.timeline_type?p(t)+"%":p(t)}));c.o("#casesAxis").transition().duration(500).call(x),c.o("#deathsAxis").transition().duration(500).call(w),c.o("#VaccinesAxis").transition().duration(500).call(k);const q=d.selectAll(".bar_group").data(a).attr("transform",(function(t,e){return"translate("+E(t.date)+")"}));q.selectAll(".cases_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_cases-c.o(this.parentNode).datum().OTH.new_cases;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_cases),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_cases),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_cases);let r=0;return"cumulative"===e.timeline_type&&(r=140-y(t.cumulative_cases)-y(i)),"non-cumulative"===e.timeline_type&&(r=140-y(t.new_cases)-y(i)),"stacked"===e.timeline_type&&(r=140-t.new_cases/n*140-i/n*140),r&&r>0?r:0})).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_cases-c.o(this.parentNode).datum().OTH.new_cases;let i=0;return"cumulative"===e.timeline_type&&(i=y(t.cumulative_cases)),"non-cumulative"===e.timeline_type&&(i=y(t.new_cases)),"stacked"===e.timeline_type&&(i=t.new_cases/n*140),i&&i>0?i:0})).attr("fill",(function(t,e){return _.regions[t.region]})),q.selectAll(".deaths_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_deaths-c.o(this.parentNode).datum().OTH.new_deaths;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_deaths),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_deaths),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_deaths);let r=0;return"cumulative"===e.timeline_type&&(r=140-v(t.cumulative_deaths)-v(i)+170),"non-cumulative"===e.timeline_type&&(r=140-v(t.new_deaths)-v(i)+170),"stacked"===e.timeline_type&&(r=140-t.new_deaths/n*140-i/n*140+170),r&&r>0?r:0})).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_deaths-c.o(this.parentNode).datum().OTH.new_deaths;let i=0;return"cumulative"===e.timeline_type&&(i=v(t.cumulative_deaths)),"non-cumulative"===e.timeline_type&&(i=v(t.new_deaths)),"stacked"===e.timeline_type&&(i=t.new_deaths/n*140),"non-cumulative"===e.timeline_type&&i<0?0:i&&i>0?i:0})),0==a.length&&(c.p(".cases_bar").transition().duration(500).attr("y",140).attr("height",0),c.p(".deaths_bar").transition().duration(500).attr("y",310).attr("height",0));d.selectAll(".vbar_group").data(P).attr("transform",(function(t,e){return"translate("+E(t.date)+", 344)"})).selectAll(".vaccines_bar").data((function(t,e){return t.region.filter((function(t,e){return"OTH"!==t.region}))})).transition().duration(500).attr("y",(function(t,a){const n=c.o(this.parentNode).datum().total_new_vaccines-c.o(this.parentNode).datum().OTH.new_vaccines;let i=0;if(a>0)for(let o=1;o<=a;o++)"cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].cumulative_vaccines),"non-cumulative"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_vaccines),"stacked"===e.timeline_type&&(i+=c.o(this.parentNode).datum().region[o-1].new_vaccines);let r=0;return"cumulative"===e.timeline_type&&(r=140-b(t.cumulative_vaccines)-b(i)),"non-cumulative"===e.timeline_type&&(r=140-b(t.new_vaccines)-b(i)),"stacked"===e.timeline_type&&(r=140-t.new_vaccines/n*140-i/n*140),r&&r>0?r:0})).attr("height",(function(t,a){const n=c.o(this.parentNode).datum().total_new_vaccines-c.o(this.parentNode).datum().OTH.new_vaccines;let i=0;return"cumulative"===e.timeline_type&&(i=b(t.cumulative_vaccines)),"non-cumulative"===e.timeline_type&&(i=b(t.new_vaccines)),"stacked"===e.timeline_type&&(i=t.new_vaccines/n*140),i&&i>0?i:0})),0==P.length&&c.p(".vaccines_bar").transition().duration(500).attr("y",140).attr("height",0),c.o("#timechart_svg").on("mouseover",(t=>{var a=c.k(t);C.attr("opacity",1);var n=E.invert(a[0]);"week"==e.timeline_frequency&&(n=s()(n).startOf("isoWeek")),"day"==e.timeline_frequency&&(n=s()(n).startOf("day")),"month"==e.timeline_frequency&&(n=s()(n).startOf("month")),a[1]<470?(S.attr("opacity",1).attr("display","inline"),C.attr("height","100%")):a[1]>510?(I.attr("opacity",1),C.attr("height","90%")):(I.attr("opacity",0),S.attr("opacity",0),C.attr("height","100%")),n.toDate().getTime()<M.getTime()&&(C.attr("opacity",0),S.attr("opacity",0)),c.o("#svg_container").style("z-index",10)})).on("mouseout",(t=>{C.attr("opacity",0),S.attr("opacity",0).attr("display","none"),c.o("#svg_container").style("z-index",1),I.attr("opacity",0).attr("transform","translate(0,0)"),c.p(".event_marker circle").style("stroke",_.black)})).on("mousemove",(t=>{var n=c.k(t),i=E.invert(n[0]),r="";"week"==e.timeline_frequency&&(r=(i=s()(i).startOf("isoWeek")).format("ll"),c.o("#timeline_tooltip_date tspan").text(r)),"day"==e.timeline_frequency&&(r=(i=s()(i).startOf("day")).format("ll"),c.o("#timeline_tooltip_date tspan").text(r)),"month"==e.timeline_frequency&&(r=(i=s()(i).startOf("month")).format("MMMM YYYY"),c.o("#timeline_tooltip_date tspan").text(r)),C.attr("x",E(i.toDate()));var o=a.filter((function(t,e){return s()(t.date).startOf("day").unix()==i.startOf("day").unix()})),l=P.filter((function(t,e){return s()(t.date).startOf("day").unix()==i.startOf("day").unix()})),u="-",d="-",m="-";if("cumulative"==e.timeline_type?(o[0]&&(d=p(o[0].total_cumulative_cases,2)),o[0]&&(u=p(o[0].total_cumulative_deaths,2)),l[0]&&(m=p(l[0].total_cumulative_vaccines,2))):(o[0]&&(d=p(o[0].total_new_cases,2)),o[0]&&(u=p(o[0].total_new_deaths,2)),l[0]&&(m=p(l[0].total_new_vaccines,2))),0==u&&(u="-"),0==d&&(d="-"),0==m&&(m="-"),c.o("#tooltip_cases tspan").text(d).attr("text-anchor","end").attr("dx",32),c.o("#tooltip_deaths tspan").text(u).attr("text-anchor","end").attr("dx",32),c.o("#tooltip_vaccines tspan").text(m).attr("text-anchor","end").attr("dx",32),i.toDate().getTime()<M.getTime()&&"day"==e.timeline_frequency&&(C.attr("opacity",0),S.attr("opacity",0)),"month"==e.timeline_frequency&&C.attr("width",(function(){return E(s()(i).endOf("month"))-E(s()(i).startOf("month"))})),S.attr("transform",(function(){var t=(e.brushR-e.brushL)/600,a=0;return t<.5&&(a=3),t<.3&&(a=12),t<.2&&(a=20),t<.15&&(a=21),"month"==e.timeline_frequency?(t<.6&&(a=20),t<.5&&(a=30),t<.3&&(a=50),t<.2&&(a=60),t<.1&&(a=70),"translate("+(D(i.toDate())+h/3+a)+","+(n[1]+353)+")"):"translate("+(D(i.toDate())+18+a)+","+(n[1]+353)+")"})),n[1]<470)S.attr("opacity",1),C.attr("opacity",1),C.attr("height","100%");else if(n[1]>510){I.attr("opacity",1),C.attr("height","90%");var f=s()(E.invert(n[0])).startOf("day");E.invert(n[0]);I.attr("transform",(function(){return"translate("+(D(f.toDate())+-3)+",817)"}));var y=H.filter((function(t,e){return s()(t.date).startOf("day").unix()==f.unix()}));if(0==y.length&&(y=H.filter((function(t,e){return s()(t.date).startOf("day").unix()<=s()(f).add(1,"days").unix()&&s()(t.date).startOf("day").unix()>=s()(f).subtract(1,"days").unix()}))),y.length>0){c.o("#event-"+s()(y[0].date).startOf("day").unix()).select("path").style("stroke","#000").attr("opacity",1),r=s()(y[0].date).startOf("day").format("ll"),c.o("#event_tooltip_date tspan").text(r);var v=Object(g.textwrap)().bounds({height:200,width:230}).method("tspans");t=c.o("#event_tooltip_text").text(y[0].description).attr("y",18).attr("x",6);c.o("#event_tooltip_text").call(v),c.p("#event_tooltip_text tspan").attr("dy","1.3em");var b=c.o("#event_tooltip_text").node().getBBox();c.o("#event_tooltip_rect").attr("width",b.width+17).attr("height",b.height+26);c.o("#event_tooltip_rect").attr("height");var x=0;b.height<20?x=19:b.height<30?x=9:b.height<40?x=0:(b.height<50||b.height<60)&&(x=-20);c.o("#event_tooltip_rect").attr("y");c.o("#event_tooltip_rect").attr("y",x),c.p("#event_tooltip_text").attr("y",(function(t,e){return parseInt(c.o(this).attr("y"))+x})),c.p("#event_tooltip_date tspan").attr("dy",(function(t,e){return x})),I.attr("opacity",1)}else c.p(".event_marker circle").style("stroke",_.black),I.attr("opacity",0)}else I.attr("opacity",0),S.attr("opacity",0),C.attr("opacity",0),C.attr("height","100%");if("day"==e.timeline_frequency&&i.toDate().getTime()<M.getTime())return C.attr("opacity",0),S.attr("opacity",0),!1}))}let L,W,U,Y,V,Z,$;const J={left:20,top:0,right:58};let X,G=[];function K(t,e,a){t.regions.forEach((function(t,e){t.population=0,t.cumulative_deaths=0,t.cumulative_cases=0,t.cumulative_vaccines=0})),t.country.forEach((function(e,a){t.regions.forEach((function(t,a){t.code==e.ifrc_region&&(e.population>0&&e.who_daily_latest&&(e.who_daily_latest.cumulative_cases>0&&(t.cumulative_cases+=e.who_daily_latest.cumulative_cases),e.who_daily_latest.cumulative_deaths>0&&(t.cumulative_deaths+=e.who_daily_latest.cumulative_deaths||0),t.population+=e.population),e.population>0&&e.vaccine_daily_latest&&(t.cumulative_vaccines+=e.vaccine_daily_latest.total_vaccinations||0))}))})),t.regions.forEach((function(t,e){t.cumulative_cases_per_100k=t.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.cumulative_deaths/(t.population/1e5),t.cumulative_vaccines_per_100k=t.cumulative_vaccines/(t.population/1e5),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0)})),"per100"==e.region_switch?(U=c.h(t.regions,(function(t,e){return t.cumulative_vaccines_per_100k})),L=c.h(t.regions,(function(t,e){return t.cumulative_cases_per_100k})),W=c.h(t.regions,(function(t,e){return t.cumulative_deaths_per_100k}))):(U=c.h(t.regions,(function(t,e){return t.cumulative_vaccines})),L=c.h(t.regions,(function(t,e){return t.cumulative_cases})),W=c.h(t.regions,(function(t,e){return t.cumulative_deaths})));const n=c.o("#layout #region_chart_container").attr("opacity",0);X={x:n.attr("x"),y:n.attr("y"),width:n.attr("width"),height:n.attr("height")};const i=c.o("#layout").append("g").attr("transform","translate("+X.x+", "+X.y+")").attr("id","region_chart");var r=X.height/(t.regions.length-1),o=i.selectAll(".bar-row").data(t.regions.filter((t=>"OTH"!==t.code))).enter().append("g").attr("class","bar-row").attr("transform",(function(t,e){return"translate(0,"+(e*r+J.top)+")"})),l=o.append("text").attr("y",r/2).attr("x",J.left-5).attr("class",(function(t,e){return"bar-labels bar-label-"+t.code})).style("alignment-baseline","middle").style("font-size","11px").attr("opacity",1).attr("fill","#000").text((function(t,e){return"AM"===t.code?"Americas":"EU"===t.code?"Europe":"AF"===t.code?"Africa":"ME"===t.code?"Middle East and North Africa":"AP"===t.code?"Asia-Pacific":void 0})).style("text-anchor","end");$=o.node().getBBox().width+J.left,l.attr("x",$+89),$+=94,c.p(".timeBar").attr("opacity",1);o.append("rect").attr("y",0).attr("x",0).attr("width",$).attr("height",r-2).style("opacity",0).attr("fill","grey").style("cursor","pointer").attr("class",(function(t,e){return"bar-bg-"+t.code})).attr("data-id",(function(t,e){return t.code})).on("mouseover",(function(t){c.o(this).style("opacity",.1)})).on("mouseout",(function(){c.o(this).style("opacity",0)})).on("click",(function(t,e){var n=c.o(this).attr("data-id");a([n],"regionchart")}));Y=c.l().range([0,X.width-J.right-$]).domain([0,L]),V=c.l().range([0,X.width-J.right-$]).domain([0,W]),Z=c.l().range([$,X.width-J.right-$]).domain([0,U]);o.append("rect").attr("id",(function(t,e){return"bar-"+t.code})).attr("data-id",(function(t,e){return t.code})).attr("class","region-bar").attr("width",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=Y(t.cumulative_cases_per_100k)),"deaths"==e.region_chart_toggle&&(n=V(t.cumulative_deaths_per_100k)),"vaccines"==e.region_chart_toggle&&(n=Z(t.cumulative_vaccines_per_100k))):("cases"==e.region_chart_toggle&&(n=Y(t.cumulative_cases)),"deaths"==e.region_chart_toggle&&(n=V(t.cumulative_deaths)),"vaccines"==e.region_chart_toggle&&(n=Z(t.cumulative_vaccines))),isNaN(n)?0:parseFloat(n)})).attr("x",$).style("outline","none").style("cursor","pointer").attr("y",.1*r-1).attr("height",r-.1*r*2).style("fill",(function(t){return _.regions[t.code]})).attr("opacity",1).on("click",(function(t,e){var n=c.o(this).attr("data-id");a([n],"regionchart")})).on("mouseover",(function(t){c.o(this.parentNode).datum()})).on("mouseout",(function(){})),o.append("text").text((function(t){var a=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(a=Math.round(t.cumulative_cases_per_100k)),"deaths"==e.region_chart_toggle&&(a=Math.round(t.cumulative_deaths_per_100k)),"vaccines"==e.region_chart_toggle&&(a=Math.round(t.cumulative_vaccines_per_100k))):("cases"==e.region_chart_toggle&&(a=Math.round(t.cumulative_cases)),"deaths"==e.region_chart_toggle&&(a=Math.round(t.cumulative_deaths)),"vaccines"==e.region_chart_toggle&&(a=Math.round(t.cumulative_vaccines))),h(a)})).attr("id",(function(t,e){return"data-label"+t.code})).attr("data-id",(function(t,e){return t.code})).attr("class","data-label").attr("y",r/2).style("alignment-baseline","middle").style("text-anchor","start").attr("x",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=Y(t.cumulative_cases_per_100k)+$+5),"deaths"==e.region_chart_toggle&&(n=V(t.cumulative_deaths_per_100k)+$+5),"vaccines"==e.region_chart_toggle&&(n=Z(t.cumulative_vaccines_per_100k)+$+5)):("cases"==e.region_chart_toggle&&(n=Y(t.cumulative_cases)+$+5),"deaths"==e.region_chart_toggle&&(n=V(t.cumulative_deaths)+$+5),"vaccines"==e.region_chart_toggle&&(n=Z(t.cumulative_vaccines)+$+5)),n})).attr("opacity",(function(t,a){var n=0;return"per100"==e.region_switch?("cases"==e.region_chart_toggle&&(n=t.cumulative_cases_per_100k),"deaths"==e.region_chart_toggle&&(n=t.cumulative_deaths_per_100k),"vaccines"==e.region_chart_toggle&&(n=t.cumulative_vaccines_per_100k)):("cases"==e.region_chart_toggle&&(n=t.cumulative_cases),"deaths"==e.region_chart_toggle&&(n=t.cumulative_deaths),"vaccines"==e.region_chart_toggle&&(n=t.cumulative_vaccines)),n>0?1:0})).style("fill","#696969").style("font-weight","normal").style("font-size","10px")}function Q(t,e){e.regions.forEach((function(t,e){t.population=0,t.cumulative_deaths=0,t.cumulative_cases=0,t.cumulative_vaccines=0})),e.country.forEach((function(t,a){e.regions.forEach((function(e,a){e.code==t.ifrc_region&&(t.population>0&&t.who_daily_latest&&(t.who_daily_latest.cumulative_cases>0&&(e.cumulative_cases+=t.who_daily_latest.cumulative_cases),t.who_daily_latest.cumulative_deaths>0&&(e.cumulative_deaths+=t.who_daily_latest.cumulative_deaths||0),e.population+=t.population),t.population>0&&t.vaccine_daily_latest&&(e.cumulative_vaccines+=t.vaccine_daily_latest.total_vaccinations||0))}))})),e.regions.forEach((function(t,e){t.cumulative_cases_per_100k=t.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.cumulative_deaths/(t.population/1e5),t.cumulative_vaccines_per_100k=t.cumulative_vaccines/(t.population/1e5),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0)})),"per100"==t.region_switch?(U=c.h(e.regions,(function(t,e){return t.cumulative_vaccines_per_100k})),L=c.h(e.regions,(function(t,e){return t.cumulative_cases_per_100k})),W=c.h(e.regions,(function(t,e){return t.cumulative_deaths_per_100k}))):(U=c.h(e.regions,(function(t,e){return t.cumulative_vaccines})),L=c.h(e.regions,(function(t,e){return t.cumulative_cases})),W=c.h(e.regions,(function(t,e){return t.cumulative_deaths}))),Y=c.l().range([0,X.width-J.right-$]).domain([0,L]),V=c.l().range([0,X.width-J.right-$]).domain([0,W]),Z=c.l().range([0,X.width-J.right-$]).domain([0,U]),0==U&&0==L&&0==W?(c.p(".region-bar").transition().duration(500).attr("width",0),c.p(".data-label").transition().duration(500).attr("x",$).attr("opacity",0)):(c.p(".region-bar").transition().duration(500).style("fill",(function(t){return _.regions[t.code]})).attr("width",(function(e,a){var n=c.o(this).attr("data-id");G.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=Y(e.cumulative_cases_per_100k)),"deaths"==t.region_chart_toggle&&(i=V(e.cumulative_deaths_per_100k)),"vaccines"==t.region_chart_toggle&&(i=Z(e.cumulative_vaccines_per_100k))):("cases"==t.region_chart_toggle&&(i=Y(e.cumulative_cases)),"deaths"==t.region_chart_toggle&&(i=V(e.cumulative_deaths)),"vaccines"==t.region_chart_toggle&&(i=Z(e.cumulative_vaccines))),isNaN(i)?0:parseFloat(i)})),c.p(".data-label").transition().duration(500).tween("text",(function(e,a){var n=0,i=c.o(this).attr("data-id");G.forEach((function(t,a){t.code==i&&(e=t)})),"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(n=Math.round(e.cumulative_cases_per_100k)),"deaths"==t.region_chart_toggle&&(n=Math.round(e.cumulative_deaths_per_100k)),"vaccines"==t.region_chart_toggle&&(n=Math.round(e.cumulative_vaccines_per_100k))):("cases"==t.region_chart_toggle&&(n=Math.round(e.cumulative_cases)),"deaths"==t.region_chart_toggle&&(n=Math.round(e.cumulative_deaths)),"vaccines"==t.region_chart_toggle&&(n=Math.round(e.cumulative_vaccines)));a=c.g(Math.floor(2346*Math.random()+9345),n);return function(t){c.o(this).text(h(Math.round(a(t))))}})).attr("x",(function(e,a){var n=c.o(this).attr("data-id");G.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=Y(e.cumulative_cases_per_100k)+$+5),"deaths"==t.region_chart_toggle&&(i=V(e.cumulative_deaths_per_100k)+$+5),"vaccines"==t.region_chart_toggle&&(i=Z(e.cumulative_vaccines_per_100k)+$+5)):("cases"==t.region_chart_toggle&&(i=Y(e.cumulative_cases)+$+5),"deaths"==t.region_chart_toggle&&(i=V(e.cumulative_deaths)+$+5),"vaccines"==t.region_chart_toggle&&(i=Z(e.cumulative_vaccines)+$+5)),i})).attr("opacity",(function(e,a){var n=c.o(this).attr("data-id");G.forEach((function(t,a){t.code==n&&(e=t)}));var i=0;return"per100"==t.region_switch?("cases"==t.region_chart_toggle&&(i=e.cumulative_cases_per_100k),"deaths"==t.region_chart_toggle&&(i=e.cumulative_deaths_per_100k),"vaccines"==t.region_chart_toggle&&(i=e.cumulative_vaccines_per_100k)):("cases"==t.region_chart_toggle&&(i=e.cumulative_cases),"deaths"==t.region_chart_toggle&&(i=e.cumulative_deaths),"vaccines"==t.region_chart_toggle&&(i=e.cumulative_vaccines)),i>0?1:0})))}var tt=a(6),et=(a(119),a(120),a(34)),at=a(13),nt=a.n(at);const it="#595454",rt="#EAEAEA",ot="#000",ct="#FFF";var lt;var st=function(t,e,a,n,i,r){c.o("#vaccine_tooltip").attr("opacity",0).style("display","none"),c.o("#vaccine_info path").attr("fill",_.black),t.select("#vaccine_info").style("cursor","pointer").on("mouseover",(function(t,e){c.o("#svg_container").style("z-index",10),c.o("#vaccine_tooltip").style("display","inline").transition().duration(500).attr("opacity",1),c.o("#vaccine_info path").transition().duration(200).attr("fill",_.blue)})).on("mouseout",(function(t,e){c.o("#svg_container").style("z-index",1),c.o("#vaccine_tooltip").style("display","none").attr("opacity",0),c.o("#vaccine_info path").transition().duration(500).attr("fill",_.black)})),t.select("#region_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,a){e.region_filter=[],n("clear-region")})),t.select("#region_switch").style("cursor","pointer").on("click",(function(t,n){"total"==e.region_switch?(e.region_switch="per100",c.o("#region_switch_toggle").transition().duration(200).attr("x",15.1)):(e.region_switch="total",c.o("#region_switch_toggle").transition().duration(200).attr("x",3.1)),Q(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-cases").style("cursor","pointer").on("click",(function(n){if("cases"===e.region_chart_toggle)return!1;e.region_chart_toggle="cases",t.selectAll("#region-chart-toggle rect").attr("fill",rt),t.selectAll("#region-chart-toggle text").attr("fill",ot),t.select("#region-chart-toggle-cases rect").attr("fill",it),t.select("#region-chart-toggle-cases text").attr("fill",ct),Q(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-deaths").style("cursor","pointer").on("click",(function(n){if("deaths"===e.region_chart_toggle)return!1;e.region_chart_toggle="deaths",t.selectAll("#region-chart-toggle rect").attr("fill",rt),t.selectAll("#region-chart-toggle text").attr("fill",ot),t.select("#region-chart-toggle-deaths rect").attr("fill",it),t.select("#region-chart-toggle-deaths text").attr("fill",ct),Q(e,a)})),t.select("#region-chart-toggle #region-chart-toggle-vaccines").style("cursor","pointer").on("click",(function(n){if("vaccines"===e.region_chart_toggle)return!1;e.region_chart_toggle="vaccines",t.selectAll("#region-chart-toggle rect").attr("fill",rt),t.selectAll("#region-chart-toggle text").attr("fill",ot),t.select("#region-chart-toggle-vaccines rect").attr("fill",it),t.select("#region-chart-toggle-vaccines text").attr("fill",ct),Q(e,a)})),t.select("#map-toggle #map-toggle-bi-weekly-change").style("cursor","pointer").on("click",(function(n){if("bi-weekly-change"===e.map_toggle)return!1;e.map_toggle="bi-weekly-change",t.selectAll("#map-toggle rect").attr("fill",rt),t.selectAll("#map-toggle text").attr("fill",ot),t.select("#map-toggle-bi-weekly-change rect").attr("fill",it),t.select("#map-toggle-bi-weekly-change text").attr("fill",ct),r(a,e,700)})),t.select("#map-toggle #map-toggle-cases").style("cursor","pointer").on("click",(function(n){if("cases"===e.map_toggle)return!1;e.map_toggle="cases",t.selectAll("#map-toggle rect").attr("fill",rt),t.selectAll("#map-toggle text").attr("fill",ot),t.select("#map-toggle-cases rect").attr("fill",it),t.select("#map-toggle-cases text").attr("fill",ct),r(a,e,700)})),t.select("#map-toggle #map-toggle-deaths").style("cursor","pointer").on("click",(function(n){if("deaths"===e.map_toggle)return!1;e.map_toggle="deaths",t.selectAll("#map-toggle rect").attr("fill",rt),t.selectAll("#map-toggle text").attr("fill",ot),t.select("#map-toggle-deaths rect").attr("fill",it),t.select("#map-toggle-deaths text").attr("fill",ct),r(a,e,700)})),t.select("#map-toggle #map-toggle-percent-fully-vaccinated").style("cursor","pointer").on("click",(function(n){if("percent-fully-vaccinated"===e.map_toggle)return!1;e.map_toggle="percent-fully-vaccinated",t.selectAll("#map-toggle rect").attr("fill",rt),t.selectAll("#map-toggle text").attr("fill",ot),t.select("#map-toggle-percent-fully-vaccinated rect").attr("fill",it),t.select("#map-toggle-percent-fully-vaccinated text").attr("fill",ct),r(a,e,700)})),t.select("#map-toggle #map-toggle-percent-vaccine-acceptance").style("cursor","pointer").on("click",(function(n){if("percent-vaccine-acceptance"===e.map_toggle)return!1;e.map_toggle="percent-vaccine-acceptance",t.selectAll("#map-toggle rect").attr("fill",rt),t.selectAll("#map-toggle text").attr("fill",ot),t.select("#map-toggle-percent-vaccine-acceptance rect").attr("fill",it),t.select("#map-toggle-percent-vaccine-acceptance text").attr("fill",ct),r(a,e,700)})),t.select("#timechart-type-toggle #timechart-type-toggle-cumulative").style("cursor","pointer").on("click",(function(n){if("cumulative"===e.timeline_type)return!1;e.timeline_type="cumulative",t.selectAll("#timechart-type-toggle rect").attr("fill",rt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ot),t.select("#timechart-type-toggle-cumulative rect").attr("fill",it),t.select("#timechart-type-toggle-cumulative polyline").attr("stroke",ct),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",it),R(a,e)})),Object(tt.a)("#timechart-type-toggle-cumulative",{content:"Cumulative",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-type-toggle #timechart-type-toggle-non-cumulative").style("cursor","pointer").on("click",(function(n){if("non-cumulative"===e.timeline_type)return!1;e.timeline_type="non-cumulative",t.selectAll("#timechart-type-toggle rect").attr("fill",rt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ot),t.select("#timechart-type-toggle-non-cumulative rect").attr("fill",it),t.select("#timechart-type-toggle-non-cumulative polyline").attr("stroke",ct),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",it),R(a,e)})),Object(tt.a)("#timechart-type-toggle-non-cumulative",{content:"Non-cumulative",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-type-toggle #timechart-type-toggle-stacked").style("cursor","pointer").on("click",(function(n){if("stacked"===e.timeline_type)return!1;e.timeline_type="stacked",t.selectAll("#timechart-type-toggle rect").attr("fill",rt),t.selectAll("#timechart-type-toggle polyline").attr("stroke",ot),t.select("#timechart-type-toggle-stacked rect").attr("fill",it),t.select("#timechart-type-toggle-stacked polyline").attr("stroke",ct),t.selectAll("#timechart-type-toggle-stacked polygon").attr("fill",ct),R(a,e)})),Object(tt.a)("#timechart-type-toggle-stacked",{content:"Stacked 100%",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-day").style("cursor","pointer").on("click",(function(n){if("day"===e.timeline_frequency)return!1;e.timeline_frequency="day",t.selectAll("#timechart-frequency-toggle rect").attr("fill",rt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ot),t.select("#timechart-frequency-toggle-day rect").attr("fill",it),t.select("#timechart-frequency-toggle-day text").attr("fill",ct),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("DAY"),z(a,e)})),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-week").style("cursor","pointer").on("click",(function(n){if("week"===e.timeline_frequency)return!1;e.timeline_frequency="week",t.selectAll("#timechart-frequency-toggle rect").attr("fill",rt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ot),t.select("#timechart-frequency-toggle-week rect").attr("fill",it),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("WEEK"),t.select("#timechart-frequency-toggle-week text").attr("fill",ct),z(a,e)})),t.select("#timechart-frequency-toggle #timechart-frequency-toggle-month").style("cursor","pointer").on("click",(function(n){if("month"===e.timeline_frequency)return!1;e.timeline_frequency="month",t.selectAll("#timechart-frequency-toggle rect").attr("fill",rt),t.selectAll("#timechart-frequency-toggle text").attr("fill",ot),t.select("#timechart-frequency-toggle-month rect").attr("fill",it),t.select("#tooltip_frequency tspan").attr("text-anchor","end").attr("dx",20).text("MONTH"),t.select("#timechart-frequency-toggle-month text").attr("fill",ct),z(a,e)})),t.select("#hdi_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,e){c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1),n("clear-hdi")})),t.select("#hdi-toggle #hdi-toggle-very-high").style("cursor","pointer").on("click",(function(t){ut(e.hdi_filter,"very-high"),4===e.hdi_filter.length?(e.hdi_filter=[],c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){c.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-high").style("cursor","pointer").on("click",(function(t){ut(e.hdi_filter,"high"),4===e.hdi_filter.length?(e.hdi_filter=[],c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){c.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-medium").style("cursor","pointer").on("click",(function(t){ut(e.hdi_filter,"medium"),4===e.hdi_filter.length?(e.hdi_filter=[],c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){c.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#hdi-toggle #hdi-toggle-low").style("cursor","pointer").on("click",(function(t){ut(e.hdi_filter,"low"),4===e.hdi_filter.length?(e.hdi_filter=[],c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1)):0===e.hdi_filter.length?c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",1):e.hdi_filter.length>0&&c.p("#hdi-toggle-very-high, #hdi-toggle-high, #hdi-toggle-medium, #hdi-toggle-low").attr("opacity",.3),e.hdi_filter.length>0&&e.hdi_filter.forEach((function(t,e){c.o("#hdi-toggle-"+t).attr("opacity",1)})),n("hdi")})),t.select("#inform_remove_filter").attr("opacity",0).style("cursor","pointer").on("click",(function(t,e){c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1),n("clear-inform")})),t.select("#inform-toggle #inform-toggle-no-score").style("cursor","pointer").on("click",(function(t){ut(e.inform_filter,"no-score"),5===e.inform_filter.length?(e.inform_filter=[],c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){c.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-low").style("cursor","pointer").on("click",(function(t){ut(e.inform_filter,"low"),5===e.inform_filter.length?(e.inform_filter=[],c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){c.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-medium").style("cursor","pointer").on("click",(function(t){ut(e.inform_filter,"medium"),5===e.inform_filter.length?(e.inform_filter=[],c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){c.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-high").style("cursor","pointer").on("click",(function(t){ut(e.inform_filter,"high"),5===e.inform_filter.length?(e.inform_filter=[],c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){c.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),t.select("#inform-toggle #inform-toggle-very-high").style("cursor","pointer").on("click",(function(t){ut(e.inform_filter,"very-high"),5===e.inform_filter.length?(e.inform_filter=[],c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1)):0===e.inform_filter.length?c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",1):e.inform_filter.length>0&&c.p("#inform-toggle-very-high, #inform-toggle-high, #inform-toggle-medium, #inform-toggle-low, #inform-toggle-no-score").attr("opacity",.3),e.inform_filter.length>0&&e.inform_filter.forEach((function(t,e){c.o("#inform-toggle-"+t).attr("opacity",1)})),n("inform")})),c.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),c.o("#vac-tab").attr("opacity",1).select("#vac-tab-content").attr("display","inline"),c.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),c.o("#bubbleSelectContainer").style("display","none"),t.select("#tabs #vaccination-tab").style("cursor","pointer").on("click",(function(a){if("vaccination-data"===e.tab_toggle)return!1;e.tab_toggle="vaccination-data",c.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),c.o("#vac-tab").attr("opacity",1).select("#vac-tab-content").attr("display","inline"),c.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),t.selectAll("#tabs rect").attr("fill",rt),t.selectAll("#tabs text").attr("fill",ot),t.select("#vaccination-tab rect").attr("fill",it),t.select("#vaccination-tab text").attr("fill",ct),c.o("#bubbleSelectContainer").style("display","none")})),t.select("#tabs #indicators-tab").style("cursor","pointer").on("click",(function(a){if("indicators"===e.tab_toggle)return!1;e.tab_toggle="indicators",c.o("#additional-indicators-tab").attr("opacity",1).select("#additional-indicators-tab-content").attr("display","inline"),c.o("#vac-tab").attr("opacity",0).select("#vac-tab-content").attr("display","none"),c.o("#bubblechart-tab").attr("opacity",0).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","none"),t.selectAll("#tabs rect").attr("fill",rt),t.selectAll("#tabs text").attr("fill",ot),t.select("#indicators-tab rect").attr("fill",it),t.select("#indicators-tab text").attr("fill",ct),c.o("#bubbleSelectContainer").style("display","none")})),t.select("#tabs #bubble-chart-tab").style("cursor","pointer").on("click",(function(a){if("bubble-chartt"===e.tab_toggle)return!1;e.tab_toggle="bubble-chart",c.o("#additional-indicators-tab").attr("opacity",0).select("#additional-indicators-tab-content").attr("display","none"),c.o("#vac-tab").attr("opacity",0).select("#vac-tab-content").attr("display","none"),c.o("#bubblechart-tab").attr("opacity",1).selectAll("#bubblechart, #bubblechart-tab-content").attr("display","inline"),t.selectAll("#tabs rect").attr("fill",rt),t.selectAll("#tabs text").attr("fill",ot),t.select("#bubble-chart-tab rect").attr("fill",it),t.select("#bubble-chart-tab text").attr("fill",ct),c.o("#bubbleSelectContainer").style("display","inline-block")})),c.o("#svg defs").append("clipPath").attr("id","mask").append("rect").attr("y",340).attr("height",590).attr("width",660).attr("x",22);const o=t.select("#timechart_container").attr("opacity",0),l={x:o.attr("x"),y:o.attr("y"),width:o.attr("width"),height:o.attr("height")},s=t.append("svg").attr("id","timechart_svg").attr("viewBox","0 0 2000 "+l.height).attr("preserveAspectRatio","none").attr("x",l.x).attr("y",l.y).attr("width",l.width).attr("height",l.height),u=s.append("g").attr("id","layer1");s.append("g").attr("id","layer0"),u.append("rect").attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").attr("opacity",0).style("fill","transparent");var d=18,h=68;for(let m=0;m<10;m++){var p=c.o("#vac-tab").append("g").attr("class","row").attr("id","row"+m);p.on("mouseover",(function(t,e){c.p(".rowbg").attr("fill","#fff"),c.o(this).selectAll("text").nodes().length>0&&c.o(this).select(".rowbg").attr("fill","#FAFAFA")})).on("mouseout",(function(t,e){c.p(".rowbg").attr("fill","#fff")})),p.append("rect").attr("class","rowbg").attr("x",0).attr("y",(function(){return 66+24.8*m})).attr("height",22).attr("width",622).attr("fill",_.white),p.append("rect").attr("class","col1bg colbg").attr("id","col1bg"+m).attr("x",120).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",68).attr("fill",_.lightgrey),p.append("rect").attr("class","col1bar").attr("id","col1bar"+m).attr("x",120).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",0).attr("fill",_.blue),p.append("rect").attr("class","col2bg colbg").attr("id","col2bg"+m).attr("x",230).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",68).attr("fill",_.lightgrey),p.append("rect").attr("class","col2bar").attr("id","col2bar"+m).attr("x",230).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",0).attr("fill",_.blue),p.append("rect").attr("class","col3bg colbg").attr("id","col3bg"+m).attr("x",340).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",68).attr("fill",_.lightgrey),p.append("rect").attr("class","col3bar").attr("id","col3bar"+m).attr("x",340).attr("y",(function(){return h+24.8*m})).attr("height",d).attr("width",0).attr("fill",_.blue),p.append("rect").attr("class","col4bg colbg").attr("id","col4bg"+m).attr("x",454).attr("y",(function(){return 67+24.8*m})).attr("height",d).attr("width",68).attr("fill",_.lightgrey),p.append("rect").attr("class","col4bar").attr("id","col4bar"+m).attr("x",454).attr("y",(function(){return 67+24.8*m})).attr("height",d).attr("width",0).attr("fill",_.blue);for(var g=0;g<6;g++)c.o("#col"+g+"_sort_desc").attr("opacity",0),c.o("#col"+g+"_sort_asc").attr("opacity",0),c.o("#col"+g+"_sort").style("cursor","pointer").on("click",(function(){var t=c.o(this).attr("id");e.table_sort==t?"desc"==e.table_sort_direction?e.table_sort_direction="asc":e.table_sort_direction="desc":(e.table_sort=t,e.table_sort_direction="desc"),e.page=1,i(a,e)}))}c.o("#reset_locations").attr("display","none"),Object(tt.a)("#button-png",{content:"Save as PNG",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),Object(tt.a)("#button-copy",{content:"Copy to clipboard",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),Object(tt.a)("#button-print",{content:"Print to PDF",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),Object(tt.a)("#button-expand",{content:"Open in new window",duration:0,placement:"bottom",theme:"light",arrow:!0,delay:[500,200]}),c.o("#button-print").on("click",(function(){if(lt)return!1;lt=!0,setTimeout((function(){nt()(document.querySelector("#root"),{allowTaint:!0,onclone:function(t){},useCORS:!1,foreignObjectRendering:!0,ignoreElements:function(t){return!1},scale:2,x:0,y:0,scrollX:0,scrollY:0,logging:!1}).then((t=>{var e=t.toDataURL("image/png"),a=new et.a("l","mm","a4"),n=a.getImageProperties(e),i=a.internal.pageSize.getWidth(),r=n.height*i/n.width;a.addImage(e,"JPEG",10,10,i-20,r-30),a.save("deep-pdf-export.pdf"),lt=!1}),200)}))})),c.o("#button-png").on("click",(function(){if(lt)return!1;lt=!0,setTimeout((function(){nt()(document.querySelector("#root"),{allowTaint:!0,onclone:function(t){},useCORS:!1,foreignObjectRendering:!0,ignoreElements:function(t){return!1},scale:2,x:0,y:0,scrollX:0,scrollY:0,logging:!1}).then((t=>{var e=t.toDataURL("image/png").replace("image/png","image/octet-stream"),a=document.createElement("a");a.download="dashboard-export.png",a.href=e,a.click(),a.remove(),lt=!1}),200)}))})),c.o("#button-expand").on("click",(function(){window.open(window.location.href,"_blank")}))};function ut(t,e){var a=t.indexOf(e);-1!==a?t.splice(a,1):t.push(e)}let dt,_t,ht,pt,gt=1e3,mt=100,ft=1e6,yt=600,vt=233,bt=35,xt=58;function wt(t,e,a){gt=c.h(t.country,(function(t,e){return parseFloat(t.gni_2017)})),mt=c.h(t.country,(function(t,a){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis||"percent-fully-vaccinated"==e.bubble_chart_y_axis||"percent-vaccine-acceptance"==e.bubble_chart_y_axis?100:void 0})),ft=c.h(t.country,(function(t,e){return parseFloat(t.population)})),dt=c.l().range([0,yt]).domain([0,gt]).nice(),_t=c.l().range([vt,0]).domain([0,mt]),ht=c.m().domain([0,ft]).range([1,20]);const n=c.o("#bubblechart-tab").append("g").attr("transform","translate("+bt+", "+xt+")").attr("id","bubblechart");n.append("g").attr("id","bubbley").call(c.b(_t).ticks(3).tickSize(3)),n.append("g").attr("id","bubblex").attr("class","xAxis").attr("transform","translate(0,"+vt+")").call(c.a(dt).ticks(4).tickSize(3)),pt=c.o("#bubblechart").selectAll(".bubble").data(t.country).join((function(t){t.append("circle").attr("class",(function(t){return"bubble"})).attr("cx",(function(t){return dt(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?_t(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?_t(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?_t(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return ht(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&_.regions[t.ifrc_region]?_.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&_.hdi_category[t.hdi_category]?_.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&_.inform_severity[t.inform_severity]?_.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).style("stroke-width",1).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.transition().duration(800).attr("cx",(function(t){return dt(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?_t(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?_t(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?_t(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return ht(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&_.regions[t.ifrc_region]?_.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&_.hdi_category[t.hdi_category]?_.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&_.inform_severity[t.inform_severity]?_.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.remove()})),c.o("#bubblechart").selectAll(".bubble").on("mousemove",(function(t,a){c.o("#bubbleSelectContainer").style("z-index",1),c.o("#bubblechart_tooltip_title tspan").text(a.country_name),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% vaccinated at least 1 dose"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% fully vaccinated"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_fully_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% vaccine acceptance"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.vaccine_acceptance_percent).toFixed(2)+"%").attr("text-anchor","end").attr("dx",37)),c.o("#bubblechart_tooltip_gni tspan").text("$"+h(Math.round(parseFloat(a.gni_2017)))).attr("text-anchor","end").attr("dx",37),c.o("#bubblechart_tooltip_population tspan").text(p(Math.round(parseInt(a.population)))).attr("text-anchor","end").attr("dx",37);var n=c.k(t,c.o("#svg").node());n[0]<1110?(c.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]+20)+","+(n[1]+xt-90)+")").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_left").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_right").attr("display","none")):(c.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]-220)+","+(n[1]+xt-90)+")").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_left").attr("display","none"),c.o("#bubblechart_tooltip_arrow_right").attr("display","inline")),c.p(".bubble").attr("opacity",.4),c.o(this).attr("opacity",1).style("stroke-width",2)})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;c.o("#bubbleSelectContainer").style("z-index",2),c.o("#bubblechart_tooltip").attr("display","none"),c.p(".bubble").attr("opacity",1).style("stroke-width",1)})),c.o("#bubblechart_tooltip").attr("display","none"),c.o("#bubble_y_axis_label").attr("text-anchor","middle").select("tspan").attr("dx",50),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% vaccinated at least 1 dose"),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% fully vaccinated"),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% vaccine acceptance")}function kt(t,e,a){gt=c.h(t.country,(function(t,e){return parseFloat(t.gni_2017)})),mt=c.h(t.country,(function(t,a){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?parseFloat(t.people_vaccinated_per_hundred):"percent-fully-vaccinated"==e.bubble_chart_y_axis?parseFloat(t.people_fully_vaccinated_per_hundred):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?parseFloat(t.vaccine_acceptance_percent):void 0})),ft=c.h(t.country,(function(t,e){return parseFloat(t.population)})),dt=c.l().range([0,yt]).domain([0,gt]),_t=c.l().range([vt,0]).domain([0,mt]),ht=c.m().domain([0,ft]).range([1,20]);const n=c.o("#bubblechart");n.select("#bubbley").transition().duration(800).call(c.b(_t).ticks(3)),n.select("#bubblex").transition().duration(800).call(c.a(dt).ticks(3)),pt=c.o("#bubblechart").selectAll(".bubble").data(t.country).join((function(t){t.append("circle").attr("cx",(function(t){return dt(gt)})).attr("cy",(function(t){return _t(mt)})).attr("class",(function(t){return"bubble"})).transition().duration(800).attr("cx",(function(t){return dt(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?_t(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?_t(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?_t(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return ht(parseFloat(t.population))})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&_.regions[t.ifrc_region]?_.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&_.hdi_category[t.hdi_category]?_.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&_.inform_severity[t.inform_severity]?_.inform_severity[t.inform_severity]:"transparent"})).style("stroke",(function(t){return"#FFF"})).style("stroke-width",1).attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1}))}),(function(t){t.attr("display",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)||0==_t.invert(n)?"none":"inline"})).attr("opacity",(function(t,a){var n=0;return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_vaccinated_per_hundred))),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.people_fully_vaccinated_per_hundred))),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(n=_t(parseFloat(t.vaccine_acceptance_percent))),isNaN(n)?0:1})).style("fill",(function(t){return"region"==e.bubble_chart_color_by&&_.regions[t.ifrc_region]?_.regions[t.ifrc_region]:"hdi"==e.bubble_chart_color_by&&_.hdi_category[t.hdi_category]?_.hdi_category[t.hdi_category]:"inform-severity"==e.bubble_chart_color_by&&_.inform_severity[t.inform_severity]?_.inform_severity[t.inform_severity]:"transparent"})).transition().duration(800).attr("cx",(function(t){return dt(parseFloat(t.gni_2017))})).attr("cy",(function(t){return"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis?_t(parseFloat(t.people_vaccinated_per_hundred)):"percent-fully-vaccinated"==e.bubble_chart_y_axis?_t(parseFloat(t.people_fully_vaccinated_per_hundred)):"percent-vaccine-acceptance"==e.bubble_chart_y_axis?_t(parseFloat(t.vaccine_acceptance_percent)):void 0})).attr("r",(function(t){return ht(parseFloat(t.population))}))}),(function(t){t.remove()})),c.o("#bubblechart").selectAll(".bubble").on("mousemove",(function(t,a){c.o("#bubbleSelectContainer").style("z-index",1),c.o("#bubblechart_tooltip_title tspan").text(a.country_name),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% vaccinated at least 1 dose"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% fully vaccinated"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.people_fully_vaccinated_per_hundred)+"%").attr("text-anchor","end").attr("dx",37)),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&(c.o("#bubblechart_tooltip_label tspan").text("% vaccine acceptance"),c.o("#bubblechart_tooltip_value tspan").text(parseFloat(a.vaccine_acceptance_percent).toFixed(2)+"%").attr("text-anchor","end").attr("dx",37)),c.o("#bubblechart_tooltip_gni tspan").text("$"+h(Math.round(parseFloat(a.gni_2017)))).attr("text-anchor","end").attr("dx",37),c.o("#bubblechart_tooltip_population tspan").text(p(Math.round(parseInt(a.population)))).attr("text-anchor","end").attr("dx",37);var n=c.k(t,c.o("#svg").node());n[0]<1110?(c.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]+20)+","+(n[1]+xt-90)+")").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_left").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_right").attr("display","none")):(c.o("#bubblechart_tooltip").attr("transform","translate("+(n[0]-220)+","+(n[1]+xt-90)+")").attr("display","inline"),c.o("#bubblechart_tooltip_arrow_left").attr("display","none"),c.o("#bubblechart_tooltip_arrow_right").attr("display","inline")),c.p(".bubble").attr("opacity",.4),c.o(this).attr("opacity",1).style("stroke-width",2)})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;c.o("#bubbleSelectContainer").style("z-index",2),c.o("#bubblechart_tooltip").attr("display","none"),c.p(".bubble").attr("opacity",1).style("stroke-width",1)})),"percent-vaccinated-at-least-1-dose"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% vaccinated at least 1 dose"),"percent-fully-vaccinated"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% fully vaccinated"),"percent-vaccine-acceptance"==e.bubble_chart_y_axis&&c.o("#bubble_y_axis_label tspan").text("% vaccine acceptance")}var Ft={region_chart_toggle:"cases",region_switch:"total",region_filter:[],country_filter:[],hdi_filter:[],inform_filter:[],timeline_type:"non-cumulative",timeline_frequency:"week",map_toggle:"cases",tab_toggle:"vaccination-data",table_sort:"col1_sort",table_sort_direction:"desc",bubble_chart_color_by:"hdi",bubble_chart_y_axis:"percent-vaccinated-at-least-1-dose",brushL:0,brushR:600,page:1,numPages:1},Ot=a(4),At=a.n(Ot);var Et=function(t,e){t.regions=[{sort:5,code:"AF",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:3,code:"ME",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:4,code:"AP",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:2,code:"EU",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:1,code:"AM",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0},{sort:6,code:"OTH",cumulative_cases:0,cumulative_deaths:0,cumulative_vaccines:0,population:0}],t.regions.sort((function(t,e){return t.sort-e.sort})),t.ns_involvement=[],t.country=t.equity_data,t.country.forEach((function(e,a){"AF"!=e.ifrc_region&&"ME"!=e.ifrc_region&&"AP"!=e.ifrc_region&&"EU"!=e.ifrc_region&&"AM"!=e.ifrc_region&&(e.ifrc_region="OTH"),e.population=parseInt(e.population)||0;var n=0;e.population>0&&(n=e.population),t.regions.forEach((function(t,a){t.code==e.ifrc_region&&(t.population+=n)})),e.vaccines_used=[],e.avg_tests_per_1000=parseFloat(e.avg_tests_per_1000)||0,e.number_vaccine_types_used=0,e.vaccines_per_100=0,e.number_vaccine_types_used=parseInt(e.avg_tests_per_1000),t.vaccines_who_data.forEach((function(t,a){e.country_iso3==t.ISO3&&(e.number_vaccine_types_used=parseInt(t.NUMBER_VACCINES_TYPES_USED),e.vaccines_per_100=parseFloat(t.TOTAL_VACCINATIONS_PER100),isNaN(e.vaccines_per_100)&&(e.vaccines_per_100=0),e.vaccines_used=t.VACCINES_USED.split(",").map((function(t){return t.trim()})))})),e.ns_involvement=0,t.self_assessment.forEach((function(a,n){e.country_iso3==a.ISO3&&""!=e.country_iso3&&"Yes"==a["Final involvement"]&&(e.ns_involvement=1,t.ns_involvement.push(e.country_iso3))})),e.vaccine_acceptance_percent=0,t.vaccine_acceptance.forEach((function(t,a){e.country_iso3==t.iso3&&(e.vaccine_acceptance_percent=100*parseFloat(t.indicator_value),e.vaccine_acceptance_population=parseInt(t.population_size))})),"all"==e.contract_tracing.toLowerCase()||"some"==e.contract_tracing.toLowerCase()?e.contract_tracing=1:e.contract_tracing=0,e.hdi_category.match(/very high/i)?e.hdi_category="very-high":e.hdi_category.match(/high/i)?e.hdi_category="high":e.hdi_category.match(/medium/i)?e.hdi_category="medium":e.hdi_category.match(/low/i)&&(e.hdi_category="low"),e.inform_severity.match(/very high/i)?e.inform_severity="very-high":e.inform_severity.match(/high/i)?e.inform_severity="high":e.inform_severity.match(/medium/i)?e.inform_severity="medium":e.inform_severity.match(/low/i)?e.inform_severity="low":e.inform_severity.match(/no/i)&&(e.inform_severity="no-score")}));let a=s()(new Date(Object(c.h)(t.who_data,(function(t){return t.Date_reported})))).startOf("day");t.min_date=s()("2019-12-31").startOf("day").toDate();let n=s()(new Date(Object(c.h)(t.vaccines_data,(function(t){return t.date})))).startOf("day");t.min_vaccine_date=s()(new Date(Object(c.j)(t.vaccines_data,(function(t){return t.date})))).startOf("day").toDate(),t.max_vaccine_date=n.toDate(),n.unix()>a.unix()&&(a=n),t.max_date=a.toDate(),t.who_data.forEach((function(e,a){e.date=s()(e.Date_reported).startOf("day").toDate(),e.country_code=e.Country_code,e.country_name=null,t.country.forEach((function(t,a){t.country_iso2===e.country_code&&(e.ifrc_region=t.ifrc_region,e.country_name=t.country_name)})),e.cumulative_deaths=parseInt(e.Cumulative_deaths),e.cumulative_cases=parseInt(e.Cumulative_cases),e.new_cases=parseInt(e.New_cases),e.new_deaths=parseInt(e.New_deaths)})),t.who_data.sort((function(t,e){return new Date(t.date)-new Date(e.Date_reported)}));var i=Object(c.f)(t.who_data,(t=>t.country_code)),r=[];i.forEach((function(e,a){var n=s()(Object(c.h)(e[1],(t=>t.date))).startOf("day"),i=f()(e[1][e[1].length-1]);n.unix()!=t.max_date.getTime()&&(i.date=new Date(t.max_date),i.new_cases=0,i.new_deaths=0,r.push(i))})),t.who_data.push(...r),t.who_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)}));let o=-1,l=0,u=-1,d=-1,_=0,h=0,p=[];t.who_data.forEach((function(t,e){t.dayOfYear=s()(t.date).dayOfYear(),t.dayOfYear!==l&&o++,t.dayTotal=o,t.week=s()(t.date).isoWeek(),t.week!==d&&u++,t.weekTotal=u,t.month=t.date.getMonth(),t.month!==h&&_++,t.monthTotal=_,t.year=t.date.getFullYear(),t.week_start=new Date(s()(t.date).startOf("isoWeek").startOf("day").toDate()),t.month_start=new Date(s()(t.date).startOf("month").startOf("day").toDate()),t.new_deaths<0&&(t.new_deaths=0),t.new_cases<0&&(t.new_cases=0),void 0==t.ifrc_region&&(t.ifrc_region="OTH"),!p.includes(t.country_code)&&t.country_code.length>1&&p.push(t.country_code),delete t.Date_reported,delete t.Country,delete t.New_cases,delete t.New_deaths,delete t.Country_code,delete t.Cumulative_deaths,delete t.Cumulative_cases,delete t.Country_code,delete t.WHO_region,delete t.Country,l=t.dayOfYear,d=t.week,h=t.month})),t.vaccines_data.forEach((function(t,e){t.date=s()(t.date).startOf("day").toDate()})),t.vaccines_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)})),t.vaccines_data=t.vaccines_data.filter((function(t,e){return 3===t.iso_code.length&&t.total_vaccinations>0}));var g=Object(c.f)(t.vaccines_data,(t=>t.iso_code)),m=[],y=[],v=[];g.forEach((function(e,a){new Date(t.min_date),new Date(t.max_date);y=[],m=[],e.lastDate=s()(Object(c.h)(e[1],(function(t,e){return t.date}))).startOf("day").toDate(),t.country.forEach((function(t,a){t.country_iso3===e[0]&&(e.ifrc_region=t.ifrc_region,e.country_name=t.country_name,e.country_code=t.country_iso2,t.data_updated=e.lastDate)})),e[1].forEach((function(t,e){t.total_vaccinations=parseInt(t.total_vaccinations),t.daily_vaccinations=parseInt(t.daily_vaccinations),y.push(new Date(t.date).getTime())}));for(var n=new Date(t.min_vaccine_date);n<=t.max_date;n.setDate(n.getDate()+1)){var i=new Date(n).getTime();y.includes(i)||m.push({date:new Date(n),total_vaccinations:null,daily_vaccinations:0})}e[1].push(...m),e[1].sort((function(t,e){return new Date(t.date)-new Date(e.date)}));var r=0,o=0,l=0,u=0;e[1].forEach((function(t,a){var n;t.total_vaccinations?r=t.total_vaccinations:t.total_vaccinations=r,t.total_vaccinations_per_hundred?o=t.total_vaccinations_per_hundred:t.total_vaccinations_per_hundred=o,t.people_vaccinated_per_hundred?l=t.people_vaccinated_per_hundred:t.people_vaccinated_per_hundred=l,t.people_fully_vaccinated_per_hundred?u=t.people_fully_vaccinated_per_hundred:t.people_fully_vaccinated_per_hundred=u,n=null==e.country_name?e[0]:e.country_name;var i=0;t.daily_vaccinations&&t.daily_vaccinations>0&&(i=t.daily_vaccinations),v.push({date:new Date(t.date),lastDate:e.lastDate,total_vaccinations_per_hundred:parseFloat(o),people_vaccinated_per_hundred:parseFloat(l),people_fully_vaccinated_per_hundred:parseFloat(u),iso_code:e[0],ifrc_region:e.ifrc_region,country_name:n,country_code:e.country_code,total_vaccinations:r,daily_vaccinations:i})}))})),t.vaccines_data=v,t.vaccines_data.sort((function(t,e){return new Date(t.date)-new Date(e.date)})),o=-1,l=0,u=-1,d=-1,_=0,h=0,t.vaccines_data.forEach((function(t,e){void 0==t.ifrc_region&&(t.ifrc_region="OTH"),t.dayOfYear=s()(t.date).dayOfYear(),t.dayOfYear!==l&&o++,t.dayTotal=o,t.week=s()(t.date).isoWeek(),t.week!==d&&u++,t.weekTotal=u,t.month=t.date.getMonth(),t.month!==h&&_++,t.monthTotal=_,t.year=t.date.getFullYear(),l=t.dayOfYear,d=t.week,h=t.month,t.week_start=new Date(s()(t.date).startOf("isoWeek").toDate()),t.month_start=new Date(s()(t.date).startOf("month").toDate())})),g=Object(c.f)(t.vaccines_data,(t=>t.country_code));var b=Object(c.f)(t.who_data,(t=>t.country_code));t.country.forEach((function(t,e){t.cumulative_cases_per_100k=0,t.cumulative_deaths_per_100k=0,t.cumulative_vaccines_per_100k=0,t.people_fully_vaccinated_per_hundred=0,t.people_vaccinated_per_hundred=0,t.total_vaccinations_per_hundred=0;var a=t.country_iso2;b.forEach((function(e,n){if(e[0]==a){t.who_daily_latest=e[1][e[1].length-1],t.who_daily_7_days=e[1][e[1].length-8],t.who_daily_14_days=e[1][e[1].length-15],t.who_daily_21_days=e[1][e[1].length-22],t.who_daily_28_days=e[1][e[1].length-29],t.cumulative_cases_per_100k=t.who_daily_latest.cumulative_cases/(t.population/1e5),t.cumulative_deaths_per_100k=t.who_daily_latest.cumulative_deaths/(t.population/1e5),t.cumulative_cases=t.who_daily_latest.cumulative_cases,t.cumulative_deaths=t.who_daily_latest.cumulative_deaths,t.cumulative_deaths_7_days=t.who_daily_7_days.cumulative_deaths,t.cumulative_deaths_14_days=t.who_daily_14_days.cumulative_deaths,t.cumulative_deaths_21_days=t.who_daily_21_days.cumulative_deaths,t.cumulative_deaths_28_days=t.who_daily_28_days.cumulative_deaths,t.cumulative_cases_7_days=t.who_daily_7_days.cumulative_cases,t.cumulative_cases_14_days=t.who_daily_14_days.cumulative_cases,t.cumulative_cases_21_days=t.who_daily_21_days.cumulative_cases,t.cumulative_cases_28_days=t.who_daily_28_days.cumulative_cases;var i=parseFloat((t.cumulative_cases-t.cumulative_cases_14_days-(t.cumulative_cases_14_days-t.cumulative_cases_28_days))/(t.cumulative_cases_14_days-t.cumulative_cases_28_days));isFinite(i)?t.percent_change=i:t.percent_change=0}})),g.forEach((function(e,n){e[0]==a&&(e[0],t.vaccine_daily_latest=e[1][e[1].length-1],t.cumulative_vaccines_per_100k=t.vaccine_daily_latest.total_vaccinations/(t.population/1e5),t.people_fully_vaccinated_per_hundred=t.vaccine_daily_latest.people_fully_vaccinated_per_hundred,t.people_vaccinated_per_hundred=t.vaccine_daily_latest.people_vaccinated_per_hundred,t.total_vaccinations_per_hundred=t.vaccine_daily_latest.total_vaccinations_per_hundred,t.total_vaccinations=t.vaccine_daily_latest.total_vaccinations)})),isFinite(t.cumulative_cases_per_100k)||(t.cumulative_cases_per_100k=0),isFinite(t.cumulative_deaths_per_100k)||(t.cumulative_deaths_per_100k=0),isFinite(t.cumulative_vaccines_per_100k)||(t.cumulative_vaccines_per_100k=0),t.country_code=t.country_iso2})),t.original=f()(t)},qt=(a(121),a(122),a(123),a(14)),Tt=a.n(qt);a(124);Tt.a.accessToken="pk.eyJ1IjoiZ28taWZyYyIsImEiOiJjams3b2ZhZWswMGFvM3hxeHp2ZHFhOTRrIn0._pqO9OQ2iNeDGrpopJNjpg";var Dt="mapbox://styles/go-ifrc/ckqrsg27f1cwu17pex8w2de2e";let Nt,Mt;function jt(t,e,a){c.o("#map-refresh").attr("display","none").style("cursor","pointer").on("click",(function(t,e){Nt.setCenter([8,22]),Nt.setZoom(0),c.o("#map-refresh").attr("display","none")})),Nt=new Tt.a.Map({container:"map_div",style:Dt,center:[8,22],preserveDrawingBuffer:!0,zoom:0}),Nt.setRenderWorldCopies(!1),Nt.addControl(new Tt.a.NavigationControl),Nt.scrollZoom.disable(),Nt.on("zoom",(function(){c.o("#map_tooltip").attr("display","none"),c.o("#map-refresh").attr("display","inline")})),Nt.on("touchmove",(function(){c.o("#map_tooltip").attr("display","none"),c.o("#map-refresh").attr("display","inline")})),Nt.on("wheel",(function(){c.o("#map_tooltip").attr("display","none"),c.o("#map-refresh").attr("display","inline")})),Nt.on("drag",(function(){c.o("#map_tooltip").attr("display","none"),c.o("#map-refresh").attr("display","inline")}));var n=Nt.getCanvasContainer();c.o(n).append("svg").attr("id","mapoverlay").attr("width","100%").attr("height","24vw").style("position","absolute").style("z-index",2);Mt=c.o("#map_tooltip").attr("opacity",1).attr("transform","translate(0,0)").attr("display","inline"),c.o("#map_div").append("svg").attr("width","18vw").attr("height","1.5vw").attr("id","maplegend").attr("viewBox","-3 0 227 18").style("background-color","rgba(255,255,255,0.8)"),document.getElementById("maplegend").appendChild(c.o("#red_legend").node()),document.getElementById("maplegend").appendChild(c.o("#blue_legend").node()),document.getElementById("maplegend").appendChild(c.o("#bi_legend").node()),c.o("#red_legend").attr("transform","translate(20,0)"),c.o("#blue_legend").attr("transform","translate(20,0)"),c.o("#bi_legend").attr("transform","translate(0,0)"),c.o("#bi_legend").attr("display","none"),c.o("#blue_legend").attr("display","none"),document.getElementById("mapoverlay").appendChild(c.o("#map_tooltip").node()),Mt.attr("display","none"),Nt.on("load",(function(a){Nt.setPaintProperty("countries","fill-opacity-transition",{duration:0,delay:0}),Pt(t,e)}))}function Pt(t,e){if(Nt.setLayoutProperty("countries","visibility","none"),"bi-weekly-change"==e.map_toggle){var a=c.h(t.country,(function(t,e){return t.percent_change})),n=c.j(t.country,(function(t,e){return t.percent_change}));c.o("#bi_legend").attr("display","inline"),c.o("#blue_legend").attr("display","none"),c.o("#red_legend").attr("display","none"),(a=.1*Math.ceil(a/.1))>1&&(a=1),(n=.1*Math.floor(n/.1))<-1&&(n=-1),c.o("#bi_legend_dec_val").attr("text-anchor","end"),a<1?c.o("#bi_legend_inc_val tspan").text(Math.round(100*a)+"%"):c.o("#bi_legend_inc_val tspan").text(Math.round(100*a)+"% +"),n>-1?c.o("#bi_legend_dec_val tspan").text(Math.round(100*Math.abs(n))+"%").attr("dx",14):c.o("#bi_legend_dec_val tspan").text(Math.round(100*Math.abs(n))+"% +").attr("dx",14);var i=c.l().domain([-1,0,1]).range([_.blue,_.lightgrey,_.red]).clamp(!0),r=["case"];t.country.forEach((function(t,e){isFinite(t.percent_change)&&(r.push(["==",["get","iso"],t.country_code]),r.push(i(t.percent_change)))})),r.length>1&&(r.push(_.darkgrey),Nt.setPaintProperty("countries","fill-color",r))}if("cases"==e.map_toggle){var o=c.h(t.country,(function(t,e){return t.cumulative_cases_per_100k}));c.o("#bi_legend").attr("display","none"),c.o("#blue_legend").attr("display","none"),c.o("#red_legend").attr("display","inline"),c.o("#red_legend_title tspan").text("Cases per 100k"),o=o>1e3?100*Math.ceil(o/100):10*Math.ceil(o/10),c.o("#red_legend_val tspan").text(h(o));i=c.l().domain([0,o]).range([_.lightred,_.red]),r=["case"];t.country.forEach((function(t,e){r.push(["==",["get","iso"],t.country_code]),r.push(i(t.cumulative_cases_per_100k))})),r.length>1&&(r.push(_.darkgrey),Nt.setPaintProperty("countries","fill-color",r))}if("deaths"==e.map_toggle){o=c.h(t.country,(function(t,e){return t.cumulative_deaths_per_100k}));c.o("#bi_legend").attr("display","none"),c.o("#blue_legend").attr("display","none"),c.o("#red_legend").attr("display","inline"),c.o("#red_legend_title tspan").text("Deaths per 100k"),o=o>1e3?100*Math.ceil(o/100):10*Math.ceil(o/10),c.o("#red_legend_val tspan").text(h(o));i=c.l().domain([0,o]).range([_.lightred,_.red]),r=["case"];t.country.forEach((function(t,e){r.push(["==",["get","iso"],t.country_code]),r.push(i(t.cumulative_deaths_per_100k))})),r.length>1&&(r.push(_.darkgrey),Nt.setPaintProperty("countries","fill-color",r))}if("percent-fully-vaccinated"==e.map_toggle){c.o("#bi_legend").attr("display","none"),c.o("#blue_legend").attr("display","inline"),c.o("#red_legend").attr("display","none"),c.o("#blue_legend_title tspan").text("Percent fully vaccinated"),c.o("#blue_legend_val tspan").text("100%");i=c.l().domain([0,1]).range([_.lightblue,_.blue]).clamp(!0),r=["case"];t.country.forEach((function(t,e){var a=parseFloat(t.people_fully_vaccinated_per_hundred)/100;isNaN(a)&&(a=0),a>0&&(t.country_code&&r.push(["==",["get","iso"],t.country_code]),t.country_code&&r.push(i(a)))})),r.length>1?(r.push(_.darkgrey),Nt.setPaintProperty("countries","fill-color",r)):Nt.setPaintProperty("countries","fill-color",_.darkgrey)}if("percent-vaccine-acceptance"==e.map_toggle){c.o("#bi_legend").attr("display","none"),c.o("#blue_legend").attr("display","inline"),c.o("#red_legend").attr("display","none"),c.o("#blue_legend_title tspan").text("% vaccine acceptance"),c.o("#blue_legend_val tspan").text("100%");i=c.l().domain([0,1]).range([_.lightblue,_.blue]).clamp(!0),r=["case"];t.country.forEach((function(t,e){var a=parseFloat(t.vaccine_acceptance_percent)/100;isNaN(a)&&(a=0),a>0&&(t.country_code&&r.push(["==",["get","iso"],t.country_code]),t.country_code&&r.push(i(a)))})),r.length>1?(r.push(_.darkgrey),Nt.setPaintProperty("countries","fill-color",r)):Nt.setPaintProperty("countries","fill-color",_.darkgrey)}Mt.attr("display","none"),Nt.on("mousemove",(function(a){var n=Nt.queryRenderedFeatures(a.point);if(1==n.length&&"countries"==n[0].layer.id){var i,r=n[0].properties.iso,o=t.equity_data.filter((t=>t.country_iso2==r));if(o[0]&&(i=o[0].country_name),Mt.select("#map_tooltip_name tspan").text(i),0==Mt.select("#map_tooltip_name tspan").text().length&&Mt.attr("display","none"),"cases"==e.map_toggle){if(!(u=t.country.filter((t=>t.country_code==r))[0])||0==u.length)return!1;Mt.select("#map_tooltip_val tspan").text(h(Math.round(u.cumulative_cases_per_100k))+" cases per 100k")}if("deaths"==e.map_toggle){if(!(u=t.country.filter((t=>t.country_code==r))[0])||0==u.length)return!1;Mt.select("#map_tooltip_val tspan").text(h(Math.round(u.cumulative_deaths_per_100k))+" deaths per 100k")}if("bi-weekly-change"==e.map_toggle){if(!(u=t.country.filter((t=>t.country_code==r)))||0==u.length)return!1;var l="";l=(s=(100*u[0].percent_change).toFixed(1))>=0?"% increase":"% decrease",Mt.select("#map_tooltip_val tspan").text(Math.abs(s)+l)}if("percent-fully-vaccinated"==e.map_toggle){if(!(u=t.country.filter((t=>t.country_code==r)))||0==u.length)return!1;var s=parseFloat(u[0].people_fully_vaccinated_per_hundred).toFixed(2);isNaN(s)||0==s?s="-":s+="% fully vaccinated",Mt.select("#map_tooltip_val tspan").text(s)}if("percent-vaccine-acceptance"==e.map_toggle){var u;if(!(u=t.country.filter((t=>t.country_code==r)))||0==u.length)return!1;s=parseFloat(u[0].vaccine_acceptance_percent).toFixed(2);isNaN(s)||0==s?s="-":s+="% vaccine acceptance",Mt.select("#map_tooltip_val tspan").text(s)}(l=Mt.select("#map_tooltip_val tspan").text()).includes("NaN")&&Mt.attr("display","none"),c.o("#map_tooltip_bg").attr("width",20);var d=window.innerWidth/1329;Mt.attr("display","inline").attr("transform","translate("+(a.point.x+20)+","+a.point.y+")scale("+d+")");Mt.node().getBBox();var _=c.o("#map_tooltip").node().getBBox();c.o("#map_tooltip_bg").attr("width",parseFloat(_.width)+2),0==Mt.select("#map_tooltip_name tspan").text().length&&Mt.attr("display","none")}else Mt.attr("display","none")})).on("mouseout",(function(t){if("tspan"==t.toElement)return!1;Mt.attr("display","none")})),Nt.setLayoutProperty("countries","visibility","visible")}var Ct=a(2);const St={},It=[{id:"AM",text:"Americas"},{id:"EU",text:"Europe"},{id:"AP",text:"Asia-Pacific"},{id:"ME",text:"Middle East and North Africa"},{id:"AF",text:"Africa"}],Ht=[];function Bt(t){return isNaN(t)?0:t}var zt=function(){const[t,e]=Object(n.useState)(0),[a,i]=Object(n.useState)("Loading SVG layout...");async function r(){c.t("./images/layout.svg").then((function(t){c.o("#svg_container").node().append(c.o(t.documentElement).attr("width","100%").attr("height","100%").node());const a=c.o("#svg_container svg");a.select("title").remove(),a.attr("id","svg"),st(a,Ft,St,o,u,Pt),e(.1),i("Loading equity data CSV...");c.e("./data/equity_data.csv").then((function(t){St.equity_data=t,t.forEach((function(t,e){Ht.push({text:t.country_name,id:"Country-"+t.country_iso2})})),At()("#regionSelect").select2({data:[{id:"regions",text:"IFRC Regions",children:It},{id:"countries",text:"Countries",children:Ht}],placeholder:"",scrollAfterSelect:!0,renderTemplate:t=>t.text||"\u200b",dropdownParent:At()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return At()("<span>"+t.text+"<span>")}}).on("select2:unselecting",(function(){At()(this).data("unselecting",!0)})).on("select2:opening",(function(t){At()(this).data("unselecting")&&(At()(this).removeData("unselecting"),t.preventDefault())})),At()("#regionSelect").on("select2:select",(function(t){o([t.params.data.id])})),At()("#regionSelect").on("select2:unselect",(function(t){o([t.params.data.id])})),c.o("#reset_locations").style("cursor","pointer").on("click",(function(){o("clear")})),At()("#colorSelect").select2({scrollAfterSelect:!0,minimumResultsForSearch:-1,renderTemplate:t=>t.text||"\u200b",dropdownParent:At()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return At()("<span>"+t.text+"<span>")}}).on("select2:select",(function(t){var e=t.params.data;Ft.bubble_chart_color_by=e.id,kt(St,Ft)})),At()("#ySelect").select2({scrollAfterSelect:!0,minimumResultsForSearch:-1,renderTemplate:t=>t.text||"\u200b",dropdownParent:At()("#regionDrop"),shouldFocusInput:function(){return!1},templateResult:function(t){return At()("<span>"+t.text+"<span>")}}).on("select2:select",(function(t){var e=t.params.data;Ft.bubble_chart_y_axis=e.id,kt(St,Ft)})),e(.1),i("Loading WHO data CSV...");c.e("./data/owid_vaccinations.csv").then((function(t){St.vaccines_data=t,e(.07),i("Loading OWID vaccines data...");c.e("./data/who_vaccination_data.csv").then((function(t){St.vaccines_who_data=t,e(.15),i("Loading OWID vaccines data...");c.e("./data/self_assessment.csv").then((function(t){St.self_assessment=t,e(.22),i("Loading self assessment...");c.e("./data/vaccine_acceptance.csv").then((function(t){St.vaccine_acceptance=t,e(.3),i("Loading vaccine acceptance data...");c.e("./data/timeline.csv").then((function(t){St.timeline_data=t,e(.4),i("Loading WHO daily data...");c.e("./data/who_global_cases.csv").then((function(t){St.who_data=t,e(.8),i("Loading complete."),e(1),Et(St,Ft),c.o("#who_data_date tspan").text(s()(St.max_date).format("ll")),c.o("#owid_data_date tspan").text(s()(St.max_vaccine_date).format("ll")),z(St,Ft),K(St,Ft,o),u(St,Ft),l(St,Ft),jt(St,Ft),wt(St,Ft),c.o("#bubblechart").attr("display","none"),c.o("#loaderDiv").transition().duration(1e3).style("opacity",0).on("end",(()=>c.o("#loaderDiv").remove()))}))}))}))}))}))}))}))}))}function o(t,e){Ft.page=1,"clear"==t&&(Ft.region_filter=[],Ft.country_filter=[],c.o("#reset_locations").attr("display","none")),"clear-region"==t&&(Ft.region_filter=[]),"clear-hdi"==t&&(Ft.hdi_filter=[]),"clear-inform"==t&&(Ft.inform_filter=[]),1==t.length&&2==t[0].length&&"filter"!=t&&(Ft.region_filter.includes(t[0])?Ft.region_filter=Ft.region_filter.filter((e=>e!==t[0])):Ft.region_filter.push(t[0])),5==Ft.region_filter.length&&(Ft.region_filter=[]),Ft.region_filter.length>0?(c.o("#region_remove_filter").attr("opacity",1),c.p(".bar-labels").attr("opacity",.5),Ft.region_filter.forEach((function(t,e){c.o(".bar-label-"+t).attr("opacity",1)}))):(c.o("#region_remove_filter").attr("opacity",0),c.p(".bar-labels").attr("opacity",1)),St.country=St.original.country;var a=[];Ft.hdi_filter.length>0?(c.o("#hdi_remove_filter").attr("opacity",1),St.country.forEach((function(t,e){Ft.hdi_filter.includes(t.hdi_category)&&a.push(t.country_iso2)}))):c.o("#hdi_remove_filter").attr("opacity",0);var n=[];if(Ft.inform_filter.length>0?(c.o("#inform_remove_filter").attr("opacity",1),St.country.forEach((function(t,e){Ft.inform_filter.includes(t.inform_severity)&&n.push(t.country_iso2)}))):c.o("#inform_remove_filter").attr("opacity",0),1==t.length&&t[0].length>2){var i=t[0].substring(8);Ft.country_filter.includes(i)?Ft.country_filter=Ft.country_filter.filter((t=>t!==i)):Ft.country_filter.push(i)}0==Ft.region_filter.length&&0==Ft.country_filter.length&&c.o("#reset_locations").attr("display","none");var r=[];Ft.country_filter.forEach((function(t,e){r.push("Country-"+t)})),Ft.region_filter.length>0||Ft.country_filter.length>0?c.o("#reset_locations").attr("display","inline"):c.o("#reset_locations").attr("display","none");var o=Ft.region_filter.concat(r);At()("#regionSelect").val(o),At()("#regionSelect").trigger("change"),St.who_data=St.original.who_data,n.length>0&&(St.who_data=St.who_data.filter((function(t,e){return n.includes(t.country_code)}))),(Ft.region_filter.length>0||Ft.country_filter.length>0||a.length>0)&&(St.who_data=St.who_data.filter((function(t,e){return a.length>0?Ft.region_filter.length>0||Ft.country_filter.length>0?(Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_code))&&a.includes(t.country_code):a.includes(t.country_code):Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_code)}))),St.vaccines_data=St.original.vaccines_data,n.length>0&&(St.vaccines_data=St.vaccines_data.filter((function(t,e){return n.includes(t.country_code)}))),(Ft.region_filter.length>0||Ft.country_filter.length>0||a.length>0)&&(St.vaccines_data=St.vaccines_data.filter((function(t,e){return a.length>0?Ft.region_filter.length>0||Ft.country_filter.length>0?(Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_code))&&a.includes(t.country_code):a.includes(t.country_code):Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_code)}))),n.length>0&&(St.country=St.country.filter((function(t,e){return n.includes(t.country_iso2)}))),(Ft.region_filter.length>0||Ft.country_filter.length>0||a.length>0)&&(St.country=St.country.filter((function(t,e){return a.length>0?Ft.region_filter.length>0||Ft.country_filter.length>0?(Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_iso2))&&a.includes(t.country_iso2):a.includes(t.country_iso2):Ft.region_filter.includes(t.ifrc_region)||Ft.country_filter.includes(t.country_iso2)}))),function(){var t=At()("#regionSelect").select2("data");At()("#regionSelectContainer").width()/At()("#regionSelectContainer").height()<10?(At()(".select2-selection__choice").hide(),At()(".select2-search__field").attr("placeholder",t.length+" LOCATIONS SELECTED").css("width","100%")):(At()(".select2-search__field").attr("placeholder",""),At()(".select2-selection__choice").show())}(),Q(Ft,St),u(St,Ft),l(St,Ft),R(St,Ft),Pt(St,Ft),kt(St,Ft)}function l(t,e){var a=t.country.length,n=c.q(t.country,(t=>t.cumulative_cases));c.o("#total_cases tspan").transition().duration(500).textTween((function(){return function(t){return p(c.g(0,n)(t))}})),0==n?c.p(".bar_group").attr("opacity",0):c.p(".bar_group").attr("opacity",1);var i=n-c.q(t.country,(t=>t.cumulative_cases_7_days));c.o("#total_new_cases tspan").text("-"),c.o("#total_new_cases tspan").transition().duration(500).textTween((function(){return function(t){return p(c.g(0,i)(t))}}));var r=c.q(t.country,(t=>t.cumulative_deaths));c.o("#total_deaths tspan").transition().duration(500).textTween((function(){return function(t){return p(c.g(0,r)(t))}}));var o=c.q(t.country,(t=>t.total_vaccinations));c.o("#total_vaccines tspan").transition().duration(500).textTween((function(){return function(t){return p(c.g(0,o)(t))}}));var l={population:0,vaccine_population:0},s={population:0,vaccine_acceptance_population:0},u=0;t.vaccine_types=[],t.country.forEach((function(e,a){e.vaccines_per_100>0&&e.population>0&&(l.population+=e.population,l.vaccine_population+=e.population*e.vaccines_per_100),e.vaccine_acceptance_population>0&&(s.population+=e.vaccine_acceptance_population,s.vaccine_acceptance_population+=e.vaccine_acceptance_population*e.vaccine_acceptance_percent),e.vaccines_used.forEach((function(e){!t.vaccine_types.includes(e)&&e.length>1&&!e.includes("nactiv")&&t.vaccine_types.push(e)})),t.ns_involvement.forEach((function(t,a){t==e.country_iso3&&u++}))})),c.o("#total_vac_100 tspan").text("-");var d=l.vaccine_population/l.population;d&&c.o("#total_vac_100 tspan").transition().duration(500).textTween((function(){return function(t){return c.g(0,d)(t).toFixed(1)}})),c.o("#percent_acceptance tspan").text("-");var _=s.vaccine_acceptance_population/s.population;_&&c.o("#percent_acceptance tspan").transition().duration(500).textTween((function(){return function(t){return Math.round(c.g(0,Math.round(_))(t))+"%"}})),c.o("#total_ns_countries tspan").transition().duration(500).textTween((function(){return function(t){return Math.round(c.g(0,u)(t))}})),c.o("#num_vaccines tspan").transition().duration(500).textTween((function(){return function(e){return Math.round(c.g(0,t.vaccine_types.length)(e))}})),c.p(".vaccine_type").remove(),c.o("#vaccine_tooltip_bg").attr("height",1),t.vaccine_types.forEach((function(t,e){c.o("#vaccine_tooltip").append("text").attr("font-size",9).attr("fill","#000").attr("class","vaccine_type").append("tspan").text(t).attr("dx",6).attr("dy",1.3*e+1.8+"em")}));var g=c.o("#vaccine_tooltip").node().getBBox();c.o("#vaccine_tooltip_bg").attr("height",g.height+6);var m={"very-high":0,high:0,medium:0,low:0},f={"very-high":0,high:0,medium:0,low:0},y={"very-high":0,high:0,medium:0,low:0},v={"very-high":0,high:0,medium:0,low:0},b={"very-high":0,high:0,medium:0,low:0},x={"very-high":[],high:[],medium:[],low:[]},w={"very-high":0,high:0,medium:0,low:0,"no-score":0},k={"very-high":0,high:0,medium:0,low:0,"no-score":0},F={"very-high":0,high:0,medium:0,low:0,"no-score":0},O={"very-high":0,high:0,medium:0,low:0,"no-score":0},A={"very-high":0,high:0,medium:0,low:0,"no-score":0},E={"very-high":[],high:[],medium:[],low:[],"no-score":[]};n>0&&t.country.forEach((function(t,e){m[t.hdi_category]+=1,f[t.hdi_category]+=parseInt(t.population),y[t.hdi_category]+=parseInt(t.total_vaccinations)||0,w[t.inform_severity]+=1,O[t.inform_severity]+=t.contract_tracing,v[t.hdi_category]+=t.contract_tracing,"very-high"!=t.hdi_category&&"high"!=t.hdi_category&&"medium"!=t.hdi_category&&"low"!=t.hdi_category||x[t.hdi_category].push(t.avg_tests_per_1000),"very-high"!=t.inform_severity&&"high"!=t.inform_severity&&"medium"!=t.inform_severity&&"low"!=t.inform_severity&&"no-score"!=t.inform_severity||E[t.inform_severity].push(t.avg_tests_per_1000),k[t.inform_severity]+=parseInt(t.population),F[t.inform_severity]+=parseInt(t.total_vaccinations)||0,b[t.hdi_category]+=t.cumulative_cases||0,A[t.inform_severity]+=t.cumulative_cases||0}));var q=f["very-high"]+f.high+f.medium+f.low,T=k["very-high"]+k.high+k.medium+k.low+k["no-score"];c.o("#hdi-percent-val-very-high tspan").text(Bt(b["very-high"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#hdi-percent-bar-very-high").transition().duration(500).attr("width",70*Bt(b["very-high"]/n)),c.o("#hdi-percent-val-high tspan").text(Bt(b.high/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#hdi-percent-bar-high").transition().duration(500).attr("width",70*Bt(b.high/n)),c.o("#hdi-percent-val-medium tspan").text(Bt(b.medium/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#hdi-percent-bar-medium").transition().duration(500).attr("width",70*Bt(b.medium/n)),c.o("#hdi-percent-val-low tspan").text(Bt(b.low/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#hdi-percent-bar-low").transition().duration(500).attr("width",70*Bt(b.low/n)),c.o("#inform-percent-val-very-high tspan").text(Bt(A["very-high"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#inform-percent-bar-very-high").transition().duration(500).attr("width",64*Bt(A["very-high"]/n)),c.o("#inform-percent-val-high tspan").text(Bt(A.high/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#inform-percent-bar-high").transition().duration(500).attr("width",64*Bt(A.high/n)),c.o("#inform-percent-val-medium tspan").text(Bt(A.medium/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#inform-percent-bar-medium").transition().duration(500).attr("width",64*Bt(A.medium/n)),c.o("#inform-percent-val-low tspan").text(Bt(A.low/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#inform-percent-bar-low").transition().duration(500).attr("width",64*Bt(A.low/n)),c.o("#inform-percent-val-no-score tspan").text(Bt(A["no-score"]/n*100).toFixed(0)+"%").style("text-anchor","end").attr("dx","16"),c.o("#inform-percent-bar-no-score").transition().duration(500).attr("width",64*Bt(A["no-score"]/n)),c.o("#hdi-toggle-very-high-val tspan").text(m["very-high"]).style("text-anchor","end").attr("dx","10"),c.o("#hdi-toggle-high-val tspan").text(m.high).style("text-anchor","end").attr("dx","10"),c.o("#hdi-toggle-medium-val tspan").text(m.medium).style("text-anchor","end").attr("dx","10"),c.o("#hdi-toggle-low-val tspan").text(m.low).style("text-anchor","end").attr("dx","10"),c.o("#inform-toggle-very-high-val tspan").text(w["very-high"]).style("text-anchor","end").attr("dx","6"),c.o("#inform-toggle-high-val tspan").text(w.high).style("text-anchor","end").attr("dx","10"),c.o("#inform-toggle-medium-val tspan").text(w.medium).style("text-anchor","end").attr("dx","9"),c.o("#inform-toggle-low-val tspan").text(w.low).style("text-anchor","end").attr("dx","7"),c.o("#inform-toggle-no-score-val tspan").text(w["no-score"]).style("text-anchor","end").attr("dx","13"),c.o("#hdi1val-very-high tspan").text(Bt(f["very-high"]/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi1bar-very-high").transition().duration(500).attr("width",70*Bt(f["very-high"]/q)),c.o("#hdi1val-high tspan").text(Bt(f.high/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi1bar-high").transition().duration(500).attr("width",70*Bt(f.high/q)),c.o("#hdi1val-medium tspan").text(Bt(f.medium/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi1bar-medium").transition().duration(500).attr("width",70*Bt(f.medium/q)),c.o("#hdi1val-low tspan").text(Bt(f.low/q*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi1bar-low").transition().duration(500).attr("width",70*Bt(f.low/q)),c.o("#inform1val-very-high tspan").text(Bt(k["very-high"]/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform1bar-very-high").transition().duration(500).attr("width",64*Bt(k["very-high"]/T)),c.o("#inform1val-high tspan").text(Bt(k.high/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform1bar-high").transition().duration(500).attr("width",64*Bt(k.high/T)),c.o("#inform1val-medium tspan").text(Bt(k.medium/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform1bar-medium").transition().duration(500).attr("width",64*Bt(k.medium/T)),c.o("#inform1val-low tspan").text(Bt(k.low/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform1bar-low").transition().duration(500).attr("width",64*Bt(k.low/T)),c.o("#inform1val-no-score tspan").text(Bt(k["no-score"]/T*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform1bar-no-score").transition().duration(500).attr("width",64*Bt(k["no-score"]/T)),c.o("#hdi2val-very-high tspan").text(Bt(y["very-high"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi2bar-very-high").transition().duration(500).attr("width",70*Bt(y["very-high"]/o)),c.o("#hdi2val-high tspan").text(Bt(y.high/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi2bar-high").transition().duration(500).attr("width",70*Bt(y.high/o)),c.o("#hdi2val-medium tspan").text(Bt(y.medium/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi2bar-medium").transition().duration(500).attr("width",70*Bt(y.medium/o)),c.o("#hdi2val-low tspan").text(Bt(y.low/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi2bar-low").transition().duration(500).attr("width",70*Bt(y.low/o)),c.o("#inform2val-very-high tspan").text(Bt(F["very-high"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform2bar-very-high").transition().duration(500).attr("width",64*Bt(F["very-high"]/o)),c.o("#inform2val-high tspan").text(Bt(F.high/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform2bar-high").transition().duration(500).attr("width",64*Bt(F.high/o)),c.o("#inform2val-medium tspan").text(Bt(F.medium/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform2bar-medium").transition().duration(500).attr("width",64*Bt(F.medium/o)),c.o("#inform2val-low tspan").text(Bt(F.low/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform2bar-low").transition().duration(500).attr("width",64*Bt(F.low/o)),c.o("#inform2val-no-score tspan").text(Bt(F["no-score"]/o*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform2bar-no-score").transition().duration(500).attr("width",64*Bt(F["no-score"]/o));var D=c.h([y.low,y.medium,y.high,y["very-high"]]),N=c.h([F.low,F.medium,F.high,F["very-high"],F["no-score"]]);c.o("#hdi3val-very-high tspan").text(p(y["very-high"])).style("text-anchor","end").attr("dx",""),c.o("#hdi3bar-very-high").transition().duration(500).attr("width",70*Bt(y["very-high"]/D)),c.o("#hdi3val-high tspan").text(p(y.high)).style("text-anchor","end").attr("dx",""),c.o("#hdi3bar-high").transition().duration(500).attr("width",70*Bt(y.high/D)),c.o("#hdi3val-medium tspan").text(p(y.medium)).style("text-anchor","end").attr("dx",""),c.o("#hdi3bar-medium").transition().duration(500).attr("width",70*Bt(y.medium/D)),c.o("#hdi3val-low tspan").text(p(y.low)).style("text-anchor","end").attr("dx",""),c.o("#hdi3bar-low").transition().duration(500).attr("width",70*Bt(y.low/D)),c.o("#inform3val-very-high tspan").text(p(F["very-high"])).style("text-anchor","end").attr("dx",""),c.o("#inform3bar-very-high").transition().duration(500).attr("width",64*Bt(F["very-high"]/N)),c.o("#inform3val-high tspan").text(p(F.high)).style("text-anchor","end").attr("dx",""),c.o("#inform3bar-high").transition().duration(500).attr("width",64*Bt(F.high/N)),c.o("#inform3val-medium tspan").text(p(F.medium)).style("text-anchor","end").attr("dx",""),c.o("#inform3bar-medium").transition().duration(500).attr("width",64*Bt(F.medium/N)),c.o("#inform3val-low tspan").text(p(F.low)).style("text-anchor","end").attr("dx",""),c.o("#inform3bar-low").transition().duration(500).attr("width",64*Bt(F.low/N)),c.o("#inform3val-no-score tspan").text(p(F["no-score"])).style("text-anchor","end").attr("dx",""),c.o("#inform3bar-no-score").transition().duration(500).attr("width",64*Bt(F["no-score"]/N)),c.o("#hdi4val-very-high tspan").text(Bt(v["very-high"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi4bar-very-high").transition().duration(500).attr("width",70*Bt(v["very-high"]/a)),c.o("#hdi4val-high tspan").text(Bt(v.high/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi4bar-high").transition().duration(500).attr("width",70*Bt(v.high/a)),c.o("#hdi4val-medium tspan").text(Bt(v.medium/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi4bar-medium").transition().duration(500).attr("width",70*Bt(v.medium/a)),c.o("#hdi4val-low tspan").text(Bt(v.low/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#hdi4bar-low").transition().duration(500).attr("width",70*Bt(v.low/a)),c.o("#inform4val-very-high tspan").text(Bt(O["very-high"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform4bar-very-high").transition().duration(500).attr("width",64*Bt(O["very-high"]/a)),c.o("#inform4val-high tspan").text(Bt(O.high/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform4bar-high").transition().duration(500).attr("width",64*Bt(O.high/a)),c.o("#inform4val-medium tspan").text(Bt(O.medium/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform4bar-medium").transition().duration(500).attr("width",64*Bt(O.medium/a)),c.o("#inform4val-low tspan").text(Bt(O.low/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform4bar-low").transition().duration(500).attr("width",64*Bt(O.low/a)),c.o("#inform4val-no-score tspan").text(Bt(O["no-score"]/a*100).toFixed(0)+"%").style("text-anchor","end").attr("dx",""),c.o("#inform4bar-no-score").transition().duration(500).attr("width",64*Bt(O["no-score"]/a)),x.low=Math.round(c.i(x.low))||0,x.medium=Math.round(c.i(x.medium))||0,x.high=Math.round(c.i(x.high))||0,x["very-high"]=Math.round(c.i(x["very-high"]))||0,E["no-score"]=Math.round(c.i(E["no-score"]))||0,E.low=Math.round(c.i(E.low))||0,E.medium=Math.round(c.i(E.medium))||0,E.high=Math.round(c.i(E.high))||0,E["very-high"]=Math.round(c.i(E["very-high"]))||0;var M=c.h([x.low,x.medium,x.high,x["very-high"]]),j=c.h([E.low,E.medium,E.high,E["very-high"],E["no-score"]]);c.o("#hdi5val-very-high tspan").text(h(x["very-high"])).style("text-anchor","end").attr("dx",""),c.o("#hdi5bar-very-high").transition().duration(500).attr("width",70*Bt(x["very-high"]/M)),c.o("#hdi5val-high tspan").text(h(x.high)).style("text-anchor","end").attr("dx",""),c.o("#hdi5bar-high").transition().duration(500).attr("width",70*Bt(x.high/M)),c.o("#hdi5val-medium tspan").text(h(x.medium)).style("text-anchor","end").attr("dx",""),c.o("#hdi5bar-medium").transition().duration(500).attr("width",70*Bt(x.medium/M)),c.o("#hdi5val-low tspan").text(h(x.low)).style("text-anchor","end").attr("dx",""),c.o("#hdi5bar-low").transition().duration(500).attr("width",70*Bt(x.low/M)),c.o("#inform5val-very-high tspan").text(h(E["very-high"])).style("text-anchor","end").attr("dx",""),c.o("#inform5bar-very-high").transition().duration(500).attr("width",64*Bt(E["very-high"]/j)),c.o("#inform5val-high tspan").text(h(E.high)).style("text-anchor","end").attr("dx",""),c.o("#inform5bar-high").transition().duration(500).attr("width",64*Bt(E.high/j)),c.o("#inform5val-medium tspan").text(h(E.medium)).style("text-anchor","end").attr("dx",""),c.o("#inform5bar-medium").transition().duration(500).attr("width",64*Bt(E.medium/j)),c.o("#inform5val-low tspan").text(h(E.low)).style("text-anchor","end").attr("dx",""),c.o("#inform5bar-low").transition().duration(500).attr("width",64*Bt(E.low/j)),c.o("#inform5val-no-score tspan").text(h(E["no-score"])).style("text-anchor","end").attr("dx",""),c.o("#inform5bar-no-score").transition().duration(500).attr("width",64*Bt(E["no-score"]/j)),c.o("#countries_filtered tspan").text(a+" countries filtered").style("text-anchor","end").attr("dx","105")}async function u(t,e){var a;"col0_sort"==e.table_sort&&(a="country_name"),"col1_sort"==e.table_sort&&(a="total_vaccinations_per_hundred"),"col2_sort"==e.table_sort&&(a="people_vaccinated_per_hundred"),"col3_sort"==e.table_sort&&(a="people_fully_vaccinated_per_hundred"),"col4_sort"==e.table_sort&&(a="vaccine_acceptance_percent"),"col5_sort"==e.table_sort&&(a="total_vaccinations");for(var n=0;n<6;n++)c.o("#col"+n+"_sort_desc").attr("opacity",0),c.o("#col"+n+"_sort_asc").attr("opacity",0);c.o("#"+e.table_sort+"_"+e.table_sort_direction).attr("opacity",1),"country_name"==a?"asc"==e.table_sort_direction?t.country.sort((function(t,e){return e.country_name.localeCompare(t.country_name)})):t.country.sort((function(t,e){return t.country_name.localeCompare(e.country_name)})):"desc"==e.table_sort_direction?t.country.sort((function(t,e){return e[a]-t[a]})):t.country.sort((function(t,e){return t[a]-e[a]})),c.p(".tablerow").remove(),c.p(".col1bar").attr("opacity",0),c.p(".col2bar").attr("opacity",0),c.p(".col3bar").attr("opacity",0),c.p(".col4bar").attr("opacity",0),c.p(".colbg").attr("opacity",0),c.p(".table_country_name tspan").text(""),e.numPages=Math.ceil(t.country.length/10),c.o("#next").attr("opacity",(function(){return e.page==e.numPages?.5:1})),c.o("#prev").attr("opacity",(function(){return 1==e.page?.5:1})),c.o("#pagination_text").attr("text-anchor","end"),c.o("#pagination_text tspan").attr("x",40),c.o("#pagination_text tspan").text("Page "+e.page+" of "+e.numPages);var i=0;const r=t=>new Promise((e=>setTimeout(e,t)));for(let o=10*(e.page-1);o<10*e.page;o++){var l=t.country[o];if(t.country[o]){var s=c.o("#row"+i);s.append("text").attr("class","tablerow table_country_name").text((function(){var t;return 17==(t=(t=l.country_name?l.country_name:l.country_code).substring(0,17)).length&&(t+="."),t})).attr("data-id",l.country_code).attr("x",0).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),s.append("text").attr("class","tablerow").text((function(){var t=parseFloat(l.total_vaccinations_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t})).style("text-anchor","end").attr("x",112).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),c.o("#col1bar"+i).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=l.total_vaccinations_per_hundred;return l.total_vaccinations_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),c.o("#col1bg"+i).attr("opacity",1),s.append("text").attr("class","tablerow").text((function(){var t=parseFloat(l.people_vaccinated_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",223).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),c.o("#col2bar"+i).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=l.people_vaccinated_per_hundred;return l.people_vaccinated_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),c.o("#col2bg"+i).attr("opacity",1),s.append("text").attr("class","tablerow").text((function(){var t=parseFloat(l.people_fully_vaccinated_per_hundred).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",335).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),c.o("#col3bar"+i).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=l.people_fully_vaccinated_per_hundred;return l.people_fully_vaccinated_per_hundred>100&&(t=100),isNaN(t)?0:t/100*68})),c.o("#col3bg"+i).attr("opacity",1),s.append("text").attr("class","tablerow").text((function(){var t=parseFloat(l.vaccine_acceptance_percent).toFixed(1);return isNaN(t)||0==t?"":t+"%"})).style("text-anchor","end").attr("x",450).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),c.o("#col4bar"+i).attr("opacity",1).transition().duration(200).attr("width",(function(){var t=l.vaccine_acceptance_percent;return l.vaccine_acceptance_percent>100&&(t=100),isNaN(t)?0:t/100*68})),c.o("#col4bg"+i).attr("opacity",1);var u=c.r("%b %d");s.append("text").attr("class","tablerow").text((function(){var t=l.total_vaccinations;return isNaN(t)||0==t?"":p(t)})).style("text-anchor","end").attr("x",572).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),s.append("text").attr("class","tablerow").text((function(){var t=l.data_updated;return t?u(t):""})).style("text-anchor","end").attr("x",620).attr("y",(function(){return 80+24.8*i})).style("fill","#000").style("font-size","9px"),i++,await r(5)}else c.o("#col1bar"+i).attr("width",0),c.o("#col2bar"+i).attr("width",0),c.o("#col3bar"+i).attr("width",0),c.o("#col4bar"+i).attr("width",0)}c.p(".row").style("cursor",(function(t,e){return c.o(this).selectAll("text").nodes().length>0?"pointer":"default"})).on("click",(function(t,e){var a=c.o(this).select(".table_country_name");a.empty()||o(["Country-"+a.attr("data-id")])}))}return c.o("#prev").style("cursor","pointer").attr("opacity",.5).on("click",(function(){if(1==Ft.page)return!1;Ft.page=Ft.page-1,u(St,Ft)})),c.o("#next").style("cursor","pointer").on("click",(function(){if(Ft.page==Ft.numPages)return!1;Ft.page=Ft.page+1,u(St,Ft)})),Object(n.useEffect)((()=>{r()}),[]),Object(Ct.jsxs)("div",{children:[Object(Ct.jsxs)("div",{id:"loaderDiv",children:[Object(Ct.jsx)("div",{id:"loaderText",children:a}),Object(Ct.jsx)("div",{id:"loaderBar",children:Object(Ct.jsx)("div",{id:"loaderProgress",style:{width:100*t+"%"}})})]}),Object(Ct.jsxs)("div",{id:"regionSelectContainer",children:[Object(Ct.jsx)("select",{id:"regionSelect",className:"js-example-responsive",name:"region[]",multiple:"multiple"}),Object(Ct.jsx)("div",{id:"regionDrop"})]}),Object(Ct.jsxs)("div",{id:"bubbleSelectContainer",children:[Object(Ct.jsxs)("div",{id:"colorSelectContainer",children:["Color by\xa0\xa0",Object(Ct.jsxs)("select",{id:"colorSelect",className:"js-example-responsive",name:"colorby[]",defaultValue:"hdi",children:[Object(Ct.jsx)("option",{value:"region",children:"IFRC region"}),Object(Ct.jsx)("option",{value:"hdi",children:"Human Development Index (HDI)"}),Object(Ct.jsx)("option",{value:"inform-severity",children:"INFORM Severity Index"})]}),Object(Ct.jsx)("div",{id:"colorDrop"})]}),Object(Ct.jsxs)("div",{id:"ySelectContainer",children:["y-Axis\xa0\xa0",Object(Ct.jsxs)("select",{id:"ySelect",className:"js-example-responsive",name:"yaxis[]",children:[Object(Ct.jsx)("option",{value:"percent-vaccinated-at-least-1-dose",children:"% vaccinated at least 1 dose"}),Object(Ct.jsx)("option",{value:"percent-fully-vaccinated",children:"% fully vaccinated"}),Object(Ct.jsx)("option",{value:"percent-vaccine-acceptance",children:"% vaccine acceptance"})]}),Object(Ct.jsx)("div",{id:"yDrop"})]})]}),Object(Ct.jsx)("div",{id:"svg_container",className:"App"}),Object(Ct.jsx)("div",{id:"map_div_outer",children:Object(Ct.jsx)("div",{id:"map_div"})}),Object(Ct.jsxs)("div",{id:"footer",children:["Data Sources - ",Object(Ct.jsx)("a",{href:"https://covid19.who.int/info/",target:"_blank",children:"WHO Daily cases and deaths by date, vaccination data"}),", ",Object(Ct.jsx)("a",{href:"https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations",target:"_blank",children:"OWID vaccinations csv"})]})]})};var Rt=t=>{t&&t instanceof Function&&a.e(5).then(a.bind(null,243)).then((e=>{let{getCLS:a,getFID:n,getFCP:i,getLCP:r,getTTFB:o}=e;a(t),n(t),i(t),r(t),o(t)}))};o.a.render(Object(Ct.jsx)(i.a.StrictMode,{children:Object(Ct.jsx)(zt,{})}),document.getElementById("root")),Rt()}},[[127,1,3]]]);
//# sourceMappingURL=main.2debc367.chunk.js.map