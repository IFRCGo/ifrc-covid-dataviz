{"ast":null,"code":"import*as d3 from\"d3\";import moment from'moment';import colors from'./colors';import{addCommas}from'./HelperFunctions';import{filter}from'./App';var maxX=1000;var maxY=100;var maxZ=1000000;var xScale;var yScale;var zScale;var groupedData=[];var width=600;var height=233;var x=40;var y=58;var bubbles;export function drawBubblechart(data,options,filter){data.vGroup.forEach(function(d,i){data.equity_data.forEach(function(dd,ii){if(d[0]==dd.country_iso3){dd.people_fully_vaccinated_per_hundred=parseFloat(d[1][0].people_fully_vaccinated_per_hundred);dd.people_vaccinated_per_hundred=parseFloat(d[1][0].people_vaccinated_per_hundred);dd.total_vaccinations=parseFloat(d[1][0].total_vaccinations);dd.total_vaccinations_per_hundred=parseFloat(d[1][0].total_vaccinations_per_hundred);}});});console.log(data);maxX=d3.max(data.equity_data,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.equity_data,function(d,i){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return parseFloat(d.people_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return parseFloat(d.people_fully_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return parseFloat(d.vaccince_acceptance_percent);});maxZ=d3.max(data.equity_data,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]);yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart-tab').append('g').attr('transform','translate('+x+', '+y+')').attr('id','bubblechart');// create y-axis\nsvg.append(\"g\").attr('id','bubbley').call(d3.axisLeft(yScale).ticks(3));// create x-axis\nsvg.append(\"g\").attr('id','bubblex').attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(xScale).ticks(3));// Add dots\nbubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.equity_data).join(function(enter){enter.append(\"circle\").attr(\"class\",function(d){return\"bubble\";}).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke-width\",2).style(\"fill-opacity\",0.8);},function(update){update.transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';});},function(exit){exit.remove();});}export function updateBubblechart(data,options,filter){data.vGroup.forEach(function(d,i){data.equity_data.forEach(function(dd,ii){if(d[0]==dd.country_iso3){dd.people_fully_vaccinated_per_hundred=parseFloat(d[1][0].people_fully_vaccinated_per_hundred);dd.people_vaccinated_per_hundred=parseFloat(d[1][0].people_vaccinated_per_hundred);dd.total_vaccinations=parseFloat(d[1][0].total_vaccinations);dd.total_vaccinations_per_hundred=parseFloat(d[1][0].total_vaccinations_per_hundred);}});});maxX=d3.max(data.equity_data,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.equity_data,function(d,i){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return parseFloat(d.people_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return parseFloat(d.people_fully_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return parseFloat(d.vaccince_acceptance_percent);});maxZ=d3.max(data.equity_data,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]);yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart');// create y-axis\nsvg.select('#bubbley').transition().duration(800).call(d3.axisLeft(yScale).ticks(3));// create x-axis\nsvg.select('#bubblex').transition().duration(800).call(d3.axisBottom(xScale).ticks(3));bubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.equity_data).join(function(enter){enter.append(\"circle\").attr(\"cx\",function(d){return xScale(maxX);}).attr(\"cy\",function(d){return yScale(maxY);}).attr(\"class\",function(d){return\"bubble\";}).transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke-width\",2).style(\"fill-opacity\",0.8);},function(update){update.transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';});},function(exit){exit.remove();});}export default drawBubblechart;","map":{"version":3,"sources":["/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/Bubblechart.js"],"names":["d3","moment","colors","addCommas","filter","maxX","maxY","maxZ","xScale","yScale","zScale","groupedData","width","height","x","y","bubbles","drawBubblechart","data","options","vGroup","forEach","d","i","equity_data","dd","ii","country_iso3","people_fully_vaccinated_per_hundred","parseFloat","people_vaccinated_per_hundred","total_vaccinations","total_vaccinations_per_hundred","console","log","max","gni_2017","bubble_chart_y_axis","vaccince_acceptance_percent","population","scaleLinear","range","domain","scaleSqrt","svg","select","append","attr","call","axisLeft","ticks","axisBottom","selectAll","join","enter","style","bubble_chart_color_by","regions","ifrc_region","hdi_category","inform_severity","update","transition","duration","exit","remove","updateBubblechart"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxX =1000;\nlet maxY = 100;\nlet maxZ = 1000000;\nlet xScale; \nlet yScale; \nlet zScale; \nlet groupedData = [];\nlet width = 600;\nlet height = 233;\nlet x = 40;\nlet y = 58;\nlet bubbles;\n\nexport function drawBubblechart(data, options, filter) {\n\n    data.vGroup.forEach(function(d,i){\n        data.equity_data.forEach(function(dd,ii){\n            if(d[0] == dd.country_iso3){\n                dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n                dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n                dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n                dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n\n            }\n        })\n    })\n    console.log(data);\n\n    maxX = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.equity_data, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccince_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart-tab').append('g').attr('transform', 'translate('+x+', '+y+')')\n    .attr('id', 'bubblechart');\n\n    // create y-axis\n    svg.append(\"g\")\n    .attr('id', 'bubbley')\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.append(\"g\")\n    .attr('id', 'bubblex')\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    // Add dots\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.equity_data)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke-width\", 2)\n        .style(\"fill-opacity\", 0.8);\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n    },function(exit){\n        exit.remove();\n    })\n\n\n}\n\nexport function updateBubblechart(data,options,filter) {\n    \n    data.vGroup.forEach(function(d,i){\n        data.equity_data.forEach(function(dd,ii){\n            if(d[0] == dd.country_iso3){\n                dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n                dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n                dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n                dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n\n            }\n        })\n    })\n\n    maxX = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.equity_data, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccince_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart');\n\n    // create y-axis\n    svg.select('#bubbley')\n    .transition().duration(800)\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.select('#bubblex')\n    .transition().duration(800)\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.equity_data)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"cx\", function (d) { return xScale(maxX)})\n        .attr(\"cy\", function (d) { return yScale(maxY)})\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .transition().duration(800)\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke-width\", 2)\n        .style(\"fill-opacity\", 0.8);\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n    },function(exit){\n        exit.remove();\n    })\n\n\n}\n\nexport default drawBubblechart;\n"]},"metadata":{},"sourceType":"module"}