{"ast":null,"code":"var _jsxFileName = \"/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Select from 'react-select';\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport { drawTimechart, updateTimechart } from './Timechart';\nimport { drawRegionchart, updateRegionchart } from './Regionchart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css';\nimport $ from \"jquery\";\nimport select2 from 'select2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\nconst whoDataUrl = \"./data/who_global_cases.csv\";\nconst worldUrl = \"./data/world-wb5.geojson\";\nconst data = {\n  'data': []\n};\nconst regionOptions = [{\n  value: 'AM',\n  label: 'Americas'\n}, {\n  value: 'EU',\n  label: 'Europe'\n}, {\n  value: 'AP',\n  label: 'Asia-Pacific'\n}, {\n  value: 'ME',\n  label: 'Middle East and North Africa'\n}, {\n  value: 'AF',\n  label: 'Africa'\n}];\nconst countryOptions = [];\n\nfunction App() {\n  _s();\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...'); // const [countryOptions, setCountryOptions] = useState([]);\n\n  async function init() {\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function (d) {\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', 'auto').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      Layout(svg, options, data);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...'); // data source 2: equity_data.csv\n\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function (d) {\n        data.equity_data = d;\n        d.forEach(function (d, i) {\n          console.log(d);\n          countryOptions.push({\n            'label': d.country_name,\n            'value': d.country_iso2\n          });\n        });\n        console.log(countryOptions);\n        setProgress(0.3);\n        setLoaderText('Loading WHO data CSV...'); // data source 3: who_global_cases.csv\n\n        const whoData = d3.csv(whoDataUrl);\n        whoData.then(function (d) {\n          data.who_data = d;\n          setProgress(0.8);\n          setLoaderText('Loading World Map GeoJSON...'); // data source 4: world-wb5.geojson\n\n          const world = d3.csv(worldUrl);\n          world.then(function (d) {\n            data.world = d;\n            setLoaderText('Loading complete.');\n            setProgress(1);\n            ParseData(data);\n            createCharts();\n            console.log(data);\n            d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n          });\n        });\n      });\n    });\n  }\n\n  function createCharts() {\n    drawTimechart(data, options);\n    drawRegionchart(data, options);\n  }\n\n  useEffect(() => {\n    init();\n  }, []);\n  const selectStyle = {\n    control: (base, state) => ({ ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n        border: '1px solid #D8D8D8'\n      }\n    })\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"loaderDiv\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"loaderText\",\n        children: loaderText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"loaderBar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"loaderProgress\",\n          style: {\n            width: progress * 100 + '%'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"regionSelectContainer\",\n      children: /*#__PURE__*/_jsxDEV(Select, {\n        id: \"regionSelect\",\n        options: regionOptions,\n        styles: selectStyle,\n        isMulti: true,\n        hideSelectedOptions: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"countrySelectContainer\",\n      children: /*#__PURE__*/_jsxDEV(Select, {\n        id: \"countrySelect\",\n        options: countryOptions,\n        styles: selectStyle,\n        isMulti: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"svg_container\",\n      className: \"App\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"dIWdRh6Aq0pdUXjFSLJaJri2VpA=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/App.js"],"names":["React","useEffect","useState","Select","d3","Layout","drawTimechart","updateTimechart","drawRegionchart","updateRegionchart","options","ParseData","$","select2","equityDataUrl","layoutUrl","whoDataUrl","worldUrl","data","regionOptions","value","label","countryOptions","App","progress","setProgress","loaderText","setLoaderText","init","layout","xml","then","d","select","node","append","documentElement","attr","svg","remove","equityData","csv","equity_data","forEach","i","console","log","push","country_name","country_iso2","whoData","who_data","world","createCharts","transition","duration","style","on","selectStyle","control","base","state","border","boxShadow","width"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAAQC,aAAR,EAAuBC,eAAvB,QAA6C,aAA7C;AACA,SAAQC,eAAR,EAAyBC,iBAAzB,QAAiD,eAAjD;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAO,WAAP;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,OAAP,MAAoB,SAApB;;AAEA,MAAMC,aAAa,GAAG,wBAAtB;AACA,MAAMC,SAAS,GAAG,qBAAlB;AACA,MAAMC,UAAU,GAAG,6BAAnB;AACA,MAAMC,QAAQ,GAAG,0BAAjB;AAEA,MAAMC,IAAI,GAAG;AAAC,UAAQ;AAAT,CAAb;AAEA,MAAMC,aAAa,GAAG,CACpB;AAAEC,EAAAA,KAAK,EAAE,IAAT;AAAeC,EAAAA,KAAK,EAAE;AAAtB,CADoB,EAEpB;AAAED,EAAAA,KAAK,EAAE,IAAT;AAAeC,EAAAA,KAAK,EAAE;AAAtB,CAFoB,EAGpB;AAAED,EAAAA,KAAK,EAAE,IAAT;AAAeC,EAAAA,KAAK,EAAE;AAAtB,CAHoB,EAIpB;AAAED,EAAAA,KAAK,EAAE,IAAT;AAAeC,EAAAA,KAAK,EAAE;AAAtB,CAJoB,EAKpB;AAAED,EAAAA,KAAK,EAAE,IAAT;AAAeC,EAAAA,KAAK,EAAE;AAAtB,CALoB,CAAtB;AAQA,MAAMC,cAAc,GAAG,EAAvB;;AAEA,SAASC,GAAT,GAAe;AAAA;;AAEb,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BvB,QAAQ,CAAC,CAAD,CAAxC;AACA,QAAM,CAACwB,UAAD,EAAaC,aAAb,IAA8BzB,QAAQ,CAAC,uBAAD,CAA5C,CAHa,CAIb;;AAEA,iBAAe0B,IAAf,GAAqB;AAEnB;AACA,UAAMC,MAAM,GAAGzB,EAAE,CAAC0B,GAAH,CAAOf,SAAP,CAAf;AACAc,IAAAA,MAAM,CAACE,IAAP,CAAY,UAASC,CAAT,EAAW;AACrB5B,MAAAA,EAAE,CAAC6B,MAAH,CAAU,gBAAV,EAA4BC,IAA5B,GAAmCC,MAAnC,CAA0C/B,EAAE,CAAC6B,MAAH,CAAUD,CAAC,CAACI,eAAZ,EAA6BC,IAA7B,CAAkC,OAAlC,EAA2C,MAA3C,EAAmDA,IAAnD,CAAwD,QAAxD,EAAkE,MAAlE,EAA0EH,IAA1E,EAA1C;AACA,YAAMI,GAAG,GAAGlC,EAAE,CAAC6B,MAAH,CAAU,oBAAV,CAAZ;AACAK,MAAAA,GAAG,CAACL,MAAJ,CAAW,OAAX,EAAoBM,MAApB;AACAlC,MAAAA,MAAM,CAACiC,GAAD,EAAM5B,OAAN,EAAeQ,IAAf,CAAN;AACAO,MAAAA,WAAW,CAAC,GAAD,CAAX;AACAE,MAAAA,aAAa,CAAC,4BAAD,CAAb,CANqB,CAOrB;;AACA,YAAMa,UAAU,GAAGpC,EAAE,CAACqC,GAAH,CAAO3B,aAAP,CAAnB;AACA0B,MAAAA,UAAU,CAACT,IAAX,CAAgB,UAASC,CAAT,EAAW;AACzBd,QAAAA,IAAI,CAACwB,WAAL,GAAmBV,CAAnB;AAEAA,QAAAA,CAAC,CAACW,OAAF,CAAU,UAASX,CAAT,EAAWY,CAAX,EAAa;AACrBC,UAAAA,OAAO,CAACC,GAAR,CAAYd,CAAZ;AACAV,UAAAA,cAAc,CAACyB,IAAf,CAAoB;AAAC,qBAASf,CAAC,CAACgB,YAAZ;AAA0B,qBAAShB,CAAC,CAACiB;AAArC,WAApB;AACD,SAHD;AAIAJ,QAAAA,OAAO,CAACC,GAAR,CAAYxB,cAAZ;AAEAG,QAAAA,WAAW,CAAC,GAAD,CAAX;AACAE,QAAAA,aAAa,CAAC,yBAAD,CAAb,CAVyB,CAWvB;;AACA,cAAMuB,OAAO,GAAG9C,EAAE,CAACqC,GAAH,CAAOzB,UAAP,CAAhB;AACAkC,QAAAA,OAAO,CAACnB,IAAR,CAAa,UAASC,CAAT,EAAW;AACtBd,UAAAA,IAAI,CAACiC,QAAL,GAAgBnB,CAAhB;AACAP,UAAAA,WAAW,CAAC,GAAD,CAAX;AACAE,UAAAA,aAAa,CAAC,8BAAD,CAAb,CAHsB,CAItB;;AACA,gBAAMyB,KAAK,GAAGhD,EAAE,CAACqC,GAAH,CAAOxB,QAAP,CAAd;AACAmC,UAAAA,KAAK,CAACrB,IAAN,CAAW,UAASC,CAAT,EAAW;AACpBd,YAAAA,IAAI,CAACkC,KAAL,GAAapB,CAAb;AACAL,YAAAA,aAAa,CAAC,mBAAD,CAAb;AACAF,YAAAA,WAAW,CAAC,CAAD,CAAX;AACAd,YAAAA,SAAS,CAACO,IAAD,CAAT;AACAmC,YAAAA,YAAY;AACZR,YAAAA,OAAO,CAACC,GAAR,CAAY5B,IAAZ;AACAd,YAAAA,EAAE,CAAC6B,MAAH,CAAU,YAAV,EAAwBqB,UAAxB,GAAqCC,QAArC,CAA8C,IAA9C,EAAoDC,KAApD,CAA0D,SAA1D,EAAqE,CAArE,EAAwEC,EAAxE,CAA2E,KAA3E,EAAkF,MAAMrD,EAAE,CAAC6B,MAAH,CAAU,YAAV,EAAwBM,MAAxB,EAAxF;AACD,WARD;AASD,SAfD;AAgBH,OA7BD;AA8BD,KAvCD;AAwCD;;AAED,WAASc,YAAT,GAAuB;AACrB/C,IAAAA,aAAa,CAACY,IAAD,EAAOR,OAAP,CAAb;AACAF,IAAAA,eAAe,CAACU,IAAD,EAAOR,OAAP,CAAf;AACD;;AAEDT,EAAAA,SAAS,CAAC,MAAM;AACd2B,IAAAA,IAAI;AACL,GAFQ,EAEN,EAFM,CAAT;AAKA,QAAM8B,WAAW,GAAG;AAClBC,IAAAA,OAAO,EAAE,CAACC,IAAD,EAAOC,KAAP,MAAkB,EACzB,GAAGD,IADsB;AAEzBE,MAAAA,MAAM,EAAE,mBAFiB;AAGzBC,MAAAA,SAAS,EAAE,MAHc;AAIzB,iBAAW;AACPD,QAAAA,MAAM,EAAE;AADD;AAJc,KAAlB;AADS,GAApB;AAWA,sBACE;AAAA,4BACE;AAAK,MAAA,EAAE,EAAC,WAAR;AAAA,8BACE;AAAK,QAAA,EAAE,EAAC,YAAR;AAAA,kBAAsBpC;AAAtB;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAK,QAAA,EAAE,EAAC,WAAR;AAAA,+BACE;AAAK,UAAA,EAAE,EAAC,gBAAR;AAAyB,UAAA,KAAK,EAAE;AAACsC,YAAAA,KAAK,EAAExC,QAAQ,GAAC,GAAT,GAAa;AAArB;AAAhC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAQE;AAAK,MAAA,EAAE,EAAC,uBAAR;AAAA,6BACE,QAAC,MAAD;AAAQ,QAAA,EAAE,EAAC,cAAX;AAA0B,QAAA,OAAO,EAAEL,aAAnC;AAAkD,QAAA,MAAM,EAAEuC,WAA1D;AAAuE,QAAA,OAAO,MAA9E;AAA+E,QAAA,mBAAmB,EAAE;AAApG;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YARF,eAWE;AAAK,MAAA,EAAE,EAAC,wBAAR;AAAA,6BACE,QAAC,MAAD;AAAQ,QAAA,EAAE,EAAC,eAAX;AAA2B,QAAA,OAAO,EAAEpC,cAApC;AAAoD,QAAA,MAAM,EAAEoC,WAA5D;AAAyE,QAAA,OAAO;AAAhF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAXF,eAeA;AAAK,MAAA,EAAE,EAAC,eAAR;AAAwB,MAAA,SAAS,EAAC;AAAlC;AAAA;AAAA;AAAA;AAAA,YAfA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAuBD;;GAhGQnC,G;;KAAAA,G;AAkGT,eAAeA,GAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Select from 'react-select'\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {drawRegionchart, updateRegionchart} from './Regionchart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css'\nimport $ from \"jquery\";\nimport select2 from 'select2';\n\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\nconst whoDataUrl = \"./data/who_global_cases.csv\";\nconst worldUrl = \"./data/world-wb5.geojson\";\n\nconst data = {'data': []};\n\nconst regionOptions = [\n  { value: 'AM', label: 'Americas' },\n  { value: 'EU', label: 'Europe' },\n  { value: 'AP', label: 'Asia-Pacific' },\n  { value: 'ME', label: 'Middle East and North Africa'},\n  { value: 'AF', label: 'Africa' }\n]\n\nconst countryOptions = [];\n\nfunction App() {\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...');\n  // const [countryOptions, setCountryOptions] = useState([]);\n\n  async function init(){\n\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function(d){\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', 'auto').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      Layout(svg, options, data);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...');\n      // data source 2: equity_data.csv\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function(d){\n        data.equity_data = d;\n\n        d.forEach(function(d,i){\n          console.log(d);\n          countryOptions.push({'label': d.country_name, 'value': d.country_iso2 })\n        })\n        console.log(countryOptions);\n\n        setProgress(0.3);\n        setLoaderText('Loading WHO data CSV...');\n          // data source 3: who_global_cases.csv\n          const whoData = d3.csv(whoDataUrl);\n          whoData.then(function(d){\n            data.who_data = d;\n            setProgress(0.8);\n            setLoaderText('Loading World Map GeoJSON...');\n            // data source 4: world-wb5.geojson\n            const world = d3.csv(worldUrl);\n            world.then(function(d){\n              data.world = d;\n              setLoaderText('Loading complete.');\n              setProgress(1);\n              ParseData(data);\n              createCharts();\n              console.log(data);\n              d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n            });\n          });\n      });\n    })\n  }\n  \n  function createCharts(){\n    drawTimechart(data, options);\n    drawRegionchart(data, options);\n  }\n\n  useEffect(() => {\n    init();\n  }, [])\n\n\n  const selectStyle = {\n    control: (base, state) => ({\n      ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n          border: '1px solid #D8D8D8',\n      }\n  })\n  };\n\n  return (\n    <div>\n      <div id=\"loaderDiv\">\n        <div id=\"loaderText\">{loaderText}</div>\n        <div id=\"loaderBar\">\n          <div id=\"loaderProgress\" style={{width: progress*100+'%'}}></div>\n        </div>\n      </div>\n\n      <div id=\"regionSelectContainer\">\n        <Select id=\"regionSelect\" options={regionOptions} styles={selectStyle} isMulti hideSelectedOptions={true}/>\n      </div>\n      <div id=\"countrySelectContainer\">\n        <Select id=\"countrySelect\" options={countryOptions} styles={selectStyle} isMulti/>\n      </div>\n\n    <div id=\"svg_container\" className=\"App\">\n\n    </div>\n\n\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}