{"ast":null,"code":"import*as d3 from\"d3\";import moment from'moment';import colors from'./colors';import{addCommas,nFormatter}from'./HelperFunctions';import{filter}from'./App';var maxX=1000;var maxY=100;var maxZ=1000000;var xScale;var yScale;var zScale;var groupedData=[];var width=600;var height=233;var x=35;var y=58;var bubbles;export function drawBubblechart(data,options,filter){data.vGroup.forEach(function(d,i){data.equity_data.forEach(function(dd,ii){if(d[0]==dd.country_iso3){dd.people_fully_vaccinated_per_hundred=parseFloat(d[1][0].people_fully_vaccinated_per_hundred);dd.people_vaccinated_per_hundred=parseFloat(d[1][0].people_vaccinated_per_hundred);dd.total_vaccinations=parseFloat(d[1][0].total_vaccinations);dd.total_vaccinations_per_hundred=parseFloat(d[1][0].total_vaccinations_per_hundred);}});});console.log(data);maxX=d3.max(data.equity_data,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.equity_data,function(d,i){// if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\nif(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return 100;// if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\nif(options.bubble_chart_y_axis=='percent-fully-vaccinated')return 100;if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return 100;});maxZ=d3.max(data.equity_data,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]).nice();yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart-tab').append('g').attr('transform','translate('+x+', '+y+')').attr('id','bubblechart');// create y-axis\nsvg.append(\"g\").attr('id','bubbley').call(d3.axisLeft(yScale).ticks(3).tickSize(3));// create x-axis\nsvg.append(\"g\").attr('id','bubblex').attr('class','xAxis').attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(xScale).ticks(4).tickSize(3));// Add dots\nbubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.equity_data).join(function(enter){enter.append(\"circle\").attr(\"class\",function(d){return\"bubble\";}).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke-width\",1)// .style(\"fill-opacity\", 0.8)\n.attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(update){update.transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){// if(options.bubble_chart_color_by == 'region') {\n//    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n// } \n// if(options.bubble_chart_color_by == 'hdi') {\n//     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n//  }\n//  if(options.bubble_chart_color_by == 'inform-severity') {\n//     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n//  }\n// return  'transparent';\nreturn'#FFF';}).attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(exit){exit.remove();});d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove',function(event,d){d3.select('#bubbleSelectContainer').style('z-index',1);d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.vaccince_acceptance_percent).toFixed(2)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\",\"end\").attr('dx',37);d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\",\"end\").attr('dx',37);var coords=d3.pointer(event,d3.select('#svg').node());if(coords[0]<1110){d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_right').attr('display','none');}else{d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','none');d3.select('#bubblechart_tooltip_arrow_right').attr('display','inline');}d3.selectAll(\".bubble\").attr('opacity',0.4);d3.select(this).attr('opacity',1).style('stroke-width',3);}).on('mouseout',function(event){if(event.toElement=='tspan')return false;d3.select('#bubbleSelectContainer').style('z-index',2);// mapTooltip.attr('display', 'none');\nd3.select('#bubblechart_tooltip').attr('display','none');d3.selectAll(\".bubble\").attr('opacity',1).style('stroke-width',2);});d3.select('#bubblechart_tooltip').attr('display','none');d3.select('#bubble_y_axis_label').attr('text-anchor','middle').select('tspan').attr('dx',50);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');}}export function updateBubblechart(data,options,filter){data.vGroup.forEach(function(d,i){data.equity_data.forEach(function(dd,ii){if(d[0]==dd.country_iso3){dd.people_fully_vaccinated_per_hundred=parseFloat(d[1][0].people_fully_vaccinated_per_hundred);dd.people_vaccinated_per_hundred=parseFloat(d[1][0].people_vaccinated_per_hundred);dd.total_vaccinations=parseFloat(d[1][0].total_vaccinations);dd.total_vaccinations_per_hundred=parseFloat(d[1][0].total_vaccinations_per_hundred);}});});maxX=d3.max(data.equity_data,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.equity_data,function(d,i){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return parseFloat(d.people_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return parseFloat(d.people_fully_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return parseFloat(d.vaccince_acceptance_percent);});maxZ=d3.max(data.equity_data,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]);yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart');// create y-axis\nsvg.select('#bubbley').transition().duration(800).call(d3.axisLeft(yScale).ticks(3));// create x-axis\nsvg.select('#bubblex').transition().duration(800).call(d3.axisBottom(xScale).ticks(3));bubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.equity_data).join(function(enter){enter.append(\"circle\").attr(\"cx\",function(d){return xScale(maxX);}).attr(\"cy\",function(d){return yScale(maxY);}).attr(\"class\",function(d){return\"bubble\";}).transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){// if(options.bubble_chart_color_by == 'region') {\n//    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n// } \n// if(options.bubble_chart_color_by == 'hdi') {\n//     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n//  }\n//  if(options.bubble_chart_color_by == 'inform-severity') {\n//     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n//  }\n// return  'transparent';\nreturn'#FFF';}).style(\"stroke-width\",1)// .style(\"fill-opacity\", 0.8)\n.attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(update){update.transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccince_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccince_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(exit){exit.remove();});d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove',function(event,d){d3.select('#bubbleSelectContainer').style('z-index',1);d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.vaccince_acceptance_percent).toFixed(2)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\",\"end\").attr('dx',37);d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\",\"end\").attr('dx',37);var coords=d3.pointer(event,d3.select('#svg').node());if(coords[0]<1110){d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_right').attr('display','none');}else{d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','none');d3.select('#bubblechart_tooltip_arrow_right').attr('display','inline');}d3.selectAll(\".bubble\").attr('opacity',0.4);d3.select(this).attr('opacity',1).style('stroke-width',2);}).on('mouseout',function(event){if(event.toElement=='tspan')return false;d3.select('#bubbleSelectContainer').style('z-index',2);// mapTooltip.attr('display', 'none');\nd3.select('#bubblechart_tooltip').attr('display','none');d3.selectAll(\".bubble\").attr('opacity',1).style('stroke-width',1);});if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');}}export default drawBubblechart;","map":{"version":3,"sources":["/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/Bubblechart.js"],"names":["d3","moment","colors","addCommas","nFormatter","filter","maxX","maxY","maxZ","xScale","yScale","zScale","groupedData","width","height","x","y","bubbles","drawBubblechart","data","options","vGroup","forEach","d","i","equity_data","dd","ii","country_iso3","people_fully_vaccinated_per_hundred","parseFloat","people_vaccinated_per_hundred","total_vaccinations","total_vaccinations_per_hundred","console","log","max","gni_2017","bubble_chart_y_axis","population","scaleLinear","range","domain","nice","scaleSqrt","svg","select","append","attr","call","axisLeft","ticks","tickSize","axisBottom","selectAll","join","enter","vaccince_acceptance_percent","style","bubble_chart_color_by","regions","ifrc_region","hdi_category","inform_severity","val","isNaN","update","transition","duration","exit","remove","on","event","text","country_name","toFixed","Math","round","parseInt","coords","pointer","node","toElement","updateBubblechart"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxX =1000;\nlet maxY = 100;\nlet maxZ = 1000000;\nlet xScale; \nlet yScale; \nlet zScale; \nlet groupedData = [];\nlet width = 600;\nlet height = 233;\nlet x = 35;\nlet y = 58;\nlet bubbles;\n\nexport function drawBubblechart(data, options, filter) {\n\n    data.vGroup.forEach(function(d,i){\n        data.equity_data.forEach(function(dd,ii){\n            if(d[0] == dd.country_iso3){\n                dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n                dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n                dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n                dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n            }\n        })\n    })\n    console.log(data);\n\n    maxX = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.equity_data, function(d,i){\n        // if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return 100;\n        // if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return 100;\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return 100;\n    });\n\n    maxZ = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]).nice();\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart-tab').append('g').attr('transform', 'translate('+x+', '+y+')')\n    .attr('id', 'bubblechart');\n\n    // create y-axis\n    svg.append(\"g\")\n    .attr('id', 'bubbley')\n    .call(d3.axisLeft(yScale).ticks(3).tickSize(3));\n\n    // create x-axis\n    svg.append(\"g\")\n    .attr('id', 'bubblex')\n    .attr('class', 'xAxis')\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(xScale).ticks(4).tickSize(3));\n\n    // Add dots\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.equity_data)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        }).attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccince_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 3);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 2);\n    });\n\n    d3.select('#bubblechart_tooltip').attr('display', 'none');\n\n    d3.select('#bubble_y_axis_label').attr('text-anchor', 'middle').select('tspan').attr('dx', 50);\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n\n\n}\n\nexport function updateBubblechart(data,options,filter) {\n    \n    data.vGroup.forEach(function(d,i){\n        data.equity_data.forEach(function(dd,ii){\n            if(d[0] == dd.country_iso3){\n                dd.people_fully_vaccinated_per_hundred = parseFloat(d[1][0].people_fully_vaccinated_per_hundred);\n                dd.people_vaccinated_per_hundred = parseFloat(d[1][0].people_vaccinated_per_hundred);\n                dd.total_vaccinations = parseFloat(d[1][0].total_vaccinations);\n                dd.total_vaccinations_per_hundred = parseFloat(d[1][0].total_vaccinations_per_hundred);\n\n            }\n        })\n    })\n\n    maxX = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.equity_data, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccince_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.equity_data, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart');\n\n    // create y-axis\n    svg.select('#bubbley')\n    .transition().duration(800)\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.select('#bubblex')\n    .transition().duration(800)\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.equity_data)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"cx\", function (d) { return xScale(maxX)})\n        .attr(\"cy\", function (d) { return yScale(maxY)})\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .transition().duration(800)\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccince_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        }).attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccince_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccince_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n    \n    \n\n\n}\n\nexport default drawBubblechart;\n"]},"metadata":{},"sourceType":"module"}