{"ast":null,"code":"import*as d3 from\"d3\";import moment from'moment';import colors from'./colors';import{addCommas,nFormatter}from'./HelperFunctions';import{filter}from'./App';var maxX=1000;var maxY=100;var maxZ=1000000;var xScale;var yScale;var zScale;var groupedData=[];var width=600;var height=233;var x=35;var y=58;var bubbles;export function drawBubblechart(data,options,filter){maxX=d3.max(data.country,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.country,function(d,i){// if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\nif(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return 100;// if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\nif(options.bubble_chart_y_axis=='percent-fully-vaccinated')return 100;if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return 100;});maxZ=d3.max(data.country,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]).nice();yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart-tab').append('g').attr('transform','translate('+x+', '+y+')').attr('id','bubblechart');// create y-axis\nsvg.append(\"g\").attr('id','bubbley').call(d3.axisLeft(yScale).ticks(3).tickSize(3));// create x-axis\nsvg.append(\"g\").attr('id','bubblex').attr('class','xAxis').attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(xScale).ticks(4).tickSize(3));// Add dots\nbubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.country).join(function(enter){enter.append(\"circle\").attr(\"class\",function(d){return\"bubble\";}).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccine_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){// if(options.bubble_chart_color_by == 'region') {\n//    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n// } \n// if(options.bubble_chart_color_by == 'hdi') {\n//     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n//  }\n//  if(options.bubble_chart_color_by == 'inform-severity') {\n//     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n//  }\n// return  'transparent';\nreturn'#FFF';}).style(\"stroke-width\",1)// .style(\"fill-opacity\", 0.8)\n.attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(update){update.transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccine_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){// if(options.bubble_chart_color_by == 'region') {\n//    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n// } \n// if(options.bubble_chart_color_by == 'hdi') {\n//     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n//  }\n//  if(options.bubble_chart_color_by == 'inform-severity') {\n//     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n//  }\n// return  'transparent';\nreturn'#FFF';}).attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(exit){exit.remove();});d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove',function(event,d){d3.select('#bubbleSelectContainer').style('z-index',1);d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.vaccine_acceptance_percent).toFixed(2)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\",\"end\").attr('dx',37);d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\",\"end\").attr('dx',37);var coords=d3.pointer(event,d3.select('#svg').node());if(coords[0]<1110){d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_right').attr('display','none');}else{d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','none');d3.select('#bubblechart_tooltip_arrow_right').attr('display','inline');}d3.selectAll(\".bubble\").attr('opacity',0.4);d3.select(this).attr('opacity',1).style('stroke-width',2);}).on('mouseout',function(event){if(event.toElement=='tspan')return false;d3.select('#bubbleSelectContainer').style('z-index',2);// mapTooltip.attr('display', 'none');\nd3.select('#bubblechart_tooltip').attr('display','none');d3.selectAll(\".bubble\").attr('opacity',1).style('stroke-width',1);});d3.select('#bubblechart_tooltip').attr('display','none');d3.select('#bubble_y_axis_label').attr('text-anchor','middle').select('tspan').attr('dx',50);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');}}export function updateBubblechart(data,options,filter){maxX=d3.max(data.country,function(d,i){return parseFloat(d.gni_2017);});maxY=d3.max(data.country,function(d,i){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return parseFloat(d.people_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return parseFloat(d.people_fully_vaccinated_per_hundred);if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return parseFloat(d.vaccine_acceptance_percent);});maxZ=d3.max(data.country,function(d,i){return parseFloat(d.population);});xScale=d3.scaleLinear().range([0,width]).domain([0,maxX]);yScale=d3.scaleLinear().range([height,0]).domain([0,maxY]);zScale=d3.scaleSqrt().domain([0,maxZ]).range([1,20]);var svg=d3.select('#bubblechart');// create y-axis\nsvg.select('#bubbley').transition().duration(800).call(d3.axisLeft(yScale).ticks(3));// create x-axis\nsvg.select('#bubblex').transition().duration(800).call(d3.axisBottom(xScale).ticks(3));bubbles=d3.select('#bubblechart').selectAll(\".bubble\").data(data.country).join(function(enter){enter.append(\"circle\").attr(\"cx\",function(d){return xScale(maxX);}).attr(\"cy\",function(d){return yScale(maxY);}).attr(\"class\",function(d){return\"bubble\";}).transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccine_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).style(\"stroke\",function(d){// if(options.bubble_chart_color_by == 'region') {\n//    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n// } \n// if(options.bubble_chart_color_by == 'hdi') {\n//     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n//  }\n//  if(options.bubble_chart_color_by == 'inform-severity') {\n//     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n//  }\n// return  'transparent';\nreturn'#FFF';}).style(\"stroke-width\",1)// .style(\"fill-opacity\", 0.8)\n.attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return 0;return 1;});},function(update){update.attr('display',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return'none';return'inline';}).attr('opacity',function(d,i){var val=0;if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')val=yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')val=yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')val=yScale(parseFloat(d.vaccine_acceptance_percent));if(isNaN(val))return 0;return 1;}).style(\"fill\",function(d){if(options.bubble_chart_color_by=='region'){if(colors.regions[d.ifrc_region])return colors.regions[d.ifrc_region];}if(options.bubble_chart_color_by=='hdi'){if(colors.hdi_category[d.hdi_category])return colors.hdi_category[d.hdi_category];}if(options.bubble_chart_color_by=='inform-severity'){if(colors.inform_severity[d.inform_severity])return colors.inform_severity[d.inform_severity];}return'transparent';}).transition().duration(800).attr(\"cx\",function(d){return xScale(parseFloat(d.gni_2017));}).attr(\"cy\",function(d){if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose')return yScale(parseFloat(d.people_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-fully-vaccinated')return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));if(options.bubble_chart_y_axis=='percent-vaccine-acceptance')return yScale(parseFloat(d.vaccine_acceptance_percent));}).attr(\"r\",function(d){return zScale(parseFloat(d.population));});},function(exit){exit.remove();});d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove',function(event,d){d3.select('#bubbleSelectContainer').style('z-index',1);d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.vaccine_acceptance_percent).toFixed(2)+'%').attr(\"text-anchor\",\"end\").attr('dx',37);}d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\",\"end\").attr('dx',37);d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\",\"end\").attr('dx',37);var coords=d3.pointer(event,d3.select('#svg').node());if(coords[0]<1110){d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_right').attr('display','none');}else{d3.select('#bubblechart_tooltip').attr('transform','translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display','inline');d3.select('#bubblechart_tooltip_arrow_left').attr('display','none');d3.select('#bubblechart_tooltip_arrow_right').attr('display','inline');}d3.selectAll(\".bubble\").attr('opacity',0.4);d3.select(this).attr('opacity',1).style('stroke-width',2);}).on('mouseout',function(event){if(event.toElement=='tspan')return false;d3.select('#bubbleSelectContainer').style('z-index',2);// mapTooltip.attr('display', 'none');\nd3.select('#bubblechart_tooltip').attr('display','none');d3.selectAll(\".bubble\").attr('opacity',1).style('stroke-width',1);});if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');}if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');}if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');}}export default drawBubblechart;","map":{"version":3,"sources":["/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/Bubblechart.js"],"names":["d3","moment","colors","addCommas","nFormatter","filter","maxX","maxY","maxZ","xScale","yScale","zScale","groupedData","width","height","x","y","bubbles","drawBubblechart","data","options","max","country","d","i","parseFloat","gni_2017","bubble_chart_y_axis","population","scaleLinear","range","domain","nice","scaleSqrt","svg","select","append","attr","call","axisLeft","ticks","tickSize","axisBottom","selectAll","join","enter","people_vaccinated_per_hundred","people_fully_vaccinated_per_hundred","vaccine_acceptance_percent","style","bubble_chart_color_by","regions","ifrc_region","hdi_category","inform_severity","val","isNaN","update","transition","duration","exit","remove","on","event","text","country_name","toFixed","Math","round","parseInt","coords","pointer","node","toElement","updateBubblechart"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport moment from 'moment';\nimport colors from './colors';\nimport {addCommas, nFormatter} from './HelperFunctions';\nimport {filter} from './App';\n\nlet maxX =1000;\nlet maxY = 100;\nlet maxZ = 1000000;\nlet xScale; \nlet yScale; \nlet zScale; \nlet groupedData = [];\nlet width = 600;\nlet height = 233;\nlet x = 35;\nlet y = 58;\nlet bubbles;\n\nexport function drawBubblechart(data, options, filter) {\n\n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        // if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return 100;\n        // if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return 100;\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return 100;\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]).nice();\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart-tab').append('g').attr('transform', 'translate('+x+', '+y+')')\n    .attr('id', 'bubblechart');\n\n    // create y-axis\n    svg.append(\"g\")\n    .attr('id', 'bubbley')\n    .call(d3.axisLeft(yScale).ticks(3).tickSize(3));\n\n    // create x-axis\n    svg.append(\"g\")\n    .attr('id', 'bubblex')\n    .attr('class', 'xAxis')\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(xScale).ticks(4).tickSize(3));\n\n    // Add dots\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update.transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        }).attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    d3.select('#bubblechart_tooltip').attr('display', 'none');\n\n    d3.select('#bubble_y_axis_label').attr('text-anchor', 'middle').select('tspan').attr('dx', 50);\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n\n\n}\n\nexport function updateBubblechart(data,options,filter) {\n    \n    maxX = d3.max(data.country, function(d,i){\n        return parseFloat(d.gni_2017);\n    })\n\n    maxY = d3.max(data.country, function(d,i){\n        if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return parseFloat(d.people_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return parseFloat(d.people_fully_vaccinated_per_hundred);\n        if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return parseFloat(d.vaccine_acceptance_percent);\n    });\n\n    maxZ = d3.max(data.country, function(d,i){\n        return parseFloat(d.population);\n    });\n\n    xScale = d3.scaleLinear()\n\t.range([0, width])\n\t.domain([0, maxX]);\n\n    yScale = d3.scaleLinear()\n\t.range([height, 0])\n\t.domain([0, maxY]);\n\n    zScale = d3.scaleSqrt()\n    .domain([0, maxZ])\n    .range([1, 20]);\n\n    const svg = d3.select('#bubblechart');\n\n    // create y-axis\n    svg.select('#bubbley')\n    .transition().duration(800)\n    .call(d3.axisLeft(yScale).ticks(3));\n\n    // create x-axis\n    svg.select('#bubblex')\n    .transition().duration(800)\n    .call(d3.axisBottom(xScale).ticks(3));\n\n    bubbles = d3.select('#bubblechart').selectAll(\".bubble\")\n    .data(data.country)\n    .join(function(enter){\n        enter.append(\"circle\")\n        .attr(\"cx\", function (d) { return xScale(maxX)})\n        .attr(\"cy\", function (d) { return yScale(maxY)})\n        .attr(\"class\", function(d) { return \"bubble\" })\n        .transition().duration(800)\n        .attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .style(\"stroke\", function (d) { \n            // if(options.bubble_chart_color_by == 'region') {\n            //    if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            // } \n            // if(options.bubble_chart_color_by == 'hdi') {\n            //     if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n            //  }\n            //  if(options.bubble_chart_color_by == 'inform-severity') {\n            //     if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n            //  }\n            // return  'transparent';\n            return '#FFF';\n        })\n        .style(\"stroke-width\", 1)\n        // .style(\"fill-opacity\", 0.8)\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        })\n        .attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n    }, function(update){\n        update\n        .attr('display', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 'none'\n            return 'inline';\n        }).attr('opacity', function(d,i){\n            var val = 0;\n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') val = yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') val = yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') val = yScale(parseFloat(d.vaccine_acceptance_percent));\n            if(isNaN(val))return 0;\n            return 1;\n        })\n        .style(\"fill\", function (d) { \n            if(options.bubble_chart_color_by == 'region') {\n               if(colors.regions[d.ifrc_region]) return colors.regions[d.ifrc_region];\n            } \n            if(options.bubble_chart_color_by == 'hdi') {\n                if(colors.hdi_category[d.hdi_category]) return colors.hdi_category[d.hdi_category];\n             }\n             if(options.bubble_chart_color_by == 'inform-severity') {\n                if(colors.inform_severity[d.inform_severity]) return colors.inform_severity[d.inform_severity];\n             }\n            return  'transparent';\n        })\n        .transition().duration(800).attr(\"cx\", function (d) { return xScale(parseFloat(d.gni_2017)); } )\n        .attr(\"cy\", function (d) { \n            if(options.bubble_chart_y_axis == 'percent-vaccinated-at-least-1-dose') return yScale(parseFloat(d.people_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-fully-vaccinated') return yScale(parseFloat(d.people_fully_vaccinated_per_hundred));\n            if(options.bubble_chart_y_axis == 'percent-vaccine-acceptance') return yScale(parseFloat(d.vaccine_acceptance_percent));\n        })\n        .attr(\"r\", function (d) { return zScale(parseFloat(d.population)); } )\n        \n        \n    },function(exit){\n        exit.remove();\n    });\n\n    d3.select('#bubblechart').selectAll(\".bubble\").on('mousemove', function(event, d){\n        d3.select('#bubbleSelectContainer').style('z-index', 1);\n        d3.select('#bubblechart_tooltip_title tspan').text(d.country_name);\n        if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccinated at least 1 dose');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% fully vaccinated');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat(d.people_fully_vaccinated_per_hundred)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n            d3.select('#bubblechart_tooltip_label tspan').text('% vaccine acceptance');\n            d3.select('#bubblechart_tooltip_value tspan').text(parseFloat((d.vaccine_acceptance_percent)).toFixed(2)+'%')\n            .attr(\"text-anchor\", \"end\").attr('dx', 37)\n        }\n        d3.select('#bubblechart_tooltip_gni tspan').text('$'+addCommas(Math.round(parseFloat(d.gni_2017)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        d3.select('#bubblechart_tooltip_population tspan').text(nFormatter(Math.round(parseInt(d.population)))).attr(\"text-anchor\", \"end\").attr('dx', 37)\n        var coords = d3.pointer( event, (d3.select('#svg').node()));\n        if(coords[0]<1110){\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]+20)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'none');\n        } else {\n            d3.select('#bubblechart_tooltip').attr('transform', 'translate('+(coords[0]-220)+','+(coords[1]+y-90)+')').attr('display', 'inline');\n            d3.select('#bubblechart_tooltip_arrow_left').attr('display', 'none');\n            d3.select('#bubblechart_tooltip_arrow_right').attr('display', 'inline');\n        }\n        d3.selectAll(\".bubble\").attr('opacity', 0.4);\n        d3.select(this).attr('opacity', 1).style('stroke-width', 2);\n    }).on('mouseout', function(event){\n        if(event.toElement=='tspan') return false;\n        d3.select('#bubbleSelectContainer').style('z-index', 2);\n\n        // mapTooltip.attr('display', 'none');\n        d3.select('#bubblechart_tooltip').attr('display', 'none');\n        d3.selectAll(\".bubble\").attr('opacity', 1).style('stroke-width', 1);\n    });\n\n    if(options.bubble_chart_y_axis=='percent-vaccinated-at-least-1-dose'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccinated at least 1 dose');\n    }\n    if(options.bubble_chart_y_axis=='percent-fully-vaccinated'){\n        d3.select('#bubble_y_axis_label tspan').text('% fully vaccinated');\n    }\n    if(options.bubble_chart_y_axis=='percent-vaccine-acceptance'){\n        d3.select('#bubble_y_axis_label tspan').text('% vaccine acceptance');\n    }\n    \n    \n\n\n}\n\nexport default drawBubblechart;\n"]},"metadata":{},"sourceType":"module"}