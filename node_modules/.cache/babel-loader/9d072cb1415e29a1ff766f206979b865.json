{"ast":null,"code":"var _jsxFileName = \"/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport Select from 'react-select';\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport { drawTimechart, updateTimechart } from './Timechart';\nimport { drawRegionchart, updateRegionchart } from './Regionchart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css';\nimport $ from \"jquery\";\nimport select2 from 'select2';\nimport 'select2/dist/css/select2.min.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\nconst whoDataUrl = \"./data/who_global_cases.csv\";\nconst worldUrl = \"./data/world-wb5.geojson\";\nconst data = {\n  'data': []\n};\nconst regionOptions = [{\n  id: 'AM',\n  text: 'Americas'\n}, {\n  id: 'EU',\n  text: 'Europe'\n}, {\n  id: 'AP',\n  text: 'Asia-Pacific'\n}, {\n  id: 'ME',\n  text: 'Middle East and North Africa'\n}, {\n  id: 'AF',\n  text: 'Africa'\n}];\nconst countryOptions = [];\n\nfunction App() {\n  _s();\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...'); // const [countryOptions, setCountryOptions] = useState([]);\n\n  async function init() {\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function (d) {\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', 'auto').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      Layout(svg, options, data);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...'); // data source 2: equity_data.csv\n\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function (d) {\n        data.equity_data = d;\n        d.forEach(function (d, i) {\n          // console.log(d);\n          countryOptions.push({\n            'label': d.country_name,\n            'value': d.country_iso2\n          });\n        });\n        console.log(countryOptions);\n        createSelects();\n        setProgress(0.3);\n        setLoaderText('Loading WHO data CSV...'); // data source 3: who_global_cases.csv\n\n        const whoData = d3.csv(whoDataUrl);\n        whoData.then(function (d) {\n          data.who_data = d;\n          setProgress(0.8);\n          setLoaderText('Loading World Map GeoJSON...'); // data source 4: world-wb5.geojson\n\n          const world = d3.csv(worldUrl);\n          world.then(function (d) {\n            data.world = d;\n            setLoaderText('Loading complete.');\n            setProgress(1);\n            ParseData(data);\n            createCharts();\n            console.log(data);\n            d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n          });\n        });\n      });\n    });\n  }\n\n  function createCharts() {\n    drawTimechart(data, options);\n    drawRegionchart(data, options);\n  }\n\n  function createSelects() {\n    // region select\n    $('#regionSelect').select2({\n      data: regionOptions,\n      placeholder: 'LOCATIONS',\n      scrollAfterSelect: true,\n      renderTemplate: item => item.text || '\\u200B',\n      dropdownParent: $('#regionDrop'),\n      shouldFocusInput: function () {\n        return false;\n      },\n      templateResult: function (data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n    });\n  }\n\n  useEffect(() => {\n    init();\n  }, []);\n  const selectStyle = {\n    control: (base, state) => ({ ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n        border: '1px solid #D8D8D8'\n      }\n    })\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"loaderDiv\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"loaderText\",\n        children: loaderText\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"loaderBar\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"loaderProgress\",\n          style: {\n            width: progress * 100 + '%'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"regionSelectContainer\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"regionSelect\",\n        class: \"js-example-responsive\",\n        name: \"states[]\",\n        multiple: \"multiple\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"regionSelectSub\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"regionDrop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"svg_container\",\n      className: \"App\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"dIWdRh6Aq0pdUXjFSLJaJri2VpA=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/matthewsmawfield/www/ifrc-covid-dataviz/src/App.js"],"names":["React","useEffect","useState","Select","d3","Layout","drawTimechart","updateTimechart","drawRegionchart","updateRegionchart","options","ParseData","$","select2","equityDataUrl","layoutUrl","whoDataUrl","worldUrl","data","regionOptions","id","text","countryOptions","App","progress","setProgress","loaderText","setLoaderText","init","layout","xml","then","d","select","node","append","documentElement","attr","svg","remove","equityData","csv","equity_data","forEach","i","push","country_name","country_iso2","console","log","createSelects","whoData","who_data","world","createCharts","transition","duration","style","on","placeholder","scrollAfterSelect","renderTemplate","item","dropdownParent","shouldFocusInput","templateResult","$state","selectStyle","control","base","state","border","boxShadow","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Select from 'react-select'\nimport * as d3 from \"d3\";\nimport Layout from './Layout';\nimport {drawTimechart, updateTimechart} from './Timechart';\nimport {drawRegionchart, updateRegionchart} from './Regionchart';\nimport options from './Options';\nimport ParseData from './ParseData';\nimport './App.css'\nimport $ from \"jquery\";\nimport select2 from 'select2';\nimport 'select2/dist/css/select2.min.css'\n\nconst equityDataUrl = './data/equity_data.csv';\nconst layoutUrl = \"./images/layout.svg\";\nconst whoDataUrl = \"./data/who_global_cases.csv\";\nconst worldUrl = \"./data/world-wb5.geojson\";\n\nconst data = {'data': []};\n\nconst regionOptions = [\n  { id: 'AM', text: 'Americas' },\n  { id: 'EU', text: 'Europe' },\n  { id: 'AP', text: 'Asia-Pacific' },\n  { id: 'ME', text: 'Middle East and North Africa'},\n  { id: 'AF', text: 'Africa' }\n]\n\nconst countryOptions = [];\n\nfunction App() {\n\n  const [progress, setProgress] = useState(0);\n  const [loaderText, setLoaderText] = useState('Loading SVG layout...');\n  // const [countryOptions, setCountryOptions] = useState([]);\n\n  async function init(){\n\n    // data source 1: layout.svg\n    const layout = d3.xml(layoutUrl);\n    layout.then(function(d){\n      d3.select('#svg_container').node().append(d3.select(d.documentElement).attr('width', '100%').attr('height', 'auto').node());\n      const svg = d3.select('#svg_container svg');\n      svg.select('title').remove();\n      Layout(svg, options, data);\n      setProgress(0.1);\n      setLoaderText('Loading equity data CSV...');\n      // data source 2: equity_data.csv\n      const equityData = d3.csv(equityDataUrl);\n      equityData.then(function(d){\n        data.equity_data = d;\n\n        d.forEach(function(d,i){\n          // console.log(d);\n          countryOptions.push({'label': d.country_name, 'value': d.country_iso2 })\n        })\n        console.log(countryOptions);\n        createSelects();\n\n        setProgress(0.3);\n        setLoaderText('Loading WHO data CSV...');\n          // data source 3: who_global_cases.csv\n          const whoData = d3.csv(whoDataUrl);\n          whoData.then(function(d){\n            data.who_data = d;\n            setProgress(0.8);\n            setLoaderText('Loading World Map GeoJSON...');\n            // data source 4: world-wb5.geojson\n            const world = d3.csv(worldUrl);\n            world.then(function(d){\n              data.world = d;\n              setLoaderText('Loading complete.');\n              setProgress(1);\n              ParseData(data);\n              createCharts();\n              console.log(data);\n              d3.select('#loaderDiv').transition().duration(1000).style('opacity', 0).on(\"end\", () => d3.select('#loaderDiv').remove());\n            });\n          });\n      });\n    })\n  }\n  \n  function createCharts(){\n    drawTimechart(data, options);\n    drawRegionchart(data, options);\n  }\n\n  function createSelects(){\n     // region select\n      $('#regionSelect').select2({\n        data: regionOptions,\n        placeholder: 'LOCATIONS',\n        scrollAfterSelect: true,\n        renderTemplate: item => item.text || '\\u200B',\n        dropdownParent: $('#regionDrop'),\n        shouldFocusInput: function() {\n        return false;\n      },\n        templateResult: function(data) {\n        var $state = $('<span>' + data.text + '<span>');\n        return $state;\n      }\n      });\n  }\n\n  useEffect(() => {\n    init();\n  }, [])\n\n\n  const selectStyle = {\n    control: (base, state) => ({\n      ...base,\n      border: '1px solid #D8D8D8',\n      boxShadow: 'none',\n      '&:hover': {\n          border: '1px solid #D8D8D8',\n      }\n  })\n  };\n\n  return (\n    <div>\n      <div id=\"loaderDiv\">\n        <div id=\"loaderText\">{loaderText}</div>\n        <div id=\"loaderBar\">\n          <div id=\"loaderProgress\" style={{width: progress*100+'%'}}></div>\n        </div>\n      </div>\n\n      <div id=\"regionSelectContainer\">\n      <select id=\"regionSelect\" class=\"js-example-responsive\" name=\"states[]\" multiple=\"multiple\"></select>\n\n        <div id=\"regionSelectSub\">\n      </div>\n      <div id=\"regionDrop\"></div>\n\n\n        {/* <Select id=\"regionSelect\" options={regionOptions} styles={selectStyle} isMulti hideSelectedOptions={true}/> */}\n      </div>\n      {/* <div id=\"countrySelectContainer\">\n        <Select id=\"countrySelect\" options={countryOptions} styles={selectStyle} isMulti/>\n      </div> */}\n\n    <div id=\"svg_container\" className=\"App\">\n\n    </div>\n\n\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}